<!DOCTYPE HTML PUBLIC  "-//IETF//DTD HTML Strict//EN">
<html>
<head>
<title>OpenBSD Patch Branches</title>
<link rev=made href=mailto:www@openbsd.org>
<meta name="resource-type" content="document">
<meta name="description" content="stable">
<meta name="keywords" content="openbsd,anoncvs,updates,stable">
<meta name="distribution" content="global">
<meta name="copyright" content="This document copyright 1996-1998 by OpenBSD.">
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#23238E">

<img alt="[OpenBSD]" height=30 width=141 SRC="images/smalltitle.gif">
<p>
<h2><font color=#e00000>Patch Branches</font><hr></h2>

<p>
<ul><h3>Table Of Contents</h3>
<li><a href="#whatis">What is a patch branch?</a>
<li><a href="#getting">Getting a patch branch</a>
<li><a href="#building">Building from a patch branch</a>
</ul>
</p>
<hr>

<a name="whatis"></a>
<h3><font color=#0000e0>What is a patch branch?</font></h3>

<p>
Starting with 2.7, the OpenBSD project is providing a source
tree that contains the patches and fixes from the
<a href="errata.html">errata</a> and making
it available via <a href="anoncvs.html">CVS</a> in addition to the
current source.  Users can choose to follow either branch: current
for those who want/need all of the latest features, and the patch
branch for those who want to stick with releases and only require
the fixes and patches between releases.

<a name="getting"></a>
<h3><font color=#0000e0>Getting a patch branch</font></h3>

<p>
To obtain a patch branch for a particular release of OpenBSD, you
can either start with a source tree from the CD shipped with the release
of OpenBSD you want to use (see <a href="orders.html">ordering</a>), or
you can grab the whole tree from an <a href="anoncvs.html">AnonCVS</a> server.
The instructions for getting a patch branch and staying up to date are
described in the Getting Started section of the
<a href="anoncvs.html#starting">AnonCVS documentation</a>.

<p>
Please note that the patch branches are not helpful for upgrading from one
release of OpenBSD to another, eg. to go from 2.5 to 2.6.  They only provide
a means for staying up to date with the patches for a given release.  If
you are trying to go from one release to another via source, please visit
the <a href="faq/upgrade-minifaq.html">upgrade-minifaq</a>.

<a name="building"></a>
<h3><font color=#0000e0>Building from an OpenBSD patch branch</font></h3>
Once you have obtained a source tree via <a href="anoncvs.html">anoncvs</a>,
you must rebuild the system.  The stages for doing so are:

<ul>
 <li>Rebuild the kernel
 <li>Reboot with the new kernel
 <li>Rebuild the binaries
</ul>

<h4><font color=#0000e0>Rebuilding the kernel</font></h4>

<p>
To rebuild the default kernel from stable:
<pre>
# cd /usr/src/sys/arch/i386/conf
# /usr/sbin/config GENERIC
# cd /usr/src/sys/arch/i386/compile/GENERIC
# make clean &amp;&amp; make depend &amp;&amp; make
</pre>

<p>
Replace <i>i386</i> with your architecture, eg.
<i>sparc</i>, <i>alpha</i>, etc.

<h4><font color=#0000e0>Rebooting with the new kernel</font></h4>

<p>
To reboot with the newly compiled kernel:
<pre>
# cd /usr/src/sys/arch/i386/compile/GENERIC
# cp /bsd /bsd.old          <i>(Save an old copy of your kernel)</i>
# cp bsd /bsd               <i>(Copy the new kernel into place)</i>
# reboot
</pre>

<p>
As above, substitute your architecture for <i>i386</i>.  If your system has
trouble booting the new kernel, you can easily go back and reboot from the
old kernel, now called <i>bsd.old</i>.

<h4><font color=#0000e0>Rebuilding the binaries</font></h4>

<p> To rebuild the system binaries:
<pre>
# cd /usr/src
# rm -r /usr/obj/*
# make obj &amp;&amp; make build
</pre>

<p>This will take awhile...
<hr>
<a href=index.html><img height=24 width=24 src=back.gif border=0 alt=OpenBSD></a>
<a href=mailto:www@openbsd.org>www@openbsd.org</a>
<br><small>$OpenBSD: stable.html,v 1.2 2000/05/29 07:58:56 deraadt Exp $</small>
</body>
</html>


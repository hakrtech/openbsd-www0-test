<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-2022-jp">
<meta name="resource-type" content="document">
<meta name="description" content="The OpenBSD Ports and Packages Collection">
<meta name="keywords" content="openbsd,ports">
<meta name="distribution" content="global">
<meta name="copyright" content="copyright 1997-2004 by OpenBSD.">
<title>OpenBSD Ports and Packages</title>
<link rev="made" href="mailto:www@openbsd.org">
</head>

<body text="#000000" bgcolor="#FFFFFF" link="#23238E">

<a href="index.html"><img alt="[OpenBSD]" height="30" width="141" src="../images/smalltitle.gif" border="0"></a>

<h2><font color="#e00000">Ports &amp; Packages コレクション</font></h2>

<hr>

<h3><font color="#0000e0">目次</font></h3>
<ul>
<li><a href="#Motivation">動機</a></li>
<li><a href="#Get">Packages の入手</a></li>
<li><a href="#stable">OpenBSD のリリースに合わせた Ports および Packages の更新</a></li>
<li><a href="#Manage">インストール済 Packages の管理</a></li>
<li><a href="#Use">Ports を使用する</a></li>
<li><a href="#Life">Ports ツリーのライフサイクル</a></li>
<li><a href="#XFree86">Ports と XFree86</a></li>
<li><a href="#Example">Ports ツリーの使用例</a></li>
<li><a href="#Advanced">Ports ツリーの使用例 (応用編)</a></li>
<li><a href="#Create">新しい Ports の作成</a></li>
<li><a href="#Lag">いつ Ports は主流のバージョンから遅れを取ってしまうのでしょう ?</a></li>
<li><a href="#Help">問題発生時の連絡先</a></li>
</ul>

<hr>

<h3><font color="#0000e0"><a name="Motivation">動機</a></font></h3>

OpenBSD は、それ自身がかなり完全なシステムですが、それでも誰かが追加してくれる
ことを期待したくなる多数のソフトウェアがあります。しかしながら、時おり発生する
ライセンスの問題や輸出制限の問題と同様、何を含めるかということに関する線引きを
どこで行うのかという問題があります。OpenBSD は、小さくて独立した UNIX ライクな
オペレーティングシステムとしてサポートされていますので、ものによってはシステム
に含めて出荷することができません。

<p>
<strong><font color="#e00000">
ports &amp; packages コレクションは、OpenBSD で行われている徹底的なセキュリティ監査を通していません。
私たちは packages コレクションの品質を高く保つために努力していますが、残念ながら、堅牢性とセキュリティを
同じレベルで保障できるだけの十分な人的リソースを有していません。
</font></strong>

<p>
もともと <a href="http://www.freebsd.org/">FreeBSD</a> のものを移植した
ports コレクションが、このギャップを埋めてくれるでしょう。そのコンセプトは、
それぞれのサードパーティ製ソフトウェアが、以下のことを制御することができる
Makefile を持つ、とういものです。
<ul>
<li>どこから取得してくるのか。
<li>どのようにして取得してくるのか。
<li>(それが何であれ) 依存しているものは何か。
<li>(もし、必要なら) どのようにしてソースを代替するのか。
<li>そして、どのようにして設定、構築し、インストールするのか。
</ul>
この情報は /usr/ports ディレクトリ以下のディレクトリ構造中に
保持されています。

<p>
packages は ports のバイナリ版です。コンパイル済の ports が packages であり、
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a>
を使用してシステムにインストールすることが可能なものです。

<p>
<strong><font color="#e00000">
packages は、単なる <code>.tgz</code> の集合体のように見えますが、
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a>
だけが理解する、どのように取り扱う必要があるのかなどの
特別な情報をいくつか持っているかも知れませんので、必ず
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a>
を使用してインストールしなければなりません。</font></strong>
ヒント: packages と単なる <strong>.tgz</strong> の集合体は、
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_info&amp;sektion=1&amp;format=html">pkg_info(1)</a>
を使用して区別することができます。

<h3><font color="#0000e0"><a name="Get">Packages の入手</a></font></h3>

コンパイル済 packages の大規模なコレクションは、ほとんどの
共通アーキテクチャ上で利用可能となっています。
<ul>
<li>(<a href="orders.html">こちら</a>から購入可能な) CDROM 上。
<li><a href=ftp.html>FTP ミラーサイト</a>上。
<li>以下の web package リストから検索して入手。
<ul>
<li><a href="http://www.openbsd.org/3.5_packages/">OpenBSD 3.5 用 packages</a>
</ul>
</ul>


packages の追加は非常に簡単で、
<code>pkg_add pkgname.tgz</code> とします。
もし、いつも同じ配布元 (パッケージリポジトリ) から packages を入手しているのでしたら、
取得の依存性に従って、PKG_PATH をその URL に設定しておいてください。

<p>
たとえば、FTP サイトから i386 マシン上の 3.5 リリース用の (依存性を含む)
Gimp パッケージをインストールする場合、次のようにします。

<pre>
    # setenv PKG_PATH ftp://ftp.openbsd.org/pub/OpenBSD/3.5/packages/i386/
    # pkg_add ${PKG_PATH}gimp-1.2.5.tgz
</pre>

<h3><font color="#0000e0"><a name="stable">OpenBSD のリリースに合わせた Ports および Packages の更新</a></font></h3>
<p>
2.7 リリースから、ports ツリーにも安定版ブランチが導入されるようになりました。
<p>
たとえば、3.5 リリース用の安定版ブランチを入手するには、次のようにしてください。
<pre>
    $ cd /usr/ports
    $ cvs -q -d anoncvs@some.anon.server:/cvs up -r OPENBSD_3_5 -Pd
</pre>
<p>
2.8 リリース以降では、選択されたバイナリパッケージも
利用可能になっています。
安定版ブランチに対する packages の更新と重要な更新については、
<a href="pkg-stable.html">安定版 packages のページ</a>
を参照してください。
</p>
<p>
リリースからのパッケージとバグ修正版パッケージとが区別できなくなる
危険性を回避するため、packages が更新された場合には、package
の名前は<strong>必ず</strong>変更されます。
</p>

<h3><font color="#0000e0"><a name="Manage">インストール済 Packages の管理</a></font></h3>

<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=packages&amp;sektion=7&amp;format=html">packages(7)</a>
マニュアルページには、インストール済 packages の管理の方法や
(ファイルが既に存在しているなどの) 衝突の解決、依存性の取り扱い
に関する、役に立つ情報が記載されています。
<p>
OpenBSD 2.8 の場合、packages を更新するには以下のようにします。
<ul>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_delete&amp;sektion=1&amp;format=html">pkg_delete(1)</a> 
を使用して、古い packages を消去。
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> 
を使用して、新しい packages をインストール。
</ul>
この方法は、依存性の引き金を引くことになるかも知れませんし、更新のために packages
の大きなサブセットを消去しなければならなくなるかも知れませんので、やや不便な方法ではあります。

<h3><font color="#0000e0"><a name="Use">Ports を使用する</a></font></h3>

使用中のアーキテクチャ用の packages が存在していない場合でも、ports から
コンパイルを行うことは可能です。さらに、さまざまな理由から、何でもソースから
コンパイルしないと気が済まないユーザもいます。

<p>
<a href=ftp.html>FTP ミラーサイト</a>のいずれかの pub/OpenBSD/[version]
(ここで、[version] はリリースバージョン番号のことです) ディレクトリから
リリースバージョンを ftp で取得することができます。
リリースバージョンとは、CDROM で出荷されているバージョンのことで、他のどのような
スナップショットよりも入念なテストを経ています。より詳しくは、
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ports&amp;sektion=7&amp;format=html">ports(7)</a>
man ページを参照してください。

<h3><font color="#0000e0"><a name="Life">Ports ツリーのライフサイクル</a></font></h3>

<p>
ports ツリーは、残りの OpenBSD のツリーと同様、絶えず変化しています。
<p>
現在の ports ツリーは、前回のリリースバージョン用には<strong>使用できないかも知れません
</strong>。これは、典型的には ports を作成するプロセスの、OpenBSD-current
のソースツリーに基づくコードを要求するような変更に起因しています。
<p>ports ツリーは単一の実体として動作します。ひとつのディレクトリだけを更新しても、
packages の依存性が、ports ツリーの膨大な部分を更新し、再コンパイルすることを
要求してくるかも知れませんので、動作は保障されません。
ですから、さまざまな問題に対処する準備ができていない場合には、ports-current
を追いかけるべきではないということを、強くお勧めします。また、
<code>ports-changes@openbsd.org</code> や
<code>tech@openbsd.org</code> のような
<a href=mail.html>メーリングリスト</a>は非常に参考になることでしょう。

<p>業務用のマシン上では、安定版の ports を追いかけることをお勧めします。
私たちは、問題に対して、ある基準に達するよう、安定版の ports ツリーを維持するよう、
また同様に、バイナリもタイムリーに更新するよう、努めています。

<p>ftp.openbsd.org では、完全なリポジトリを保持していますので、配布ファイルが
消えてなくなることは問題ではないということに注意してください。また、同様に、
チェックサムが変化することも問題ではなく、
<pre>
	make checksum REFETCH=true 
</pre>
とすることで、使用中の ports ツリー用の正しい配布ファイルを確実に取得することも可能なのです。

<i>current</i> および<i>安定版</i>の記述に関しては、
<a href="../faq/ja/upgrade-minifaq.html#1.1">アップグレード ミニ FAQ</a>
を参照してください。


<p>ports および ports-current の<a href="../portsplus/ja/index.html">日々の変更</a>
のリストも用意されています。

<p>
ports-current のツリーは以下のところから入手可能です。
<ul>
<li><a href=anoncvs.html>Anonymous CVS</a> (リンクを参照してください)。
基本的なコマンドは <strong>cvs get ports</strong> です。
<li><a href="ftp://ftp.openbsd.org/pub/OpenBSD/snapshots/ports.tar.gz">
ftp://ftp.openbsd.org/pub/OpenBSD/snapshots/ports.tar.gz</a>
への Anonymous ftp。
	このアーカイブは毎夜更新されます。
<li><a href="cvsup.html">CVSup</a>。CVSup の
    <a href="cvsup.html#checkout">checkout mode</a> の使用例を参照してください。
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/ports/">CVS
	web インターフェイス</a>
への web アクセス。
</ul>

<h3><font color="#0000e0"><a name="XFree86">Ports と XFree86</a></font></h3>
OpenBSD の XFree86 の設定ファイルには、ports ツリーから /usr/local
の下の imake ベースのアプリケーションのインストールを可能とするための
ちょっとした仕掛けが用意されています。

<p>OpenBSD 2.9 は XFree86 4.0.3 とともに出荷されました。
もし、それ以前のディストリビューションを、XFree86 プロジェクトの XFree86 バイナリとともに
使用している場合には、OpenBSD の ports ツリーとともに使用可能とするため、
<code>/usr/ports/infrastructure/patches/patch-xfree-4.0</code>
にあるパッチを、デフォルトのバイナリの XFree86 4.0.x ディストリビューションに
適用する必要があるかも知れません。

<h3><a name="Example"></a><font color="#0000e0">Ports ツリーの使用例</font></h3>

<p>
何とか ports ツリーを入手したので、アーカイブユーティリティの <strong>unzip</strong>
をコンパイルしてインストールしたい、とします。
その場合には、以下のようにすれば良いでしょう。

<pre>
    % cd /usr/ports/archivers/unzip
    % su
    # make
    # make install
    # exit
</pre>

簡単だったでしょう ?  特別に、その裏側で何が起きているのかをすべて見てみましょう。
<ul>
<li>ftp サイトからの unzip のソースの取得。
<li>ソースアーカイブの完全性のチェック。
<li>unzip のソースの展開。
<li>OpenBSD 固有のパッチの適用。
<li>プログラムの構成とビルド。
<li>/usr/ports/packages の下にバイナリパッケージを生成。
<li>作成されたバイナリパッケージのインストール。
</ul>

<p>
OpenBSD 3.0 では、ほとんどすべての ports が、インストール時に
自動的に packages を生成します。

<p>
ports をビルドするため、/usr/ports/distfiles ディレクトリには、プログラムのソースが
置かれます。また、/usr/ports/packages ディレクトリには、バイナリパッケージが置かれます。
インターネットとの接続性の悪いユーザは、一度にすべての配布ファイルを取得するための十分な方法として、
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mirroring-ports&amp;sektion=7&amp;format=html">mirroring-ports(7)</a>
を参照してください。OpenBSD-current では、古い配布ファイルを追いかけるため、
/usr/ports/infrastructure/fetch/clean-old
スクリプトを使用することもできます。
OpenBSD CD には、ports ツリーと選択された packages が入っているだけということに注意してください。
もし、配布ファイルも必要なのでしたら、
他の方法でそれらを取得する必要があります。

<h3><font color="#0000e0"><a name="Advanced"></a>Ports ツリーの使用例 (応用編)</font></h3>

<p>
ports ツリーは、上級ユーザにとって、基本的なインストール以上に価値のあるツールに
するための多くの機能を持っています。上級ユーザは、makefile を変更したいと思うかも
知れません (まずは
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a>
マニュアルページをお読みください) し、make のコマンド行や <tt>/etc/mk.conf</tt>
ファイル内にいろいろな変数を設定したいと思うかも知れません。これらの変数は、その詳細が
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bsd.port.mk&amp;sektion=5&amp;format=html">bsd.port.mk(5)</a>
マニュアルページや、以下の移植のためのドキュメントの中に記述されています。
</p>

<h3><font color="#0000e0"><a name="Create">新しい Ports の作成</a></font></h3>
<p>
もし、OpenBSD の ports ツリーの拡張の支援に興味があるのでしたら、
まず、<a href="porting.html">porting.html</a> をお読みください。
このページは、OpenBSD 固有のポリシーやヒントと同様に、
<a href="http://www.freebsd.org/doc/en_US.ISO8859-1/books/porters-handbook/index.html">
FreeBSD Porter's Handbook</a>
も参照しています。

<h3><font color="#0000e0"><a name="Lag">いつ Ports は主流のバージョンから遅れを取ってしまうのでしょう ?</a></font></h3>

<p>
ports コレクションはボランティアベースのプロジェクトです。ときどき、プロジェクトは
すべてのものを更新し続けられるだけの開発者のリソースを有していないことがあります。
開発者は、実に多くの彼らがおもしろいと考えるものをピックアップし、彼らの環境でテストすることができます。
あなたの<a href="goals.html#funding">寄付</a>によって、
ports がどのようなプラットフォームに対応されるかが変わってくるのです。
</p>

<p>
いくつかの個別の ports が、この理由によって、主流のバージョンから遅れを取ることがあるかも知れません。
たとえば、3 ヶ月前の 5 月に、あるプログラムの元の開発者が新しいバージョンをリリースしたにも関わらず、
ports コレクションは、1 月のそのプログラムのより以前のバージョンかも知れません。
しばしば、これは意識的な決定なのです。新しいバージョンは、OpenBSD ではメンテナが解決を試みている最中の
問題を抱えているのかも知れませんし、単純に、そのアプリケーションが古いバージョンのものよりも
悪くなってしまっただけなのかも知れません。また、OpenBSD は、他のプロジェクトの主力開発者とは
異なる<a href="goals.html">目標</a>を持っているのかも知れませんから、
時として、選択された機能や設計、実装の結果が、OpenBSD の開発者の観点からは
好ましくないものであるのかも知れません。また、新しいバージョンが極めて重要な更新であるとは
考えられないために、ports の更新が延期されることもあります。
</p>

<p>
しかし、もし、本当に新しいバージョンの ports が必要な場合には、その ports の<tt>メンテナ</tt>に
ports を更新するよう、連絡を取ってみるべきでしょう (メンテナが誰なのかをどのようにして見つかるのかは。
<a href="#Help">以下の項目</a>をご覧ください)。もし、これについてのパッチを送ることができれば、それは
さらに良いことでしょう。また、適正なパッチを生成するためには、
<a href="porting.html">ports のビルドに関するドキュメント</a>に目を通してください。
</p>

<h3><font color="#0000e0"><a name="Help">問題発生時の連絡先</a></font></h3>

<p>
もし、既存の ports に問題点があった場合には、ports のメンテナに電子メールを
送ってください。その ports のメンテナが誰であるのかを知るためには、
たとえば、以下のようにしてください。
<pre>
       % cd /usr/ports/archivers/unzip
       % make show=MAINTAINER
</pre>
別の方法としては、もし、メンテナがいない場合や、あるいはメンテナに辿り着けない場合には、
OpenBSD ports メーリングリスト <a href="mailto:ports@openbsd.org">ports@openbsd.org</a>
にメールを送ってください。
ports に関する質問の場合、misc@openbsd.org メーリングリストを使用しないでください。
訂正は常に歓迎されますが、どのような場合においても以下の情報を用意してください。
<ul>
<li><code>uname -a</code> の出力。
<li>適用したかも知れないいかなるパッチも含む、使用中の OpenBSD のバージョン。
<li>遭遇した問題に関する完全な記述。
</ul>
ports が正常にビルドできない場合には、ほとんど常に、そのビルド時の記録が必要です。
そのために、/usr/ports/infrastructure/build にある portslogger スクリプトを
使用することができます。
portslogger の実行例は以下のようになります。

<pre>
       % cd /usr/ports/archivers/unzip
       % su
       # mkdir -p ~/portslogs
       # make clean install 2>&amp;1 | /usr/ports/infrastructure/build/portslogger \
               ~/portslogs
</pre>

これによって、~/portslogs ディレクトリ中に、ports のメンテナに送ることができる
このビルドのログファイルが生成されます。また、たとえば、/etc/mk.conf 中などで
特別なビルドオプションを使用していないことを確認しておいてください。

<p>
これ以外の方法として、
<ul>
<li>完全なビルドの記録を取るため、<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=script&amp;sektion=1&amp;format=html">script(1)</a> を使用してください。また、その際には configure の情報を削除しないようにしてください。
<li>少しでも関係がありそうなら、<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_info&amp;sektion=1&amp;format=html">pkg_info(1)</a> の出力を貼り付けてください。
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gcc&amp;sektion=1&amp;format=html">gcc(1)</a> の内部コンパイラエラーは、そのバグを gcc のメーリングリストに報告してください。
彼らの指示に従うことで、時間を節約することができるはずです。また、少なくとも、
<tt>gcc -save-temps</tt> によって生成されるさまざまなファイルを提供してください。
</ul>

<hr>
<a href="index.html"><img height=24 width=24 src=../back.gif border=0 alt=OpenBSD></a> 
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
Originally [OpenBSD: ports.html,v 1.78 ]
<br>
$Translation: ports.html,v 1.9 2004/05/04 12:18:41 toshi Exp $
<br>
$OpenBSD: ports.html,v 1.8 2004/05/09 09:58:23 saad Exp $
</small>
</body>
</html>

<html>
<head>
<title>OpenSSH FAQ</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright (C) 1999 OpenBSD">
</head>

<body bgcolor= "#ffffff" text= "#000000" link= "#23238E">
<img alt="[OpenSSH]" height=30 width=141 src="/images/smalltitle.gif">
<p>

<h1>OpenSSH FAQ (Frequently asked questions)</h1>

<strong>Date: 2001/06/02</strong>

<hr>

<ul>
<h3><a href= "#1.0">1.0 - What is OpenSSH and Where Can i get it?</a></h3>
	<ul>
	<li><a href= "#1.1">1.1 - What is OpenSSH?</a>
	<li><a href= "#1.2">1.2 - Why should it be used?</a>
	<li><a href= "#1.3">1.3 - What Operating Systems are supported?</a>
	<li><a href= "#1.4">1.4 - What about copyright, usage and patents?</a>
	<li><a href= "#1.5">1.5 - Where should I ask for help?</a>
	</ul>
<h3><a href= "#2.0">2.0 - General Questions</a></h3>
	<ul>
	<li><a href= "#2.1">2.1 - Why does ssh/scp make connections from low-numbered ports. My firewall blocks these.</a>
	<li><a href= "#2.2">2.2 - Why is the ssh client setuid root?</a>
	<li><a href= "#2.3">2.3 - Why does SSH 2.3 have problems interoperating with OpenSSH 2.1.1?</a>
	<li><a href= "#2.4">2.4 - Old versions of commercial SSH encrypt host keys with IDEA.</a>
	<li><a href= "#2.5">2.5 - What are these warning messages about key lengths?</a>
	<li><a href= "#2.6">2.6 - X11 and/or agent forwarding does not work.</a>
	</ul>
<h3><a href= "#3.0">3.0 - Portable OpenSSH Questions</a></h3>
	<ul>
	<li><a href= "#3.1">3.1 - Spurious PAM authentication messages in logfiles.</a>
	<li><a href= "#3.2">3.2 - Empty passwords not allowed with PAM authentication.</a>
	<li><a href= "#3.3">3.3 - ssh(1) takes a long time to connect with Linux/glibc 2.1</a>
	<li><a href= "#3.4">3.4 - "Can't locate module net-pf-10" messages in log under Linux.</a>
	<li><a href= "#3.5">3.5 - Password authentication doesn't work on Slackware 7.0</a>
	<li><a href= "#3.6">3.6 - Configure or sshd(8) complain about lack of RSA support</a>
	<li><a href= "#3.7">3.7 - "scp: command not found" errors</a>
	<li><a href= "#3.8">3.8 - Unable to read passphrase</a>
	<li><a href= "#3.9">3.9 - 'configure' missing or make fails</a>
	</ul>
</ul>


<hr>

<p>
<a name= "1.0"></a>
<h2><u>1.0 - What is OpenSSH and Where Can i get it?</u></h2>
</p>

<p>
<a name= "1.1"></a>
<h2>1.1 - What is OpenSSH?</h2>
</p>

<p>
OpenSSH is a <b>FREE</b> version of the SSH suite of network connectivity tools that increasing numbers of people on the Internet are coming to rely on. Many users of telnet, rlogin, ftp, and other such programs might not realize that their password is transmitted across the Internet unencrypted, but it is. OpenSSH encrypts all traffic (including passwords) to effectively eliminate eavesdropping, connection hijacking, and other network-level attacks.
</p>

<p>
The OpenSSH suite includes the <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&sektion=1">ssh(1)</a> program which replaces rlogin and telnet, and <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=scp&sektion=1">scp(1)</a> which replaces <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rcp&sektion=1">rcp(1)</a> and <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp&sektion=1">ftp(1)</a>. OpenSSH has also, recently, added <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sftp&sektion=1">sftp(1)</a> and <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sftp-server&sektion=8">sftp-server(8)</a> which give implement an easier solution for file-transfer. This is based upon the <a href="txt/draft-ietf-secsh-filexfer-00.txt">secsh-filexfer</a> IETF draft.
</p>

<ul>
<strong>OpenSSH consists of a number of programs.</strong>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&sektion=8">sshd(8)</a> - Server program run on the server machine. This listens for connections from client machines, and whenever it receives a connection, it performs authentication and starts serving the client.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&sektion=1">ssh(1)</a> - This is the client program used to log into another machine or to execute commands on the other machine. <i>slogin</i> is another name for this program.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=scp&sektion=1">scp(1)</a> - Securely copies files from one machine to another.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-keygen&sektion=1">ssh-keygen(1)</a> - Used to create Pubkey Authentication (RSA or DSA) keys (host keys and user authentication keys).
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-agent&sektion=1">ssh-agent(1)</a> - Authentication agent.  This can be used to hold RSA keys for authentication.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-add&sektion=1">ssh-add(1)</a> - Used to register new keys with the agent.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sftp-server&sektion=8">sftp-server(8)</a> - SFTP server subsystem.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sftp&sektion=1">sftp(1)</a> - Secure file tranfer program.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-keyscan&sektion=1">ssh-keyscan(1)</a> - gather ssh public keys.
</ul>

<p>
<a name= "1.2"></a>
<h2>1.2 - Why should it be used?</h2>
</p>

<p>
OpenSSH is a suite of tools to help secure your network connections. Here is a list of features:
</p>

<ul>
	<li>Strong authentication.  Closes several security holes (e.g., IP, routing, and DNS spoofing).
	<li>Improved privacy.  All communications are automatically and transparently encrypted.
	<li>Secure X11 sessions.  The program automatically sets DISPLAY on the server machine, and forwards any X11 connections over the secure channel.
	<li>Arbitrary TCP/IP ports can be redirected through the encrypted channel in both directions (e.g., for e-cash transactions).
	<li>No retraining needed for normal users.
	<li>Never trusts the network. Minimal trust on the remote side of the connection. Minimal trust on domain name servers. Pure RSA authentication never trusts anything but the private key.
	<li>Client RSA-authenticates the server machine in the beginning of every connection to prevent trojan horses (by routing or DNS spoofing) and man-in-the-middle attacks, and the server RSA-authenticates the client machine before accepting <i>.rhosts</i> or <i>/etc/hosts.equiv</i> authentication (to prevent DNS, routing, or IP-spoofing).
	<li>Host authentication key distribution can be centrally by the administration, automatically when the first connection is made to a machine.
	<li>Any user can create any number of user authentication RSA keys for his/her own use.
	<li>The server program has its own server RSA key which is automatically regenerated every hour.
	<li>An authentication agent, running in the user's laptop or local workstation, can be used to hold the user's RSA authentication keys.
	<li>The software can be installed and used (with restricted functionality) even without root privileges.
	<li>The client is customizable in system-wide and per-user configuration files.
	<li>Automatically executes conventional rsh (after displaying a warning) if the server machine is not running sshd.
	<li>Optional compression of all data with gzip (including forwarded X11 and TCP/IP port data), which may result in significant speedups on slow connections.
	<li>Complete replacement for rlogin, rsh, and rcp.
</ul>

<p>
Currently, almost all communications in computer networks are done
without encryption.  As a consequence, anyone who has access to any
machine connected to the network can listen in on any communication.
This is being done by hackers, curious administrators, employers,
criminals, industrial spies, and governments.  Some networks leak off
enough electromagnetic radiation that data may be captured even from a
distance.
</p>

<p>
When you log in, your password goes in the network in plain
text.  Thus, any listener can then use your account to do any evil he
likes.  Many incidents have been encountered worldwide where crackers
have started programs on workstations without the owners knowledge
just to listen to the network and collect passwords.  Programs for
doing this are available on the Internet, or can be built by a
competent programmer in a few hours.
</p>

<p>
Businesses have trade secrets, patent applications in preparation,
pricing information, subcontractor information, client data, personnel
data, financial information, etc.  Currently, anyone with access to
the network (any machine on the network) can listen to anything that
goes in the network, without any regard to normal access restrictions.
</p>

<p>
Many companies are not aware that information can so easily be
recovered from the network.  They trust that their data is safe
since nobody is supposed to know that there is sensitive information
in the network, or because so much other data is transferred in the
network.  This is not a safe policy.
</p>

<p>
<a name= "1.3"></a>
<h2>1.3 - What operating systems are supported?</h2>
</p>

<p>
Even though OpenSSH is developed on <a href="http://www.openbsd.org">OpenBSD</a> a wide variety of ports to other operating systems exist. The portable version of OpenSSH is headed by <a href="mailto:djm@openbsd.org">Damien Miller</a>. For a quick overview of the portable version of OpenSSH see: <a href="./portable.html">http://www.openssh.com/portable.html</a>. A quick view of other OS's that are supported is below.
</p>

<ul>
	<li>OpenBSD
	<li>NetBSD
	<li>FreeBSD
	<li>AIX 
	<li>HP/UX 
	<li>Irix 
	<li>Linux 
	<li>NeXT 
	<li>SCO 
	<li>SNI/Reliant Unix 
	<li>Solaris 
	<li>Digital Unix/Tru64/OSF 
	<li>MacOS X 
</ul>

<p>
A list of vendors that include OpenSSH in their distributions is located at <a href="./users.html">www.openssh.com/users.html</a>.
<p>
<a name= "1.4"></a>
<h2>1.4 - What about copyrights, usage and patents?</h2>
</p>

<p>
The OpenSSH developers have tried very hard to keep OpenSSH free of any patent or copyright problems. To do this, some options had to be stripped from OpenSSH. Namely support for patented algorithms.
</p>

<p>
OpenSSH does not support any patented transport algorithms. In SSH1 mode, only 3DES and Blowfish are available options. In SSH2 mode, only 3DES, Blowfish, CAST128, Arcfour and AES can be selected. The patented IDEA algorithm is not supported.
</p>

<p>
OpenSSH provides support for both SSH1 and SSH2 protocols. 
The SSH2 protocol uses DH and DSA, two other algorithms which have no nasty patent issues. If you avoid use of the SSH1 protocol, and use only the SSH2
protocol, you have nothing to worry about. However, you will need to find SSH2-compatible clients and servers for your other machines. 
</p>

<p>
Since the RSA patent has expired, there are no restrictions on the use of RSA algorithm using software, including OpenBSD.
</p>

<p>
<a name= "1.5"></a>
<h2>1.5 - Where should I ask for help?</h2>
</p>

<p>
There are many places to turn to for help. In addition to the main OpenSSH website: <a href="http://www.openssh.com">http://www.openssh.com</a>, there are many mailing lists to try. But before trying any mailing lists, please search through all mailing list archives to see if your question has already been answered. The OpenSSH Mailing List has been archived and put in searchable form and can be found at <a href="http://marc.theaimsgroup.com/?l=openssh-unix-dev&r=1&w=2">theaimsgroup.com</a>.
</p>

<p>
For more information on subscribing to OpenSSH related mailing lists, please see: <a href="./list.html">www.openssh.com/list.html</a>.
</p>

<p>
<a name= "2.0"></a>
<h2><u>2.0 - General Questions</u></h2>
</p>

<p>
<a name= "2.1"></a>
<h2>2.1 - Why does ssh/scp make connections from low-numbered ports.</a></h2>
</p>

<p>
The OpenSSH client uses low numbered ports for rhosts and rhosts-rsa authentication because the server needs to trust the username provided by the client. To get around this, you can add the below example to your <i>ssh_config</i> or <i>~/.ssh/config</i> file.
</p>

<ul>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<b>UsePrivilegedPort no</b>
                </td>
        </tr>
</table>
</ul>

<p>
Or you can specify this option on the command line, using the <b>-o</b> option to <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&sektion=1">ssh(1)</i> command.
</p>

<ul>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
$ <b>ssh -o "UsePrivilegedPort no" host.com</b>
                </td>
        </tr>
</table>
</ul>

<p>
<a name= "2.2"></a>
<h2>2.2 - Why is the ssh client setuid root?</h2>
</p>

<p>
In conjunction with the previous question, (<a href="#2.1">2.1</a>) OpenSSH needs root authority to be able to bind to low-numbered ports to facilitate rhosts and rhosts-rsa authentication. You can safely remove the setuid bit from the ssh executable if you don't want to use these authentication methods.
</p>

<p>
<a name= "2.3"></a>
<h2>2.3 - Why does SSH 2.3 have problems interoperating with OpenSSH 2.1.1?</h2>
</p>

<p>
SSH 2.3 and earlier versions contain a flaw in their HMAC implementation. Their code was not supplying the full data block output from the digest, and instead always provided 128 bits. For longer digests, this caused SSH 2.3 to not interoperate with OpenSSH.
</p>

<p>
OpenSSH 2.2.0 detects that SSH 2.3 has this flaw. Future versions of SSH will have this bug fixed. Or you can add the following to ssh 2.3's <i>/etc/sshd_config</i>.
</p>

<ul>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<b>Mac hmac-md5</b>
               </td>
        </tr>
</table>
</ul>

<p>
In addition to the flawed HMAC implementation, problems in interoperation have been seen dut to OpenSSH not yet supporting the option of rekeying. However SSH 2.3 tries to negotiate this feature, and you might experience connection freezes or see the error message &quot;<b>Dispatch protocol error: type 20</b>&quot;. To solve this problem, either disable rekeying by adding the below statement to your commercial SSH 2.3's <i>sshd_config</i>.
</p>

<ul>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<b>RekeyIntervalSeconds 0</b>
                </td>
        </tr>
</table>
</ul>

<p>
Upgrading to SSH 2.4 will also eliminate the problem.
</p>

<p>
<a name= "2.4"></a>
<h2>2.4 - Old versions of commercial SSH encrypt host keys with IDEA.</h2>
</p>

<p>
The old versions of SSH used a patented algorithm to encrypt their <i>/etc/ssh/ssh_host_key</i>. This problem will manifest as <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&sektion=8">sshd(8)</a> not being able to read its host key. To solve this, use the command below to convert your ssh_host_key to use 3DES. <b>NOTE:</b> Use the <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-keygen&sektion=1">ssh-keygen(1)</a> program from the Commercial SSH product, *NOT* OpenSSH for the example below.
</p>

<ul>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
# <b>ssh-keygen -u -f /etc/ssh/ssh_host_key<b>
                </td>
        </tr>
</table>
</ul>

<p>
<a name= "2.5"></a>
<h2>2.5 - What are these warning messages about key lengths</h2>
</p>

<p>
Commercial SSH's <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-keygen&sektion=1">ssh-keygen(1)</a> program contained a bug which caused it to occasionally generate Pubkey Authentication (RSA or DSA) keys which had their Most Significant Bit (MSB) unset. Such keys were advertised as being full-length, but are actually, half the time, half as long as advertised.
</p>

<p>
OpenSSH will print warning messages when it encounters such keys. To rid yourself of these message, edit you known_hosts files and replace the incorrect key length (usually "1024") with the correct key length (usually "1023"). However, as previously stated, these keys are usually less secure, so it is best to just make new ones.
</p>

<p>
<a name= "2.6"></a>
<h2>2.6 - X11 and/or agent forwarding does not work.</h2>
</p>

<p>
Check your <i>ssh_config</i> and <i>sshd_config</i>. The default configuration files disable authentication agent and X11 forwarding. To enable it, put the lines below in your configuration.
</p>

<ul>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<b>X11Forwarding yes</b><br>
<b>ForwardAgent yes</b>
                </td>
        </tr>
</table>
</ul>

<p>
<b>NOTE:</b> For users of Linux Mandrake 7.2, Mandrake modifies the <i>XAUTHORITY</i> environment variable in <i>/etc/skel/.bashrc</i>, and thus any bash user's home directory. This variable is set by OpenSSH and for either of the above options to work, you need to comment out the line:
</p>

<ul>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<b># export XAUTHORITY=$HOME/.Xauthority</b>
                </td>
        </tr>
</table>
</ul>

<p>
<a name= "3.0"></a>
<h2><u>3.0 - Portable OpenSSH Questions</u></h2>
</p>

<p>
<a name= "3.1"></a>
<h2>3.1 - Spurious PAM authentication messages in logfiles.</h2>
</p>

<p>
The portable version of OpenSSH will generate spurious authentication failures at every login, similar to:
</p>

<ul>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
&quot;<b>authentication failure; (uid=0) -> root for sshd service</b>&quot;
                </td>
        </tr>
</table>
</ul>

<p>
These are generated because OpenSSH first tries to determine whether a user needs authentication to login (e.g. empty password). Unfortunatly PAM likes to log all authentication events, this one included.
</p>

<p>
If it annoys you too much, set &quot;<b>PermitEmptyPasswords no</b>&quot; in <i>sshd_config</i>. This will quiet the error message at the expense of disabling logins to accounts with no password set. This is the default if you use the supplied <i>sshd_config</i> file.
</p>

<p>
<a name= "3.2"></a>
<h2>3.2 - Empty passwords not allowed with PAM authentication.</h2>
</p>

<p>
To enable empty passwords with a version of OpenSSH built with PAM you must add the flag nullok to the end of the password checking module in the <i>/etc/pam.d/sshd</i> file. For example:
</p>

<ul>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
auth required/lib/security/pam_unix.so shadow nodelay nullok
                </td>
        </tr>
</table>
</ul>

<p>
This must be done in addtion to setting &quot;<b>PermitEmptyPasswords yes</b>&quot; in the <i>sshd_config</i> file. 

<p>
There is one caveat when using empty passwords with PAM authentication: PAM will allow any password when authenticating an account with an empty password. This breaks the check that <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&sektion=8">sshd(8)</a> uses to determined whether an account has no password set and grant users access to the account regardless of the policy specified by <b>PermitEmptyPasswords</b>. For this reason, it is recommended that you do not add the <b>nullok</b> directive to your PAM configuration file unless you specifically wish to allow empty passwords.
</p>

<p>
<a name= "3.3"></a>
<h2>3.3 - ssh(1) takes a long time to connect with Linux/glibc 2.1</h2>
</p>

<p>
The glibc shipped with Redhat 6.1 appears to take a long time to resolve "IPv6 or IPv4" addresses from domain names. This can be kludged around with the --with-ipv4-default configure option. This instructs OpenSSH to use IPv4-only address resolution. (IPv6 lookups may still be made by specifying the -6 option).
</p>

<p>
<a name= "3.4"></a>
<h2>3.4 - "Can't locate module net-pf-10" messages in log under Linux.</h2>
</p>

<p>
The Linux kernel is looking (via modprobe) for protocol family 10 (IPv6). Either load the appropriate kernel module, enter the correct alias in <i>/etc/modules.conf</i> or disable IPv6 in <i>/etc/modules.conf</i>.
</p>

<p>
For some silly reason <i>/etc/modules.conf</i> may also be named <i>/etc/conf.modules</i>.
</p>

<p>
<a name= "3.5"></a>
<h2>3.5 - Password authentication doesn't work on Slackware 7.0</h2>
</p>

<p>
For Slackware 7.0, you need to link OpenSSH with libcrypt.
</p>

<ul>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
LIBS=-lcrypt ./configure [options]
                </td>
        </tr>
</table>
</ul>

<p>
<a name= "3.6"></a>
<h2>3.6 - Configure or sshd(8) complain about lack of RSA or DSA support</h2>
</p>

<p>
Ensure that your OpenSSL libraries have been built to include RSA or DSA support either internally or through RSAref.
</p>

<p>
<a name= "3.7"></a>
<h2>3.7 - "scp: command not found" errors</h2>
</p>

<p>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=scp&sektion=1">scp(1)</a> must be in the default PATH on both the client and the server. You may need to use the <b>--with-default-path</b> option to specify a custom path to search on the server. This option replaces the default path, so you need to specify all the current directories on your path as well as where you have installed scp. For example:
</p>

<ul>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
$ <b>./configure --with-default-path=/bin:/usr/bin:/usr/local/bin:/path/to/scp</b>
                </td>
        </tr>
</table>
</ul>

<p>
<a name= "3.8"></a>
<h2>3.8 - Unable to read passphrase</h2>
</p>

<p>
Some operating systems set <i>/dev/tty</i> with incorrect modes, causing the reading of passwords to fail with the following error:
</p>

<ul>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
You have no controlling tty.  Cannot read passphrase.
                </td>
        </tr>
</table>
</ul>

<p>
The solution to this is to reset the permissions on <i>/dev/tty</i> to mode 0666 and report the error as a bug to your OS vendor. 
</p>

<p>
<a name= "3.9"></a>
<h2>3.9 - 'configure' missing or make fails</h2>
</p>

<p>
If there is no 'configure' file in the tar.gz file that you downloaded or make fails with "missing separator" errors, you have probably downloaded the OpenBSD distribution of OpenSSH and are attempting to compile it on another platform. Please refer to the information on the <a href="./portable.html">portable version</a>.
</p>

<hr>
<a href=index.html><img height=24 width=24 src=back.gif border=0 alt=OpenSSH></a>
<a href=mailto:www@openbsd.org>www@openbsd.org</a>
<br>
<small>$OpenBSD: faq.html,v 1.26 2001/02/12 21:16:51 naddy Exp $</small>

</body>
</html>

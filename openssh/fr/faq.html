<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title> FAQ OpenSSH</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta name= "resource-type" content= "document">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name= "description"   content= "the OpenSSH FAQ page">
<meta name= "keywords"      content= "OpenSSH,SSH,Secure Shell,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 1999-2004 OpenBSD.">
</head>

<body bgcolor= "#ffffff" text= "#000000" link= "#23238E">
<img alt="[OpenSSH]" height=30 width=141 src="../images/smalltitle.gif">
<p>

<h1>FAQ OpenSSH (Foire aux questions)</h1>

<strong>Date : 2004/04/12</strong>

<hr>

<blockquote>
<h3><a href= "#1.0">1.0 - Qu'est-ce que OpenSSH et o&ugrave; puis-je
l'obtenir ?</a></h3>
<ul>
<li><a href= "#1.1">1.1 - Qu'est-ce que OpenSSH ?</a> 
<li><a href= "#1.2">1.2 - Pourquoi devrait on l'utiliser ?</a>
<li><a href= "#1.3">1.3 - Quels sont les syst&egrave;mes d'exploitation
    support&eacute;s ?</a>
<li><a href= "#1.4">1.4 - Qu'en est-il des droits d'auteur, de
    l'utilisation, et des brevets ?</a>
<li><a href= "#1.5">1.5 - Comment obtenir de l'aide ?</a> 
</ul>

<h3><a href= "#2.0">2.0 - Questions G&eacute;n&eacute;rales</a></h3>
<ul>
<li><a href= "#2.1">2.1 - Pourquoi ssh/scp &eacute;tablit des connexions
    &agrave; partir de ports privil&eacute;gi&eacute;s. Mon pare-feu
    bloque ceux-ci. </a>
<li><a href= "#2.2">2.2 - Pourquoi le client ssh est setuid root ?</a>
<li><a href= "#2.3">2.3 - Pourquoi SSH 2.3 a des probl&egrave;mes
    d'interop&eacute;rabilit&eacute; avec OpenSSH 2.1.1 ?</a>
<li><a href= "#2.4">2.4 - Pourquoi OpenSSH affiche : Dispatch protocol
    error: type 20</a>
<li><a href= "#2.5">2.5 - Les anciennes versions de SSH commercial
    utilisent IDEA pour le cryptage des cl&eacute;s de h&ocirc;tes.</a>
<li><a href= "#2.6">2.6 - A quoi correspondent les messages
    d'avertissement concernant les longueurs de cl&eacute; ?</a>
<li><a href= "#2.7">2.7 - X11 et/ou agent forwarding ne fonctionne
    pas.</a>
<li><a href= "#2.8">2.8 - Apr&egrave;s la mise &agrave; jour de OpenSSH,
    j'ai perdu le support SSH2.</a>
<li><a href= "#2.9">2.9 - sftp/scp &eacute;choue &agrave; la connexion
    mais ssh fonctionne.</a>
<li><a href= "#2.10">2.10 - Allez-vous ajouter la fonctionnalit&eacute;
    [foo] &agrave; scp ?</a>
<li><a href= "#2.11">2.11 - Comment utiliser le "port forwarding" ?</a>
<li><a href= "#2.12">2.12 - Ma connexion ssh se fige ou s'arr&ecirc;te
    apr&egrave;s N minutes d'inactivit&eacute;.</a>
</ul>

<h3><a href= "#3.0">3.0 - Questions sur la version portable de OpenSSH
</a></h3>
<ul>
<li><a href= "#3.1">3.1 - Faux messages d'authentification dans les
    journaux syst&egrave;mes.</a>
<li><a href= "#3.2">3.2 - Mots de passe vides non permis par
    l'authentification PAM.</a>
<li><a href= "#3.3">3.3 - ssh(1) n&eacute;cessite beaucoup de temps pour
    effectuer une connexion ou ouvrir une session interactive</a>
<li><a href= "#3.4">3.4 - Messages d'erreur "Can't locate module net-pf-
    10" dans les journaux syst&egrave;me sous Linux.</a>
<li><a href= "#3.5">3.5 - L'authentification par mot de passe ne
fonctionne pas sous Slackware 7.0 ou Red Hat Linux 6.x</a>
<li><a href= "#3.6">3.6 - Configure ou sshd(8) se plaignent de l'absence
    du support RSA</a>
<li><a href= "#3.7">3.7 - Erreurs "scp: command not found"</a>
<li><a href= "#3.8">3.8 - Incapable de lire la phrase de
protection (passphrase)</a>
<li><a href= "#3.9">3.9 - 'configure' manquant ou make &eacute;choue</a> 
<li><a href= "#3.10">3.10 - Connexions suspendues quand on quitte
    ssh</a>
<li><a href= "#3.11">3.11 - Pourquoi ssh suspend la connexion durant la
    phase de sortie du programme ?</a>
<li><a href= "#3.12">3.12 - J'ai effectu&eacute; une mise &agrave; jour
    vers OpenSSH 3.1 et X11 forwarding cesse de fonctionner.</a>
<li><a href= "#3.13">3.13 - J'ai mis &agrave; jour OpenSSH en version
    3.8 et certains programmes X11 ne fonctionnent plus.</a>
<li><a href= "#3.14">3.14 - J'ai copi&eacute; ma cl&eacute; dans le
    fichier authorized_keys mais l'authentification par cl&eacute;s ne
    fonctionne toujours pas.</a>
</ul>

</blockquote>

<hr>
<h2><u><a name= "1.0">1.0 - Qu'est-ce que OpenSSH et o&ugrave; puis-je
l'obtenir ?</a></u></h2>

<h2><a name= "1.1">1.1 - Qu'est-ce que OpenSSH ?</a></h2>

<p> 
OpenSSH est une version <b>LIBRE</b> de la suite d'outils de
connectivit&eacute; r&eacute;seau SSH sur laquelle s'appuie un nombre
croissant de personnes sur Internet. Beaucoup d'utilisateurs de telnet,
rlogin, ftp et d'autres programmes de ce type peuvent ne pas
r&eacute;aliser que leur mot de passe est transmis en clair &agrave;
travers Internet alors qu'en fait, &ccedil;a l'est. OpenSSH crypte tout
trafic (mots de passe compris) pour &eacute;liminer efficacement
l'&eacute;coute indiscr&egrave;te, le vol de connexion, et d'autres
attaques au niveau r&eacute;seau.

<p> 
La suite OpenSSH inclut le programme 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&amp;sektion=1">ssh(1)</a> 
qui remplace rlogin et telnet, et 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=scp&amp;sektion=1">scp(1)</a> 
qui remplace 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rcp&amp;sektion=1">rcp(1)</a> 
et <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp&amp;sektion=1">ftp(1)</a>. 
OpenSSH a ajout&eacute; 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sftp&amp;sektion=1">sftp(1)</a> 
et <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sftp-server&amp;sektion=8">sftp-server(8)</a> 
qui impl&eacute;mentent une m&eacute;thode plus facile de transfert de
fichiers, en se basant sur l'&eacute;bauche
<a href="../txt/draft-ietf-secsh-filexfer-02.txt">secsh-filexfer</a> 
de l'IETF. 

<p>
<strong>OpenSSH est constitu&eacute; d'un certain nombre de
programmes.</strong>
<ul>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&amp;sekt- ion=8">sshd(8)</a>
- Programme serveur qui s'ex&eacute;cute sur la machine serveur. Il
  attend des connexions &agrave; partir des machines clientes, et
  lorsqu'il en re&ccedil;oit, il effectue l'authentification et
  commence &agrave; r&eacute;pondre aux requ&ecirc;tes du client.
  Son fonctionnement est contr&ocirc;l&eacute; par le fichier de configuration
<i><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd_config&amp;sektion=5">sshd_config(5)</a></i>.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&amp;sektion=1">ssh(1)</a> 
- C'est le programme client utilis&eacute; pour se logguer sur une autre
  machine ou ex&eacute;cuter des commandes sur l'autre machine.
  <i>slogin</i> est un nom alternatif pour ce programme.
  Son fonctionnement est contr&ocirc;l&eacute; par le fichier de configuration <i>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh_config&amp;sektion=5">
ssh_config(5)</a></i> et les fichiers personnels <i>$HOME/.ssh/config</i>.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=scp&amp;sektion=1">scp(1)</a> 
- Copie de mani&egrave;re s&eacute;curis&eacute;e des fichiers d'une
  machine vers une autre.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-keygen&amp;sektion=1">ssh-keygen(1)</a> 
- Utilis&eacute; pour cr&eacute;er des cl&eacute;s (cl&eacute;s
  d'h&ocirc;tes ou cl&eacute;s d'authentification) PubKey Authentication
  (RSA ou DSA).
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-agent&amp;sektion=1">ssh-agent(1)</a> 
- Agent d'authentification. Il peut &ecirc;tre utilis&eacute; pour
  retenir des cl&eacute;s RSA pour authentification.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-add&amp;sektion=1">ssh-add(1)</a> 
- Utilis&eacute; pour d&eacute;clarer de nouvelles cl&eacute;s sur
  l'agent.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sftp-server&amp;sektion=8">sftp-server(8)</a> 
- Sous-syst&egrave;me serveur SFTP.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sftp&amp;sektion=1">sftp(1)</a> 
- Programme de transfert s&eacute;curis&eacute; de fichiers. 
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-keyscan&amp;sektion=1">ssh-keyscan(1)</a> 
- recueille les cl&eacute;s publiques ssh.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-keysign&amp;sektion=8">ssh-keysign(8)</a> 
- Programme d'aide ssh pour l'authentification bas&eacute;e sur
  l'h&ocirc;te.
</ul>

<h2><a name= "1.2">1.2 - Pourquoi devrait on l'utiliser ?</a></h2>

<p> 
OpenSSH est une suite d'outils dont l'objectif est de vous aider
&agrave; s&eacute;curiser vos connexions r&eacute;seau. Voici une liste
de fonctionnalit&eacute;s :

<ul>
<li>Authentification forte. Ferme plusieurs trous de
    s&eacute;curit&eacute; (par exemple, IP, routage, et usurpation
    DNS).
<li>Intimit&eacute; am&eacute;lior&eacute;e. Toutes les communications
    sont automatiquement crypt&eacute;es de mani&egrave;re transparente.
<li>Sessions X11 s&eacute;curis&eacute;es. Le programme positionne
    automatiquement DISPLAY sur la machine serveur, et fait suivre toute
    connexion X11 &agrave; travers le canal s&eacute;curis&eacute;.
<li>Des ports TCP/IP arbitraires peuvent &ecirc;tre redirig&eacute;s
    &agrave; travers le canal crypt&eacute; dans les deux directions
    (par exemple, pour des transactions e-cash).
<li>Aucun reformation n&eacute;cessaire pour les utilisateurs normaux.
<li>Ne fait jamais confiance au r&eacute;seau. Confiance minimale dans
    le c&ocirc;t&eacute; distant de la connexion. Confiance minimale
    dans les serveurs de noms de domaine. L'authentification RSA ne fait
    confiance qu'&agrave; la cl&eacute; priv&eacute;e.
<li>RSA client authentifie le serveur au d&eacute;but de chaque
    connexion pour se pr&eacute;munir contre les chevaux de troie (par
    routage ou usurpation DNS) et les attaques en homme du milieu, et
    RSA serveur authentifie le client avant d'accepter des connexions
    bas&eacute;es sur une authentification <i>.rhosts</i> ou
    <i>/etc/hosts.equiv</i> authentication (pour pr&eacute;venir les
    usurpations DNS, routage, ou IP).
<li>La distribution de cl&eacute;s d'authentification h&ocirc;te peut
    &ecirc;tre effectu&eacute;e de mani&egrave;re centralis&eacute;e par
    l'administration, automatiquement lorsque la premi&egrave;re
    connexion est &eacute;tablie &agrave; une machine.
<li>N'importe quel utilisateur peut cr&eacute;er n'importe quel nombre
    de cl&eacute;s d'authentification utilisateur RSA pour son propre
    usage.
<li>Le programme serveur poss&egrave;de sa propre cl&eacute; RSA qui est
    reg&eacute;n&eacute;r&eacute;e automatiquement toutes les heures.
<li>Un client d'authentification, ex&eacute;cut&eacute; sur la station
    de travail ou le portable de l'utilisateur, peut &ecirc;tre
    utilis&eacute; pour retenir les cl&eacute;s d'authentification RSA
    de l'utilisateur.
<li>Le logiciel peut &ecirc;tre install&eacute; et utilis&eacute; (avec
    des fonctionnalit&eacute;s restreintes) m&ecirc;me sans
    privil&egrave;ges root.
<li>Le client est param&eacute;trable au niveau des fichiers de
    configuration aussi bien syst&egrave;me qu'utilisateur.
<li>Compression optionnelle de toutes les donn&eacute;es avec gzip (y
    compris les sessions X11 suivies et les donn&eacute;es de port
    TCP/IP), ce qui peut aboutir &agrave; des
    acc&eacute;l&eacute;rations significatives sur des connexions
    lentes.
<li>Remplacement complet de rlogin, rsh, et rcp. 
</ul>

<p> 
Actuellement, pratiquement toutes les communications dans les
r&eacute;seaux informatiques sont effectu&eacute;es sans cryptage. Par
cons&eacute;quence, n'importe quelle personne qui a un acc&egrave;s
&agrave; n'importe quelle machine connect&eacute;e au r&eacute;seau peut
&eacute;couter n'importe quelle communication. C'est ce que font les
pirates, les administrateurs curieux, les employ&eacute;s, les
criminels, les espions industriels, et les gouvernements. Certains
r&eacute;seaux ont assez de fuites de radiation
&eacute;l&eacute;ctromagn&eacute;tique pour permettre des captures de
donn&eacute;es &agrave; distance.

<p> 
Quand vous vous logguez, votre mot de passe transite dans le
r&eacute;seau en clair. Ainsi, n'importe quelle personne &agrave;
l'&eacute;coute peut alors utiliser votre compte pour effectuer des
op&eacute;rations malintentionn&eacute;es. Plusieurs incidents ont
&eacute;t&eacute; constat&eacute;s au niveau modial lorsque des pirates
ont d&eacute;marr&eacute; des programmes sur des stations de travail
sans que les propri&eacute;taires en prennent connaissance juste pour
&eacute;couter le r&eacute;seau et collecter des mots de passe. Des
programmes pour faire de telles choses sont disponibles sur Internet, ou
peuvent &ecirc;tre d&eacute;velopp&eacute;s par un programmeur
comp&eacute;tent en quelques heures.

<p> 
Les entreprises ont des secrets de fabrication, des demandes de brevets
en pr&eacute;paration, des informations de prix, des informations sur
les contractants, des donn&eacute;es client, des donn&eacute;es sur le
personnel, des informations financi&egrave;res, etc. De nos jours,
n'importe qui ayant un acc&egrave;s au r&eacute;seau (n'importe lequel)
peut &eacute;couter tout ce qui se passe sur le r&eacute;seau, sans
respect des restrictions d'acc&egrave;s en place.

<p>
Bien des entreprises ne sont pas conscientes que l'information peut
&ecirc;tre tr&egrave;s facilement r&eacute;cup&eacute;r&eacute;e
&agrave; partir du r&eacute;seau. Ils croient que leurs donn&eacute;es
sont saines et sauves puisque personne n'est suppos&eacute;e savoir
qu'il y a des informations sensibles dans le r&eacute;seau, ou parce que
beaucoup d'autres donn&eacute;es sont transf&eacute;r&eacute;es sur le
r&eacute;seau. Cette politique n'est pas s&ucirc;re.

<h2><a name= "1.3">1.3 - Quels sont les syst&egrave;mes d'exploitation
    support&eacute;s ?</a></h2>

<p> 
Bien que OpenSSH soit d&eacute;velopp&eacute; sur 
<a href="http://www.openbsd.org/">OpenBSD</a>, il existe une grande
vari&eacute;t&eacute; de portages vers d'autres syst&egrave;mes
d'exploitation. la version portable de OpenSSH est dirig&eacute;e par 
<a href="mailto:djm@openbsd.org"> Damien Miller</a>. Pour une vue
d'ensemble rapide de la version portable de OpenSSH veuillez consulter
<a href="portable.html">OpenSSH Portable Release</a>.
Les syst&egrave;mes d'exploitation actuellement support&eacute;s sont :
<ul>
        <li>OpenBSD
        <li>NetBSD
        <li>FreeBSD
        <li>AIX 
        <li>HP-UX 
        <li>IRIX 
        <li>Linux 
        <li>NeXT 
        <li>SCO 
        <li>SNI/Reliant Unix 
        <li>Solaris 
        <li>Digital Unix/Tru64/OSF 
        <li>Mac OS X 
</ul>

<p> 
Une liste d'&eacute;diteurs qui incluent OpenSSH dans leur distribution
se trouve dans la page des
<a href="users.html">Syst&egrave;mes utilisant OpenSSH</a>.

<h2><a name= "1.4">1.4 - Qu'en est-il des droits d'auteur, de
    l'utilisation, et des brevets ?</a></h2>
<p> 
Les d&eacute;veloppeurs OpenSSH ont fait beaucoup d'efforts pour
&eacute;viter tout probl&egrave;me de brevet ou de droit d'auteur. A cet
effet, quelques options ont &eacute;t&eacute; retir&eacute;es de
OpenSSH. Plus pr&eacute;cisement le support d'algorithmes
brevet&eacute;s.

<p> 
OpenSSH ne supporte aucun algorithme de transport brevet&eacute;. En
mode SSH1, seuls 3DES et Blowfish sont disponibles. En mode SSH2,
seulement 3DES, Blowfish,CAST128, Arcfour et AES peuvent &ecirc;tre
choisis. L'algorithme brevet&eacute; IDEA n'est pas support&eacute;.

<p> 
OpenSSH fournit le support aussi bien pour le protocole SSH1 que pour
SSH2.

<p> 
Etant donn&eacute; que le brevet RSA a expir&eacute;, il n'y a plus de
restrictions au niveau de l'utilisation logicielle de l'algorithme RSA,
y compris OpenBSD.

<h2><a name= "1.5">1.5 -  Comment obtenir de l'aide ?</a></h2>
<p> 
Il y a plusieurs endroits o&ugrave; on peut trouver de l'aide. En plus
du 
<a href="http://www.openssh.com/fr/">site web principal de OpenSSH</a>, il
existe plusieurs listes de discussion. Avant de poster sur celles-ci,
merci d'effectuer des recherches au niveau des archives de ces listes
pour voir s'il n'y a pas d&eacute;j&agrave; une r&eacute;ponse &agrave;
votre question. La liste de diffusion OpenSSH a &eacute;t&eacute;
archiv&eacute;e et mise dans une forme facilitant les recherches sur
<a href="http://marc.theaimsgroup.com/?l=openssh-unix-dev&amp;r=2&amp;w=2">
theaimsgroup.com</a>.

<p> 
Pour plus d'informations concernant l'abonnement aux listes de diffusion
relatives &agrave; OpenSSH, veuillez consulter la page des
<a href="list.html">Listes de diffusion OpenSSH</a>.

<p>
Les informations concernant l'envoi de rapports de bogues se trouvent
dans la page <a href="report.html">Reporting bugs</a>.

<h2><u><a name= "2.0">2.0 - Questions
       G&eacute;n&eacute;rales</a></u></h2>

<h2><a name= "2.1">2.1 - Pourquoi ssh/scp &eacute;tablit des connexions
    &agrave; partir de ports privil&eacute;gi&eacute;s.</a></h2>
<p> 
Le client OpenSSH utilise des ports privil&eacute;gi&eacute;s (low
numbered ports) pour l'authentification rhosts et rhosts-rsa parce que
le serveur a besoin de se fier au nom d'utilisateur fournit par le
client. Pour d&eacute;sactiver ce comportement, vous pouvez ajouter la
ligne suivante &agrave; votre fichier <i>ssh_config</i> ou &agrave;
<i>~/.ssh/config</i>.

<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<b>UsePrivilegedPort no</b>
                </td>
        </tr>
</table>
</blockquote>

<p> 
Autrement vous pouvez sp&eacute;cifier cette option au niveau de la
ligne de commande en utilisant l'option <b>-o</b> de la commande
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&amp;sektion=1">ssh(1)</a>. 
<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
$ <b>ssh -o "UsePrivilegedPort no" host.com</b>
                </td>
        </tr>
</table>
</blockquote>

<h2><a name= "2.2">2.2 - Pourquoi le client ssh est setuid root
    ?</a></h2>

<p> 
Conjointement avec la question pr&eacute;c&eacute;dente(
<a href="#2.1">2.1</a>), OpenSSH a besoin de l'autorit&eacute; root pour
&ecirc;tre capable de s'attacher aux ports privil&eacute;gi&eacute;s
afin de faciliter <i> l'authentification rhosts</i>. Un port
privil&eacute;gi&eacute; est aussi requis pour l'authentification
rhosts-rsa sur les anciennes versions de older SSH.

<p> 
De plus, dans le cas de <i>l'authentification rhosts-rsa </i> (dans le
protocole version 1) et <i>l'authentification hostbased </i> dans le
protocole version 2), le client ssh a besoin d'acc&egrave;der &agrave; la
<em>cl&eacute; priv&eacute;e d'h&ocirc;te </em>pour authentifier la
machine cliente aupr&egrave;s du serveur. 
Pour ce faire, les versions d'OpenSSH ant&eacute;rieures &agrave; 3.3
n&eacute;cessitent un bit setuid root positionn&eacute; sur le binaire
<code>ssh</code>. Si vous n'utilisez pas ce mode d'authentification,
vous pouvez supprimer ce bit sans probl&egrave;me.

<p>
A partir d'OpenSSH 3.3, <code>ssh</code> n'est pas setuid par
d&eacute;faut.
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-keysign">ssh-keysign</a>,
est utilis&eacute; pour acc&eacute;der aux cl&eacute;s priv&eacute;s
d'h&ocirc;tes, et ssh n'utilise pas les ports source
privil&eacute;gi&eacute;s par d&eacute;faut. Si vous souhaitez utiliser
un port source privil&eacute;gi&eacute;, vous devez positionner
manuellement le bit setuid pour <code>ssh</code>.

<h2><a name= "2.3">2.3 - Pourquoi SSH 2.3 a des probl&egrave;mes
    d'interop&eacute;rabilit&eacute; avec OpenSSH 2.1.1 ?</a></h2>

<p> 
SSH 2.3 et les versions ant&eacute;rieures contiennent un d&eacute;faut
dans leur impl&eacute;mentation HMAC. Leur code ne fournissait pas le
bloc de donn&eacute;es entier obtenu &agrave; partir du digest. Au lieu
de cela, il fournissait toujours 128 bits. Pour des digests plus grands,
&ccedil;a entra&icirc;nait des probl&egrave;mes
d'interop&eacute;rabilit&eacute; de SSH 2.3 avec OpenSSH.

<p> 
OpenSSH 2.2.0 d&eacute;tecte ce d&eacute;faut sur SSH 2.3. Les version
r&eacute;centes de SSH fixeront ce d&eacute;faut. Autrement, vous pouvez
ajouter la ligne suivante &agrave; <i>sshd2_config </i> de SSH 2.3.
<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<b>Mac hmac-md5</b>
               </td>
        </tr>
</table>
</blockquote>

<h2><a name= "2.4">2.4 - Pourquoi OpenSSH affiche : Dispatch protocol
    error: type 20</a></h2>

<p> 
Des probl&egrave;mes d'interop&eacute;rabilit&eacute; ont
&eacute;t&eacute; constat&eacute;s car les anciennes versions de OpenSSH
ne supportent pas la ren&eacute;gociation des cl&eacute;s de sessions.
Cependant, SSH commercial 2.3 essaie de n&eacute;gocier cette
fonctionnalit&eacute;, d&egrave;s lors vous pourriez avoir des gels de
connexion ou voir le message d'erreur &quot;<b>Dispatch protocol error:
type 20 </b>&quot;. Pour r&eacute;soudre ce probl&egrave;me, effectuez
une mise &agrave; jour vers une version r&eacute;cente de OpenSSH ou
d&eacute;sactiver la ren&eacute;gociation de cl&eacute;s en ajoutant la
ligne suivante au niveau du fichier<i> ssh2_config</i> ou
<i>sshd2_config</i> sur la version commerciale SSH 2.3.
<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<b>RekeyIntervalSeconds 0</b>
                </td>
        </tr>
</table>
</blockquote>

<h2><a name= "2.5">2.5 - Les anciennes versions de SSH commercial
    utilisent IDEA pour le cryptage des cl&eacute;s de
    h&ocirc;tes.</a></h2>

<p> 
Les anciennes versions de SSH utilisaient un algorithme brevet&eacute;
pour crypter leur <i>/etc/ssh/ssh_host_key</i>. Ce probl&egrave;me se
manifestera lorsque
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&amp;sektion=8">sshd(8)</a> 
ne pourra pas lire sa cl&eacute; d'h&ocirc;te. Pour le r&eacute;soudre,
utilisez la commande ci-apr&egrave;s pour convertir votre ssh_host_key
en 3DES. <b>REMARQUE :</b> Utilisez le programme 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-keygen&amp;sektion=1">ssh-keygen(1)</a> 
du produit commercial SSH, *PAS* OpenSSH pour l'exemple ci-dessous.
<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
# <b>ssh-keygen -u -f /etc/ssh/ssh_host_key</b>
                </td>
        </tr>
</table>
</blockquote>

<h2><a name= "2.6">2.6 - A quoi correspondent les messages
    d'avertissement concernant les longueurs de cl&eacute; ?</a></h2>

<p>
Le programme 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-keygen&amp;sektion=1">ssh-keygen(1)</a> 
de SSH commercial contenaint un bogue qui lui faisait occasionnellement
g&eacute;n&eacute;rer des cl&eacute;s Pubkey Authentication (RSA or DSA)
qui avait leur bit &agrave; poids le plus significatif (Most Significant
Bit ou MSB) non positionn&eacute;. De telles cl&eacute;s &eacute;taient
annonc&eacute;es comme &eacute;tant &agrave; longueur compl&egrave;te
alors qu'en r&eacute;alit&eacute; elles sont plus petites une fois sur
deux.

<p>
OpenSSH affichera des messages d'avertissement quand de telles
cl&eacute;s sont rencontr&eacute;es. Pour se d&eacute;barasser de ces
messages, &eacute;ditez vos fichiers known_hosts et remplacez la fausse
longueur de cl&eacute; (habituellement &quot;1024&quot;) avec la vraie
longueur (habituellement &quot;1023&quot;).

<h2><a name= "2.7">2.7 - X11 et/ou agent forwarding ne fonctionne
    pas.</a></h2>

<p> 
V&eacute;rifiez <i>ssh_config</i> et <i>sshd_config</i>. Les fichiers de
configuration par d&eacute;faut d&eacute;sactivent le X11 et le agent
forwarding. Pour activer ces options, ajoutez la ligne suivante &agrave;
<i>sshd_config </i>:
<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<b>X11Forwarding yes</b>
                </td>
        </tr>
</table>
</blockquote>

<p> et ajoutez les lignes suivante &agrave; <i>ssh_config</i>: 
<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<b>ForwardAgent yes</b><br>
<b>ForwardX11 yes</b>
                </td>
        </tr>
</table>
</blockquote>

<p>
<b>REMARQUE :</b> Pour les utilisateurs de Linux Mandrake 7.2, Mandrake
   modifie la variable d'environnement <i>XAUTHORITY</i> dans
   <i>/etc/skel/.bashrc</i>, ce qui a pour effet de la modifier pour
   tous les utilisateurs. Cette variable est positionn&eacute;e par
   OpenSSH et pour que les options ci-dessus fonctionnent, vous devez
   mettre en commentaire la ligne :


<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<b># export XAUTHORITY=$HOME/.Xauthority</b>
                </td>
        </tr>
</table>
</blockquote>

<h2><a name= "2.8">2.8 - Apr&egrave;s la mise &agrave; jour de OpenSSH,
    j'ai perdu le support SSH2.</a></h2>

<p>
Entre des versions diff&eacute;rentes, des modifications peuvent
&ecirc;tre apport&eacute;es &agrave; <i>sshd_config</i> ou
<i>ssh_config</i>. Vous devriez toujours v&eacute;rifier ces
modifications lors de la mise &agrave; jour OpenSSH. Apr&egrave;s la
version 2.3.0 de OpenSSH, vous aurez besoin d'ajouter ce qui suit
&agrave; <i>sshd_config</i>.


<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<b>HostKey /etc/ssh_host_dsa_key</b><br>
<b>HostKey /etc/ssh_host_rsa_key</b>
                </td>
        </tr>
</table>
</blockquote>

<h2><a name= "2.9">2.9 - sftp/scp &eacute;choue &agrave; la connexion
    mais ssh fonctionne.</a></h2>

<p>
sftp et/ou scp peuvent &eacute;chouer &agrave; la connexion si vous avez
une initialisation du shell (.profile, .bashrc, .cshrc, etc) qui produit
une sortie pour des sessions non-interactives. Cette sortie rend le
client sftp/scp confus. Vous pouvez v&eacute;rifier si c'est le cas pour
votre shell en ex&eacute;cutant la commande suivante :

<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<b>ssh yourhost /usr/bin/true</b>
                </td>
        </tr>
</table>
</blockquote>

<p>
Si la commande ci-dessus g&eacute;n&egrave;re une sortie, alors vous
aurez besoin de modifier votre initialisation du shell.

<h2><a name= "2.10">2.10 - Allez-vous ajouter la fonctionnalit&eacute;
    [foo] &agrave; scp ?</a></h2>

<p>
R&eacute;ponse courte : non.

<p>
R&eacute;ponse longue : scp n'est pas une commande standard. La seule
sp&eacute;cification approchante de ce que fait scp est celle de rcp.
Etant donn&eacute; que c'est la m&ecirc;me commande qui est
utilis&eacute;e par les deux extr&ecirc;mit&eacute;s de la
communication, l'ajout de fonctionnalit&eacute;s ou d'options risque de
casser l'interop&eacute;rabilit&eacute; avec d'autres
impl&eacute;mentations.

<p>
De nouvelles fonctionnalit&eacute;s peuvent cependant &ecirc;tre
introduites dans sftp, vu que le protocole est standardis&eacute;
(enfin pratiquement, il y a un
<a href="http://www.ietf.org/internet-drafts/draft-ietf-secsh-filexfer-05.txt">
document de travail</a>),
et que le client et le serveur sont d&eacute;coupl&eacute;s.

<h2><a name= "2.11">2.11 - Comment utiliser le "port forwarding"
?</a></h2>

<p>
Si le serveur distant est un serveur sshd(8), il est possible de
cr&eacute;er un tunnel pour certains services via ssh. Ceci peut
&ecirc;tre utile pour chiffrer des connexions POP ou SMTP m&ecirc;me si
les logiciels ne supportent pas directement les communications
chiffr&eacute;es. La cr&eacute;ation d'un tunnel se base sur le "port
forwarding" pour cr&eacute;er une connexion entre le client et le
serveur. Le logiciel client doit &ecirc;tre capable de sp&eacute;cifier
un port non-standard auquel se connecter pour que cette technique
fonctionne.

<p>
Pour cr&eacute;er un tunnel chiffr&eacute; par ssh, l'utilisateur se
connecte &agrave; l'h&ocirc;te distant en utilisant ssh et
sp&eacute;cifie le port sur la machine cliente qui devra &ecirc;tre
utilis&eacute; pour y passer les connexions &agrave; destination du
serveur distant. Il devient alors possible de d&eacute;marrer le service
&agrave; chiffrer (par exemple fetchmail, irc ...) sur la machine client
en pr&eacute;cisant le m&ecirc;me port local que celui
pr&eacute;c&eacute;demment fourni. La connexion sera d&egrave;s lors
chiffr&eacute;e dans le tunnel ssh.

<p>
Les options &agrave; utiliser pour la cr&eacute;ation des tunnels sont
les options -L et -R, qui permettent &agrave; l'utilisateur de faire
passer des connexions &agrave; travers des tunnels, l'option -D qui
permet de faire du "port forwarding" dynamique, et l'option -f qui
permet de mettre ssh en t&acirc;che de fond. Ces options sont
d&eacute;taill&eacute;es plus bas.

<p>
Voici un exemple pour cr&eacute;er un tunnel pour une session IRC entre
une machine cliente ``127.0.0.1'' (localhost) et un serveur distant "
This is an example of tunnelling an IRC session from client machine
``127.0.0.1'' (localhost) to remote server ``server.example.com'':

<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<b>ssh -f -L 1234:server.example.com:6667 server.example.com sleep 10<br>
irc -c '#users' -p 1234 pinky 127.0.0.1</b>
        </td>
        </tr>
</table>
</blockquote>

<p>
La commande ci-dessus cr&eacute;e un tunnel pour une connexion IRC vers
le serveur server.example.com. L'utilisateur veut se joindre au canal
"#users", il a pour surnom "pinky". Le port local utilis&eacute; dans
cet exemple est le port 1234. Le num&eacute;ro de port importe peu tant
qu'il est sup&eacute;rieur &agrave; 1023 (autrement, seul "root" peut
ouvrir des sockets sur les ports privil&eacute;gi&eacute;s soit tous les
ports inf&eacute;rieurs &agrave; 1024) et qu'il n'entre en conflit avec
aucun port utilis&eacute; sur la machine. La connexion est
chiffr&eacute;e dans le tunnel jusqu'au serveur distant puis une fois
d&eacute;chiffr&eacute;e, elle est envoy&eacute;e sur le port 6667 du
serveur vu que c'est le port standard utilis&eacute; par les services
IRC.

<p>
La commande distante "sleep 10" est utilis&eacute;e pour
sp&eacute;cifier le temps d'attente (10 secondes dans l'exemple
pr&eacute;cit&eacute;) avant le d&eacute;marrage du service qui doit
transiter &agrave; travers le tunnel. Si aucune connexion n'est
effectu&eacute;e durant ce temps d'attente, ssh s'arr&ecirc;te. Si un
temps d'attente plus important est n&eacute;cessaire, la valeur de
sleep(1) peut &ecirc;tre augment&eacute;e en cons&eacute;quence,
autrement l'exemple ci-dessus pourrait &ecirc;tre ajout&eacute; comme
fonction au shell utilisateur. Consultez les pages du manuel de ksh(1)
et csh(1) pour plus de d&eacute;tails concernant les fonctions
d&eacute;finies par l'utilisateur.

<p>
ssh poss&egrave;de aussi une option -N, pratique pour une utilisation de
ssh en "port forwarding" : si -N est sp&eacute;cifi&eacute;e, il n'est
plus n&eacute;cessaire d'utiliser une commande distante ("sleep 10" dans
l'exemple ci-dessus). Cependant, l'utilisation de cette option oblige
ssh &agrave; attendre ind&eacute;finiment (alors qu'avec une commande
distante, ssh s'interrompera apr&egrave;s la fin d'ex&eacute;cution de
cette derni&egrave;re). L'utilisateur devra alors mettre fin
manuellement au processus ssh.

<h2><a name= "2.12">2.12 - Ma connexion ssh se fige ou s'arr&ecirc;te
    apr&egrave;s N minutes d'inactivit&eacute;.</a></h2>

<p>
Ceci est g&eacute;n&eacute;ralement d&ucirc; &agrave; l'expiration de
votre session ssh au niveau d'un pare-feu ou d'un &eacute;quipement de
NAT en raison d'inactivit&eacute;. Afin d'&eacute;viter cela, vous
pouvez activer
<b>ClientAliveInterval</b> dans le fichier de configuration serveur <i>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd_config&amp;sektion=5">sshd_config</a></i>, 
ou activer <b>ServerAliveInterval</b> dans le fichier de configuration
client <i>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh_config&amp;sektion=5">
ssh_config</a></i>.
Cette derni&egrave;re option n'est disponible qu'&agrave; partir de
OpenSSH 3.8.

<p>
L'activation d'une des options pr&eacute;cit&eacute;es en positionnant
leur valeur &agrave; un intervalle plus petit que le temps
d'inactivit&eacute; avant expiration de la session permettra de garder
la session dans la table de connexion de l'&eacute;quipement, sans que
la session expire.

<h2><u><a name= "3.0">3.0 - Questions sur la version portable de
       OpenSSH</a></u></h2>

<h2><a name= "3.1">3.1 - Faux messages d'authentification dans les
    journaux syst&egrave;mes.</a></h2>

<p>
La version portable de OpenSSH g&eacute;n&eacute;rera de faux messages
d'authentification &agrave; chaque login, similaires &agrave; :

<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
&quot;<b>authentication failure; (uid=0) -&gt; root for sshd service</b>&quot;
                </td>
        </tr>
</table>
</blockquote>

<p>
Ces messages sont g&eacute;n&eacute;r&eacute;s car OpenSSH essaie
d'abord de d&eacute;terminer si un utilisateur a besoin
d'authentification pour se logguer (par exemple, un mot de passe vide).
Malheureusement, PAM aime enregistrer tous les &eacute;v&eacute;nements
d'authentification, y compris celui-ci.

<p>
Si cela vous g&ecirc;ne beaucoup, positionnez
&quot;<b>PermitEmptyPasswords no</b>&quot; dans <i>sshd_config</i>. Ceci
aura pour effet de stopper le message d'erreur mais en
d&eacute;sactivant, par la m&ecirc;me occasion, les connexions &agrave;
des comptes sans mot de passe. C'est le comportement par d&eacute;faut
si vous utilisez le fichier <i>sshd_config</i> fourni.

<h2><a name= "3.2">3.2 - Mots de passe vides non permis par
    l'authentification PAM.</a></h2>

<p> 
Pour permettre l'utilisation de mots de passe vides avec une version de
OpenSSH construite avec PAM, vous devez ajouter le drapeau nullok
&agrave; la fin du module de v&eacute;rification du mot de passe dans le
fichier <i>/etc/pam.d/sshd</i>. Par exemple :

<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
auth required/lib/security/pam_unix.so shadow nodelay nullok
                </td>
        </tr>
</table>
</blockquote>

<p>
Cette action doit &ecirc;tre effectu&eacute;e en plus du positionnement
&quot;<b>PermitEmptyPasswords yes</b>&quot; dans le fichier
<i>sshd_config</i>.

<p>
Il y a un probl&egrave;me lorsque des mots de passe vides sont
utilis&eacute;s avec l'authentification PAM : PAM autorisera n'importe
quel mot de passe quand on s'authentifie sur un compte dot&eacute; d'un
mot de passe vide. Ce qui a pour effet de casser la v&eacute;rification
que
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&amp;sektion=8">sshd(8)</a>
effectue pour d&eacute;terminer si un compte n'a pas de mot de passe
positionn&eacute; et autorise l'acc&egrave;s quelque soit la politique
sp&eacute;cifi&eacute;e par <b>PermitEmptyPasswords</b>. Pour cette
raison, il est recommand&eacute; de ne pas ajouter la directive
<b>nullok</b> &agrave; votre fichier de configuration PAM &agrave; moins
que vous souhaitiez sp&eacute;cifiquement autoriser les mots de passe
vides.

<h2><a name= "3.3">3.3 - ssh(1) n&eacute;cessite beaucoup de temps pour
effectuer une connexion ou ouvrir une session interactive</a></h2>

<p>
D'importants d&eacute;lais (plus de 10 secondes) &agrave; la connexion sont typiquement caus&eacute;s par un
probl&egrave;me au niveau de la r&eacute;solution de noms :
<ul>
<li>Certaines versions de la glibc (notamment la glibc 2.1 fournie avec
Red Hat 6.1) peut n&eacute;cessiter un temps significatif pour
r&eacute;soudre des adresses IPv6 ou IPv4 &agrave; partir de noms de
domaine. Un moyen de contournement consiste &agrave; sp&eacute;cifier
l'option <b>AddressFamily inet</b> dans le fichier
<i>ssh_config</i>.

<li>Il peut y avoir un probl&egrave;me de r&eacute;solution DNS
c&ocirc;t&eacute; client ou c&ocirc;t&eacute; serveur. Vous pouvez
utiliser la commande <code>nslookup</code> pour v&eacute;rifier la
r&eacute;solution de noms et des adresses IP du client sur le serveur et
vice-versa. Vous pouvez d&eacute;sactiver la plupart des
r&eacute;solutions DNS effectu&eacute;es c&ocirc;t&eacute; serveur en
utilisant <b>UseDNS no</b> dans <i>sshd_config</i>.
</ul>

<p>
Des d&eacute;lais de moins de 10 secondes peuvent avoir d'autres causes.

<ul>

<li>Les versions d'OpenSSH ant&eacute;rieures &agrave; la version 3.8
    ont un fichier <i>moduli</i> qui contient du moduli juste
    inf&eacute;rieur &agrave; ce que sshd n&eacute;cessitait. Par
    cons&eacute;quence, sshd finissait par utiliser du moduli largement
    sup&eacute;rieur &agrave; ce qui &eacute;tait demand&eacute;
    d'o&ugrave; une baisse des performances. Le remplacement du fichier
    <i>moduli</i> r&eacute;soudra ce probl&egrave;me. Il est &agrave;
    noter que, dans la plupart des cas, le fichier n'est pas
    remplac&eacute; suivant une mise &agrave; jour. Il devra alors
    &ecirc;tre remplac&eacute; manuellement.

<li>Les versions d'OpenSSH ant&eacute;rieures &agrave; la version 3.8
    contiennent un d&eacute;faut dans <code>ssh</code>. A cause de ce
    d&eacute;faut, <code>ssh</code> demande du moduli plus grand que
    n&eacute;cessaire. Combin&eacute; au probl&egrave;me
    pr&eacute;cit&eacute;, les baisses de performance &eacute;taient
    encore plus significatives. La mise &agrave; jour du client en
    version 3.8 ou sup&eacute;rieure r&eacute;sout ce probl&egrave;me.

<li>Si le client ou le serveur ne poss&egrave;de pas un m&eacute;canisme
    de g&eacute;n&eacute;ration de nombres al&eacute;atoires bas&eacute;
    sur le noyau (par exemple : Solaris &lt; 9, AIX &lt; 5.2, HP-UX &lt;
    11.11) et qu'aucun m&eacute;canisme altenatif n'est disponibles (par
    exemple :
    <a href= "ftp://ftp.ayamura.org/pub/prngd/">prngd</a>,
    il est alors possible qu'un des programmes appel&eacute;s par
    <code>ssh-rand- helper</code> pour g&eacute;n&eacute;rer de
    l'entropie ne rend pas la main. Pour v&eacute;rifier si c'est le
    cas, il suffit d'ex&eacute;cuter <code>ssh-rand-helper</code> en
    mode debug :

<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
/usr/local/libexec/ssh-rand-helper -vvv
                </td>
        </tr>
</table>
</blockquote>

Tout d&eacute;lai significatif &agrave; la connexion doit &ecirc;tre
investigu&eacute; et corrig&eacute;. Sinon, il suffira de supprimer les
commandes posant probl&egrave;me du fichier
<i>ssh_prng_cmds</i>.
 
</ul>

<h3>Lenteur des connexions</h3>
Dans des conditions normales, la vitesse des sessions interactives SSH
d&eacute;pend de la vitesse du processeur sur le client et sur le
serveur. A titre de comparaison, les donn&eacute;es suivantes
repr&eacute;sentent des temps de connexion typiques pour
l'ex&eacute;cution de <code>time ssh localhost true</code> avec une
cl&eacute; RSA de 1024 bits sur des machines non charg&eacute;es.
OpenSSH et OpenSSL ont &eacute;t&eacute; compil&eacute;s avec gcc 3.3.x.

<p>
<table>
<tr><th>CPU</th><th>Time (SSHv1)<a href="#3.3fn1">[1]</a></th>
        <th>Time (SSHv2)</th></tr>
<tr><td>170MHz SPARC/sun4m</td><td>0.74 sec</td><td>1.25 sec</td></tr>
<tr><td>236MHz HPPA/8200<a href="#3.3fn2">[2]</a></td><td>0.44 sec</td>
        <td>0.79 sec</td></tr>
<tr><td>375MHz PowerPC/604e</td><td>0.38 sec</td><td>0.51 sec</td></tr>
<tr><td>933MHz VIA Ezra</td><td>0.34 sec</td><td>0.44 sec</td></tr>
<tr><td>2.1GHz Althon 2600</td><td>0.14 sec</td><td>0.22 sec</td></tr>
</table>

<br>

<a name="3.3fn1">[1]</a> 
Le protocole SSHv1 est plus rapide que SSHv2 mais cryptographiquement
plus faible.<br>

<a name="3.3fn2">[2]</a>
A l'heure de la r&eacute;daction de ces lignes, gcc g&eacute;n&egrave;re
du code relativement lent sous HPPA pour les op&eacute;rations RSA et
Diffie-Hellman (veuillez consulter
<a href= "http://gcc.gnu.org/bugzilla/show_bug.cgi?id=7625">gcc
bug #7625</a> et
<a href="http://marc.theaimsgroup.com/?l=openssh-unix-dev&m=102646106016694">discussion on openssh-unix-dev</a>).

<h2><a name= "3.4">3.4 - Messages d'erreur "Can't locate module
    net-pf-10" dans les journaux syst&egrave;me sous Linux.</a></h2>

<p>
Le noyau Linux recherche (&agrave; travers modprobe) la famille de
protocoles 10 (IPv6). Il faut soit charger le module noyau
appropri&eacute;, soit saisir l'alias correct dans
<i>/etc/modules.conf</i> ou d&eacute;sactiver IPv6 dans
<i>/etc/modules.conf</i>.


<p>
Pour une raison inconnue, <i>/etc/modules.conf</i> peut aussi s'appeler
<i>/etc/conf.modules</i>.


<h2><a name= "3.5">3.5 - L'authentification par mot de passe ne
    fonctionne pas sous Slackware 7.0 ou Red Hat 6.x</a></h2>

<p> 
Sur Slackware 7.0, vous aurez besoin de lier OpenSSH &agrave; libcrypt.

<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
LIBS=-lcrypt ./configure [options]
                </td>
        </tr>
</table>
</blockquote>

<p>
Certaines versions de Red Hat ont des outils de g&eacute;n&eacute;ration
de mots de passe qui cr&eacute;ent des mots de passe MD5, mais la
fonction syst&egrave;me crypt() ne les comprend pas. Si
l'authentification par mot de passe &eacute;chouent pour les nouveaux
comptes ou pour des comptes dont le mot de passe a &eacute;t&eacute;
r&eacute;cemment modifi&eacute;, alors c'est la cause probable. (Les
comptes affect&eacute;s auront des cha&icirc;nes de mots de passe dans
<i>/etc/shadow</i> d&eacute;butant avec <code>$1$</code>).

<p>
Pour r&eacute;soudre ce probl&egrave;me, activez le support MD5 dans
sshd lors de la compilation

<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
./configure --with-md5-passwords [options]
                </td>
        </tr>
</table>
</blockquote>

<h2><a name= "3.6">3.6 - Configure ou sshd(8) se plaignent de l'absence
    du support RSA</a></h2>

<p> 
Assurez vous que vos librairies OpenSSL disposent du support RSA ou DSA
soit en interne soit &agrave; travers RSAref.

<h2><a name= "3.7">3.7 - Erreurs "scp: command not found"</a></h2>

<p> 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=scp&amp;sektion=1">scp(1)</a> 
doit &ecirc;tre dans le PATH par d&eacute;faut sur le client et sur le
serveur. Vous aurez peut-&ecirc;tre besoin d'utiliser l'option
<b>--with-default-path</b> pour sp&eacute;cifier un chemin particulier
&agrave; inclure sur le serveur. Cette option remplace le chemin par
d&eacute;faut. Vous aurez donc besoin de sp&eacute;cifier tous les
r&eacute;pertoires actuellement dans votre chemin aussi bien que le
r&eacute;pertoire dans lequel se trouve scp. Par exemple :

<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
$ <b>./configure --with-default-path=/bin:/usr/bin:/usr/local/bin:/path/to/scp</b>
                </td>
        </tr>
</table>
</blockquote>

<p>
La configuration effectu&eacute;e par l'administrateur du serveur est
prioritaire par rapport &agrave; <b>--with-default-path</b>. Ceci inclut
la mise &agrave; z&eacute;ro de PATH dans /etc/profile, PATH dans
<i>/etc/environment</i> sous AIX, ou (pour les versions d'OpenSSH
sup&eacute;rieures ou &eacute;gales &agrave; 3.7p1), le positionnement
de PATH ou de SUPATH dans <i>/etc/default/login</i> sous Solaris ou
Reliant Unix.

<h2><a name= "3.8">3.8 - Incapable de lire la phrase de protection
    (passphrase)</a></h2>

<p> 
Certains syst&egrave;mes d'exploitation positionnent des permissions
incorrectes sur <i>/dev/tty</i>. Par cons&eacute;quence, la lecture de
mots de passe &eacute;choue avec l'erreur suivante :

<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
You have no controlling tty.  Cannot read passphrase.
                </td>
        </tr>
</table>
</blockquote>

<p> 
La solution consiste &agrave; positionner les permissions &agrave; 0666
sur <i>/dev/tty</i> et soumettre l'erreur comme &eacute;tant un bogue
&agrave; l'&eacute;diteur de votre OS.

<h2><a name= "3.9">3.9 - 'configure' manquant ou make
    &eacute;choue</a></h2>

<p> 
S'il n'y a pas de fichier 'configure' dans le fichier tar.gz que vous
avez t&eacute;l&eacute;charg&eacute; ou si make &eacute;choue avec des
erreurs du type "missing separator", vous avez probablement
t&eacute;l&eacute;charg&eacute; la distribution OpenBSD de OpenSSH et
vous &ecirc;tes entrain de d'essayer de la compiler sur une autre
plateforme. Merci de consultez la page 
<a href="portable.html">portable version</a>.

<h2><a name= "3.10">3.10 - Connexions suspendues quand on quitte
    ssh</a></h2>

<p> 
OpenSSH peut suspendre une connexion en phase de terminaison. Ceci peut
arriver quand il y a un processus actif en arri&egrave;re plan. C'est un
probl&egrave;me connu sous Linux et HP-UX. On peut v&eacute;rifier son
existence en faisant : 

<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
$ <b>sleep 20 & exit</b>
                </td>
        </tr>
</table>
</blockquote>

Ou essayez plut&ocirc;t d'utiliser la commande suivante : 
<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
$ <b>sleep 20 < /dev/null > /dev/null 2>&1 &</b>
                </td>
        </tr>
</table>
</blockquote>

<p> 
Une solution de contournement pour les utilisateurs bash est de mettre
<b>"shopt -s huponexit"</b> soit dans /etc/bashrc soit dans ~/.bashrc.
Autrement, consultez la page de manuel de votre shell pour une option
qui permet d'envoyer un signal HUP &agrave; des t&acirc;ches actives
durant la phase de terminaison. Consultez
<a href="http://bugzilla.mindrot.org/show_bug.cgi?id=52">bug #52</a>
pour d'autres solutions de contournement.

<h2><a name= "3.11">3.11 - Pourquoi ssh suspend la connexion durant la
    phase de sortie du programme ?</a></h2>

<p>
Quand la commande 
<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
$ <b>ssh host command</b>
                </td>
        </tr>
</table>
</blockquote>
est ex&eacute;cut&eacute;e, ssh <b>a besoin</b> de suspendre la
connexion, car il doit attendre :
<ul>
<li>Jusqu'&agrave; ce qu'il soit s&ucirc;r que <code>command</code> n'a
     pas besoin d'autres informations en entr&eacute;e.
<li>Jusqu'&agrave; ce qu'il soit s&ucirc;r que <code>command</code> ne
     produit pas d'autres informations en sortie.
<li>Jusqu'&agrave; ce que <code>command</code> finisse car sshd a besoin
    de communiquer le code de sortie de <code>command</code> &agrave;
    ssh.
</ul>
<p>

<h2><a name= "3.12">J'ai effectu&eacute; une mise &agrave; jour vers
    OpenSSH 3.1 et X11 forwarding cesse de fonctionner.</a></h2>

A partir de OpenSSH 3.1, le serveur sshd x11 forwarding &eacute;coute
sur localhost par d&eacute;faut. Vous pouvez utiliser l'option
<b>X11UseLocalhost</b> pour revenir au comportement
pr&eacute;c&eacute;dent si vos anciens clients X11 ne fonctionnent pas
avec cette configuration.

<p> 
De mani&egrave;re g&eacute;n&eacute;rale, les clients X11 utilisant X11
R6 devraient fonctionner avec le param&eacute;trage par d&eacute;faut.
Certains &eacute;diteurs, HP compris, utilisent sur leurs
syst&egrave;mes des clients X11 avec des librairies R6 et R5. Ainsi,
certains clients vont fonctionner et d'autres ne fonctionneront pas.
C'est le cas pour HP-UX 11.X.<p>

<h2><a name= "3.13">3.13 - J'ai mis &agrave; jour OpenSSH en version 3.8 et
certains programmes X11 ne fonctionnent plus.</a></h2>

<p>
Tel que c'est document&eacute; dans les
<a href="../txt/release-3.8">notes d'information de la version 3.8</a>,
<code>ssh</code> utilise d&eacute;sormais les cookies X11 non dignes de
confiance par d&eacute;faut. Le comportement pr&eacute;c&eacute;dent
peut &ecirc;tre restor&eacute; en positionnant <b>ForwardX11Trusted
yes</b> dans <i>ssh_config</i>.

<p>
Voici une liste de quelques sympt&ocirc;mes possibles :<br>
<code>BadWindow (invalid Window parameter)<br>
BadAccess (attempt to access private resource denied)<br>
X Error of failed request:  BadAtom (invalid Atom parameter)<br>
Major opcode of failed request:  20 (X_GetProperty)<br></code>

<h2><a name= "3.14">3.14 - J'ai copi&eacute; ma cl&eacute; dans le
    fichier authorized_keys mais l'authentification par cl&eacute;s ne
    fonctionne toujours .</a></h2>

Ce probl&egrave;me est typiquement caus&eacute; par des permissions plus
larges que celles permises par sshd par d&eacute;faut pour les
r&eacute;pertoires $HOME, $HOME/.ssh ou le fichier
$HOME/.ssh/authorized_keys.

<p>
Dans ce cas, l'ex&eacute;cution des commandes suivantes sur le serveur
r&eacute;soudra le probl&egrave;me :
<blockquote>
<table border=0 width="800">
<tr>
  <td nowrap bgcolor="#EEEEEE">
$ <b>chmod go-w $HOME $HOME/.ssh</b><br>
$ <b>chmod 600 $HOME/.ssh/authorized_keys</b>
  </td>
</tr>
</table>
</blockquote>

<p>
Si, pour quelque raison que ce soit, ce n'est pas envisageable de faire
&ccedil;a une solution alternative consiste &agrave; positionner
<b>StrictModes no</b> dans <i>sshd_config</i>, cependant cette solution
n'est pas recommand&eacute;e.

<hr>
<a href="index.html"><img height=24 width=24 src="../back.gif" border=0 alt=OpenSSH></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
Originally [OpenBSD: faq.html,v 1.85 ]<br>
$Translation: faq.html,v 1.15 2004/04/27 21:45:00 saad Exp $<br>
$OpenBSD: faq.html,v 1.11 2004/04/28 17:12:42 jufi Exp $
</small>

</body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title> FAQ OpenSSH</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta name= "resource-type" content= "document">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name= "description"   content= "the OpenSSH FAQ page">
<meta name= "keywords"      content= "OpenSSH,SSH,Secure Shell,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 1999-2005 OpenBSD.">
</head>

<body bgcolor= "#ffffff" text= "#000000" link= "#23238E">
<a href="index.html"><img alt="[OpenSSH]" height="30" width="141"
src="../images/smalltitle.gif" border="0"></a>
<p>

<h1>FAQ OpenSSH (Foire aux questions)</h1>

<strong>Date : 2005/01/25</strong>

<hr>

<blockquote>
<h3><a href= "#1.0">1.0 - Qu'est-ce que OpenSSH et où puis-je
l'obtenir ?</a></h3>
<ul>
<li><a href= "#1.1">1.1 - Qu'est-ce que OpenSSH et où puis-je
    l'obtenir ?</a>
<li><a href= "#1.2">1.2 - Pourquoi devrait on l'utiliser ?</a>
<li><a href= "#1.3">1.3 - Quels sont les systèmes d'exploitation
    supportés ?</a>
<li><a href= "#1.4">1.4 - Qu'en est-il des droits d'auteur, de
    l'utilisation, et des brevets ?</a>
<li><a href= "#1.5">1.5 - Comment obtenir de l'aide ?</a> 
</ul>

<h3><a href= "#2.0">2.0 - Questions Générales</a></h3>
<ul>
<li><a href= "#2.1">2.1 - Pourquoi ssh/scp établit des connexions
    à partir de ports privilégiés. Mon pare-feu
    bloque ceux-ci. </a>
<li><a href= "#2.2">2.2 - Pourquoi le client ssh est setuid root ?</a>
<li><a href= "#2.3">2.3 - Pourquoi SSH 2.3 a des problèmes
    d'interopérabilité avec OpenSSH 2.1.1 ?</a>
<li><a href= "#2.4">2.4 - Pourquoi OpenSSH affiche : Dispatch protocol
    error: type 20</a>
<li><a href= "#2.5">2.5 - Les anciennes versions de SSH commercial
    utilisent IDEA pour le cryptage des clés de hôtes.</a>
<li><a href= "#2.6">2.6 - A quoi correspondent les messages
    d'avertissement concernant les longueurs de clé ?</a>
<li><a href= "#2.7">2.7 - X11 et/ou agent forwarding ne fonctionne
    pas.</a>
<li><a href= "#2.8">2.8 - Après la mise à jour de OpenSSH,
    j'ai perdu le support SSH2.</a>
<li><a href= "#2.9">2.9 - sftp/scp échoue à la connexion
    mais ssh fonctionne.</a>
<li><a href= "#2.10">2.10 - Allez-vous ajouter la fonctionnalité
    [foo] à scp ?</a>
<li><a href= "#2.11">2.11 - Comment utiliser le "port forwarding" ?</a>
<li><a href= "#2.12">2.12 - Ma connexion ssh se fige ou s'arrête
    après N minutes d'inactivité.</a>
<li><a href= "#2.13">2.13 - Comment puis-je utiliser scp pour copier un
    fichier dont le nom comporte deux-points ?</a>
<li><a href= "#2.14">2.14 - Pourquoi OpenSSH annonce sa version aux
    clients ?</a>
</ul>

<h3><a href= "#3.0">3.0 - Questions sur la version portable de OpenSSH
</a></h3>
<ul>
<li><a href= "#3.1">3.1 - Faux messages d'authentification dans les
    journaux systèmes.</a>
<li><a href= "#3.2">3.2 - Mots de passe vides non permis par
    l'authentification PAM.</a>
<li><a href= "#3.3">3.3 - ssh(1) nécessite beaucoup de temps pour
    effectuer une connexion ou ouvrir une session interactive</a>
<li><a href= "#3.4">3.4 - Messages d'erreur "Can't locate module net-pf-
    10" dans les journaux système sous Linux.</a>
<li><a href= "#3.5">3.5 - L'authentification par mot de passe ne
    fonctionne pas (sous Slackware 7.0 ou Red Hat Linux 6.x par
    exemple)</a>
<li><a href= "#3.6">3.6 - Configure ou sshd(8) se plaignent de l'absence
    du support RSA</a>
<li><a href= "#3.7">3.7 - Erreurs "scp: command not found"</a>
<li><a href= "#3.8">3.8 - Incapable de lire la phrase de
protection (passphrase)</a>
<li><a href= "#3.9">3.9 - 'configure' manquant ou make échoue</a> 
<li><a href= "#3.10">3.10 - Connexions suspendues quand on quitte
    ssh</a>
<li><a href= "#3.11">3.11 - Pourquoi ssh suspend la connexion durant la
    phase de sortie du programme ?</a>
<li><a href= "#3.12">3.12 - J'ai effectué une mise à jour
    vers OpenSSH 3.1 et X11 forwarding cesse de fonctionner.</a>
<li><a href= "#3.13">3.13 - J'ai mis à jour OpenSSH en version
    3.8 et certains programmes X11 ne fonctionnent plus.</a>
<li><a href= "#3.14">3.14 - J'ai copié ma clé dans le
    fichier authorized_keys mais l'authentification par clés ne
    fonctionne toujours pas.</a>
<li><a href= "#3.15">3.15 - Les versions d'OpenSSH et leur comportement
	 vis-à-vis de PAM.</a>
<li><a href= "#3.16">3.16 - Pourquoi "w" et "who" ne montrent pas les
	 utilisateurs loggués via ssh sur AIX 5.x ?</a>
</ul>

</blockquote>

<hr>
<h2><u><a name= "1.0">1.0 - Qu'est-ce que OpenSSH et où puis-je
l'obtenir ?</a></u></h2>

<h2><a name= "1.1">1.1 - Qu'est-ce que OpenSSH ?</a></h2>

<p> 
OpenSSH est une version <b>LIBRE</b> de la suite d'outils de
connectivité réseau SSH sur laquelle s'appuie un nombre croissant de
personnes sur Internet. Beaucoup d'utilisateurs de telnet, rlogin, ftp
et d'autres programmes de ce type peuvent ne pas réaliser que leurs mots
de passe est transmis en clair à travers Internet alors qu'en fait, ça
l'est. OpenSSH crypte l'intégralité du trafic (mots de passe compris)
pour éliminer efficacement l'écoute indiscrète, le vol de connexion, et
d'autres attaques au niveau réseau.

<p> 
La suite OpenSSH inclut le programme 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&amp;sektion=1">ssh(1)</a> 
qui remplace rlogin et telnet et 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=scp&amp;sektion=1">scp(1)</a> 
qui remplace 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rcp&amp;sektion=1">rcp(1)</a> 
et <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp&amp;sektion=1">ftp(1)</a>. 
OpenSSH a ajouté 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sftp&amp;sektion=1">sftp(1)</a> 
et <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sftp-server&amp;sektion=8">sftp-server(8)</a> 
qui implémentent une méthode plus facile de transfert de
fichiers, en se basant sur l'ébauche
<a href="../txt/draft-ietf-secsh-filexfer-02.txt">secsh-filexfer</a> 
de l'IETF. 

<p>
<strong>OpenSSH est constitué d'un certain nombre de
programmes.</strong>
<ul>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&amp;sekt- ion=8">sshd(8)</a>
- Programme serveur qui s'exécute sur la machine serveur. Il
  attend des connexions à partir des machines clientes, et
  lorsqu'il en reçoit, il effectue l'authentification et
  commence à répondre aux requêtes du client.
  Son fonctionnement est contrôlé par le fichier de configuration
<i><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd_config&amp;sektion=5">sshd_config(5)</a></i>.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&amp;sektion=1">ssh(1)</a> 
- C'est le programme client utilisé pour se logguer sur une autre
  machine ou exécuter des commandes sur l'autre machine.
  <i>slogin</i> est un nom alternatif pour ce programme.
  Son fonctionnement est contrôlé par le fichier de configuration <i>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh_config&amp;sektion=5">
ssh_config(5)</a></i> et les fichiers personnels <i>$HOME/.ssh/config</i>.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=scp&amp;sektion=1">scp(1)</a> 
- Copie de manière sécurisée des fichiers d'une
  machine vers une autre.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-keygen&amp;sektion=1">ssh-keygen(1)</a> 
- Utilisé pour créer des clés (clés
  d'hôtes ou clés d'authentification) PubKey Authentication
  (RSA ou DSA).
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-agent&amp;sektion=1">ssh-agent(1)</a> 
- Agent d'authentification. Il peut être utilisé pour
  retenir des clés RSA pour authentification.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-add&amp;sektion=1">ssh-add(1)</a> 
- Utilisé pour déclarer de nouvelles clés sur
  l'agent.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sftp-server&amp;sektion=8">sftp-server(8)</a> 
- Sous-système serveur SFTP.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sftp&amp;sektion=1">sftp(1)</a> 
- Programme de transfert sécurisé de fichiers. 
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-keyscan&amp;sektion=1">ssh-keyscan(1)</a> 
- recueille les clés publiques ssh.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-keysign&amp;sektion=8">ssh-keysign(8)</a> 
- Programme d'aide ssh pour l'authentification basée sur
  l'hôte.
</ul>

<h3>Téléchargement</h3>

<p>
OpenSSH est disponible sous forme de deux distributions
téléchargeables : la distribution <a href="openbsd.html">OpenBSD</a>
originale et la distribution <a href="portable.html">Portable</a> multi-
plateformes. Si vous souhaitez utiliser OpenSSH sur une version récente
d'OpenBSD ou pour l'intégrer dans un produit, utilisez la distribution
<a href="openbsd.html">OpenBSD</a>. Si vous souhaitez utiliser OpenBSD
sur une autre plate-forme ou sur une ancienne version d'OpenBSD,
utilisez la distribution <a href="portable.html">Portable</a>.

<p>
Lors d'un téléchargement, utilisez s'il vous plaît un <a
href="portable.html#mirrors">miroir</a> près de chez vous.

<h2><a name= "1.2">1.2 - Pourquoi devrait on l'utiliser ?</a></h2>

<p> 
OpenSSH est une suite d'outils dont l'objectif est de vous aider à
sécuriser vos connexions réseau. Voici une liste de fonctionnalités :

<ul>
<li>Authentification forte. Ferme plusieurs trous de sécurité (par
    exemple, IP, routage, et usurpation DNS).
<li>Intimité améliorée. Toutes les communications sont automatiquement
    cryptées de manière transparente.
<li>Sessions X11 sécurisées. Le programme positionne automatiquement
    DISPLAY sur la machine serveur, et fait suivre toute connexion X11 à
    travers le canal sécurisé.
<li>Des ports TCP/IP arbitraires peuvent être redirigés à travers le
    canal crypté dans les deux directions (par exemple, pour des
    transactions e-cash).
<li>Aucun reformation nécessaire pour les utilisateurs normaux.
<li>Ne fait jamais confiance au réseau. Confiance minimale dans le côté
    distant de la connexion. Confiance minimale dans les serveurs de
    noms de domaine. L'authentification RSA ne fait confiance qu'à la
    clé privée.
<li>RSA client authentifie le serveur au début de chaque connexion pour
    se prémunir contre les chevaux de troie (par routage ou usurpation
    DNS) et les attaques en homme du milieu, et RSA serveur authentifie
    le client avant d'accepter des connexions basées sur une
    authentification <i>.rhosts</i> ou <i>/etc/hosts.equiv</i>
    authentication (pour prévenir les usurpations DNS, routage, ou IP).
<li>La distribution de clés d'authentification hôte peut être effectuée
    de manière centralisée par l'administration, automatiquement lorsque
    la première connexion est établie à une machine.
<li>N'importe quel utilisateur peut créer n'importe quel nombre de clés
    d'authentification utilisateur RSA pour son propre usage.
<li>Le programme serveur possède sa propre clé RSA qui est regénérée
    automatiquement toutes les heures.
<li>Un client d'authentification, exécuté sur la station de travail ou
    le portable de l'utilisateur, peut être utilisé pour retenir les
    clés d'authentification RSA de l'utilisateur.
<li>Le logiciel peut être installé et utilisé (avec des fonctionnalités
    restreintes) même sans privilèges root.
<li>Le client est paramétrable au niveau des fichiers de configuration
    aussi bien système qu'utilisateur.
<li>Compression optionnelle de toutes les données avec gzip (y compris
    les sessions X11 suivies et les données de port TCP/IP), ce qui peut
    aboutir à des accélérations significatives sur des connexions
    lentes.
<li>Remplacement complet de rlogin, rsh, et rcp. 
</ul>

<p> 
Actuellement, pratiquement toutes les communications dans les réseaux
informatiques sont effectuées sans cryptage. Par conséquence, n'importe
quelle personne qui a un accès à n'importe quelle machine connectée au
réseau peut écouter n'importe quelle communication. C'est ce que font
les pirates, les administrateurs curieux, les employés, les criminels,
les espions industriels, et les gouvernements. Certains réseaux ont
assez de fuites de radiation éléctromagnétique pour permettre des
captures de données à distance.

<p> 
Quand vous vous logguez, votre mot de passe transite dans le réseau en
clair. Ainsi, n'importe quelle personne à l'écoute peut alors utiliser
votre compte pour effectuer des opérations malintentionnées. Plusieurs
incidents ont été constatés au niveau modial lorsque des pirates ont
démarré des programmes sur des stations de travail sans que les
propriétaires en prennent connaissance juste pour écouter le réseau et
collecter des mots de passe. Des programmes pour faire de telles choses
sont disponibles sur Internet, ou peuvent être développés par un
programmeur compétent en quelques heures.

<p> 
Les entreprises ont des secrets de fabrication, des demandes de brevets
en préparation, des informations de prix, des informations sur les
contractants, des données client, des données sur le personnel, des
informations financières, etc. De nos jours, n'importe qui ayant un
accès au réseau (n'importe lequel) peut écouter tout ce qui se passe sur
le réseau, sans respect des restrictions d'accès en place.

<p>
Bien des entreprises ne sont pas conscientes que l'information peut être
très facilement récupérée à partir du réseau. Ils croient que leurs
données sont saines et sauves puisque personne n'est supposée savoir
qu'il y a des informations sensibles dans le réseau, ou parce que
beaucoup d'autres données sont transférées sur le réseau. Cette
politique n'est pas sûre.

<h2><a name= "1.3">1.3 - Quels sont les systèmes d'exploitation
    supportés ?</a></h2>

<p> 
Bien que OpenSSH soit développé sur <a
href="http://www.openbsd.org/">OpenBSD</a>, il existe une grande variété
de portages vers d'autres systèmes d'exploitation. la version portable
de OpenSSH est dirigée par <a href="mailto:djm@openbsd.org"> Damien
Miller</a>. Pour une vue d'ensemble rapide de la version portable de
OpenSSH veuillez consulter <a href="portable.html">OpenSSH Portable
Release</a>. Les systèmes d'exploitation actuellement supportés sont :
<ul>
        <li>OpenBSD
        <li>NetBSD
        <li>FreeBSD
        <li>AIX 
        <li>HP-UX 
        <li>IRIX 
        <li>Linux 
        <li>NeXT 
        <li>SCO 
        <li>SNI/Reliant Unix 
        <li>Solaris 
        <li>Digital Unix/Tru64/OSF 
        <li>Mac OS X 
        <li>Cygwin
</ul>

<p> 
Une liste d'éditeurs qui incluent OpenSSH dans leur distribution
se trouve dans la page des
<a href="users.html">Systèmes utilisant OpenSSH</a>.

<h2><a name= "1.4">1.4 - Qu'en est-il des droits d'auteur, de
    l'utilisation, et des brevets ?</a></h2>
<p> 
Les développeurs OpenSSH ont fait beaucoup d'efforts pour éviter tout
problème de brevet ou de droit d'auteur. A cet effet, quelques options
ont été retirées de OpenSSH. Plus précisement le support d'algorithmes
brevetés.

<p> 
OpenSSH ne supporte aucun algorithme de transport breveté. En mode SSH1,
seuls 3DES et Blowfish sont disponibles. En mode SSH2, seulement 3DES,
Blowfish,CAST128, Arcfour et AES peuvent être choisis. L'algorithme
breveté IDEA n'est pas supporté.

<p> 
OpenSSH fournit le support du protocole SSH1 ainsi que du protocole
SSH2.

<p> 
Etant donné que le brevet RSA a expiré, il n'y a plus de restrictions au
niveau de l'utilisation logicielle de l'algorithme RSA, y compris
OpenBSD.

<h2><a name= "1.5">1.5 -  Comment obtenir de l'aide ?</a></h2>
<p> 
Il y a plusieurs endroits où on peut trouver de l'aide. En plus du
<a href="http://www.openssh.com/fr/">site web principal de OpenSSH</a>, il
existe plusieurs listes de discussion. Avant de poster sur celles-ci,
merci d'effectuer des recherches au niveau des archives de ces listes
pour voir s'il n'y a pas déjà une réponse à votre question. La liste de
diffusion OpenSSH a été archivée et mise dans une forme facilitant les
recherches sur <a href="http://marc.theaimsgroup.com/?l=openssh-unix-
dev&amp;r=2&amp;w=2"> theaimsgroup.com</a>.

<p> 
Pour plus d'informations concernant l'abonnement aux listes de diffusion
relatives à OpenSSH, veuillez consulter la page des <a
href="list.html">listes de diffusion OpenSSH</a>.

<p>
Les informations concernant l'envoi de rapports de bogues se trouvent
dans la page <a href="report.html">Reporting bugs</a>.

<h2><u><a name= "2.0">2.0 - Questions
       Générales</a></u></h2>

<h2><a name= "2.1">2.1 - Pourquoi ssh/scp établit des connexions
    à partir de ports privilégiés.</a></h2>
<p> 
Le client OpenSSH utilise des ports privilégiés (low numbered ports)
pour l'authentification rhosts et rhosts-rsa parce que le serveur a
besoin de se fier au nom d'utilisateur fournit par le client. Pour
désactiver ce comportement, vous pouvez ajouter la ligne suivante à
votre fichier <i>ssh_config</i> ou à
<i>~/.ssh/config</i>.

<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<b>UsePrivilegedPort no</b>
                </td>
        </tr>
</table>
</blockquote>

<p> 
Autrement vous pouvez spécifier cette option au niveau de la ligne de
commande en utilisant l'option <b>-o</b> de la commande
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&amp;sektion=1">ssh(1)</a>. 
<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
$ <b>ssh -o "UsePrivilegedPort no" host.com</b>
                </td>
        </tr>
</table>
</blockquote>

<h2><a name= "2.2">2.2 - Pourquoi le client ssh est setuid root
    ?</a></h2>

<p> 
Conjointement avec la question précédente ( <a href="#2.1">2.1</a>),
OpenSSH a besoin de l'autorité root pour être capable de s'attacher aux
ports privilégiés afin de faciliter <i> l'authentification rhosts</i>.
Un port privilégié est aussi requis pour l'authentification rhosts-rsa
sur les anciennes versions de older SSH.

<p> 
De plus, dans le cas de <i>l'authentification rhosts-rsa </i> (dans le
protocole version 1) et <i>l'authentification hostbased </i> dans le
protocole version 2), le client ssh a besoin d'accèder à la <em>clé
privée d'hôte </em>pour authentifier la machine cliente auprès du
serveur.
Pour ce faire, les versions d'OpenSSH antérieures à 3.3 nécessitent un
bit setuid root positionné sur le binaire <code>ssh</code>. Si vous
n'utilisez pas ce mode d'authentification, vous pouvez supprimer ce bit
sans problème.

<p>
A partir d'OpenSSH 3.3, <code>ssh</code> n'est pas setuid par
défaut.
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-keysign">ssh-keysign</a>,
est utilisé pour accéder aux clés privés d'hôtes, et ssh n'utilise pas
les ports source privilégiés par défaut. Si vous souhaitez utiliser un
port source privilégié, vous devez positionner manuellement le bit
setuid pour <code>ssh</code>.

<h2><a name= "2.3">2.3 - Pourquoi SSH 2.3 a des problèmes
    d'interopérabilité avec OpenSSH 2.1.1 ?</a></h2>

<p> 
SSH 2.3 et les versions antérieures contiennent un défaut dans leur
implémentation HMAC. Leur code ne fournissait pas le bloc de données
entier obtenu à partir du digest. Au lieu de cela, il fournissait
toujours 128 bits. Pour des digests plus grands, ça entraînait des
problèmes d'interopérabilité de SSH 2.3 avec OpenSSH.

<p> 
OpenSSH 2.2.0 détecte ce défaut sur SSH 2.3. Les version récentes de SSH
fixeront ce défaut. Autrement, vous pouvez ajouter la ligne suivante à
<i>sshd2_config </i> de SSH 2.3.
<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<b>Mac hmac-md5</b>
               </td>
        </tr>
</table>
</blockquote>

<h2><a name= "2.4">2.4 - Pourquoi OpenSSH affiche : Dispatch protocol
    error: type 20</a></h2>

<p> 
Des problèmes d'interopérabilité ont été constatés car les anciennes
versions de OpenSSH ne supportent pas la renégociation des clés de
sessions. Cependant, SSH commercial 2.3 essaie de négocier cette
fonctionnalité, dès lors vous pourriez avoir des gels de connexion ou
voir le message d'erreur &quot;<b>Dispatch protocol error: type 20
</b>&quot;. Pour résoudre ce problème, effectuez une mise à jour vers
une version récente de OpenSSH ou désactiver la renégociation de clés en
ajoutant la ligne suivante au niveau du fichier<i> ssh2_config</i> ou
<i>sshd2_config</i> sur la version commerciale SSH 2.3.
<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<b>RekeyIntervalSeconds 0</b>
                </td>
        </tr>
</table>
</blockquote>

<h2><a name= "2.5">2.5 - Les anciennes versions de SSH commercial
    utilisent IDEA pour le cryptage des clés de
    hôtes.</a></h2>

<p> 
Les anciennes versions de SSH utilisaient un algorithme breveté pour
crypter leur <i>/etc/ssh/ssh_host_key</i>. Ce problème se manifestera
lorsque
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&amp;sektion=8">sshd(8)</a> 
ne pourra pas lire sa clé d'hôte. Pour le résoudre,
utilisez la commande ci-après pour convertir votre ssh_host_key
en 3DES. <b>REMARQUE :</b> Utilisez le programme 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-keygen&amp;sektion=1">ssh-keygen(1)</a> 
du produit commercial SSH, *PAS* OpenSSH pour l'exemple ci-dessous.
<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
# <b>ssh-keygen -u -f /etc/ssh/ssh_host_key</b>
                </td>
        </tr>
</table>
</blockquote>

<h2><a name= "2.6">2.6 - A quoi correspondent les messages
    d'avertissement concernant les longueurs de clé ?</a></h2>

<p>
Le programme 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-keygen&amp;sektion=1">ssh-keygen(1)</a> 
de SSH commercial contenait un bogue qui lui faisait occasionnellement
générer des clés Pubkey Authentication (RSA or DSA) qui avait leur bit à
poids le plus significatif (Most Significant Bit ou MSB) non positionné.
De telles clés étaient annoncées comme étant à longueur complète alors
qu'en réalité elles sont plus petites une fois sur deux.

<p>
OpenSSH affichera des messages d'avertissement quand de telles clés sont
rencontrées. Pour se débarasser de ces messages, éditez vos fichiers
<i>known_hosts</i> et remplacez la fausse longueur de clé
(habituellement &quot;1024&quot;) avec la vraie longueur (habituellement
&quot;1023&quot;).

<h2><a name= "2.7">2.7 - X11 et/ou agent forwarding ne fonctionne
    pas.</a></h2>

<p> 
Vérifiez <i>ssh_config</i> et <i>sshd_config</i>. Les fichiers de
configuration par défaut désactivent le X11 et le agent forwarding. Pour
activer ces options, ajoutez la ligne suivante à
<i>sshd_config </i>:
<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<b>X11Forwarding yes</b>
                </td>
        </tr>
</table>
</blockquote>

<p> et ajoutez les lignes suivante à <i>ssh_config</i>: 
<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<b>ForwardAgent yes</b><br>
<b>ForwardX11 yes</b>
                </td>
        </tr>
</table>
</blockquote>

<p>
Remarque sur l'intéropérabilité des agents : il y a deux types
différents et incompatibles de mécanismes "agent forwarding" au sein du
protocole SSH2.
OpenSSH a toujours utilisé une extension des requêtes de l'agent SSH1
original, alors que les produits commerciaux en utilisent un autre, non
libre. Ceci signifie donc que l' "agent forwarding" ne peut pas être
utiliser entre OpenSSH et ces protocoles.

<p>
<b>REMARQUE :</b> Pour les utilisateurs de Linux Mandrake 7.2, Mandrake
   modifie la variable d'environnement <i>XAUTHORITY</i> dans
   <i>/etc/skel/.bashrc</i>, ce qui a pour effet de la modifier pour
   tous les utilisateurs. Cette variable est positionnée par
   OpenSSH et pour que les options ci-dessus fonctionnent, vous devez
   mettre en commentaire la ligne :


<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<b># export XAUTHORITY=$HOME/.Xauthority</b>
                </td>
        </tr>
</table>
</blockquote>

<h2><a name= "2.8">2.8 - Après la mise à jour de OpenSSH,
    j'ai perdu le support SSH2.</a></h2>

<p>
Entre des versions différentes, des modifications peuvent être apportées
à <i>sshd_config</i> ou <i>ssh_config</i>. Vous devriez toujours
vérifier ces modifications lors de la mise à jour OpenSSH. Après la
version 2.3.0 de OpenSSH, vous aurez besoin d'ajouter ce qui suit à
<i>sshd_config</i>.


<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<b>HostKey /etc/ssh_host_dsa_key</b><br>
<b>HostKey /etc/ssh_host_rsa_key</b>
                </td>
        </tr>
</table>
</blockquote>

<h2><a name= "2.9">2.9 - sftp/scp échoue à la connexion
    mais ssh fonctionne.</a></h2>

<p>
sftp et/ou scp peuvent échouer à la connexion si vous avez une
initialisation du shell (.profile, .bashrc, .cshrc, etc) qui produit une
sortie pour des sessions non-interactives. Cette sortie rend le client
sftp/scp confus. Vous pouvez vérifier si c'est le cas pour votre shell
en exécutant la commande suivante :

<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<b>ssh yourhost /usr/bin/true</b>
                </td>
        </tr>
</table>
</blockquote>

<p>
Si la commande ci-dessus génère une sortie, alors vous
aurez besoin de modifier votre initialisation du shell.

<h2><a name= "2.10">2.10 - Allez-vous ajouter la fonctionnalité
    [foo] à scp ?</a></h2>

<p>
Réponse courte : non.

<p>
Réponse longue : scp n'est pas une commande standard. La seule
spécification approchante de ce que fait scp est celle de rcp. Etant
donné que c'est la même commande qui est utilisée par les deux
extrêmités de la communication, l'ajout de fonctionnalités ou d'options
risque de casser l'interopérabilité avec d'autres implémentations.

<p>
De nouvelles fonctionnalités peuvent cependant être introduites dans
sftp, vu que le protocole est standardisé (enfin pratiquement, il y a un
<a href="http://www.ietf.org/internet-drafts/draft-ietf-secsh-filexfer-05.txt">
document de travail</a>), et que le client et le serveur sont découplés.

<h2><a name= "2.11">2.11 - Comment utiliser le "port forwarding"
?</a></h2>

<p>
Si le serveur distant est un serveur sshd(8), il est possible de créer
un tunnel pour certains services via ssh. Ceci peut être utile pour
chiffrer des connexions POP ou SMTP même si les logiciels ne supportent
pas directement les communications chiffrées. La création d'un tunnel se
base sur le "port forwarding" pour créer une connexion entre le client
et le serveur. Le logiciel client doit être capable de spécifier un port
non-standard auquel se connecter pour que cette technique fonctionne.

<p>
Pour créer un tunnel chiffré par ssh, l'utilisateur se connecte à l'hôte
distant en utilisant ssh et spécifie le port sur la machine cliente qui
devra être utilisé pour y passer les connexions à destination du serveur
distant. Il devient alors possible de démarrer le service à chiffrer
(par exemple fetchmail, irc ...) sur la machine client en précisant le
même port local que celui précédemment fourni. La connexion sera dès
lors chiffrée dans le tunnel ssh.

<p>
Les options à utiliser pour la création des tunnels sont les options -L
et -R, qui permettent à l'utilisateur de faire passer des connexions à
travers des tunnels, l'option -D qui permet de faire du "port
forwarding" dynamique, et l'option -f qui permet de mettre ssh en tâche
de fond. Ces options sont détaillées plus bas.

<p>
Voici un exemple pour créer un tunnel pour une session IRC entre une
machine cliente ``127.0.0.1'' (localhost) et un serveur distant " This
is an example of tunnelling an IRC session from client machine
``127.0.0.1'' (localhost) to remote server ``server.example.com'':

<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<b>ssh -f -L 1234:server.example.com:6667 server.example.com sleep 10<br>
irc -c '#users' -p 1234 pinky 127.0.0.1</b>
        </td>
        </tr>
</table>
</blockquote>

<p>
La commande ci-dessus crée un tunnel pour une connexion IRC vers le
serveur server.example.com. L'utilisateur veut se joindre au canal
"#users", il a pour surnom "pinky". Le port local utilisé dans cet
exemple est le port 1234. Le numéro de port importe peu tant qu'il est
supérieur à 1023 (autrement, seul "root" peut ouvrir des sockets sur les
ports privilégiés soit tous les ports inférieurs à 1024) et qu'il
n'entre en conflit avec aucun port utilisé sur la machine. La connexion
est chiffrée dans le tunnel jusqu'au serveur distant puis une fois
déchiffrée, elle est envoyée sur le port 6667 du serveur vu que c'est le
port standard utilisé par les services IRC.

<p>
La commande distante "sleep 10" est utilisée pour spécifier le temps
d'attente (10 secondes dans l'exemple précité) avant le démarrage du
service qui doit transiter à travers le tunnel. Si aucune connexion
n'est effectuée durant ce temps d'attente, ssh s'arrête. Si un temps
d'attente plus important est nécessaire, la valeur de sleep(1) peut être
augmentée en conséquence, autrement l'exemple ci-dessus pourrait être
ajouté comme fonction au shell utilisateur. Consultez les pages du
manuel de ksh(1) et csh(1) pour plus de détails concernant les fonctions
définies par l'utilisateur.

<p>
ssh possède aussi une option -N, pratique pour une utilisation de ssh en
"port forwarding" : si -N est spécifiée, il n'est plus nécessaire
d'utiliser une commande distante ("sleep 10" dans l'exemple ci-dessus).
Cependant, l'utilisation de cette option oblige ssh à attendre
indéfiniment (alors qu'avec une commande distante, ssh s'interrompera
après la fin d'exécution de cette dernière). L'utilisateur devra alors
mettre fin manuellement au processus ssh.

<h2><a name= "2.12">2.12 - Ma connexion ssh se fige ou s'arrête
    après N minutes d'inactivité.</a></h2>

<p>
Ceci est généralement dû à l'expiration de votre session ssh au niveau
d'un pare-feu ou d'un équipement de NAT en raison d'inactivité. Afin
d'éviter cela, vous pouvez activer
<b>ClientAliveInterval</b> dans le fichier de configuration serveur <i>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd_config&amp;sektion=5">sshd_config</a></i>, 
ou activer <b>ServerAliveInterval</b> dans le fichier de configuration
client <i>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh_config&amp;sektion=5">
ssh_config</a></i>.
Cette dernière option n'est disponible qu'à partir de OpenSSH 3.8.

<p>
L'activation d'une des options précitées en positionnant leur valeur à
un intervalle plus petit que le temps d'inactivité avant expiration de
la session permettra de garder la session dans la table de connexion de
l'équipement, sans que la session expire.

<h2><a name= "2.13">2.13 - Comment puis-je utiliser scp pour copier un
    fichier dont le nom comporte deux-points ?</a></h2>

<b><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=scp&amp;sektion=1">
scp</a></b> interprétera l'élément précédant le point-virgule comme le
nom d'un serveur distant et tentera de s'y connecter. Pour empêcher
cela, utilisez un chemin relatif ou absolu, par exemple :

<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
$ scp ./source:file sshserver:
                </td>
        </tr>
</table>
</blockquote>

<h2><a name= "2.14">2.14 - Pourquoi OpenSSH annonce sa version aux
    clients ?</a></h2>

<p>
Comme la plupart des implémentations SSH, OpenSSH annonce son nom et sa
version aux clients lorsque ces derniers initient une connexion. Par
exemple :
</p>

<blockquote>
SSH-2.0-OpenSSH_3.9
</blockquote>

<p>
Cette information est utilisée par les clients et les serveurs pour
activer des options de compatibilité protocolaire pour contourner des
fonctionnalités modifiées, problématiques ou absentes au niveau de
l'implémentation vers laquelle la connexion est initiée. Cette
fonctionnalité de vérification du protocole est encore requise à l'heure
actuelle car le protocole SSH n'a pas encore été publié en tant que RFC
et d'autres modifications incompatibles peuvent être introduites avant
que cette publication n'aie lieu.

<h2><u><a name= "3.0">3.0 - Questions sur la version portable de
       OpenSSH</a></u></h2>

<h2><a name= "3.1">3.1 - Faux messages d'authentification dans les
    journaux systèmes.</a></h2>

<p>
La version portable de OpenSSH générera de faux messages
d'authentification à chaque login, similaires à :

<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
&quot;<b>authentication failure; (uid=0) -&gt; root for sshd service</b>&quot;
                </td>
        </tr>
</table>
</blockquote>

<p>
Ces messages sont générés car OpenSSH essaie d'abord de déterminer si un
utilisateur a besoin d'authentification pour se logguer (par exemple, un
mot de passe vide). Malheureusement, PAM aime enregistrer tous les
événements d'authentification, y compris celui-ci.

<p>
Si cela vous gêne beaucoup, positionnez &quot;<b>PermitEmptyPasswords
no</b>&quot; dans <i>sshd_config</i>. Ceci aura pour effet de stopper le
message d'erreur mais en désactivant, par la même occasion, les
connexions à des comptes sans mot de passe. C'est le comportement par
défaut si vous utilisez le fichier <i>sshd_config</i> fourni.

<h2><a name= "3.2">3.2 - Mots de passe vides non permis par
    l'authentification PAM.</a></h2>

<p> 
Pour permettre l'utilisation de mots de passe vides avec une version de
OpenSSH construite avec PAM, vous devez ajouter le drapeau nullok à la
fin du module de vérification du mot de passe dans le fichier
<i>/etc/pam.d/sshd</i>. Par exemple :

<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
auth required/lib/security/pam_unix.so shadow nodelay nullok
                </td>
        </tr>
</table>
</blockquote>

<p>
Cette action doit être effectuée en plus du positionnement
&quot;<b>PermitEmptyPasswords yes</b>&quot; dans le fichier
<i>sshd_config</i>.

<p>
Il y a un problème lorsque des mots de passe vides sont utilisés avec
l'authentification PAM : PAM autorisera n'importe quel mot de passe
quand on s'authentifie sur un compte doté d'un mot de passe vide. Ce qui
a pour effet de casser la vérification que <a href="http://www.openbsd.org/cgi-
bin/man.cgi?query=sshd&amp;sektion=8">sshd(8)</a> effectue pour
déterminer si un compte n'a pas de mot de passe positionné et autorise
l'accès quelque soit la politique spécifiée par
<b>PermitEmptyPasswords</b>. Pour cette raison, il est recommandé de ne
pas ajouter la directive <b>nullok</b> à votre fichier de configuration
PAM à moins que vous souhaitiez spécifiquement autoriser les mots de
passe vides.

<h2><a name= "3.3">3.3 - ssh(1) nécessite beaucoup de temps pour
effectuer une connexion ou ouvrir une session interactive</a></h2>

<p>
D'importants délais (plus de 10 secondes) à la connexion sont
typiquement causés par un problème au niveau de la résolution de noms :
<ul>
<li>Certaines versions de la glibc (notamment la glibc 2.1 fournie avec
Red Hat 6.1) peut nécessiter un temps significatif pour résoudre des
adresses IPv6 ou IPv4 à partir de noms de domaine. Un moyen de
contournement consiste à spécifier l'option <b>AddressFamily inet</b>
dans le fichier <i>ssh_config</i>.

<li>Il peut y avoir un problème de résolution DNS côté client
ou côté serveur. Vous pouvez utiliser la commande <code>nslookup</code>
pour vérifier la résolution de noms et des adresses IP du client sur le
serveur et vice-versa. Vous pouvez désactiver la plupart des résolutions
DNS effectuées côté serveur en utilisant <b>UseDNS no</b> dans
<i>sshd_config</i>.
</ul>

<p>
Des délais de moins de 10 secondes peuvent avoir d'autres causes.

<ul>

<li>Les versions d'OpenSSH antérieures à la version 3.8 ont un fichier
    <i>moduli</i> qui contient du moduli juste inférieur à ce que sshd
    nécessitait. Par conséquence, sshd finissait par utiliser du moduli
    largement supérieur à ce qui était demandé d'où une baisse des
    performances. Le remplacement du fichier <i>moduli</i> résoudra ce
    problème. Il est à noter que, dans la plupart des cas, le fichier
    n'est pas remplacé suivant une mise à jour. Il devra alors être
    remplacé manuellement.

<li>Les versions d'OpenSSH antérieures à la version 3.8 contiennent un
    défaut dans <code>ssh</code>. A cause de ce défaut, <code>ssh</code>
    demande du moduli plus grand que nécessaire. Combiné au problème
    précité, les baisses de performance étaient encore plus
    significatives. La mise à jour du client en version 3.8 ou
    supérieure résout ce problème.

<li>Si le client ou le serveur ne possède pas un mécanisme de génération
    de nombres aléatoires basé sur le noyau (par exemple : Solaris &lt;
    9, AIX &lt; 5.2, HP-UX &lt; 11.11) et qu'aucun mécanisme altenatif
    n'est disponibles (par exemple :
    <a href="ftp://ftp.ayamura.org/pub/prngd/">prngd</a>, il est alors
    possible qu'un des programmes appelés par <code>ssh-rand-
    helper</code> pour générer de l'entropie ne rend pas la main. Pour
    vérifier si c'est le cas, il suffit d'exécuter <code>ssh-rand-
    helper</code> en mode debug :

<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
/usr/local/libexec/ssh-rand-helper -vvv
                </td>
        </tr>
</table>
</blockquote>

Tout délai significatif à la connexion doit être investigué et corrigé.
Sinon, il suffira de supprimer les commandes posant problème du fichier
<i>ssh_prng_cmds</i>.
 
</ul>

<h3>Lenteur des connexions</h3>
Dans des conditions normales, la vitesse des sessions interactives SSH
dépend de la vitesse du processeur sur le client et sur le serveur. A
titre de comparaison, les données suivantes représentent des temps de
connexion typiques pour l'exécution de <code>time ssh localhost
true</code> avec une clé RSA de 1024 bits sur des machines non chargées.
OpenSSH et OpenSSL ont été compilés avec gcc 3.3.x.

<p>
<table>
<tr><th>CPU</th><th>Time (SSHv1)<a href="#3.3fn1">[1]</a></th>
        <th>Time (SSHv2)</th></tr>
<tr><td>170MHz SPARC/sun4m</td><td>0.74 sec</td><td>1.25 sec</td></tr>
<tr><td>236MHz HPPA/8200<a href="#3.3fn2">[2]</a></td><td>0.44 sec</td>
        <td>0.79 sec</td></tr>
<tr><td>375MHz PowerPC/604e</td><td>0.38 sec</td><td>0.51 sec</td></tr>
<tr><td>933MHz VIA Ezra</td><td>0.34 sec</td><td>0.44 sec</td></tr>
<tr><td>2.1GHz Athlon XP 2600+</td><td>0.14 sec</td><td>0.22 sec</td></tr>
</table>

<br>

<a name="3.3fn1">[1]</a> 
Le protocole SSHv1 est plus rapide que SSHv2 mais cryptographiquement
plus faible.<br>

<a name="3.3fn2">[2]</a>
A l'heure de la rédaction de ces lignes, gcc génère
du code relativement lent sous HPPA pour les opérations RSA et
Diffie-Hellman (veuillez consulter
<a href= "http://gcc.gnu.org/bugzilla/show_bug.cgi?id=7625">gcc
bug #7625</a> et
<a href="http://marc.theaimsgroup.com/?l=openssh-unix-dev&m=102646106016694">discussion on openssh-unix-dev</a>).

<h2><a name= "3.4">3.4 - Messages d'erreur "Can't locate module
    net-pf-10" dans les journaux système sous Linux.</a></h2>

<p>
Le noyau Linux recherche (à travers modprobe) la famille de protocoles
10 (IPv6). Il faut soit charger le module noyau approprié, soit saisir
l'alias correct dans <i>/etc/modules.conf</i> ou désactiver IPv6 dans
<i>/etc/modules.conf</i>.


<p>
Pour une raison inconnue, <i>/etc/modules.conf</i> peut aussi s'appeler
<i>/etc/conf.modules</i>.


<h2><a name= "3.5">3.5 - L'authentification par mot de passe ne
    fonctionne pas (sous Slackware 7.0 ou Red Hat 6.x par
    exemple)</a></h2>

<p> 
Si le mot de passe est correct mais la connexion est refusée, il est
fort probable que le système soit configuré pour utiliser des mots de
passe de type MD5. Cependant, la fonction <a href="http://www.openbsd.org/cgi-
bin/man.cgi?query=crypt&amp;sektion=3">crypt(3)</a> utilisée par sshd ne
sait pas les interpréter.

<p>
Les comptes d'utilisateurs affectés par ce problème contiendront les
caractères <b>$1$</b> en début de la chaîne représentant le mot de passe
dans <i>/etc/passwd</i> ou <i>/etc/shadow</i>.
Vous pouvez être pratiquement sûr que tel est le problème lorsque
l'authentification par mots de passe échoue pour les nouveaux comptes ou
pour les comptes dont le mot de passe a été changé récemment, alors
qu'elle fonctionne pour les anciens comptes.

<p>
La cause sous-jacente de ce problème est l'existence de certaines
versions d'OpenSSL dont la fonction crypt(3) ne sait pas interpréter les
mots de passe MD5 et l'ordre de liage des librairies au sein de sshd
donne une préférence à la fonction crypt(3) fournie par le système. Le
programme configure d'OpenSSH tente de corriger ce problème lorsqu'il le
détecte mais il n'est pas toujours couronné de succès.

<p>
Il existe plusieurs solutions possibles :

<ul>
<li>
<p>
Activer le support natif des mots de passe MD5 de sshd à la compilation.

<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
./configure --with-md5-passwords [options]
                </td>
        </tr>
</table>
</blockquote>

Cette solution est sans danger même si vous avez les deux types de
chiffrement du mot de passe. En effet, sshd sélectionnera
automatiquement l'algorithme adapté pour chaque compte.

<li>
<p>
Si votre système a une librairie libcrypt séparée (tel que Slackware 7),
vous pouvez ajouter manuellement -lcrypt à la liste LIBS pour que cette
librairie soit utilisée au lieu de celle d'OpenSSL.

<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
LIBS=-lcrypt ./configure [options]
                </td>
        </tr>
</table>
</blockquote>

<li>
<p>
Si votre plate-forme supporte PAM, vous pouvez configurer sshd de telle
manière à ce qu'il utilise les fonctionnalités PAM (voir la <a href=
"#3.15" >section 3.15</a>). Ceci se traduira alors par une modification
dans la manière utilisée par sshd pour vérifier la validité des mots de
passe qui lui sont soumis : il fera appel aux modules PAM configurés
pour cette vérification au lieu de le faire lui-même.
</ul>

<h2><a name= "3.6">3.6 - Configure ou sshd(8) se plaignent de l'absence
    du support RSA</a></h2>

<p> 
Assurez vous que vos librairies OpenSSL disposent du support RSA ou DSA
soit en interne soit à travers RSAref.

<h2><a name= "3.7">3.7 - Erreurs "scp: command not found"</a></h2>

<p> 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=scp&amp;sektion=1">scp(1)</a>
doit être dans le PATH par défaut sur le client et sur le serveur. Vous
aurez peut-être besoin d'utiliser l'option
<b>--with-default-path</b> pour spécifier un chemin particulier
à inclure sur le serveur. Cette option remplace le chemin par
défaut. Vous aurez donc besoin de spécifier tous les
répertoires actuellement dans votre chemin aussi bien que le
répertoire dans lequel se trouve scp. Par exemple :

<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
$ <b>./configure --with-default-path=/bin:/usr/bin:/usr/local/bin:/path/to/scp</b>
                </td>
        </tr>
</table>
</blockquote>

<p>
La configuration effectuée par l'administrateur du serveur est
prioritaire par rapport à <b>--with-default-path</b>. Ceci inclut la
mise à zéro de PATH dans <i>/etc/profile</i>, PATH dans
<i>/etc/environment</i> sous AIX, ou (pour les versions d'OpenSSH
supérieures ou égales à 3.7p1), le positionnement
de PATH ou de SUPATH dans <i>/etc/default/login</i> sous Solaris ou
Reliant Unix.

<h2><a name= "3.8">3.8 - Incapable de lire la phrase de protection
    (passphrase)</a></h2>

<p> 
Certains systèmes d'exploitation positionnent des permissions
incorrectes sur <i>/dev/tty</i>. Par conséquence, la lecture de
mots de passe échoue avec l'erreur suivante :

<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
You have no controlling tty.  Cannot read passphrase.
                </td>
        </tr>
</table>
</blockquote>

<p> 
La solution consiste à positionner les permissions à 0666 sur
<i>/dev/tty</i> et soumettre l'erreur comme étant un bogue à l'éditeur
de votre OS.

<h2><a name= "3.9">3.9 - 'configure' manquant ou make
    échoue</a></h2>

<p> 
S'il n'y a pas de fichier 'configure' dans le fichier tar.gz que vous
avez téléchargé ou si make échoue avec des
erreurs du type "missing separator", vous avez probablement
téléchargé la distribution OpenBSD de OpenSSH et
vous êtes entrain de d'essayer de la compiler sur une autre
plateforme. Merci de consultez la page 
<a href="portable.html">portable version</a>.

<h2><a name= "3.10">3.10 - Connexions suspendues quand on quitte
    ssh</a></h2>

<p> 
OpenSSH peut suspendre une connexion en phase de terminaison. Ceci peut
arriver quand il y a un processus actif en arrière plan. C'est un
problème connu sous Linux et HP-UX. On peut vérifier son existence en
faisant :

<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
$ <b>sleep 20 &amp; exit</b>
                </td>
        </tr>
</table>
</blockquote>

Ou essayez plutôt d'utiliser la commande suivante : 
<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
$ <b>sleep 20 &lt; /dev/null &gt; /dev/null 2&gt;&amp;1 &amp;</b>
                </td>
        </tr>
</table>
</blockquote>

<p> 
Une solution de contournement pour les utilisateurs bash est de mettre
<b>"shopt -s huponexit"</b> soit dans /etc/bashrc soit dans ~/.bashrc.
Autrement, consultez la page de manuel de votre shell pour une option
qui permet d'envoyer un signal HUP à des tâches actives
durant la phase de terminaison. Consultez
<a href="http://bugzilla.mindrot.org/show_bug.cgi?id=52">bug #52</a>
pour d'autres solutions de contournement.

<h2><a name= "3.11">3.11 - Pourquoi ssh suspend la connexion durant la
    phase de sortie du programme ?</a></h2>

<p>
Quand la commande 
<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
$ <b>ssh host command</b>
                </td>
        </tr>
</table>
</blockquote>
est exécutée, ssh <b>a besoin</b> de suspendre la
connexion, car il doit attendre :
<ul>
<li>Jusqu'à ce qu'il soit sûr que <code>command</code> n'a
     pas besoin d'autres informations en entrée.
<li>Jusqu'à ce qu'il soit sûr que <code>command</code> ne
     produit pas d'autres informations en sortie.
<li>Jusqu'à ce que <code>command</code> finisse car sshd a besoin
    de communiquer le code de sortie de <code>command</code> à
    ssh.
</ul>
<p>

<h2><a name= "3.12">J'ai effectué une mise à jour vers
    OpenSSH 3.1 et X11 forwarding cesse de fonctionner.</a></h2>

A partir de OpenSSH 3.1, le serveur sshd x11 forwarding écoute
sur localhost par défaut. Vous pouvez utiliser l'option
<b>X11UseLocalhost</b> pour revenir au comportement
précédent si vos anciens clients X11 ne fonctionnent pas
avec cette configuration.

<p> 
De manière générale, les clients X11 utilisant X11
R6 devraient fonctionner avec le paramétrage par défaut.
Certains éditeurs, HP compris, utilisent sur leurs
systèmes des clients X11 avec des librairies R6 et R5. Ainsi,
certains clients vont fonctionner et d'autres ne fonctionneront pas.
C'est le cas pour HP-UX 11.X.<p>

<h2><a name= "3.13">3.13 - J'ai mis à jour OpenSSH en version 3.8 et
certains programmes X11 ne fonctionnent plus.</a></h2>

<p>
Tel que c'est documenté dans les <a href="../txt/release-3.8">notes
d'information de la version 3.8</a>, <code>ssh</code> utilise désormais
les cookies X11 non dignes de confiance par défaut. Le comportement
précédent peut être restoré en positionnant <b>ForwardX11Trusted yes</b>
dans <i>ssh_config</i>.

<p>
Voici une liste de quelques symptômes possibles :<br> <code>BadWindow
(invalid Window parameter)<br> BadAccess (attempt to access private
resource denied)<br> X Error of failed request: BadAtom (invalid Atom
parameter)<br> Major opcode of failed request: 20
(X_GetProperty)<br></code>

<h2><a name= "3.14">3.14 - J'ai copié ma clé dans le
    fichier authorized_keys mais l'authentification par clés ne
    fonctionne toujours .</a></h2>

Ce problème est typiquement causé par des permissions plus larges que
celles permises par sshd par défaut pour les répertoires $HOME,
$HOME/.ssh ou le fichier $HOME/.ssh/authorized_keys.

<p>
Dans ce cas, l'exécution des commandes suivantes sur le serveur
résoudra le problème :
<blockquote>
<table border=0 width="800">
<tr>
  <td nowrap bgcolor="#EEEEEE">
$ <b>chmod go-w $HOME $HOME/.ssh</b><br>
$ <b>chmod 600 $HOME/.ssh/authorized_keys</b>
  </td>
</tr>
</table>
</blockquote>

<p>
Si, pour quelque raison que ce soit, ce n'est pas envisageable de faire
ça une solution alternative consiste à positionner
<b>StrictModes no</b> dans <i>sshd_config</i>, cependant cette solution
n'est pas recommandée.

<h2><a name= "3.15">3.15 - Les versions d'OpenSSH et leur comportement
vis-à-vis de PAM.</a></h2>

La version portable d'OpenSSH a la possibilité, via une option de
compilation, d'activer le support de l'interface <a
href="http://www.opengroup.org/onlinepubs/008329799/">PAM</a>(Pluggable
Authentication Modules) au niveau de sshd.

<blockquote>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
./configure --with-pam [options]
                </td>
        </tr>
</table>
</blockquote>

Pour activer le support PAM, cette option doit être utilisée à la
compilation. Le comportement de la version portable d'OpenSSH, lorsque
le support PAM est activé, dépend de la version utilisée et, dans le cas
des versions les plus récentes, du positionnement de la directive
<b>UsePAM</b> dans le fichier de configuration <i>sshd_config</i>.

<p>
Le tableau ci-après résume le comportement des options
d'authentifications lorsque le support PAM est activé.

<p>
<table border="1">
  <tr> <th>Version</th> <th>Valeur par défaut de UsePAM</th> <th>PasswordAuthentication</th>
<th>ChallengeResponseAuthentication</th> </tr>
  <tr>
    <td>&lt;=3.6.1p2</td>
    <td>Non applicable</td>
    <td>Utilise PAM</td>
    <td>Utilise PAM si <b>PAMAuthenticationViaKbdInt</b> est activé</td>
  </tr>
  <tr>
    <td>3.7p1 - 3.7.1p1</td>
    <td><b>yes</b></td>
    <td>N'utilise pas PAM</td>
    <td>Utilise PAM si <b>UsePAM</b> est activé</td>
  </tr>
  <tr>
    <td>3.7.1p2 - 3.8.1p1</td>
    <td><b>no</b></td>
    <td>N'utilise pas PAM <a href="#3.15fn1">[1]</a></td>
    <td>Utilise PAM si <b>UsePAM</b> est activé</td>
  </tr>
  <tr>
    <td>3.9p1</td>
    <td><b>no</b></td>
    <td>Utilise PAM si <b>UsePAM</b> est activé</td>
    <td>Utilise PAM si <b>UsePAM</b> est activé</td>
  </tr>
</table>
<p>

<a name= "3.15fn1">[1]</a> Certains éditeurs, notamment Red Hat/Fedora,
ont intégré le comportement de PasswordAuthentitication de la version
3.9p1 à leurs packages 3.8x. Si vous utilisez un package fourni par
éditeur, consultez la documentation qui l'accompagne.

<p>
L'interface PAM de la version portable d'OpenSSH a encore quelques
problèmes avec certains modules. Nous espérons toutefois réduire le
nombre de ces problèmes dans le futur. Les problèmes connus au niveau de
la version 3.9p1 sont les suivants :

<ul>
  <li>Les modules s'appuyant sur des données de module privées (tels que
pam_dhkeys, pam_krb5, et AFS) peuvent échouer à créer correctement les
habilitations (bogue numéro <a
href="http://bugzilla.mindrot.org/show_bug.cgi?id=688">#688</a>) lors de
l'authentification via <b>ChallengeResponseAuthentication</b>.
<b>PasswordAuthentication</b> devrait fonctionner sans problème.
</ul>

Vous pouvez aussi consulter
<a href="http://bugzilla.mindrot.org/buglist.cgi?product=Portable+OpenSSH&amp;bug_status=RESOLVED&amp;bug_status=NEW&amp;bug_status=ACCEPTED&amp;component=PAM+support">bugzilla
pour les problèmes PAM actuels</a>.

<h2><a name= "3.16">3.16 - Pourquoi "w" et "who" ne montrent pas les
    utilisateurs loggués via ssh sur AIX 5.x ?</a></h2>

Entre AIX 4.3.3 et AIX 5.x, le format de la struct wtmp a changé. Cela
signifie que les binaires sshd compilés sur AIX 4.x n'écriront pas
correctement les entrées wtmp lors de leurs lancements sur AIX 5.x. Ceci
peut être corrigé en recompilant simplement sshd sur les systèmes AIX
5.x et en les utilisant.

<hr>
<a href="index.html"><img height=24 width=24 src="../back.gif" border=0 alt=OpenSSH></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: faq.html,v 1.99 ]<br>
$Translation: faq.html,v 1.28 2005/04/21 05:30:14 aanriot Exp $<br>
-->
$OpenBSD: faq.html,v 1.22 2005/04/23 07:03:38 jufi Exp $
</small>

</body>
</html>

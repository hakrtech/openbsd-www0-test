<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>OpenBSD AnonCVS</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta name="resource-type" content="document">
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="description" content="How to get OpenBSD updates via Internet using Anonymous CVS">
<meta name="keywords" content="openbsd,anoncvs,updates">
<meta name="distribution" content="global">
<meta name="copyright" content="This document copyright 1996-2004 by OpenBSD.">
</head>

<body bgcolor="#ffffff" text="#000000" link="#23238e">

<a href="index.html"><img alt="[OpenBSD]" height="30" width="141" src="../images/smalltitle.gif" border="0"></a>
<p>
<h2><font color="#e00000">匿名CVS</font></h2>

<hr>

<h3>内容索引</h3>

<ul>
  <li><a href="#anoncvs">什么是匿名CVS?</a> 
  <li><a href="#CVS">什么是CVS?</a> 
  <li><a href="#starting">开始使用匿名CVS</a> 
  <li><a href="#using">使用CVS来获取和更新源码树</a> 
  <li><a href="#CVSROOT">可用的CVS服务器</a> 
  <li><a href="#CRYPTO">通过cvs获取crypto源码(1)</a>
<li><a href="#EXAMPLE">cvs(1)使用范例</a>
  <li><a href="#WHICH">使用rsh(1)还是 ssh(1)?</a> 
  <li><a href="#SUP">使用sup(1)镜像CVS库</a> 
  <li><a href="#MIRROR">设置一个anoncvs镜像</a> 
</ul>

<hr>

<h3><a name="anoncvs"><font color="#0000e0">什么是匿名 CVS?</font></a></h3>

<p> 匿名CVS是不管当前OpenBSD源码如何变化，而保持你的本地副本为最新状态的一种方法。除了可以保证开发进度的同步，还可以跟踪发行版本勘误表的patch。</p>

<p> 匿名CVS与其它源码更新技术相比，最大的优势是直接与中心源码库或者镜像连接工作。这意味着你拥有整套的CVS命令来控制其它人做的源码修改与你的修改的合并与更新，以及执行差别比较,修改历史纪录和其它针对中心的查询。</p> 

<p> OpenBSD项目当前有5个主要的源码库: </p>

<ul>
  <li><b>src</b> - 存放OpenBSD操作系统的所有源码。</li>
  <li><b>ports</b> - 存放 <a href="../ports.html">OpenBSDPorts</a>.</li>
  <li><b>www</b> - 存放所有的OpenBSDweb页(包括现在这个)。</li>
  <li><b>X11</b> - 存放 OpenBSD对 <a href="http://www.XFree86.org/">XFree86-3</a> 
    软件计划作修改后的版本。 </li>
  <li><b>XF4</b> - 存放 OpenBSD对<a href="http://www.XFree86.org/"> XFree86-4</a> 
    软件计划作修改后的版本。 </li>
</ul>

<p> 总而言之，匿名CVS真正的强大之处在于它是一个"宽容的" 源码控制系统 - 它<strong>尊重</strong>你对本地源码的修改并且让你以<strong>"最好的效果"</strong>来更新整个源码树，而不是往下进行之前必须解决一堆不可思议的问题。</p>

<h3><a name="CVS"><font color="#0000e0">什么是CVS?</font></a></h3>

<p> <a href="why-cvs.html"> CVS是用于管理 OpenBSD 源码树的源码控制系统。</a> 它对所有正式发行的源码和修改实现一个中心的库，却允许开发者维护他们本地的源码拷贝和修改。具有"<b>write 
  access</b>"的开发者能直接将修改提交到OpenBSD源码树，而 "Anonymous CVS"用户具有"<b>read access</b>"可以让他们本地的源码拷贝保持最新，并向中心库发送查询请求。</p>

<p> CVS 主要的强大之处是能对中心库的修改与本地拷贝的修改执行智能化合并。 就是说,如果你对某个模块作了修改并执行了更新操作，你的修改不会"blown 
  away",被风吹走，而且CVS可以对两地的修改作最佳的合并。</p>

<p> 如果出现修改没有完全合并完成，CVS提供了"soft fallback",它为你的本地拷贝提供带注解的修改，为你的版本保留一个未修改拷贝并继续更新你所请求的其它源码模块。 
</p>

<h3><a name="starting"><font color="#0000e0">开始使用匿名CVS</font></a></h3>

<p> 最新的CVS版本可以<a href="http://www.cvshome.org/">Cyclic</a>获取。低于1.6的版本是不推荐使用，而且可能不能工作。如果你有一个安装好的OpenBSD,那么CVS 
  已经被包含在里面了。</p>

<p> 拥有OpenBSD CD的用户也许能看到上面有<i>CVS/</i> 目录。事实上原因是，该CD有一个OpenBSD <b>src</b>模块的checkout可用于更新。使用这个树来初始化CVS更新将比全新更新整个OpenBSD源码树快很多。有两种途径使用这个CD：</p>

<ul>
  <li>将CVS树从CD拷贝至<i>/usr/src</i>(假设CD被mount在/mnt): 
    <pre>
	# <b>cd /mnt; pax -rw CVS Makefile [a-z]* /usr/src</b>
</pre>
  <li>与CD使用一个union mount(见 <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mount_union&amp;apropos=0&amp;sektion=8&amp;manpath=OpenBSD+Current&amp;format=html">mount_union(8)</a>) 
    ，mount 到一个可写的目录。(只是在需要从该树编译的情况下使用。) 
    <pre>
	# <b>mount -t union -o -b /mnt /usr/src</b>
</pre>
</ul>

<p> 对于没有CD的用户，你可以使用 <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1&amp;format=html"> 
  cvs(1)</a> 来 "<b>checkout</b>" 源码库。这将在 <a href="#using">下节</a>讨论。</p>
<p> 这之后，<i>/usr/src</i> 将成为checkout目录，在这里所有的<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1&amp;format=html"> 
  cvs(1)</a> 命令都能正常工作了<font color="#0000e0">。</font></p>

<h3><a name="using"><font color="#0000e0">使用CVS来获取和更新源码树</font></a></h3>

<p> CVS 被设计为一种简易的方法来检索和更新你的源码，因此你要做的相关事情不多。首先，你必须确定你要跟踪同步的是<i>current</i>还是patch 
  分支。 current树反映所有最新的修改，而patch branch包含正式的发行版本以及<a href="../errata.html">errata</a>发布的可用patch。如果想了解关于<i>current</i>,请参考 
  <a href="../faq/upgrade-minifaq.html#1.1">Upgrade Mini-FAQ</a>。 
<p>一旦你确定了你要跟踪同步的树，你必须选择要使用的匿名 CVS 服务器。<a href="#CVSROOT">下面</a>是一个可用的服务器列表。有三种方式可以访问这些服务器。</p>

<dl>
  <dt><b>ssh</b> 
  <dd>Secure Shell可用来访问匿名CVS服务器。这是我们<em>推荐</em>使用的方式，因为它是加密的。从2.6起，OpenBSD已经把OpenSSH包含在它的标准的发行版本内了。 
  <dt><b>rsh</b>
  <dd>Remote Shell对那些无法使用<a href="http://www.openssh.com/">ssh</a>的用户，可用于访问其中一些服务器 
    。 
  <dt><b>pserver</b>
  <dd>pserver对那些处于防火墙后面，被阻塞了其它两种连接方式的用户来说，很有用。 
</dl>

<p> <b>说明:</b> 对想使用rsh的用户，你必须首先设置<var>CVS_RSH</var> 变量为rsh。 
<ul>
  <li>对于Korn/Bourne shells: 
    <pre>
	$ <b>export CVS_RSH=/usr/bin/rsh</b>
</pre>
  <li>对于csh/tcsh: 
    <pre>
	% <b>setenv CVS_RSH /usr/bin/rsh</b>
</pre>
</ul>

<p> 一旦你选择好了你将使用的<a href="#CVSROOT">匿名CVS Server</a> 以及使用的方法，你就可以开始使用cvs了。如果你有我们的OpenBSD光盘，你可以使用光盘上面的CVS 
  checkout ，按照<a href="#starting">上面</a>的指导来获取源码到你的系统。如果你手上没有光盘，那么使用下面的方法来checkout源码。这些方法把 
  OpenBSD 源码树放置在<i>/usr/src</i> 下面。</p>
<pre>
	# <b>cd /usr; cvs checkout -P src</b>
</pre>

<p> 上面的命令将checkout <i>current</i>源码树。很多人将只想要patch分支的源码。如果要checkout patch分支，你必须在你的命令里添加标签。比如: 
</p>

<pre>
	# <b>cd /usr; cvs checkout -P -rOPENBSD_3_5 src</b>
</pre>
<p> 对于3.4相应标签为OPENBSD_3_4 以此类推。 
<p> OPENBSD_3_5标签包含了正式发行版源码和已经发表可用的errata<font color="#0000e0">。</font> 
<h3><a name="CVSROOT"><font color="#0000e0">可用的匿名CVS服务器 </font></a></h3>

<p> 有两种源码树访问级别：
<dl>
  <dt><strong>Read-write 开发人员权限:</strong> 
  <dd>需要提交源码修改的开发人员必须在服务器上拥有用户帐户，有了帐户就可以与其它的开发者一起协同工作。 如果你做了一些漂亮的工作，并显示出你有与开发团队协作的能力，那么你也可以加入而获得一个帐户。
</dl>

<dl>
  <dt><strong>Read-only 任意用户权限:</strong> 
  <dd>任何人对CVS库都具有read-only的访问权限。这些CVS库的read-write拷贝经常被镜像使用，要想使用其中一个，把你的<var>CVSROOT</var>环境变量设置为如下的值的其中一个： 
    <p> <em>请参看下面关于<a href="#WHICH">ssh vs. rsh</a> 的说明!</em> 
    <p> 
    <ul>
      <li><strong>CVSROOT=anoncvs@anoncvs1.usa.openbsd.org:/cvs</strong><br>
        Host also known as <strong>anoncvs@anoncvs.usa.openbsd.org</strong>, <strong>anoncvs@anoncvs4.usa.openbsd.org</strong>.<br>
        Located in Redwood City, California, western USA.<br>
        Maintained by <a href="mailto:millert@openbsd.org">Todd Miller</a>.<br>
        Protocols: rsh, ssh, ssh port 2022, pserver.<br>
        Updated every 2 hours.<br>
        SSH fingerprints:<br>
        (RSA1) 1024 64:de:26:16:c2:ff:1b:c7:24:ed:a4:4a:d7:2f:69:3e<br>
        (RSA) 1024 49:67:9a:46:62:8a:3f:4e:b3:63:ca:d6:41:29:2a:2f<br>
        (DSA) 1024 a7:75:49:77:f3:47:d1:3c:5e:65:84:84:3b:03:f1:33<br>
        <p> 
      <li><strong>CVSROOT=anoncvs@anoncvs2.usa.openbsd.org:/cvs</strong><br>
        Host also known as <strong>库.citi.umich.edu</strong>.<br>
        Located at the University of Michigan, central USA.<br>
        Maintained by <a href="mailto:rees@umich.edu">Jim Rees</a>.<br>
        Protocols: ssh, ssh port 2022.<br>
        Updated every 12 hours.<br>
        <p> 
      <li><strong>CVSROOT=anoncvs@anoncvs3.usa.openbsd.org:/cvs</strong><br>
        Located at the University of Colorado, Boulder, western USA.<br>
        Maintained by <a href="mailto:millert@openbsd.org">Todd Miller</a>.<br>
        Protocols: rsh, ssh, ssh port 2022, pserver.<br>
        Updated every 2 hours.<br>
        SSH fingerprints:<br>
        (RSA1) 1024 21:d3:93:29:bc:3f:68:37:6c:84:9f:12:0c:8a:35:2f<br>
        (RSA) 1024 f4:85:d1:b4:c3:df:62:b9:cf:78:64:73:67:05:e3:ca<br>
        (DSA) 1024 8d:c7:c3:07:3b:60:fa:80:85:c1:b4:1c:0a:33:c4:33<br>
        <p> 
      <li><strong>CVSROOT=anoncvs@anoncvs1.ca.openbsd.org:/cvs</strong><br>
        Host also known as <strong>anoncvs.ca.openbsd.org</strong>, <strong>openbsd.sunsite.ualberta.ca</strong><br>
        Located in Edmonton, Alberta, Canada.<br>
        Maintained by <a href="mailto:beck@ualberta.ca">Bob Beck</a>.<br>
        Protocols: ssh, rsh, ssh port 2022, pserver<br>
        Updated every 2 hours.<br>
        <p> 
      <li><strong>CVSROOT=anoncvs@anoncvs.no.openbsd.org:/cvs</strong><br>
        Host also known as <strong>cvs.inet.no</strong>.<br>
        Located in Norway.<br>
        Maintained by <a href="mailto:cvsadmin@inet.no">Michael Shuldman</a>.<br>
        Protocols: rsh, ssh, ssh port 2022.<br>
        Updated every 4 hours.<br>
        <p> 
      <li><strong>CVSROOT=anoncvs@anoncvs.at.openbsd.org:/cvs</strong><br>
        Host also known as <strong>togetic.kd85.com</strong>.<br>
        Located in Austria.<br>
        Maintained by <a href="mailto:wim@kd85.com">Wim Vandeputte</a>.<br>
        Protocols: ssh, ssh port 2022.<br>
        Updated every 3 hours.<br>
        <p> 
      <li><strong>CVSROOT=anoncvs@anoncvs.nl.openbsd.org:/cvs</strong><br>
        Host also known as <strong>anoncvs.calyx.nl</strong>.<br>
        Located in Amsterdam, The Netherlands.<br>
        Maintained by <a href="mailto:nick@calyx.net">Nick Merrill</a> and <a href="mailto:alex@calyx.nl">Alexander 
        Grendel</a>.<br>
        Protocols: ssh.<br>
        Updated every 3 hours.<br>
        <p> 
      <li><strong>CVSROOT=anoncvs@anoncvs.jp.openbsd.org:/cvs</strong><br>
        Host also known as <strong>kankoromochi.econ.nagasaki-u.ac.jp</strong>.<br>
        Located at Nagasaki Univ. Faculty of Economics, Japan.<br>
        Maintained by <a href="mailto:sigh@net.nagasaki-u.ac.jp">SUZUKI Hitoshi</a>.<br>
        Protocols: ssh, pserver.<br>
        Updated every 3 hours.<br>
        <p> 
      <li><strong>CVSROOT=anoncvs@anoncvs.de.openbsd.org:/cvs</strong><br>
        Host also known as <strong>grappa.unix-ag.uni-kl.de</strong>.<br>
        Located at the University of Kaiserslautern, Germany.<br>
        Maintained by <a href="mailto:naddy@openbsd.org">Christian Weisgerber</a>.<br>
        Protocols: ssh, ssh port 2022, pserver<br>
        Updated every 6 hours.<br>
        SSH fingerprints:<br>
        (RSA) 1024 cf:a9:ee:a4:60:5d:66:00:50:5b:fd:d3:72:04:14:a3<br>
        (DSA) 1024 78:d4:19:da:df:6f:c0:14:7f:4a:55:2a:e9:82:5f:e4<br>
        <p> 
      <li><strong>CVSROOT=anoncvs@anoncvs.pl.openbsd.org:/cvs</strong><br>
        Host also known as <strong>anoncvs1.pl.openbsd.org</strong>, <strong>incredible.bmtmc.gda.pl</strong>.<br>
        Located at BMT Maritime Consultants, Gdansk, Poland.<br>
        Maintained by <a href="mailto:detergent@incredible.bmtmc.gda.pl"> Adam 
        Naguszewski</a>.<br>
        Protocols: ssh, pserver<br>
        Updated every 3 hours.<br>
        <p> 
      <li><strong>CVSROOT=anoncvs@rt.fm:/cvs</strong><br>
        Located in Lake in the Hills, Illinois, USA.<br>
        Maintained by <a href="mailto:jcs@rt.fm"> Joshua Stein</a>.<br>
        Protocols: ssh<br>
        Updated every 3 hours.<br>
        SSH fingerprints:<br>
        (RSA) 1024 54:74:ca:17:d0:07:c3:53:b7:7e:1d:9b:10:bf:04:37<br>
        (DSA) 1024 46:78:40:52:7a:18:f9:0e:68:61:b0:27:29:f9:d9:c4<br>
        <p> 
      <li><strong>CVSROOT=anoncvs@cvs.openbsd.cz:/cvs</strong><br>
        Located in Prague, Czech Republic.<br>
        Maintained by <a href="mailto:vlada@openbsd.cz">Vladimir Kotal</a>.<br>
        Protocols: ssh, pserver.<br>
        Updated every 4 hours.<br>
        <p> 
      <li><strong>CVSROOT=anoncvs@anoncvs.openbsd.org.ua:/cvs</strong><br>
        Located in Kiev, Ukraine.<br>
        Maintained by <a href="mailto:hunter@dg.net.ua">Sergey Smitienko</a>.<br>
        Protocols: ssh<br>
        Updated every 6 hours.<br>
        <p> 
      <li><strong>CVSROOT=openbsd@openbsd.bug.it:/cvs</strong><br>
        Located in Modena, Italy.<br>
        Maintained by <a href="mailto:jwk@bug.it">Giacomo Cariello</a>.<br>
        Protocols: ssh, password "openbsd"<br>
        Updated every 6 hours.<br>
        <p> 
      <li><strong>CVSROOT=anoncvs@anoncvs.openbsd.lt:/cvs</strong><br>
        Located at TVK, Cable TV and Internet Services, Lithuania.<br>
        Maintained by <a href="mailto:helpas@ebox.lt">Donatas Budvytis</a>.<br>
        Protocols: ssh<br>
        Updated every 3 hours from cvsup.no.openbsd.org.<br>
        <p> 
      <li><strong>CVSROOT=anoncvs@anoncvs2.de.openbsd.org:/cvs</strong><br>
        Host also known as <strong>openbsd.informatik.uni-erlangen.de</strong>.<br>
        Located at the University of Erlangen-Nuremberg, Germany.<br>
        Maintained by <a href="mailto:Alexander.Gernler@informatik.stud.uni-erlangen.de">Alexander 
        von Gernler</a>.<br>
        Protocols: ssh, ssh port 2022, pserver<br>
        Updated every 2 hours.<br>
        SSH fingerprints:<br>
        (RSA) 1024 fc:94:b0:c1:e5:b0:98:7c:58:43:99:76:97:ee:9f:b7<br>
        (DSA) 1024 a9:00:3f:ba:50:81:16:d1:e9:b8:4f:3c:b2:10:e2:6c<br>
        <p> 
      <li><strong>CVSROOT=anoncvs@mirror.osn.de:/cvs</strong><br>
        Located in N&uuml;rnberg, Germany.<br>
        Maintained by <a href="mailto:aw@osn.de">Armin Wolfermann</a>.<br>
        Protocols: ssh<br>
        Updated every 4 hours.<br>
        SSH fingerprints:<br>
        (RSA) 1024 f2:73:d2:f6:e3:01:ef:ca:3b:e7:6c:80:b6:bd:bb:84<br>
        (DSA) 1024 fb:33:05:62:96:20:cf:88:7e:10:cb:8d:91:72:57:32<br>
        <p> 
      <li><strong>CVSROOT=anoncvs@openbsd.chem.uw.edu.pl:/cvs</strong><br>
        Located in Warsaw, Poland.<br>
        Maintained by <a href="mailto:admin@chem.uw.edu.pl">Piotr Klein</a>.<br>
        Protocols: ssh<br>
        Updated every 3 hours.<br>
        <p> 
      <li><strong>CVSROOT=anoncvs@anoncvs.student.pw.edu.pl:/cvs</strong><br>
        Located at the Warsaw University of Technology, Poland.<br>
        Maintained by <a href="mailto:dmarcink@elka.pw.edu.pl">Darek Marcinkeiwicz</a>.<br>
        Protocols: ssh<br>
        Updated every 3 hours.<br>
    </ul>
    <p> <em>说明：</em>如果列在这里的你的服务器的信息不准确或者不清楚，请联系<a href="mailto:beck@openbsd.org"><tt>beck@openbsd.org</tt></a> 
    </p>
    <p> 你可能想用<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=traceroute&amp;sektion=8&amp;format=html">traceroute(8)</a> 
      来找出距离你最近的服务器。若发现服务器的问题请报告给我们的 <b>维护人员</b>。 </dl>

<h3><a name="CRYPTO"><font color="#0000e0">通过 cvs(1) 获取 crypto 源码</font></a></h3>

<p> <strong>重要说明:</strong> 有一些与密码学软件相关的问题每个人都应该注意的：
<ul>
  <li>OpenBSD 源码出自加拿大。 参看调查研究<a href="http://www.efc.ca/pages/doc/crypto-export.html"> 
    researched by a Canadian individual</a> ，以及根据<a href="http://axion.physics.ubc.ca/ECL.html"> 
    described in the Export Control list of Canada</a> ，从加拿大往世界各地输出密码学软件是合法的。 
    <p>
  <li>然后，如果你不在美国或者加拿大，你不应该从防止在美国的匿名CVS服务器上获取OpenBSD源码的密码学部分。 可能的文件有... 
    <ul>
<li>src/kerberosIV/*
<li>src/kerberosV/*
<li>src/lib/libdes/*
<li>src/lib/libc/crypt/crypt.c
<li>src/lib/libc/crypt/morecrypt.c
<li>src/sys/crypto
<li>src/sys/netinet
<li>src/usr.sbin/afs/src/rxkad/*
<li>XF4/xc-mit/lib/Xdmcp/Wraphelp.c
<li>XF4/xc-old/lib/Xdmcp/Wraphelp.c
<li>XF4/xc/lib/Xdmcp/Wraphelp.c
</ul>
由于 USA ITAR munitions list，加密软件只能从美国输出到加拿大。 
    <p>
  <li> OpenBSD计划正在寻找更多的匿名CVS服务器 -- 请查看您如何能协助我们。 
</ul>

<h3><a name="EXAMPLE"><font color="#0000e0">cvs(1)服务器使用范例</font> </a></h3>

<p> 说明: 如果你想更新一个分支(比如一个patch branch) 到<i>current</i>，你要添加 <code>-A</code> 标记到cvs，但是该标记在其它方面用处不大。一些老的 
  OpenBSD文档在很多范例中推荐使用这个标记。我们不再推荐使用这个标记，除非确实有必要。 
<p> 一个使用匿 CVS服务器的范例将象下面这样： 
<pre>
% <strong>setenv CVSROOT anoncvs@anoncvs.ca.openbsd.org:/cvs</strong>
% <strong>cd /tmp</strong>
% <strong>cvs get src/sys/arch/sparc</strong>
    [copies the files from the 库 to your machine]
% <strong>cvs log src/sys/arch/sparc/sparc/locore.s</strong>
    [shows the commit log for the chosen file]
% <strong>cvs diff -bc -r1.1 -r1.5 src/sys/arch/sparc/sparc/locore.s</strong>
    [shows the changes between revisions 1.1 and rev 1.5]
</pre>

<p> <a name="pserver">为了使用 ``pserver'' (一种直接的TCP连接，不使用ssh或者rsh)你必须登录一次:</a> 
<pre>
% <strong>setenv CVSROOT :pserver:anoncvs@anoncvs.ca.openbsd.org:/cvs</strong>
% <strong>cvs login</strong>
(Logging in to anoncvs@anoncvs1.ca.openbsd.org)
CVS password: <strong>anoncvs</strong>
    [This writes a line to ~/.cvspass (filename over-ridden by CVS_PASSFILE).]
    [An example line from my ~/.cvspass after typing 'blah' for the above    ]
    [password is:                                                            ]
    [:pserver:anoncvs@anoncvs5.usa.openbsd.org:/cvs Au'yc                    ]
    [After logging in ONCE every other use of the above CVSROOT will work.   ]
% <strong>cvs get ksrc-i386 ksrc-common</strong>
    [Allows you to retrieve ONLY that necessary to rebuild an i386 kernel.   ]
</pre>

<p> 这里是一个常规更新源码树的一个例子：
<ul>
  <li>首先`get'一个初始的源码树： 
    <p> (如果你要跟踪同步<i>current</i>): 
    <pre>
	# <strong>setenv CVSROOT anoncvs@anoncvs.ca.openbsd.org:/cvs</strong>
	# <strong>cd /usr</strong>
	# <strong>cvs -q get -P src</strong>
</pre>
    <p> (如果你要跟踪同步 3.5 patch branch): 
    <pre>
	# <strong>setenv CVSROOT anoncvs@anoncvs.ca.openbsd.org:/cvs</strong>
	# <strong>cd /usr</strong>
	# <strong>cvs -q get -rOPENBSD_3_5 -P src</strong>
</pre>
  </li>
  <li> 以后，你就可以 `update' 这个树了: 
    <p> (如果你要跟踪同步<i></i><i>current</i>): 
    <pre>
	# <strong>cd /usr/src</strong>
	# <strong>cvs -q up -Pd</strong>
</pre>
    <p> (如果你要跟踪同步 3.5 patch branch): 
    <pre>
	# <strong>cd /usr/src</strong>
	# <strong>cvs -q up -rOPENBSD_3_5 -Pd</strong>
</pre>
    每次你运行这个命令就将同步你的/usr/src树。它不会破坏你的任何本地的修改，而是试图去合并修改。如果你使用obj目录(不是 obj 符号链接) 
    你也许希望附加 "-I obj" 到 cvs 命令行。这将防止出现一个警告，大致是all the obj directories it is going 
    to encounter which are not in the 库. 
    <p> 
  <li> 说明: 如果你更新的源码树最初是取自别的服务器或者从光盘获取的，你<strong>必须</strong>添加<em>-d $CVSROOT</em> 
    选项到cvs。 
    <pre>
	# <strong>cd /usr/src</strong>
	# <strong>cvs -d $CVSROOT -q up -Pd</strong>
</pre>
  </li>
</ul>

<p> <a name="ports">使用</a><a href="../ports.html">ports</a>,与使用src类似: 
<ul>
  <li> 
    <p> (如果你要跟踪同步<i>current</i>): 
    <pre>
	# <strong>setenv CVSROOT anoncvs@anoncvs.ca.openbsd.org:/cvs</strong>
	# <strong>cd /usr</strong>
	# <strong>cvs -q get -P ports</strong>
</pre>
    <p> (如果你要跟踪同步3.5的patch branch): 
    <pre>
	# <strong>setenv CVSROOT anoncvs@anoncvs.ca.openbsd.org:/cvs</strong>
	# <strong>cd /usr</strong>
	# <strong>cvs -q get -rOPENBSD_3_5 -P ports</strong>
</pre>
  <li> 然后，可以`update'这个树: 
    <p> (如果你要跟踪同步<i>current</i>): 
    <pre>
	# <strong>cd /usr</strong>
	# <strong>cvs -q up -Pd ports</strong>
</pre>
    <p> (如果你要跟踪同步3.5的 patch): 
    <pre>
	# <strong>cd /usr</strong>
	# <strong>cvs -q up -rOPENBSD_3_5 ports</strong>
</pre>
  </li>
</ul>
在上面的例子中<i>，-q</i> 是可选的。只在想最少化cvs的输出时使用。如果希望看到完整的屏幕输出，那就可以不用。 
<p> 想要与本地patched module作差异比较 (这里比如<i>cd.c</i>)，并写入到一个bug report: 
<pre>
	# <strong>cd /usr</strong>
	# <strong>cvs diff -u src/sys/scsi/cd.c &gt; /tmp/patch</strong>
</pre>

<p> <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1&amp;format=html"> 
  cvs(1) man page</a> (包括在 CVS 源码中) 有许多关于如何使用 CVS 的信息。
<h4>X11 源码树</h4>

<p> 匿名CV服务器镜像也包括了OpenBSD X11 (XFree86)源码树。你可以对上面的指导略作修改，去更新你的取自第三方CD的XFree86源码树。 
  你可以拷贝或者下载XFree86 3 源码树，与X11 cvs模块一起。尽管current模块包含的XFree86 4就是XF4，还是有两种方法去获取 
  XF4 源码到<i>/usr/XF4</i>: 
<ul>
  <li>从光盘拷贝树(假设第三方光盘mount在/mnt): 
    <pre>
        # <strong>cd /mnt; cp -Rp XF4 /usr</strong>
</pre>
  <li>用光盘，使用一个union mount，到一个可写的目录下。 
    <pre>
        # <strong>mount -t union -o -b /mnt/XF4 /usr/XF4</strong>
</pre>
</ul>
然后，<i>/usr/XF4</i> 将可以被cvs使用了。比如，你可以更新到-current源码树(假设你已经设置好了环境变量<var>CVSROOT</var>): 
<pre>
        # <strong>cd /usr/XF4</strong>
        # <strong>cvs -q update -Pd</strong>
</pre>

<p> <strong>警告:</strong> 当使用cvs的时候，你应该当心，当前的目录要么是树的根目录，或者因该位于一个单独的位置，比如/tmp。一些命令，如"get"会在当前目录下创建一个任意的sub-tree，以后的更新将会递归的flesh 
  out这个子树。 
<p> 匿名CVS服务会给初学使用的开发者一个学习的机会来学习CVS的运作，在作"commit"提交前彻底熟悉这个系统 -- 在对开发者显示了它的一些有用的技巧和高品质之后，它自然而然的把访问的权利交给了开发者。最好还是，提供补丁的人们能创建与CVS树相关的"diff"s，这样能够简化整合。 
<h3><a name="WHICH"><font color="#0000e0">使用 rsh(1) 还是 ssh(1)?</font></a></h3>

<p> 缺省情况下，client使用ssh ("secure shell": <a href="http://www.openssh.com/">OpenSSH</a>)与CVS 
  server交谈。 
<p> 很多的CVS站点出于安全的原因不再支持rsh。本地的问题，像防火墙或者有缺陷的协议仿真器如slirp也可能阻碍rsh的使用。然而，如果希望使用rsh,必须设置<var>CVS_RSH</var>这个环境变量指向rsh 
  (通常<strong>/usr/bin/rsh</strong>)。
<p> 如果本地策略阻止外出的连接使用ssh的默认端口22，那么也可以使用2022。 要注意的是，不是所有的匿名CVS服务器都接受2022口的ssh接入。此外，大多匿名CVS服务器不再接受<strong>none</strong> 
  cipher, 因为出于安全的原因最近的版本禁止了这种无密文的连接。还有，别开启压缩功能： CVS已经启动了压缩。 
<p> 你可以在<strong>$HOME/.ssh/config</strong>配置文件里作下指定以避免上面提到的缺陷和限制： 
<pre>
	Host anoncvs.ca.openbsd.org
	    Compression no
	    Port 2022
</pre>

<p>
CVS is a little noisy starting up; to quiet it a bit you may want to
do this:

<pre>
	<strong>% setenv CVS_CLIENT_PORT -1</strong>
</pre>

<p>
<h3><a name="SUP"><font color="#0000e0">使用sup(1)镜像CVS 库</font></a></h3>

<p> 想镜像OpenBSD CVS树本身的用户，现在可以镜像<em>anoncvs.usa.openbsd.org</em>或者<em>anoncvs3.usa.openbsd.org</em>(两个不同的服务器)。注意这是cvs 
  树，<b>不是</b>checked out 的源码树。这种镜像只是在你想更快的执行cvs操作 (diff, annotate, 等等) 或者你有多个源码树，你只想传送一次数据的情况下才有用。(你可以从本地的cvs镜像checkout一个树)。 
<p> 一个示范的supfile可能是这样的：
<p> cvs host=anoncvs.usa.openbsd.org hostbase=/ base=/home delete 
<p> 这将镜像cvs树到/home/cvs ，sup数据文件结束于/home/sup。整个OpenBSD cvs树当前大概2.2GB大小。
<h3><a name="MIRROR"><font color="#0000e0">设置一个匿名CVS镜像</font></a></h3>

<p> 如果你想设置一个新的匿名CVS镜像站点，并让公众访问，请联系<a href="mailto:sup@openbsd.org">维护者</a>。匿名CVS镜像需要大概2.2GB磁盘空间。每个匿名CVS服务器用户好用32MB交换分区(假设用户执行大型的操作；而小型的操作使用更少的资源，匿名CVS仍然比ftp或者sup对系统的影响要小)。这样的匿名CVS服务器在所服务的区域应该拥有出色的网络连接性能。可以从这里得到一份<a href="../anoncvs.shar">文件</a>,该文件描述了如何设立匿名的CVS服务器.
<h3><font color="#0000e0">最后说明</font></h3>
在升级你的源码树后,你应该在build前阅读<kbd>/usr/src/Makefile</kbd>的开头部分。同样，如果可能的话你应该在<strong><kbd>make 
build</kbd>之前</strong>build一个新的内核。某些情况下在你能build内核前，rebuild和安装<kbd>config</kbd>工具。如果<kbd>config 
GENERIC</kbd> 失败，你就需要这样。 
<p> 很重要的一点是，通过rebuild源码树以从一个release版本升级到current树会相当困难，因为依赖关系总是不明显，因此，建议你尝试从源码build前安装最新的snapshot。
<hr>
<a href="index.html"><img height="24" width="24" src="../back.gif" border="0" 
alt="OpenBSD"></a> 
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
Originally [OpenBSD: anoncvs.html,v 1.217 2004/07/12 11:31:01 naddy Exp ]<br>
$Translation: anoncvs.html,v 1.2 2004/07/27 10:14:00 ci Exp $<br>
$OpenBSD: anoncvs.html,v 1.1 2004/07/27 10:45:13 jufi Exp $
</small>
</body>
</html>

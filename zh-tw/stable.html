<!-- saved from url=(0022)http://internet.e-mail -->
<!DOCTYPE HTML PUBLIC  "-//IETF//DTD HTML Strict//EN">
<html>
<head>
<title>OpenBSD Patch Branches</title>
<link rev=made href=mailto:www@openbsd.org>
<meta name="resource-type" content="document">
<meta name="description" content="stable">
<meta name="keywords" content="openbsd,anoncvs,updates,stable">
<meta name="distribution" content="global">
<meta name="copyright" content="This document copyright 1996-1998 by OpenBSD.">
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#23238E">

<a href="index.html"><img alt="[OpenBSD]" height="30" width="141" src="../images/smalltitle.gif" border="0"></a>
<p>
<h2><font color=#e00000>更新分支 (Patch Branches)</font><hr></h2>

<p>
<ul><h3>Table Of Contents</h3>
<li><a href="#whatis">什麼是更新分支?</a>
<li><a href="#getting">取得更新分支</a>
<li><a href="#building">使用更新分支編譯</a>
</ul>
</p>
<hr>

<a name="whatis"></a>
<h3><font color=#0000e0>什麼是更新分支?</font></h3>

<p>
從 2.7 版開始, OpenBSD 提供一份包含了重要更新檔及修正檔的原始程式碼目錄 
(也就是指列在
<a href="errata.html">勘誤表(Errata)</a>內, 加上其他明顯而且單純,
但不值得做為一筆勘誤的資料)
並且使之除了在目前的原始程式碼之外, 還可經由 <a href="anoncvs.html">CVS</a> 取得.
簡而言之, 使用者有三種使用方式可以選擇 :<p>
<ul>
<li>緊隨著我們最新的正式釋出版並手動採用更新檔.
<li>使用包含最重要更新檔的 <b>更新分支</b>.
<li>使用包含最新功能的 <b>current 原始程式碼</b>.
</ul>
<p>
<a href="plus.html">每日變動記錄(Daily Changelog)</a> 詳細描述了有哪些後期發表(post-release)的
更新檔被整合進了更新分支.  一般來說, 所有的 
<a href="errata.html">勘誤(Errata)</a> 項目將會在勘誤表發表後的 48 小時內合併進更新檔
分支.  其他之後的正式釋出版更新檔也會以同樣的方式合併, 
合併的方式依下列幾點情況而有所不同:
<ul>
<li>更新檔必須是簡明的,簡短的以及百分之百明顯地正確.
<li>勘誤表是以會影響多數的的臭蟲 (bugs) 而建立的.  其他的
    更新檔如果是經由不同的情形影響少部份人, 則可能是先合併到更新分支.
<li>請別要求大量的次要系統或是更新檔很快地被合併.
    維護整個更新目錄需要一些努力以使得我們的下一個正式釋出版能夠推出的更順利.
<li>除了上述的規則之外, OpenSSH 正式釋出版版本
    將會整合到更新分支.
</ul>
<p>

<a name="getting"></a>
<h3><font color=#0000e0>Getting a stable 分支</font></h3>

<p>
要取得一份特定的 OpenBSD 正式釋出版的更新分支, 你
可以從最初的原始程式碼目錄上層更新
(從 <a href="ftp.html">FTP</a> 或是 <a href="orders.html">CD</a>)
或是你可以從一個 <a href="anoncvs.html">AnonCVS</a> 伺服器取得最新的原始程式碼目錄.
取得更新分支的方法及保持在最近的更新版本的方法在
<a href="anoncvs.html#starting">AnonCVS 文件</a> 裡的
<b>開始(Getting Started)</b> 章節裡有更詳細的資料.
需要注意的是, 更新分支並不能幫助你從 OpenBSD 的某一版正式釋出版更新到
另一個版本, 例如, 從 2.7 升級到 2.8.  它們只代表了
能在下一個正式釋出版發表前, 透過更新檔保持在最新的狀態.
如果你正試著要經由原始程式碼從一個正式釋出版昇級到另一個, 請參閱
<a href="faq/upgrade-minifaq.html">upgrade-minifaq</a>.
除此之外, 因為函式庫版本的問題, 你無法反向操作由 -stable 還原到 -current.

<a name="building"></a>
<h3><font color=#0000e0>從一個 OpenBSD 更新分支重建系統</font></h3>
一旦你經由 <a href="anoncvs.html">anoncvs</a> 取得了一份原始程式碼目錄,
你必須重建系統. 這麼做的步驟為:

<ul>
 <li>重新編譯核心(kernel)
 <li>使用新的核心(kernel)重開機
 <li>重建 binary 檔
</ul>

<h4><font color=#0000e0>重新編譯核心(kernel)</font></h4>

<p>
由 stable 重新編譯預設的核心:
<ul><pre>
# <strong>cd /usr/src/sys/arch/i386/conf</strong>
# <strong>/usr/sbin/config GENERIC</strong>
# <strong>cd /usr/src/sys/arch/i386/compile/GENERIC</strong>
# <strong>make clean &amp;&amp; make depend &amp;&amp; make</strong>
</pre></ul>

<p>
將 <i>i386</i> 依據您的系統架構取代掉, 如
<i>sparc</i>, <i>alpha</i>, 等等.

<h4><font color=#0000e0>使用新的核心(kernel)重開機</font></h4>

<p>
使用最新編譯好的核心重開機:
<ul><pre>
# <strong>cd /usr/src/sys/arch/i386/compile/GENERIC</strong>
# <strong>cp /bsd /bsd.old</strong>          <i>(存一份舊的核心檔)</i>
# <strong>cp bsd /bsd</strong>               <i>(將新編譯好的核心檔放到開機時會讀到的區域)</i>
# <strong>reboot</strong>
</pre></ul>

<p>
如同上面的做法, 依照您的系統架構將 <i>i386</i> 取代掉.  如果你的系統在使用
新的核心開機時有問題, 你可以很簡單地使用舊的核心 <i>bsd.old</i> 來開機重新
來過.

<h4><font color=#0000e0>重建 binary 檔</font></h4>

<p>重建系統 binary 檔:
<ul><pre>
# <strong>cd /usr/src</strong>
# <strong>rm -r /usr/obj/*</strong>
# <strong>make obj &amp;&amp; make build</strong>
</pre></ul>

<p>這將會花費一點時間...
<hr>
<a href=index.html><img height=24 width=24 src=../back.gif border=0 alt=OpenBSD></a>
<a href=mailto:www@openbsd.org>www@openbsd.org</a>
<br><small>
Originally [OpenBSD: stable.html,v 1.10 ]<br>
$Translation: stable.html,v 1.1 2003/06/18 17:03:14 sjhuang Exp $<br>
$OpenBSD: stable.html,v 1.1 2003/06/21 12:24:00 jufi Exp $
</small>
</body>
</html>


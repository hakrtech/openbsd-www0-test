<!DOCTYPE HTML PUBLIC  "-//IETF//DTD HTML Strict//EN">
<html>
<head>
<title>OpenBSD/hppa</title>
<link rev=made href=mailto:www@openbsd.org>
<meta name="resource-type" content="document">
<meta name="description" content="Die OpenBSD/hppa Seite">
<meta name="keywords" content="openbsd,hppa">
<meta name="distribution" content="global">
<meta name="copyright" content="This document copyright 1996-2002 by OpenBSD.">
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#23238E">

<h2>OpenBSD/hppa</h2>

<hr>

Dieser port zielt darauf ab, die folgenden HP 9000 Modelle zu unterst&uuml;tzen:
705, 710, <b>712</b>, <b>715</b>, 720, <b>725</b>,
730, <b>735</b>, 742, 750, <b>755</b>, A180, A180C, B132L, B132L+,
B160L, B180L, C100, C110, C132L, C160L, C180L, J200, J210, J210XC
(bold bedeutet "l&auml;uft, soweit bekannt").
Andere &auml;hnliche Konfigurationen k&ouml;nnten unterst&uuml;tzt werden, solange 
sie auf folgender Hardware basieren:
<ul>
<li>HP PA-RISC 7000, 7100, 7150, 7100LC, 7200, 7300LC Prozessoren;
<li>Viper (und andere ?) Memory Kontroller;
<li>LASI, ASP, WAX Bus/IO Kontroller;
<li>und EISA Bus Controller;
<li>NCR53C700, NCR53C710, NCR53C720 SCSI I/O Prozessor;
<li>Venom, CRX-8, CRX-24, HCRX-8, HCRX-24 Video Kontroller;
<li>HIL oder PS/2 Tastatur und Maus;
<li>EISA Ger&auml;te funktionieren, aber sie sind nicht n&uuml;tzlich, um zu booten.
	Einige, die von HP f&uuml;r 700/800 Systeme produziert wurden, allerdings schon.
</ul>
Systeme, die eventuell arbeiten : 
<ul>
<li>PA2.0 Systeme (im 32-bit Modus);
<li>HP 9000 834, 835, 836, 844, 845, 846;
<li>HP 9000 E23, E25, E35, E45, E55;
<li>HP 3000 908, 918, 928, 938;
<li>Hitachi VQ200, VQ210, und einige andere nicht-HP Workstations;
<li>Precision Book von RDI Computer Corporation (unwahrscheinlich)
<li>HP VME und VXI Single Board Systeme (ben&ouml;tigt mindestens VME)
</ul>
<br>
Hardware wird f&uuml;r dieses Projekt ben&ouml;tigt,
siehe <a href="want.html">"Wanted List"</a>. (kontaktiere <a href=mailto:mickey@openbsd.org>mickey</a>).

<h3><strong>Status:</strong></h3>
Das System bootet mit Hilfe von <a href=http://hppa.lucifier.net/#boot_lif>bootable images</a>
in den Single-User Modus.


<h3><strong>Geschichte:</strong></h3>
Dieses Projekt wurde in den Tagen gestartet, als die einzigen Open Source
Betriebssysteme f&uuml;r HP PA-RISC Computer 
<a href=http://www.cs.utah.edu/projects/flux/lites/html>Lites</a> und
<a href=http://www.osf.org/mall/os/pa-mklinux>MkLinux</a> waren.
Diese zwei Quellen boten eine Menge an Informationen und Code f&uuml;r einen
ersten Anfang des OpenBSD/hppa portes.
Das <a href=http://www.cs.utah.edu/~mike/hpbsd/hpbsd.html>HPBSD</a>
ist mit propiet&auml;rem HP Code und USL Lizensierung belastet und ist 
daher nicht allgemein und &ouml;ffentlich erh&auml;ltlich.
Einer der direkten Vorteile von vorhergehenden Porting-Versuchen
(neben dem eigentlichen Code nat&uuml;rlich ;) ist die Unterst&uuml;tzung 
f&uuml;r HP PA-RISC in GCC und binutils, was den schnellen Aufbau der 
cross-tools Umgebung f&uuml;r die Entwicklung m&ouml;glich machte.
<p>
Sp&auml;ter entschied sich HP dazu, einen
<a href=http://www.parisc-linux.org/>Linux</a> port auf PA-RISC
Maschinen zu unterst&uuml;tzen, was in der Herausgabe von propriet&auml;rer Dokumentation
resultierte, wobei aber eine andere Klasse von 9000er Systemen als Zielplatform 
anvisiert wurde.
<p>
So weit ist hier die Geschichte des OpenBSD/hppa portes
<small>(keine Daten, aber benutze doch einfach
<a href=anoncvs.html>cvs</a> um herauszufinden, was wann passiert ist)</small>:
<ul>
<li>single user
<li>Unterst&uuml;tzung der seriellen Konsole. 
<li>Der sti Treiber wurde neu geschrieben, mit ver&ouml;ffentlichten Spezifikationen
<li>kernel symbol table wird von /boot geladen (symbolisches Debugging !)
<li>init(8) arbeitet problemlos, die folgende single-user shell <u>steigt aus</u>,
	was wahrscheinlich bedeutet, dass sie ein Problem hat, sich selber zu initialisieren.
<li>root &uuml;ber nfs, swap &uuml;ber nfs
<li>i82596-basiertes ethernet (if_ie), im ungecacheten Memory Modus
<li>Der Grossteil des MD kernel codes ist geschrieben 
<li>DDB Unterst&uuml;tzung mit Ausnahme von watchpoints und single-stepping
<li>disk boot funktioniert
<li>Stinger (*CRX-*) Graphikkarten Treiber
<li>LASI, ASP, WAX und EISA Bus Adapter
<li>com, lpt, fdc Treiber (bisher kein fd ;)
<li>PDC Treiber
<li>kernel bootstrap funktioniert
<li>network boot arbeitet mit dem LIF Image
<li>cross-tools k&ouml;nnen &uuml;bersetzt werden/funktionieren
</ul>
<h4>Dokumentation</h4>
<small>(Das meiste wurde von HP f&uuml;r das 
<a href=http://www.parisc-linux.org/>Linux/parisc</a> Projekt ver&ouml;ffentlicht)<BR>
(die Dokumente sind in Englischer Sprache geschrieben)</small>:
<ol type=1>
<li>HP PA-RISC CPUs
       <ol type=a>
<li><a href=http://ftp.parisc-linux.org/docs/PCXL_ers.ps>PA7100LC CPU ERS</a>
<li><a href=http://ftp.parisc-linux.org/docs/pcxl2_ers.ps>PA7300LC CPU ERS</a>
       </ol>
<li><b>Processor Dependent Code/I/O Dependent Code Interface</b><br> <small>(ausgesuchte Kapitel aus der "PA-RISC I/O Architecture Specification")</small>
       <ol type=a>
<li><a href=http://ftp.parisc-linux.org/docs/pdc32.pdf>PDC 1.1</a>
<li><a href=http://ftp.parisc-linux.org/docs/iodc.pdf>IODC 1.1</a>
<li><a href=http://ftp.parisc-linux.org/docs/ver_nums.pdf>Version and Identification Number Allocation</a>
<li><a href=http://ftp.parisc-linux.org/docs/data_formats.pdf>Memory Data Formats 2.0</a>
<li><a href=http://ftp.parisc-linux.org/docs/pdc.pdf>PDC Procedures 2.0</a>
<li><a href=http://ftp.parisc-linux.org/docs/pdce.pdf>PDC Entry Points 2.0</a>
<li><a href=http://ftp.parisc-linux.org/docs/os_interface.pdf>OS Interface 2.0</a>
       </ol>
<li><b>Bus controllers/bridges/adaptors</b>
       <ol type=a>
<li><a href=http://ftp.parisc-linux.org/docs/hardball_ers.pdf>ASP</a>
<li><a href=http://ftp.parisc-linux.org/docs/lasi_ers.ps>LASI Core Bus Adapter (einschliesslich LAN, SCSI, serieller und lpt Kontroller)</a>
<li><a href=http://ftp.parisc-linux.org/docs/dino_ers.ps>Dino PCI bridge</a>,
und <a href=http://ftp.parisc-linux.org/docs/Dino_3_1_Errata.html>Errata</a>
<li><a href=http://ftp.parisc-linux.org/docs/elroy_ers.ps>Elroy ERS (F&uuml;r Open Source editiert)</a>
<li>Astro <a href=http://ftp.parisc-linux.org/docs/astro_intro.ps>Overview</a>, <a href=http://ftp.parisc-linux.org/docs/astro_errors.ps>Error handling</a>,<a href=http://puffin.external.hp.com/docs/astro_ioc.ps>R2I Operations</a>, <a href=http://puffin.external.hp.com/docs/astro_regmap.ps>Registers Map</a>, <a href=http://puffin.external.hp.com/docs/astro_runway.ps>Runway Interface</a>, <a href=http://puffin.external.hp.com/docs/astro_sysmap.ps>System Mamory Map</a>
 
       </ol>

<li><a href=http://ftp.parisc-linux.org/docs/sti.pdf>Stinger graphics</a>
<li><a href=http://www.lsilogic.com/techlib/techdocs/old_storage/770_2_0.pdf>NCR 53C700/710/720 SCSI I/O Processors</a>
    <small>(Das Dokument beschreibt eigentlich  den 770, der aber kompatibel sein soll)</small>
<li>Intel <a href=http://developer.intel.com/design/network/datashts/290219.htm>i82596DX/SX</a> und <a href=http://developer.intel.com/design/network/datashts/290218.htm>i82596CA</a> Ethernet Controller
</ol>
Mehr Informaionen gibts es bei <a href=http://www.openpa.net/>OpenPA</a>.

<h4>Cross-Tools erzeugen:</h4>
<p>
Momentan k&ouml;nnen die im Quellbaum befindlichen binutils nicht benutzt werden, um cross-tools zu erzeugen.
Du solltest einen 2.7er Quellbaum benutzen, um sie zu erzeugen, 2.8 oder sp&auml;ter wird nicht funktionieren.
<p>
<pre>
cd /usr/src
sudo make TARGET=hppa cross-tools
</pre>
</p>
<p>
Die Erstellung der cross-tools k&ouml;nnte auf libc-Ebene versagen,
was aber in Ordnung ist, da die libc Unterst&uuml;tzung noch nicht fertig ist.
</p>
<a name="boot_lif"></a>
<h4>Erzeugen der boot.lif Datei mit Hilfe der cross-tools:</h4>
<p>
<pre>
cd /sys/arch/hppa/stand
make obj
set cross=(/usr/cross/hppa/usr/bin)
make MACHINE=hppa MACHINE_ARCH=hppa \
       "AS=$cross/as" "CC=$cross/cc" "CXX=$cross/c++" \
	"CPP=$cross/cpp" "LD=$cross/ld" \
	"AR=$cross/ar" "STRIP=$cross/strip" \
	"LORDER=$cross/lorder" "NM=$cross/nm" \
	"RANLIB=$cross/ranlib" "SIZE=$cross/size"
</pre>
</p>
<p>
Dann hat man im obj-Verzeichniss eine <a href=http://hppa.lucifier.net/#boot_lif><em>boot.lif</em></a>
Datei zum booten.
Dieses Image kann ein <em>diskless</em> kernel image enthalten, wenn eines in
 <em>sys/arch/hppa/compile/SHEPHERD_PIE/bsd</em> enthalten war.
<br>
Der Kernel cross-build Prozess ist dem f&uuml;r das Booten &auml;hnlich, konsultiere einfach
<a href=http://www.openbsd.org/cgi-bin/man.cgi?query=config&apropos=0&sektion=0
&manpath=OpenBSD+Current&format=html>config(8)</a>
und
<a href=http://www.openbsd.org/cgi-bin/man.cgi?query=options&apropos=0&sektion=0&manpath=OpenBSD+Current&format=html>options(8)</a>
f&uuml;r die Kernel build Optionen und Konfigurationen.
</p>
<h4>Bisherige Entwicklung:</h4>
<pre>
BOOT_ADMIN&gt; boot lan isl

Booting





&gt;&gt; OpenBSD/hppa BOOT 0.7
&gt;
booting lf0a:/bsd: 1167360+61440+274432 [164584+60691]=0x489000 start=0x12000
000
[ bsd ELF symbol table not valid: bad magic ]
[ using 225276 bytes of bsd a.out symbol table ]
Copyright (c) 1982, 1986, 1989, 1991, 1993
        The Regents of the University of California.  All rights reserved.
Copyright (c) 1995-2002 OpenBSD. All rights reserved.  http://www.OpenBSD.org

OpenBSD 3.1-beta (SHEPHERD_PIE) #834: Thu Mar 28 10:52:35 EST 2002
    mickey@lucifier.net:/sys/arch/hppa/compile/SHEPHERD_PIE
HP9000/712/80 (King Gecko) PA-RISC 1.1
real mem = 67108864 (73728 reserved for PROM, 8388608 used by OpenBSD)
mainbus0 (root) [flex fff80000]
pdc0 at mainbus0
mem0 at mainbus0 offset ffbf000: viper rev 0, size 64MB
cpu0 at mainbus0 offset ffbe000 irq 31: PCXL rev 4 L1-A 80MHz, FPU PCXL (CMOS-26B) rev 1
cpu0: 128K(32b/l) Icache, 128K(32b/l) wr-back coherent Dcache, 64 coherent TLB, 8 BTLB
lasi1 at mainbus0 offset 500000 irq 27: rev 3.0
lasi0 at mainbus0 offset 100000 irq 28: rev 3.0
gsc0 at lasi0
"Optional RJ-16" at gsc0 (type a, sv 8d) offset 4060 not configured
"Optional RJ-16" at gsc0 (type a, sv 8d) offset 4040 not configured
"PS/2 port" at gsc0 (type a, sv 84) offset 8100 not configured
"PS/2 port" at gsc0 (type a, sv 84) offset 8000 not configured
"floppy controller" at gsc0 (type a, sv 83) offset a000 not configured
harmony0 at gsc0 offset 4000 irq 13: teleshare rev 4.0
"teleshare tty0" at harmony0 not configured
"teleshare tty1" at harmony0 not configured
lpt0 at gsc0 offset 2000 irq 7
com0 at gsc0 offset 5000 irq 13: ns16550a, 16 byte fifo
com0: console
ie0 at gsc0 offset 7000 irq 8: LASI/i82596CA v1.0, address 08:00:09:87:b5:75
"Core SCSI" at gsc0 (type a, sv 82) offset 6000 not configured
sti0 at mainbus0 offset 8000000: HPA208LC1280 rev 8.04;7
sti0: 2048x1024 frame buffer, 1280x1024x8 display, offset 0x0
sti0: 8x16 font type 1, 16 bpc, charset 0-255
wsdisplay0 at sti0
gsc1 at lasi1
com1 at gsc1 offset 5000 irq 5: ns16550a, 16 byte fifo
ie1 at gsc1 offset 7000 irq 8: LASI/i82596CA v1.0, address 08:00:09:87:b5:76
nfs_boot: using network interface 'ie0'
nfs_boot: client_addr=10.0.0.5
nfs_boot: server_addr=10.0.0.1 hostname=jwalker
root on lucifier:/export/hppa/root
root time: 0x3c6770c7
WARNING: clock lost 9913 days -- CHECK AND RESET THE DATE!
init: copying out flags `-s' 3
init: copying out path `/sbin/init' 11, 0x68ff3003
#
</pre>
</p>
<small>Die Info wurde vom Bildschirm abgetippt, entschuldige Rechtschreibfehler</small>
<hr>
Um die <a href=http://hppa.lucifier.net/#boot_lif>boot.lif</a> Dateien zu benutzen,
musst du deinen Server vorbereiten und deine Maschine anweisen, &uuml;ber das Netzwerk zu booten:
<ol>
  <li>Server setup</li><br>
    <ul>
    <li> F&uuml;r &auml;ltere  Maschinen (705, 7[1235]0, alte 715) muss
       <a href=http://www.openbsd.org/cgi-bin/man.cgi?query=rbootd&apropos=0&sektion=0&manpath=OpenBSD+Current&format=html>rbootd</a> eingeschaltet und gestartet werden.<br>
      <ul>
      <li><b>/etc/<a href=http://www.openbsd.org/cgi-bin/man.cgi?query=rbootd&apropos=0&sektion=0&manpath=OpenBSD+Current&format=html>rbootd</a>.conf</b>
	enth&auml;lt eine einzelne Zeile pro Maschine, die du eingegeben hast, um vom Server zu booten.
	Jede Zeile enth&auml;lt die Ethernet Adresse der hppa-Client Maschine und
	den Namen der Datei, die vom tftp Server geladen werden soll. Z.B.: 
	<pre>
	8:0:9:70:c4:11    <a href=#boot_lif>boot.lif</a>    # 9000/720
	8:0:9:19:fb:a0    <a href=#boot_lif>boot.lif</a>    # 9000/725
	</pre>
      </li>
      </ul>
    </li>
    <li>Neuere Maschinen (712, neue 715, 725) suchen nicht nach einem rbootd-Server, sondern ben&ouml;tigen ein
	<b>bootp</b> Setup.<br>
      <ul>
      <li><b>/etc/<a href=http://www.openbsd.org/cgi-bin/man.cgi?query=bootptab&apropos=0&sektion=5&manpath=OpenBSD+Current&format=html>bootptab</a></b> enthalten einen Informationsblock f&uuml;r jede Maschine.  Zum Beispiel:
       <pre>
       # 9000/715
       boron:\
               ha=0800095f5a6e:\
               bf=boot.lif:\
               hd=:\
               ht=ethernet:\
               ip=10.0.1.143:\
               rp=/usr/local/exports/boron/root:\
               sm=255.255.255.0:\
               td=/tftpboot:
       </pre>
      </li>
       <li>
       Erzeuge das Verzeichnis /tftpboot und packe die Datei <a href=#boot_lif>boot.lif</a> hinein.<br> 
       </li>
       <li>
       Schreibe einen Eintrag f&uuml;r deine hppa in die <b>/etc/ethers</b> Datei:<br> 
       <pre>
       08:00:09:5f:5a:6e       boron
       </pre>  
       </li>
       <li>
       Schreibe einen Eintrag f&uuml;r 'boron' in die <b>/etc/hosts</b> Datei:<br> 
       <pre>
       10.0.0.143       boron
       </pre>  
       </li>
       <li>
       Erzeuge das Verzeichnis /usr/local/exports/boron/root und plaziere die Dateien 
	<a href=http://hppa.lucifier.net/root/dev/MAKEDEV>/dev/MAKEDEV</a>,
        <a href=http://hppa.lucifier.net/root/sbin/init>/sbin/init</a>, <a href=http://hppa.lucifier.net/root/bin/ksh>/bin/ksh</a>             
        an ihre relativen Pl&auml;tze. 
       </li>
       <li>
       Schreibe einen Eintrag in <b>/etc/exports</b>, so dass das root Verzeichnis zum Client exportiert wird:
       <pre>
       /usr/local/exports/boron/root boron
       </pre>  
       </li>
       <li>
       Denk daran, dass du <a href=http://www.openbsd.org/cgi-bin/man.cgi?query=bootpd&apropos=0&sektion=8&manpath=OpenBSD+Current&format=html>bootpd</a>
        und <a href=http://www.openbsd.org/cgi-bin/man.cgi?query=tftpd&apropos=0&sektion=8&manpath=OpenBSD+Current&format=html>tftpd</a>
	in /etc/inetd.conf einschalten musst, und dann noch <a href=http://www.openbsd.org/cgi-bin/man.cgi?query=inetd&apropos=0&sektion=8&manpath=OpenBSD+Current&format=html>inetd</a> neustarten musst.
      </li>
       <li>
       Vergiss auch nicht <a href=http://www.openbsd.org/cgi-bin/man.cgi?query=nfsd&apropos=0&sektion=8&manpath=OpenBSD+Current&format=html>nfs_server</a>
       und <a href=http://www.openbsd.org/cgi-bin/man.cgi?query=rarpd&apropos=0&sektion=8&manpath=OpenBSD+Current&format=html>rarpd</a> 
       in <a href=http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf&apropos=0&sektion=8&manpath=OpenBSD+Current&format=html>/etc/rc.conf</a> zu aktivieren.
       </li>
       </ul>
    </li>
    <li>Weitere Informationen &uuml;ber das Server Setup f&uuml;r Netzwerk Booten im allgemeinen gibt es hier: <a href=http://www.openbsd.org/cgi-bin/man.cgi?query=diskless&apropos=0&sektion=0&manpath=OpenBSD+Current&format=html>diskless(8)</a>.</li>
    </ul>
  <li>Client Netzwerk Boot</li><br>
  <ul>
    <li>BOOT_ADMIN<br>
	um zum BOOT_ADMIN Prompt zu gelangen, musst du die <em>&lt;esc&gt;</em> Taste dr&uuml;cken, sobald
	die Maschine gestartet wird. Wenn sie anf&auml;ngt, nach bootbaren Ger&auml;ten zu suchen, tippe 'a' um
	zum 'BOOT_ADMIN' Prompt zu gelangen.
    </li>
    <li>network boot command <br>
	Einmal am 'BOOT_ADMIN' Prompt angelangt, tippe:
<pre>
	BOOT_ADMIN> boot lan isl
</pre>
	... und du bist auf dem Weg boot.lif zu booten!
    </li>
</ul>
</ol>
<hr>
<a href=plat.html><img height=24 width=24 src=../back.gif border=0 alt=OpenBSD></a> 
<a href=mailto:www@openbsd.org>www@openbsd.org</a>
<br>
<small>
Originally [OpenBSD: hppa.html,v 1.61 ]
<br>
$Translation: hppa.html,v 1.29 2002/05/02 20:18:05 jufi Exp $
<br>
</small>
<small>$OpenBSD: hppa.html,v 1.29 2002/05/02 20:28:21 jufi Exp $</small>
</body>
</html>

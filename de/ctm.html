<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
   <TITLE>CTM</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#23238E">

<center>
<img alt="CTM for OpenBSD" src=../images/bsdctm.gif width=401 height=126>
</center>

<H3>Was ist ctm?</H3>

<P>
Ctm ist ein System, das von Poul-Henning Kamp erschaffen wurde, um die
t&auml;glichen &Auml;nderungen an einem source tree per E-Mail verf&uuml;gbar
zu machen. Das ist ein guter Weg, um beim "-current source" auf dem laufenden zu bleiben,
selbst wenn man eine schlechte Internetverbindung hat, z.B. via Modem.

<P>
Ctm benutzt eine sehr kleine Bandbreite, um die &Auml;nderungen am
source tree zu verschicken und komprimiert sie ausserdem per gzip -9.

<H3>Wie funktioniert es?</H3>

<P>
Die grunds&auml;tzliche Idee von ctm ist, dass du dich auf einer bestimmten
Mailingliste einschreibst, sie also abonnierst, um einen bestimmten Teil des
source trees zu erhalten. Du erh&auml;ltst jeden Tag eine E-Mail mit den jeweiligen 
&Auml;nderungen dieses Tages. Ein Satz &Auml;nderungen wird &quot;delta&quot;
genannt.

<P>
Du beginnst mit einem Basissatz gegen den dann sp&auml;ter die deltas gepatched
werden. Um mit ctm zu beginnen, musst du unbedingt die neueste Version des "base
set" (Basissatz) und alle danach folgenden deltas herunterladen; nachdem du diese verarbeitet 
hast, kannst du mit denen weitermachen, die du per E-Mail erh&auml;ltst.
Die Basis-S&auml;tze sin jeweils in 1440k Teile aufgeteilt, damit man sie leichter &uuml;ber
eine schlechte Leitung herunterladen und auch auf Floppies plazieren kann.

<P>
Basen werden etwa nach 100 relativen deltas erstellt, so dass du nie mehr als 
100 deltas herunterladen musst, um auf den aktuellen Stand zu kommen.

<H3>Wieviel Bandbreite braucht ctm ?</H3>

<P>
Wie oben schon erw&auml;hnt, enth&auml;lt das Basisset einen vollen source tree in tar-format,
und ist daher recht gross. Du musst das base set aber haben und alle relativen deltas bis zum 
jetzigen Datum dazu, und zwar per FTP von der unten aufgef&uuml;hrten Liste. Sie haben die folgenden
Gr&ouml;&szlig;en:

<ul>
<li> ungef&auml;hr 115Mb f&uuml;r OpenBSD-cvs
<li> ungef&auml;hr 37Mb f&uuml;r OpenBSD-cvs-x11
<li> ungef&auml;hr 65Mb f&uuml;r OpenBSD-src
<li> ungef&auml;hr 35Mb f&uuml;r OpenBSD-src-x11
<li> ungef&auml;hr 2Mb f&uuml;r OpenBSD-ports
<li> denke dran, dass das komprimierte Dateien sind -- ausgepackt sind sie etwa f&uuml;nfmal so gross.
<li> relative deltas sind zwischen 10k und 100k, und manchmal auch einige MB
<li> ctm teilt die deltas immer in 100k Messages , die dann automatisch wieder zusammengef&uuml;gt werden
</ul>

<P>
Gr&ouml;&szlig;ere ctm Updates sind selten, passieren aber meist nach dem Importieren von grossen Dingen
wie etwa den binutils, perl, usw. in den source tree. 

<H3>Wie man benutzt man ctm?</H3>

<UL>
<LI>Abboniere die ctm Mailingliste f&uuml;r das Source-set deiner Wahl.
<p>
   Es gibt verschiedene Mailinglisten f&uuml;r das Thema ctm.  Es gibt eine Liste f&uuml; die
   Updates am CVS tree,  eine Liste f&uuml;r den source tree, eine Liste
   f&uuml;r den X11 Teil und eine f&uuml;r den ports tree, sowie eine 
   f&uuml;r die Log Messages des ctm delta Generators.
   <p>
   Die folgenden Kommandos werden dich auch der entsprechenden Liste einschreiben:
<br><br><tt>
F&uuml;r den cvs tree (ohne die X11 Teile):<br>
    <b>echo subscribe OpenBSD-cvs | mail majordomo@OpenBSD.org</b><br>
F&uuml;r den X11 Teil des cvs tree:<br>
    <b>echo subscribe OpenBSD-cvs-x11 | mail majordomo@OpenBSD.org</b><br>
F&uuml;r den source tree (ohne den X11 Teil): <br>
    <b>echo subscribe OpenBSD-src | mail majordomo@OpenBSD.org</b><br>
F&uuml;r den X11 Teil des source tree: <br>
    <b>echo subscribe OpenBSD-src-x11 | mail majordomo@OpenBSD.org</b><br>
F&uuml;r den ports tree: <br>
    <b>echo subscribe OpenBSD-ports-ctm | mail majordomo@OpenBSD.org</b><br>
F&uuml;r die ctm log Liste:<br>
    <b>echo subscribe ctm-log | mail majordomo@OpenBSD.org</b><br>
</tt><br>

<LI>Warte bis du dein erstes Delta erh&auml;lst.

<LI>Entpacke es und f&uuml;ge es mit ctm_rmail wieder zusammen.
<br>
<br>
<tt>
    <b>ctm_rmail -p. -d. -b. folder</b>
</tt>
<br><br>
wobei <b>folder</b> der Mailordner ist, der die delta Mail enth&auml;lt.
<br>
Das wird das ctm delta auspacken und es im momentane Verzeichnis ablegen.
Das delta wird eine Datei der Form OpenBSD-XXX.YYYY.gz sein, wobei XXX entweder
"src" oder "cvs" ist, und YYYY die Nummer des deltas.
<p>

<li>Hole das base set von der unten aufgef&uuml;hrten ftp site, aus dem Unterverzeichnis 
<b>base/OpenBSD-cvs</b> (for OpenBSD-cvs) oder <b>base/OpenBSD-src</b>
(f&uuml;r OpenBSD-src).  Hole alle Dateien aus diesem Verzeichnis, sobald du sie all hast,
kannst du mit den folgenden Kommandos den 'base source tree' erzeugen:

<br><br>
<tt>
    <b>cd target <br>
    cat /split/OpenBSD-* | tar zxf - <br>
</b></tt><br>

wobei <b>split</b> das Verzeichnis ist, in dem du die Dateien abgelegt hast, die du 
heruntergeladen hast.

<p>
Es ist nicht l&auml;nger notwendig diese Dateien zu behalten, wenn du sicher bist, einen
kompletten Tree zu haben. Wie dem auch sei, du solltest unbedingt die Nummer des tree 
notieren, bevor du weitermachst.

<p>
Als n&auml;chstes holst du dir die deltas, die nach der Erzeugung des base trees
generiert wurden.  Gehe auf die unten aufgef&uuml;hrte FTP-Seite und zwar z.B. in das
Unterverzeichnis
<b>OpenBSD-cvs</b> oder <b>OpenBSD-src</b> und lade alle Dateien herunter, deren Nummer
<it>gr&ouml;&szlig;er</it> ist als die Nummer deiner base.

<p>
Die Adresse f&uuml;r  base und deltas ist:

<ul>
<li><a href="ftp://ctm.OpenBSD.org:/pub/OpenBSD-ctm/">
     ftp://ctm.OpenBSD.org:/pub/OpenBSD-ctm/
</a>
</ul>

<ul>
<li><a href="ftp://ctm.ca.OpenBSD.org:/pub/OpenBSD-ctm/">
     ftp://ctm.ca.OpenBSD.org:/pub/OpenBSD-ctm/
</a>
</ul>

<ul>
<li><a href="ftp://ctm.se.OpenBSD.org:/pub/OpenBSD-ctm/">
     ftp://ctm.se.OpenBSD.org:/pub/OpenBSD-ctm/
</a>
</ul>

<p>
<ul>
<li><b>HINWEIS:</b> Ich bin sehr an weiteren Sites interssiert, die die 
deltas spiegeln m&ouml;chten.
</ul>
<p>

<LI> Lasse ctm laufen.
<br>
  <br>
  <tt>
     <b>cd target<br>
     ctm -v -v /deltas/OpenBSD-cvs.*</b><br></tt>
wobei <b>target</b> das Verzeichnis ist, in dem dein cvs tree leben soll,
und <b>deltas</b> halt das Verzeichnis ist, an dem du deine deltas abgelegt hast.
<p>
Es wird einige Zeit dauern, alle deltas durchlaufen zu lassen, aber die t&auml;glichen
Aufrufe von <b>ctm_rmail</b> und <b>ctm</b> werden nicht mal ann&auml;hernd so 
lange dauern.
</ul>

<h3>Sollte ich den source oder cvs tree nehmen?</h3>

<P>
Das h&auml;ngt unter anderem von deinem verf&uuml;gbaren Paltz auf der Festplatte ab.
Da ctm noch nichts mit Dateien anfangen kann, die ausserhalb des ctm Prozesses 
modifziert wurden, ist die "bessere" Wahl wahrscheinlich der cvs-tree. Dann kannst du 
deinen funktionierenden source tree aus dem cvs-tree heraus updaten, und deine lokalen
&Auml;nderungen in deinem source tree behalten, und es alleine ctm vorbehalten, den 
cvs-tree zu ver&auml;ndern. 

<p>
Der Nachteil ist der daf&uuml;r notwendige Plattenplatz.  Ein 'checked-out'
source tree ben&ouml;tigt etwa 300Mb, aber wenn du deinen eigenen cvs tree hast,
brauchst du etwa 400Mb daf&uuml;r, <b>plus</b> zus&auml;tzliche 300Mb f&uuml;r den 
"checked out" tree.

<p>
Das beinhaltet noch nicht die 100Mb oder mehr, die du f&uuml;r einen "build" brauchst 
(abh&auml;ngig von der Archiktektur.)

<p>
Wenn du nur den source tree holst, musst du dich mit lokalen Ver&auml;nderungen 
anfreunden. Ein Weg um das zu tun, ist die Nutzung des <b>union</b> Dateisystems,
obwohl es auch schon Berichte gegeben hat, das <b>union</b> Dateisystem k&ouml;nne
unstabil sein, wenn die unteren und oberen "layers" auf dem selben physischen 
Dateisystem residieren. Wenn du aber obere und untere Layer auf verschiedene
Dateisysteme plazierst, solltest du dieses Problem nicht haben.
Ein Beispiel:

<p>
Nehmen wir an dein "ctm-updated" tree sei in <b>/usr/src-ctm</b>, und dein realer
source tree, der, an dem du deine &Auml;nderungen durchf&uuml;hrst und deine "builds" machst,
sei in <b>/usr/src</b>.  <b>/usr/src</b> sollte zu Anfang ein leeres Verzeichnis sein. 
Das folgende Kommando wird den union-mount setzen:
<br><br>
<tt>
    <b>mount -t union -o -b /usr/src-ctm /usr/src</b>
</tt>
<br><br>
&Auml;nderungen an Dateien in /usr/src werden zu einer Datei, die in
/usr/src enthalten ist, und die in src-ctm versteckt.  Wenn &Auml;nderungen via ctm 
am darunterliegen src-ctm tree gemacht werden, werden diese &Auml;nderungen <b>nicht</b>
sichtbar sein, wenn es eine Datei in der dar&uuml;berliegenden Schicht gibt, die sie versteckt.

<p>
Das solltest regelm&auml;ssig das union-Dateisystem  "unmounten" 
und nach Dateien suchen, die es nur im union Dateisystem gibt.
<br><br>
<tt>
    <b>umount /usr/src <br>
    find /usr/src -type f</b> <br>
</tt>
<br><br>
Die Kommandos <b>ls -W</b> und <b>rm -W</b> werden ebenfalls n&uuml;tzlich sein,
da Objekte namens "whiteouts" in /usr/src ebenso Dateien in src-ctm verstecken.

<p>
Wenn du den cvs-tree holst, kannst du das "cvs checkout" Komnmando benutzen, um
einen source tree zu erhalten, und jedesmal, wenn du mit ctm updatest, kannst du mit
"cvs update" deinen source tree auf den aktuellen Stand bringen.

<br><br>
F&uuml;r einen ersten src tree:<br>
<tt>
    <b>cd /usr <br>
    cvs -qd YOUR_CVS_TREE checkout src</b> <br><br>
</tt>
und nach jedem ctm update:<br>
<tt>
    <b>cd /usr/src <br>
    cvs -q update -PAd</b> <br>
</tt>

<H3>Wie stabil ist ctm f&uuml;r OpenBSD?</H3>

Ctm wird seit &uuml;ber einem Jahr in OpenBSD benutzt, und in FreeBSD seit
einer ganzen Reihe von Jahren.  Ctm ist ziemlich zuverl&auml;ssig und stabil.

<H3>Mehr Informationen</H3>

Wenn du Probleme mit ctm hast, ist das FreeBSD Handbuch ein guter Platz f&uuml;r Hilfe:

<ul>
<li> <a href="http://www.FreeBSD.org/handbook/ctm.html">
         http://www.FreeBSD.org/handbook/ctm.html
     </a>
</ul>

Es gibt auch man pages f&uuml;r alle ctm Utilities, die sich im 
source package befinden.  Wenn du OpenBSD hast solltest du man
pages, source, und binaries bereits haben. Wenn nicht, kannst du sie von der
FTP-Site weiter oben holen.

<p>
Du kannst auch die OpenBSD Mailinglisten oder mich selbst kontaktieren, wenn du 
Schwierigkeiten mit ctm hast, obwohl meine Freizeit doch recht eingeschr&auml;nkt ist.

<p>
Zusammenfassung:

<p>

<ul>
<li> Mailinglisten:

   <ul>
   <li> <b>echo subscribe OpenBSD-cvs | mail majordomo@OpenBSD.org</b>
   <li> <b>echo subscribe OpenBSD-cvs-x11 | mail majordomo@OpenBSD.org</b>
   <li> <b>echo subscribe OpenBSD-src | mail majordomo@OpenBSD.org</b>
   <li> <b>echo subscribe OpenBSD-src-x11 | mail majordomo@OpenBSD.org</b>
   <li> <b>echo subscribe OpenBSD-ports-ctm | mail majordomo@OpenBSD.org</b>
   <li> <b>echo subscribe ctm-log | mail majordomo@OpenBSD.org</b>
   </ul>

<li> FTP (f&uuml;r base und relative deltas; und OpenBSD hat ctm im source
     tree, aber wenn du keine source oder binaries hast, gibt's hier auch den source):

   <ul>
   <li> <a href="ftp://ctm.OpenBSD.org:/pub/OpenBSD-ctm">
         ftp://ctm.OpenBSD.org:/pub/OpenBSD-ctm
	   </a>
   <li> <a href="ftp://ctm.ca.OpenBSD.org:/pub/OpenBSD-ctm">
         ftp://ctm.ca.OpenBSD.org:/pub/OpenBSD-ctm
	   </a>
   <li> <a href="ftp://ctm.se.OpenBSD.org:/pub/OpenBSD-ctm">
         ftp://ctm.se.OpenBSD.org:/pub/OpenBSD-ctm
	   </a>
   </ul>
</ul>

<p>
Ich werde alle wichtigen &Auml;nderungen und Hinweise &uuml;ber ctm hier bekannt machen:
<ul>
<li> misc@OpenBSD.org
<li> announce@OpenBSD.org
</ul>

<p>
<b>HINWEIS:</b> Wenn du ctm f&uuml;r OpenBSD benutzt schicke mir doch bitte eine E-Mail,
so dass ich weiss, wieviel Leute es benutzen !

<H3>Danksagungen</H3>

<li> Poul-Henning Kamp (phk@FreeBSD.org) f&uuml;r ctm und die Hilfe 
     f&uuml;r die delta Generierung.

<li> Theo de Raadt (deraadt@theos.com) f&uuml;r OpenBSD und daf&uuml;r, dass
     er mir die Ressourcen gegeben hat, die ctm deltas auf cvs.OpenBSD.org zu erstellen
     (inzwischen werden sie an einem anderen Ort generiert) und
     f&uuml;r die Nameserver-Magie

<li> Todd C. Miller (millert@OpenBSD.org) f&uuml;r das Einrichten und Pflegen der
     ctm Mailinglisten

<li> Bob Beck (beck@OpenBSD.org), Artur Grabowski (art@OpenBSD.org),
     Magnus Holmberg (mho@OpenBSD.org) und
     Wolfram Schneider (wosch@FreeBSD.org) f&uuml;r das Einrichten des ftp space
     f&uuml;r die bases und deltas auf ctm.*OpenBSD.org

<li> ... und all den anderen, die indirekt dazu beigetragen haben...
</ul>

<P>
Viel Gl&uuml;ck!

<P>


<HR>

<ADDRESS><A HREF="mailto:graichen@OpenBSD.org">Thomas Graichen</A></ADDRESS>
<br>
Das OpenBSD/CTM Logo wurde f&uuml;r das OpenBSD Projekt von 
   <a href="mailto:flipk@openbsd.org">Phillip F Knaack</a> entworfen.

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../back.gif" border="0" alt="OpenBSD" /></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
</br>
<small>
Originally [OpenBSD: ctm.html,v 1.12 ]
<br>
$Translation: ctm.html,v 1.2 2000/11/18 14:44:54 jufi Exp $
<br></small>
<small>$OpenBSD: ctm.html,v 1.2 2000/11/18 14:50:50 jufi Exp $</small>
</body>
</html>

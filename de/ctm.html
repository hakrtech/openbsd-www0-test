<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
   <TITLE>CTM</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#23238E">

<center>
<img alt="CTM for OpenBSD" src="../images/bsdctm.gif" width="401" height="126">
</center>

<H3>Was ist ctm?</H3>

<P>
Ctm ist ein System, das von Poul-Henning Kamp erschaffen wurde, um die
t&auml;glichen &Auml;nderungen an einem source tree per E-Mail verf&uuml;gbar
zu machen. Das ist ein guter Weg, um beim "-current source" auf dem laufenden zu bleiben,
selbst wenn man eine schlechte Internetverbindung hat, z.B. via Modem.

<P>
Ctm benutzt eine sehr kleine Bandbreite, um die &Auml;nderungen am
source tree zu verschicken und komprimiert sie ausserdem per gzip -9.
Im Gegensatz zu <a
href="cvsup.html">CVSup</a>, ist ctm in normalem C geschrieben und daher f&uuml;r
jede Plattform verf&uuml;gbar, die von OpenBSD unterst&uuml;tzt wird.

<H3>Wie funktioniert es?</H3>

<P>
Die grunds&auml;tzliche Idee von ctm ist, dass du dich auf einer bestimmten
Mailingliste einschreibst, sie also abonnierst, um einen bestimmten Teil des
source trees zu erhalten. Du erh&auml;ltst jeden Tag eine E-Mail mit den jeweiligen 
&Auml;nderungen dieses Tages. Ein Satz &Auml;nderungen wird "delta"
genannt.

<P>
Du beginnst mit einem Basissatz gegen den dann sp&auml;ter die deltas gepatched
werden. Um mit ctm zu beginnen, musst du unbedingt die neueste Version des "base
set" (Basissatz) und alle danach folgenden deltas herunterladen; nachdem du diese verarbeitet 
hast, kannst du mit denen weitermachen, die du per E-Mail erh&auml;ltst.
Die Basis-S&auml;tze sind jeweils in 1440k Teile aufgeteilt, damit man sie leichter &uuml;ber
eine schlechte Leitung herunterladen und auch auf Floppies plazieren kann.

<P>
Basen werden nach 50 relativen deltas erstellt, so dass du nie mehr als 
50 deltas herunterladen musst, um auf den aktuellen Stand zu kommen.

<P>
Es gibt zur Zeit zwei verschiedene Artenvon Basis-Deltas. Eine ganze Zeit
lang haben wir <tt><b>tar.gz</b></tt> Dateien per Hand erstellt, aber wir
gehen zur&uuml;ck zu echten ctm Basis Deltas. Die letzteren enthalten
md5 Checksummen und werden automatisch erstellt, sind also etwas sicherer.
Du kannst diese beiden Arten anhand ihres Dateinamens unterscheiden. Ein Beispiel f&uuml;r 
eine <tt><b>tar.gz</b></tt> Datei ist
<tt><b>OpenBSD-cvs.1450.tar.gz</b></tt>, w&auml;hrend ein ctm Basis Delta
den folgenden Namen h&auml;tte: <tt><b>OpenBSD-cvs.1500A.gz</b></tt>.  Siehe unten f&uuml;r
detaillierte Anweisungen.

<H3>Wieviel Bandbreite braucht ctm ?</H3>

<P>
Du musst das base set aber haben und alle relativen deltas bis zum 
jetzigen Datum dazu, und zwar per FTP von der unten aufgef&uuml;hrten Liste. Sie haben die folgenden
Gr&ouml;&szlig;en:

<ul>
<li> ungef&auml;hr 115Mb f&uuml;r OpenBSD-cvs
<li> ungef&auml;hr 37Mb f&uuml;r OpenBSD-cvs-x11
<li> ungef&auml;hr 65Mb f&uuml;r OpenBSD-src
<li> ungef&auml;hr 35Mb f&uuml;r OpenBSD-src-x11
<li> ungef&auml;hr 2Mb f&uuml;r OpenBSD-ports
<li> denke dran, dass das komprimierte Dateien sind -- ausgepackt sind sie etwa f&uuml;nfmal so gross.
<li> relative deltas sind zwischen 10k und 100k, und manchmal auch einige MB
<li> ctm teilt die deltas immer in 100k Messages , die dann automatisch wieder zusammengef&uuml;gt werden
<li>Wenn ein Delta gr&ouml;sser als 5MB ist, wird es nicht via mail versendet. Anstattdessen bekommst du eine
 Benachrichtigung, dass du das Delta per FTP holen musst.
</ul>

<P>
Gr&ouml;&szlig;ere ctm Updates sind selten, passieren aber meist nach dem Importieren von grossen Dingen
wie etwa den binutils, perl, gcc, usw. in den source tree. 

<H3>Wie man benutzt man ctm?</H3>

<UL>
<LI>Abboniere die ctm Mailingliste f&uuml;r das Source-set deiner Wahl.
<p>
   Es gibt verschiedene Mailinglisten f&uuml;r das Thema ctm.  Es gibt eine Liste f&uuml; die
   Updates am CVS tree,  eine Liste f&uuml;r den source tree, eine Liste
   f&uuml;r den X11 Teil und eine f&uuml;r den ports tree, sowie eine 
   f&uuml;r die Log Messages des ctm delta Generators.
   <p>
<p>
F&uuml;r den CVS tree (ohne den X11 Teil):
<pre>
       echo subscribe OpenBSD-cvs | mail majordomo@OpenBSD.org
</pre>
F&uuml;r den X11 Teil des CVS tree:
<pre>
       echo subscribe OpenBSD-cvs-x11 | mail majordomo@OpenBSD.org
</pre>
F&uuml; den source tree (ohne den X11 Teil):
<pre>
       echo subscribe OpenBSD-src | mail majordomo@OpenBSD.org
</pre>
F&uuml;r den X11 Teil des source tree:
<pre>
       echo subscribe OpenBSD-src-x11 | mail majordomo@OpenBSD.org
</pre>
F&uuml;r den ports tree:
<pre>
       echo subscribe OpenBSD-ports-ctm | mail majordomo@OpenBSD.org
</pre>
F&uuml;r die ctm log Liste:
<pre>
       echo subscribe ctm-log | mail majordomo@OpenBSD.org
</pre>

<p>
<li>Installiere das ctm Programm aus einem Package oder aus der ports
collection.  Den port gibt's unter
<tt><b>/usr/ports/devel/ctm</b></tt>.


</ul>
	<b>Hinweis:</b> Die Beispiele unten decken nur OpenBSD-cvs ab, einfach zur
	Kl&auml;rung. Die anderen source sets m&uuml;ssen auf die gleiche Art behandelt werden.

<p><ul>

<li>Lade das Basis-Set von einer FTP Site herunter. Du findest es im 
Unterverzeichnis <tt><b>base/OpenBSD-cvs</b></tt>. Hole alle Dateien in diesem 
Verzeichnis. Wenn du sie alle hast, kannst du die Basis-Datei erstellen und sie mit 
folgenden Kommandos auspacken, abh&auml;ngig vom Typ des Basis-Deltas, das du hast:

<pre>
       cat split/OpenBSD-cvs.1500A.gz.* &gt; OpenBSD-cvs.1500A.gz
       cd target
       ctm -v -v -v .../OpenBSD-cvs.1500A.gz
</pre>
<p>
oder

<pre>
       cat split/OpenBSD-cvs.1500.tar.gz.* &gt; OpenBSD-cvs.1500.tar.gz
       cd target
       tar -xzvf .../OpenBSD-cvs.1500.tar.gz
</pre>

wobei <tt><b>split</b></tt> das Verzeichnis st, in dem du die heruntergeladenen Dateien
abgelegt hast und <tt><b>target</b></tt> der Platz ist, den du f&uuml;r das source set 
gew&auml;hlt hast.

<p>
Es ist nicht notwendig, die Dateien weiter zu behalten, sobald du einmal einen kompletten
tree hast. Aber du kannst die Basis-Set Dateien aus Backup-Gr&uuml;nden behalten. Auf jeden
Fall musst du aber die Nummer des Basis-Sets notieren, bevor du weitermachen kannst.

<p>
<li>Jetzt musst du die Deltas holen, die generiert wurden, seit das Basis-Set erstellt wurde.
Gehe auf dem FTP-Server ins Unterverzeichnis
<tt><b>OpenBSD-cvs</b></tt> und lade jede Datei herunter, die 
<em>gr&ouml;sser</em> ist als die Nummer des benutzten Basis-Sets. Dann verarbeite die Deltas:

<pre>
       cd target
       ctm -v -v -v deltas/OpenBSD-cvs.*
</pre>

<p>
wobei <tt><b>target</b></tt> das Verzeichnis ist, wo dein source set tree ist,
und <tt><b>deltas</b></tt> der Platz ist, wo deine Deltas gespeichert sind.
<p>

<LI>Warte bis du dein erstes Delta von der Mailingliste bekommst:
<p>
<LI>Entpacke und verarbeite das ctm delta mit Hilfe von ctm_rmail.
<p>

<pre>
       ctm_rmail -p /tmp -d deltas -b target folder
</pre>

<p>
wobei <tt><b>folder</b></tt> Der Mailordner ist, der die Delta-Mail enth&auml;lt.
Das wird das ctm Delta dekodieren und im 
<tt><b>deltas</b></tt> Verzeichnis speichern. Das Delta wird eine Datei der Form
form <tt><b>OpenBSD-cvs.<var>XXXX</var>.gz</b></tt> sein, wobei <var>XXXX</var>
die Nummer des Deltas ist.  Dann wird das Delta in den directory tree 
unter <tt><b>target</b></tt>, eingearbeitet, der Platz an dem du das
Basis Delta ausgepackt hast.

<p>
Wiederhole diesen letzten Schritt jedesmal, wenn du ein Delta von der
Mailingliste erh&auml;ltst. Wenn du willst, kannst du diesen Schritt mit
Hilfe von procmail oder einem &auml;hnlichem Programm automatisieren.
</ul>
<p>
Die Adresse f&uuml;r deltas ist:

<ul>
<li><a href="ftp://ctm.OpenBSD.org:/pub/OpenBSD-ctm/">
     ftp://ctm.OpenBSD.org:/pub/OpenBSD-ctm/
</a>
</ul>

<ul>
<li><a href="ftp://ctm.ca.OpenBSD.org:/pub/OpenBSD-ctm/">
     ftp://ctm.ca.OpenBSD.org:/pub/OpenBSD-ctm/
</a>
</ul>

<ul>
<li><a href="ftp://ctm.se.OpenBSD.org:/pub/OpenBSD-ctm/">
     ftp://ctm.se.OpenBSD.org:/pub/OpenBSD-ctm/
</a>
</ul>

<p>
<li><b>HINWEIS:</b> Ich bin sehr an weiteren Sites interssiert, die die 
deltas spiegeln m&ouml;chten.

<p>

<h3>Sollte ich den source oder CVS tree nehmen?</h3>

<P>
Das h&auml;ngt unter anderem von deinem verf&uuml;gbaren Paltz auf der Festplatte ab.
Da ctm nichts mit Dateien anfangen kann, die ausserhalb des ctm Prozesses 
modifziert wurden, ist die "bessere" Wahl wahrscheinlich der cvs-tree. Dann kannst du 
deinen funktionierenden source tree aus dem cvs-tree heraus updaten, 
da CVS smart genug ist, um deine lokalen &Auml;nderungen einzuf&uuml;gen.

<p>
Der Nachteil ist der daf&uuml;r notwendige Plattenplatz.  Ein 'checked-out'
source tree ben&ouml;tigt etwa 350MB, aber wenn du deinen eigenen cvs tree hast,
brauchst du etwa 1GB daf&uuml;r, <b>plus</b> zus&auml;tzliche 350MB f&uuml;r den 
"checked out" tree.

<p>
Das beinhaltet noch nicht die 100MB oder mehr, die du f&uuml;r einen "build" brauchst 
(abh&auml;ngig von der Archiktektur.), sprich das Kompilieren der Sourcen.

<p>
Wenn du nur den source tree holst, musst du dich mit lokalen Ver&auml;nderungen 
anfreunden. Ein Weg um das zu tun, ist die Nutzung des <b>union</b> Dateisystems,
obwohl es auch schon Berichte gegeben hat, das <b>union</b> Dateisystem k&ouml;nne
unstabil sein, wenn die unteren und oberen "layers" auf dem selben physischen 
Dateisystem residieren. Wenn du aber obere und untere Layer auf verschiedene
Dateisysteme plazierst, solltest du dieses Problem nicht haben.
Ein Beispiel:

<p>
Nehmen wir an dein "ctm-updated" tree sei in <tt><b>/usr/src-ctm</b></tt>, und dein realer
source tree, der, an dem du deine &Auml;nderungen durchf&uuml;hrst und deine "builds" machst,
sei in <tt><b>/usr/src</b></tt>.  <tt><b>/usr/src</b></tt> sollte zu Anfang ein leeres Verzeichnis sein. 
Das folgende Kommando wird den union-mount setzen:
<br><br>
<pre>
    <b>mount -t union -o -b /usr/src-ctm /usr/src</b>
</pre>
<p>

<br><br>
&Auml;nderungen an Dateien in /usr/src werden zu einer Datei, die in
/usr/src enthalten ist, und die in src-ctm versteckt.  Wenn &Auml;nderungen via ctm 
am darunterliegen src-ctm tree gemacht werden, werden diese &Auml;nderungen <b>nicht</b>
sichtbar sein, wenn es eine Datei in der dar&uuml;berliegenden Schicht gibt, die sie versteckt.

<p>
Das solltest regelm&auml;ssig das union-Dateisystem  "unmounten" 
und nach Dateien suchen, die es nur im union Dateisystem gibt.

<pre>
       umount /usr/src
       find /usr/src -type f
</pre>

<p>
Die Befehle <tt><b>ls -W</b></tt> und <tt><b>rm -W</b></tt> werden auch n&uuml;tzlich sein
da Objekte in /usr/src , die "whiteouts" im Namen beinhalten, auch Dateien in src-ctm 
verstecken.

<p>
Wenn du den CVS tree hast, kannst du das <tt><b>cvs checkout</b></tt>
Kommando benutzen, um daraus einen source tree zu machen, und jedesmal, wenn du mit ctm
ein Update durchgef&uuml;hrt hast, kannst du ein <tt><b>cvs update</b></tt> benutzen, um deinen
source tree 'upzudaten'.

<p>
Um einen ersten src tree zu bekommen:: 
<pre>
       cd /usr
       cvs -qd YOUR_CVS_TREE checkout -A src
</pre>
<p>
und nach jedem ctm Update:
<pre>
       cd /usr/src
       cvs -q update -PAd
</pre>

<H3>Wie stabil ist ctm f&uuml;r OpenBSD?</H3>

	ctm wird seit &uuml;ber vier Jahren in OpenBSD benutzt, und in FreeBSD noch
	l&auml;nger.  Ctm ist ziemlich zuverl&auml;ssig und stabil.

<H3>Mehr Informationen</H3>

Wenn du mehr &uuml;ber ctm lernen willst, ist das FreeBSD Handbuch ein guter Platz f&uuml;r Hilfe:

<ul>
<li> <a href="http://www.FreeBSD.org/handbook/ctm.html">
         http://www.FreeBSD.org/handbook/ctm.html
     </a>
</ul>

Es gibt auch man pages f&uuml;r alle ctm Utilities.

<p>
Du kannst auch die OpenBSD Mailinglisten oder mich selbst kontaktieren, wenn du 
Schwierigkeiten mit ctm hast, obwohl meine Freizeit doch recht eingeschr&auml;nkt ist.

<p>
Zusammenfassung:

<p>

<ul>
<li> Mailinglisten:

   <ul>
   <li><tt>echo subscribe OpenBSD-cvs | mail majordomo@OpenBSD.org</tt>
   <li><tt>echo subscribe OpenBSD-cvs-x11 | mail majordomo@OpenBSD.org</tt>
   <li><tt>echo subscribe OpenBSD-src | mail majordomo@OpenBSD.org</tt>
   <li><tt>echo subscribe OpenBSD-src-x11 | mail majordomo@OpenBSD.org</tt>
   <li><tt>echo subscribe OpenBSD-ports-ctm | mail majordomo@OpenBSD.org</tt>
   <li><tt>echo subscribe ctm-log | mail majordomo@OpenBSD.org</tt>
   </ul>

<li> FTP (f&uuml;r base und relative deltas):

   <ul>
   <li> <a href="ftp://ctm.OpenBSD.org:/pub/OpenBSD-ctm">
         ftp://ctm.OpenBSD.org:/pub/OpenBSD-ctm</a>
   <li> <a href="ftp://ctm.ca.OpenBSD.org:/pub/OpenBSD-ctm">
         ftp://ctm.ca.OpenBSD.org:/pub/OpenBSD-ctm</a>
   <li> <a href="ftp://ctm.se.OpenBSD.org:/pub/OpenBSD-ctm">
         ftp://ctm.se.OpenBSD.org:/pub/OpenBSD-ctm</a>
   </ul>
</ul>

<p>
Wichtigen &Auml;nderungen und Hinweise &uuml;ber ctm werden hier bekannt gemacht:
<ul>
<li> misc@OpenBSD.org
<li> announce@OpenBSD.org
</ul>

<p>

<H3>Danksagungen</H3>
<ul>

<li> Poul-Henning Kamp (phk@FreeBSD.org) f&uuml;r ctm und die Hilfe 
     f&uuml;r die delta Generierung.

<li> Theo de Raadt (deraadt@theos.com) f&uuml;r OpenBSD und daf&uuml;r, dass
     er mir die Ressourcen gegeben hat, die ctm deltas auf cvs.OpenBSD.org zu erstellen
     (inzwischen werden sie an einem anderen Ort generiert) und
     f&uuml;r die Nameserver-Magie

<li> Todd C. Miller (millert@OpenBSD.org) f&uuml;r das Einrichten und Pflegen der
     ctm Mailinglisten

<li> Bob Beck (beck@OpenBSD.org), Artur Grabowski (art@OpenBSD.org),
     Magnus Holmberg (mho@OpenBSD.org) und
     Wolfram Schneider (wosch@FreeBSD.org) f&uuml;r das Einrichten des ftp space
     f&uuml;r die bases und deltas auf ctm.*OpenBSD.org

<li> Thomas Graichen (graichen@OpenBSD.org) f&uuml;r den Beginn mit ctm f&uuml;r
     OpenBSD und das Verwalten &uuml;ber all diese Jahre

<li> Wim Vandeputte (wvdeputte@OpenBSD.org) f&uuml;r das aktuelle Hosten von ctm 

<li> ... und all die anderen, die indirekt geholfen haben
</ul>

<P>
Viel Gl&uuml;ck!

<P>


<HR>

<p>
Bei Problemen, Anregungen, Berichten und Fragen wende dich bitte an den
'ctm maintainer'
<a href="mailto:hgw@d1906.inka.de">Hans G&uuml;nter Weigand</a>.
<p>
Das OpenBSD/CTM Logo wurde f&uuml;r das OpenBSD Projekt von 
   <a href="mailto:flipk@openbsd.org">Phillip F Knaack</a> entworfen.

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../back.gif" border="0" alt="OpenBSD" /></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
</br>
<small>
Originally [OpenBSD: ctm.html,v 1.13 ]
<br>
$Translation: ctm.html,v 1.4 2001/02/21 20:31:53 jufi Exp $
<br></small>
<small>$OpenBSD: ctm.html,v 1.3 2001/02/21 20:52:28 jufi Exp $</small>
</body>
</html>

<!DOCTYPE HTML PUBLIC  "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>CTM</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="Content-Language" content="de">
<meta name="resource-type" content="document">
<meta name="description" content="Die OpenBSD/CTM-Seite">
<meta name="keywords" content="openbsd,ctm">
<meta name="distribution" content="global">
<meta name="copyright" content="Dieses Dokument ist Copyright 1996-2004 by OpenBSD.">
</head>
<body bgcolor="#FFFFFF" text="#000000" link="#23238E">

<center>
<img alt="CTM for OpenBSD" src="../images/bsdctm.gif" width="401" height="126">
</center>

<h3><font color="#0000e0">Was ist CTM?</font></h3>

<p>
CTM ist ein System, das von Poul-Henning Kamp erschaffen wurde, um die
regelmäßigen Änderungen an einem Source-Tree per E-Mail verfügbar
zu machen. Das ist ein guter Weg, um beim ,-current source' auf dem
Laufenden zu bleiben, selbst wenn man eine langsame Internetverbindung
hat, z.B. via Modem.

<p>
OpenBSD-CTM enthält alle Module des OpenBSD-CVS-Repository
plus einige vereinzelte Gesamtversionen von verschiedenen Modulen.
CTM benutzt eine sehr kleine Bandbreite, um die Änderungen am
Source-Tree zu verschicken und komprimiert sie außerdem per
<tt><b>gzip -9</b></tt>. Im Gegensatz zu <a
href="cvsup.html">CVSup</a> ist CTM in normalem C geschrieben und daher
für jede Plattform verfügbar, die von OpenBSD unterstützt wird.
CTM implementiert ein sogenanntes ,push'-System, während alle anderen
Methoden, die Zugriff auf das OpenBSD-CVS-Repository nehmen,
,pull'-Systeme sind.
<p>
Bei <b>jeglichen</b> Problemen, Vorschlägen, Berichten und Fragen
bezüglich CTM wende dich bitte an den CTM-Maintainer
<a href="mailto:hgw@d1906.inka.de">Hans Günter Weigand</a>.
<small>(Bitte keine anderen OpenBSD-Leute um CTM-Unterstützung,
da sie mit anderen Dingen beschäftigt sind. Danke.)</small>

<h3><font color="#0000e0">Wie funktioniert es?</font></h3>

<p>
Die grundsätzliche Idee von CTM ist, dass du dich auf einer bestimmten
Mailingliste einschreibst, sie also abonnierst, um einen bestimmten
Teil des Source-Trees oder eines CVS-Moduls zu erhalten. Du erhältst
jeden Tag eine E-Mail mit den jeweiligen Änderungen dieses Tages. Ein
solcher Satz Änderungen wird <strong>delta</strong>
genannt. Tatsächlich macht der CTM-Server alle 12 Stunden neue Deltas.


<p>
Du beginnst mit einem Basissatz gegen den dann später die Deltas
gepatcht werden. Um mit CTM zu beginnen, musst du unbedingt die neueste
Version des Basissatz (base set) und alle danach folgenden Deltas
herunterladen; nachdem du diese verarbeitet hast, kannst du mit denen
weitermachen, die du per E-Mail erhältst. Die Basissätze sind jeweils in
1440-k-Teile aufgeteilt, damit man sie leichter über eine langsame
Verbindung herunterladen kann.

<p>
Basen werden nach 50 relativen Deltas erstellt, so dass du nie mehr als 
50 Deltas herunterladen musst, um auf den aktuellen Stand zu kommen.

<p>
Es gibt zur Zeit zwei verschiedene Arten von Basisdateien. Eine ganze
Zeit lang haben wir <tt><b>tar.gz</b></tt>-Dateien per Hand erstellt,
aber wir sind jetzt wieder bei echten CTM-Basisdeltas. Die letzteren
enthalten
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=md5&amp;sektion=1">md5(1)</a>-Prüfsummen
und werden automatisch erstellt, sind also etwas sicherer.
Du kannst diese beiden Arten anhand ihres Dateinamens unterscheiden. Ein
Beispiel für eine <tt><b>tar.gz</b></tt>-Datei ist
<tt><b>OpenBSD-cvs.1450.tar.gz</b></tt>, während ein CTM Basissatz
den folgenden Namen hätte: <tt><b>OpenBSD-cvs.1500A.gz</b></tt>. Siehe
unten für detaillierte Anweisungen.

<h3><font color="#0000e0">Wieviel Bandbreite braucht CTM?</font></h3>

<p>
Du musst den Basissatz haben und alle relativen Deltas bis zum
jetzigen Datum dazu, und zwar per FTP von der unten aufgeführten Liste.
Sie haben die folgenden Größen:

<ul>
<li> ungefähr 215 Mb für OpenBSD-cvs
<li> ungefähr 40 Mb für OpenBSD-cvs-x11
<li> ungefähr 65 MB für OpenBSD-cvs-xf4.
<li> ungefähr 83 Mb für OpenBSD-src
<li> ungefähr 36 Mb für OpenBSD-src-x11
<li> ungefähr 4 Mb für OpenBSD-ports
<br> Denke dran, dass das komprimierte Dateien sind -- ausgepackt sind
sie etwa fünfmal so groß.
<li> relative Deltas sind zwischen 10 k und 500 k und manchmal auch
     einige MB
<li> CTM teilt die Deltas immer in 100-kB-Mail-Messages, die dann
     automatisch wieder zusammengefügt werden
<li> Wenn ein Delta größer als 5 MB ist, wird es nicht per Mail
     versendet. Stattdessen bekommst du eine Benachrichtigung, dass du
     das Delta per FTP holen musst. Größere CTM-Aktualisierungen sind
     selten, passieren aber meist nach dem Importieren von großen Dingen
     wie etwa den binutils, Perl, gcc, X, etc. oder dem Einfügen
     eines CVS-Tags in den Source-Tree.
</ul>

<h3><font color="#0000e0">Wie benutzt man CTM?</font></h3>

<ul>
<li>Abonniere die CTM-Mailingliste für das Source-Set deiner Wahl.
<p>
   Es gibt verschiedene Mailinglisten zum Thema CTM. Es gibt eine Liste
   für die Aktualisierungen am CVS-Repository, eine Liste für den
   Source-Tree, eine Liste für den X11-Teil und eine für den Ports-Tree,
   sowie eine für die Log-Messages des CTM-Delta-Generators.
   <p>
<p>
Für das CVS-Repository (CVSROOT-, ports-, src- und www-Module, aber ohne
die X11- und XF4-Module):
<pre>
       echo subscribe OpenBSD-cvs | mail majordomo@OpenBSD.org
</pre>
Für das X11-Modul des CVS-Trees:
<pre>
       echo subscribe OpenBSD-cvs-x11 | mail majordomo@OpenBSD.org
</pre>
Für das XF4-Modul des CVS-Repositorys:
<pre>
       echo subscribe OpenBSD-cvs-xf4 | mail majordomo@OpenBSD.org
</pre>
Für eine ausgecheckte Kopie des src-Moduls:
<pre>
       echo subscribe OpenBSD-src | mail majordomo@OpenBSD.org
</pre>
Für eine ausgecheckte Kopie des X11-Moduls:
<pre>
       echo subscribe OpenBSD-src-x11 | mail majordomo@OpenBSD.org
</pre>
Für eine ausgecheckte Kopie des Ports-Trees:
<pre>
       echo subscribe OpenBSD-ports-CTM | mail majordomo@OpenBSD.org
</pre>
Für die CTM-Logliste:
<pre>
       echo subscribe CTM-log | mail majordomo@OpenBSD.org
</pre>

<p>
<li>Installiere das CTM-Programm aus einem Package oder aus der
Ports-Kollection.  Den Port gibt es unter
<tt><b>/usr/ports/devel/CTM</b></tt>.


</ul>
	<b>Hinweis:</b> Die Beispiele unten decken nur OpenBSD-cvs ab,
	einfach zur Klärung. Die anderen Sourcesets müssen auf die
	gleiche Art behandelt werden.

<p><ul>

<li>Lade den Basissatz von einer FTP-Site herunter. Du findest es im 
Unterverzeichnis <tt><b>base/OpenBSD-cvs</b></tt>. Hole alle Dateien in
diesem Verzeichnis. Wenn du sie alle hast, kannst du die Basisdatei
erstellen und sie mit folgenden Kommandos auspacken, abhängig vom
Dateityp, den du hast:

<pre>
       cat split/OpenBSD-cvs.1500A.gz.* &gt; OpenBSD-cvs.1500A.gz
       cd target
       CTM -v -v -v .../OpenBSD-cvs.1500A.gz
</pre>
<p>
oder

<pre>
       cat split/OpenBSD-cvs.1450.tar.gz.* &gt; OpenBSD-cvs.1450.tar.gz
       cd target
       tar -xzvf .../OpenBSD-cvs.1450.tar.gz
</pre>

wobei <tt><b>split</b></tt> das Verzeichnis ist, in dem du die
heruntergeladenen Dateien abgelegt hast und <tt><b>target</b></tt> der
Platz ist, den du für das Auspacken des Sourcesets gewählt hast.

<p>
Es ist nicht notwendig, die Dateien weiter zu behalten, sobald du
einmal einen kompletten Tree hast. Aber du kannst die Basissatz-Dateien
aus Backupgründen behalten. Auf jeden Fall musst du aber die Nummer des
Basissatzes notieren, bevor du weitermachen kannst.

<p>
<li>Jetzt musst du die Deltas holen, die generiert wurden, seit der
Basissatz erstellt wurde. Gehe auf einen der FTP-Server, die unten
aufgeführt sind, ins Unterverzeichnis <tt><b>OpenBSD-cvs</b></tt> und
lade jede Datei herunter, die <em>größer</em> ist als die Nummer des
benutzten Basissatzes. Dann verarbeite die Deltas:

<pre>
       cd target
       CTM -v -v -v deltas/OpenBSD-cvs.*
</pre>

<p>
wobei <tt><b>target</b></tt> das Verzeichnis ist, wo dein Sourceset-Tree
ist, und <tt><b>deltas</b></tt> der Platz ist, wo deine Deltas
gespeichert sind.
<p>

<li>Warte bis du dein erstes Delta von der Mailingliste bekommst:
<p>
<li>Entpacke und verarbeite das CTM-Delta mit Hilfe von
    <tt><b>CTM_rmail</b></tt>.
<p>

<pre>
       CTM_rmail -p /tmp -d deltas -b target folder
</pre>

<p>
wobei <tt><b>folder</b></tt> Der Mailordner ist, der die Delta-Mail
enthält. Das wird das CTM Delta dekodieren und im 
<tt><b>deltas</b></tt>-Verzeichnis speichern. Das Delta wird eine Datei
der Form <tt><b>OpenBSD-cvs.<var>XXXX</var>.gz</b></tt> sein, wobei
<var>XXXX</var> die Nummer des Deltas ist. Dann wird das Delta in den
Directory-Tree unter <tt><b>target</b></tt>, eingearbeitet, dem Platz,
an dem du den Basissatz ausgepackt hast.

<p>
Wiederhole diesen letzten Schritt jedesmal, wenn du ein Delta von der
Mailingliste erhälst. Wenn du magst, kannst du diesen Schritt mit Hilfe
von procmail, maildrop oder ähnlichen Programmen aus der
<a href="ports.html">Ports-Kollektion</a> automatisieren.
</ul>
<p>
Hier ist die Liste der FTP-Server die CTM-Deltas bereithalten:

<ul>
<li>Der Haupt-FTP-Server ist hier zu finden:
<p>
<a href="ftp://togetic.kd85.com:/pub/OpenBSD-ctm/">
     ftp://togetic.kd85.com:/pub/OpenBSD-ctm/
</a>.
<p>
Dieser Server wird normalerweise automatisch vom
CTM-Delta-Erzeugungsprozess aktualisiert.
Basissätze sind als eine große Datei im <tt><b>base</b></tt>-Verzeichnis
zu finden. Die split-Dateien sind in <tt><b>base-split</b></tt>.
</ul>
<ul>
<li><a href="ftp://CTM.se.OpenBSD.org:/pub/OpenBSD-CTM/">
     ftp://CTM.se.OpenBSD.org:/pub/OpenBSD-CTM/
</a>
<p>
Dieser Server wird durch CTM-Deltas aktualisiert, die von der
Mailingliste eintreffen. Er hat zusätzlich die ,split base'-Deltas im
<tt><b>base</b></tt>-Unterverzeichnis. Gespiegelt vom
<a href="ftp://togetic.kd85.com:/pub/OpenBSD-ctm/">
     ftp://togetic.kd85.com:/pub/OpenBSD-ctm/
</a>.
</ul>
 
<ul>
<li><a href="ftp://ctm.OpenBSD.org:/pub/OpenBSD-ctm/">
     ftp://ctm.OpenBSD.org:/pub/OpenBSD-ctm/
</a>
<p>
ist identisch mit
<p>
<li><a href="ftp://ctm.ca.OpenBSD.org:/pub/OpenBSD-ctm/">
     ftp://ctm.ca.OpenBSD.org:/pub/OpenBSD-ctm/
</a>
<p>
und ist ein ,mirror' von
<a href="ftp://ctm.se.OpenBSD.org:/pub/OpenBSD-ctm/">
     ftp://ctm.se.OpenBSD.org
</a>
.
</ul>
<p>
<b>HINWEIS:</b> <a href="mailto:hgw@d1906.inka.de">Ich</a> bin sehr 
an weiteren Sites interessiert, die die Deltas spiegeln möchten.

<p>

<h3><font color="#0000e0">Sollte ich den Source-Tree oder das
CVS-Repository nehmen?</font></h3>

<p>
Das hängt unter anderem von deinem verfügbaren Platz auf der Festplatte
ab. Da CTM nicht besonders gut mit Dateien umgehen kann, die außerhalb
des CTM-Prozesses  modifziert wurden, ist die bessere Wahl sicherlich
das <a href="anoncvs.html">CVS</a>-Repository. Du kannst deine
Arbeitskopie des Source-Trees dann aus deinem CVS-Repository auschecken,
einem ,stable branch' folgen und auch deine lokalen Änderungen in
deinem Source-Tree behalten. CVS ist klug genug, um deine lokalen
Änderungen einzufügen. Du kannst die gesamte Palette an CVS-Kommandos
mit Ausnahme von Kommandos wie etwa <tt><b>commit</b></tt> oder
<tt><b>cvs tag</b></tt> benutzen.

<p>
Der Nachteil ist der dafür notwendige Plattenplatz.  Ein ,checked-out'
Source-Tree benötigt etwa 370 MB, aber wenn du dein eigenes
CVS-Repository hast, brauchst du etwa 1 GB dafür, <b>plus</b>
zusätzliche 370 MB für den ,checked out' Tree.
Das beinhaltet noch nicht die 100 MB oder mehr, die du für erzeugte
Dateien während dem Erzeugen brauchst (abhängig von der Archiktektur),
sprich das Kompilieren der Sourcen.

<p>
Wenn du nur den Source-Tree holst, musst du dich mit lokalen
Veränderungen anfreunden. Ein Weg, um das zu tun, ist die Nutzung des
<b>union</b>-Dateisystems,
(siehe <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mount_union&amp;sektion=8">mount_union(8)</a>),
obwohl es auch schon Berichte gegeben hat, das <b>union</b>-Dateisystem
könne instabil sein, wenn die unteren und oberen Schichten auf dem
selben physischen Dateisystem residieren. Wenn du aber obere und untere
Schichten auf verschiedene Dateisysteme plazierst, solltest du dieses
Problem nicht haben. Ein Beispiel:

<p>
Nehmen wir an, dein CTM-aktualisierter Tree sei in
<tt><b>/usr/src-CTM</b></tt>, und dein realer Source-Tree, der, an dem
du deine Änderungen durchführst und deine ,builds' machst, sei in
<tt><b>/usr/src</b></tt>. <tt><b>/usr/src</b></tt> sollte anfangs ein
leeres Verzeichnis sein. Das folgende Kommando wird den union-mount
setzen:
<br><br>
<pre>
    <b>mount -t union -o -b /usr/src-CTM /usr/src</b>
</pre>
<p>

<br><br>
Änderungen an Dateien in <tt><b>/usr/src</b></tt> werden zu einer Datei,
die in <tt><b>/usr/src</b></tt> enthalten ist, und die in
<tt><b>src-ctm</b></tt> versteckt. Wenn Änderungen per CTM am
darunterliegendem <tt><b>src-ctm</b></tt>-Tree gemacht werden, werden
diese Änderungen <b>nicht</b> sichtbar sein, wenn es eine Datei in der
darüberliegenden Schicht gibt, die sie versteckt.

<p>
Du solltest regelmäßig das union-Dateisystem  ,unmounten'
und nach Dateien suchen, die es nur im union-Dateisystem gibt.

<pre>
       umount /usr/src
       find /usr/src -type f
</pre>

<p>
Die Befehle <tt><b>ls -W</b></tt> und <tt><b>rm -W</b></tt> werden auch
nützlich sein, da Objekte in <tt><b>/usr/src</b></tt>, die ,whiteouts'
im Namen beinhalten, auch Dateien in <tt><b>src-ctm</b></tt> verstecken.

<p>
Wenn du das CVS-Repository hast, kannst du das <tt><b>cvs
checkout</b></tt>-Kommando benutzen, um daraus einen Source-Tree zu
machen, und jedesmal, wenn du mit CTM ein Update durchgeführt hast,
kannst du ein <tt><b>cvs update</b></tt> benutzen, um deinen
Source-Tree zu aktualisieren.

<p>
Um ein erstes src-Repository zu bekommen:
<pre>
       cd /usr
       cvs -qd YOUR_CVS_REPOSITORY checkout -P src
</pre>
<p>
und nach jedem CTM-Update:
<pre>
       cd /usr/src
       cvs -q update -Pd
</pre>

<h3><font color="#0000e0">Wie stabil ist CTM für OpenBSD?</font></h3>

	CTM wird seit über fünf Jahren in OpenBSD benutzt und in FreeBSD
	noch länger. CTM ist ziemlich zuverlässig und stabil.

<h3><font color="#0000e0">Was hält die Zukunft für CTM bereit?</font></h3>

Es gibt zahlreiche mögliche Verbesserungen und (kleine) Änderungen.
Darunter sind:

<ul>
<li> CTM verschickt niemals ein Delta, das größer als 5 MB ist, per
     Mail. Das konnte man auf zwei Weisen ändern: Die maximale
     Deltagröße könnte erhöht werden oder eine Warteschlange, die nur
     eine bestimmte Menge an Mails pro Tag abschickt, könnte installiert
     werden. Wenn ein Delta z.B. 6 MB groß ist, wird es in 96
     Mailnachrichten aufgeteilt. Diese werden dann in eine Warteschlange
     gepackt. Am ersten Tag werden davon 50 Nachrichten versendet, am
     zweiten Tag 46, plus 4 der folgenden Deltas.

<li> Die CTM-Software könnte neu geschrieben oder zumindest besser
     repariert werden. Die C-Implementierung ist kein Beispiel guten
     Programmierens. Das wäre auch eine gute Gelegenheit zum Hinzufügen
     neuer Funktionalitäten, wie z.B. das Unterzeichnen von CTM-Deltas
     mit PGP.

</ul>

Maile <a href="mailto:hgw@d1906.inka.de">mir</a> deine Meinung oder
Wünsche!

<h3><font color="#0000e0">Mehr Informationen</font></h3>

Wenn du mehr über CTM lernen willst, ist das FreeBSD-Handbuch ein guter
Platz für Hilfe:

<ul>
<li> <a href="http://www.freebsd.org/doc/de_DE.ISO8859-1/books/handbook/ctm.html"
     >http://www.freebsd.org/doc/de_DE.ISO8859-1/books/handbook/ctm.html</a>
</ul>

Es gibt auch Manualseiten für alle CTM-Utilities.

<p>
Du kannst auch die OpenBSD-Mailinglisten oder mich selbst kontaktieren,
wenn du Schwierigkeiten mit CTM hast, obwohl meine Freizeit doch recht
eingeschränkt ist.

<p>
<h3><font color="#0000e0">Zusammenfassung:</font></h3>

<p>

<ul>
<li> Mailinglisten:

   <ul>
   <li><tt>echo subscribe OpenBSD-cvs | mail majordomo@OpenBSD.org</tt>
   <li><tt>echo subscribe OpenBSD-cvs-x11 | mail majordomo@OpenBSD.org</tt>
   <li><tt>echo subscribe OpenBSD-cvs-xf4 | mail majordomo@OpenBSD.org</tt>
   <li><tt>echo subscribe OpenBSD-src | mail majordomo@OpenBSD.org</tt>
   <li><tt>echo subscribe OpenBSD-src-x11 | mail majordomo@OpenBSD.org</tt>
   <li><tt>echo subscribe OpenBSD-ports-CTM | mail majordomo@OpenBSD.org</tt>
   <li><tt>echo subscribe CTM-log | mail majordomo@OpenBSD.org</tt>
   </ul>

<p>
<li> FTP (für Basissätze und relative Deltas):

   <ul>
   <li> <a href="ftp://togetic.kd85.com:/pub/OpenBSD-ctm/">
        ftp://togetic.kd85.com:/pub/OpenBSD-ctm/</a>
   <li> <a href="ftp://ctm.OpenBSD.org:/pub/OpenBSD-ctm/">
         ftp://ctm.OpenBSD.org:/pub/OpenBSD-ctm/</a>
   <li> <a href="ftp://ctm.ca.OpenBSD.org:/pub/OpenBSD-ctm/">
         ftp://ctm.ca.OpenBSD.org:/pub/OpenBSD-ctm/</a>
   <li> <a href="ftp://ctm.se.OpenBSD.org:/pub/OpenBSD-ctm/">
         ftp://ctm.se.OpenBSD.org:/pub/OpenBSD-ctm/</a>
   </ul>
</ul>

<p>
Wichtigen Änderungen und Hinweise über CTM werden auf der
announce@OpenBSD.org-Mailingliste bekannt gegeben.

<p>

<h3><font color="#0000e0">Danksagungen</font></h3>
<ul>

<li> Poul-Henning Kamp (phk@FreeBSD.org) für CTM und die Hilfe für die
     Deltagenerierung.

<li> Theo de Raadt (deraadt@theos.com) für OpenBSD und dafür, dass er
     mir die Ressourcen gegeben hat, die CTM-Deltas auf cvs.OpenBSD.org
     zu erstellen (inzwischen werden sie an einem anderen Ort generiert)
     und für die Nameserver-Magie

<li> Todd C. Miller (millert@OpenBSD.org) für das Einrichten und Pflegen
     der CTM-Mailinglisten

<li> Bob Beck (beck@OpenBSD.org), Artur Grabowski (art@OpenBSD.org),
     Magnus Holmberg (mho@OpenBSD.org) und
     Wolfram Schneider (wosch@FreeBSD.org) für das Einrichten des
     ,ftp space' für die Basissätze und Deltas auf ctm.*OpenBSD.org.

<li> Thomas Graichen (graichen@OpenBSD.org) für den Beginn mit CTM für
     OpenBSD und das Verwalten über all diese Jahre

<li> Wim Vandeputte (wvdeputte@OpenBSD.org) für das aktuelle Hosten von
     CTM 

<li> ... und all die anderen, die indirekt geholfen haben.
</ul>

<p>
Viel Glück!

<p>


<hr>

<p>
Das OpenBSD/CTM-Logo wurde für das OpenBSD-Projekt von 
   <a href="mailto:flipk@openbsd.org">Phillip F Knaack</a> entworfen.

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../back.gif" border="0" alt="OpenBSD" /></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: ctm.html,v 1.28 ]
$Translation: ctm.html,v 1.24 2005/05/23 11:28:34 paldium Exp $
-->
$OpenBSD: ctm.html,v 1.21 2005/05/24 04:28:05 saad Exp $
</small>
</body>
</html>

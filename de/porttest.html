<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1">
<meta name="resource-type" content="document">
<meta name="description" content="The OpenBSD Port Testing Guide">
<meta name="keywords" content="openbsd,ports, test">
<meta name="distribution" content="global">
<meta name="copyright" content="copyright 2002-2004 by OpenBSD.">
<meta http-equiv="Content-Language" content="de">
<title>OpenBSD Port Testing Guide</title>
</head>

<body text="#000000" bgcolor="#FFFFFF" link="#23238E">
    <a href="index.html"><img alt="[OpenBSD]" height="30" width="141" src=
    "../images/smalltitle.gif" border="0"></a> 

    <h2><font color="#e00000">Port Test-Guide</font></h2>
    <hr>

    <h2><font color="#0000e0">Index</font></h2>

    <ul>
      <li><a href="#Introduction">Einführung</a></li>

      <li><a href="#How">So wird's gemacht</a></li>

      <li><a href="#First">Erste Schritte</a></li>

      <li><a href="#Testing">Testen</a></li>

      <li><a href="#Commenting">Kommentieren</a></li>

      <li><a href="#More">Noch mehr Tests</a></li>
    </ul>
    <hr>

    <h2><a name="Introduction"><font color=
    "#0000e0">Einführung</font></a></h2>

    <p>Der <a href="ports.html">ports tree</a> ist ein riesiges 
    Stück Arbeit, das OpenBSD-Usern erlaubt, Programme von dritten
    zu benutzen, ohne Zeit mit Patchen, Konfigurieren oder dem Installieren
    jedes einzelnen Teils zu verschwenden. Diese Arbeit wir von einer Gruppe
    Freiwilliger gemacht, die ihre Zeit opfern, um Anwendungsprogramme
    über die ganze Breite der OpenBSD-Plattformen zu portieren und 
    zu testen. Viele Leute glauben, dass sie dabei nicht helfen können,
    weil sie nicht genug Fachwissen haben; das ist aber falsch, sie können
    den Programmieren durchaus helfen, schneller und besser zu arbeiten.
    </p>

    <h2><a name="How"><font color="#0000e0">So wird's gemacht</font></a></h2>

    <p>Testen von Updates oder neuen ports, die auf der 
    <a href="mail.html">ports Mailingliste</a> gemailt wurden. Indem du
    das tust, reduzierst du die Wartezeit bei commits und erhöhst auch die
    Anzahl von ports, die committed werden (viele ports werden mangels Tests
    gar nicht erst committed!).</p>

    <h2><a name="First"><font color="#0000e0">Erste Schritte</font></a></h2>

    <p>Der ports tree wird mittels
    <a href="../plus.html">OpenBSD-current</a> entwickelt; es gibt also keinerlei
    Garantie, dass neue Ports auch in den anderen Zweigen normal funktionieren.
    Das bedeutet auch, dass du dein System auf dem neusten Stand halten 
    solltest (Anweisungen dazu gibt es auf der
    <a href="anoncvs.html">anoncvs</a> Seite und in der
    <a href="../faq/upgrade-minifaq.html">FAQ</a>).
    Ausserdem ist es empfehlenswert sich auf den ports und den ports-changes
    <a href="mail.html">Mailinglisten</a> einzuschreiben. Auf dieser Weise
    wirst du über neue und geänderte ports informiert.</p>
    
    <h2><a name="Testing"><font color="#0000e0">Testen</font></a></h2>

    <p>Es gibt zwei Typen von Einsendungen auf den Mailinglisten; neue ports
    und Updates. Neue ports werden generell als tarball Attachments
    oder URLs gepostet. Es ist immer eine gute Idee, sie in ein Verzeichnis
    <tt>/usr/ports/mystuff/</tt> zu entpacken und von dort zu testen.
    Updates sind generell ein diff gegen den -current ports tree, also ist 
    es am besten, den port nach <tt>mystuff/</tt> zu kopieren und dann 
    diff anzuwenden, damit es nicht zu einem kaputten Tree kommt.
    </p>

    <p>Ein Schritt-für-Schritt Erzeugen des ports ist notwendig, um 
    sicherzustellen, dass jedes Ziel von 
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ports&amp;sektion=7&amp;">
    ports(7)</a> auch korrekt erreicht wird :</p>

    <ul>
      <li><i>fetch</i>
        <ul>
         <li>Damit wird überprüft, dass das/die distfile(s) 
         korrekt heruntergeladen werden. Versuche alle <tt>MASTER_SITES</tt>
         zu testen, die angegeben sind, damit auch alle möglichen Quellen
         geprüft sind.</li>
        </ul>

      <li><i>checksum</i>
        <ul>
         <li>Prüfe die Übereinstimmung zwischen heruntergeladenen 
         distfiles und den checksums in der <tt>distinfo</tt> Datei.</li>
        </ul>

      <li><i>extract</i>
        <ul><li>Jedes der distfiles sollte jedes abhängige Programm 
        (wie z.B. bzip2) vorher installieren.</li></ul>

      <li><i>patch</i>
        <ul>
         <li>Patches müssen ohne Warnmeldungen eingespielt werden.
         <li>Es sollten hinterher keinerlei <tt>.orig</tt> Dateien mehr im
             <tt>patches/</tt> Verzeichnis vorhanden sein.
         <li>Ein anderer weit verbreiteter Fehler ist das Einfügen eines 
             RCS tags in einen Patch; sobald der port in den CVS-Baum 
             eingecheckt wird und das RCS tag erweitert wird, führt 
             das zu Problemen.
        </ul>

      <li><i>configure</i>
        <ul>
         <li>Überprüfe, dass configure auch die Features deiner Plattform
            korrekt entdeckt und einbindet.
         <li>GNU libtool ist berüchtigt für ungewollte 'Features' auf OpenBSD,
             überprüfe also, dass der port eine aktuelle Version benutzt, die 
             korrekte Libraries auf deiner Architektur erzeugt.
         <li>Das configure Skript sollte keine bereits installierten Applikationen entdecken,
             die bereits auf deinem System installiert sind, ohne dass die expliziten 
	     Abhängigkeiten (dependencies) gesetzt sind.
        </ul>

      <li><i>build</i>
        <ul>
         <li>Prüfe auf Fehler beim build und verdächtige Warnungen.
         <li>Warnungen über <a href=
      "http://www.openbsd.org/cgi-bin/man.cgi?query=tmpnam&amp;sektion=3&amp;">
      tmpnam(3)</a> Probleme sollten mittels
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mkstemp&amp;sektion=3&amp;"> mkstemp(3)</a> 
         gelöst werden.
         <li>Versuche die <tt>SEPARATE_BUILD</tt> Variable auf 'concurrent' zu setzen und sieh nach,
         ob der build dann immer noch funktioniert.
         <li>Überpüfe, ob Abhängigkeiten von GNU make wirklich notwendig sind.
        </ul>

      <li><i>regress</i>
        <ul>
          <li>Suche nach Fehlern  (Tests ohne Ergebnis bedeuten alles ist okay).
        </ul>


      <li><i>fake</i>
        <ul>
         <li>Dieses Ziel installert die Applikation in ein fake Arbeits-Verzeichnis,
         um sicherzustellen, dass alle Dateien ohne Konflikte mit dem Basis-System 
         zusammengestellt werden können.
         <li>Der port sollte <b>niemals</b> Dateien ausserhalb des fake-Verzeichnisses
         installieren (wie z.B. in <tt>/usr/local</tt>).
         <li>GNU libtool hat manchmal Schwierigkeiten mit dem Linken von Libraries
         während des fake Prozesses auf manchen Architekturen.
        </ul>

      <li><i>package</i>
        <ul>
         <li>Das Erzeugen des package kann schiefgehen, wenn pkg/PLIST* und/oder
         pkg/PFRAG* nicht korrekt sind.</li>
        </ul>

      <li><i>install</i>
        <ul>
         <li>Packages sollten alle Dateien aus ihrer packaging List erfolgreich und
         mit den richtigen Dateirechten installieren. Sei besonders bei Dateien mit
         gesetztem setuid Bit vorsichtig. 
         <li>Stelle sicher, dass das package <tt>INSTALL</tt> Skript korrekt funktioniert,
         und auch keinerlei Dateien in <tt>/etc</tt> überschreibt.
        </ul>

      <li><i>deinstall</i>
        <ul>
         <li>Hiermit sollten alle Dateien entfernt werden, die vom package installiert 
	 wurden, mit Ausnahme derer in <tt>/etc</tt>.
         <li>Stelle sicher, dass das <tt>DEINSTALL</tt> Skript wie erwartet funkioniert.
        </ul>
    </ul>

    <p>Verbleibende <tt>pkg/</tt> Dateien wie DESCR und MESSAGE sollten auf 
    Grammatik und Tippfehler geprüft werden. Absätze werden mittels
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fmt&amp;sektion=1&amp;format=html">fmt(1)</a> 
    formatiert und bei etwa 70 Zeichen werden die Zeilen umgebrochen.</p>

    <h2><a name="Commenting"><font color="#0000e0">Kommentieren</font></a></h2>

    <p>Am Ende des Tests kommt das Allerwichtigste : Kommentare.
    Selbst, wenn der port wunderbar funktioniert, muss das kommentiert werden. 
    Wenn wir 10 Kommentare von Leuten haben, die besagen, dass der port prima 
    auf verschiedenen Architekturen läuft, wird der port schneller fertig. 
    Wenn er aber nicht wie gewünscht läuft, solltest du Informationen 
    beisteuern.
    Es gibt Tools, die bei diesem Problem helfen können, wie z.B. <a href=
    "http://www.openbsd.org/cgi-bin/cvsweb/ports/infrastructure/build/portslogger">
    portslogger</a>, der wie ein  "intelligentes tee" funktioniert, das die 
    Ausgaben in eine Logdatei lenkt.</p>

    <p>Beispiel :<br>
    </p>

    <div style="margin-left: 2em">
      <table border="0" cellpadding="3" width="90%">
        <tr>
          <td nowrap bgcolor="#EEEEEE">
<pre>
   # make install 2&gt;&amp;1 | /usr/ports/infrastructure/build/portslogger .
</pre>
          </td>
        </tr>
      </table>
    </div>
    <br>
     <br>
     

    <p>Das wird die Ausgabe in eine Log-Datei im aktuellen Verzeichnis umleiten.
    </p>

    <h2><a name="More"><font color="#0000e0">Noch mehr Tests</font></a></h2>

    <p>Prüfe das Makefile des ports auf Tippfehler, falsche Links,
    unbrauchbare oder fehlende Variablen, korrekte Lizenzen und Kategorien.
    Die Leute mit noch mehr Sachverstand können Dinge wie einen
    <i>lib-depends-check</i> machen, Patches untersuchen, aber auch diffs
    zur Korrektur von Bugs bereitstellen, flavors hinzufügen, oder 
    auch andere Erweiterungen vornehmen.</p>
    <p>Diese diffs sollten mit den <tt>-uNr --exclude=CVS</tt> Optionen 
    hergestellt werden.
    <tt>cvs diff -uN</tt> kann auch genutzt werden, um Patches gegen das
    CVS Repository zu machen.</p>
<hr>
<a href="index.html"><img src="../back.gif" height="24" width="24" alt="OpenBSD" border="0"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a><br>
<p>
<small>
<!--
Originally [OpenBSD: porttest.html,v 1.18 ]
$Translation: porttest.html,v 1.9 2005/01/18 14:33:43 paldium Exp $
-->
$OpenBSD: porttest.html,v 1.9 2005/01/18 17:16:48 jufi Exp $
</small>
</body>
</html>

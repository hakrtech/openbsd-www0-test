<!DOCTYPE HTML PUBLIC  "-//IETF//DTD HTML Strict//EN">
<html>
<head>
<title>OpenBSD/hppa</title>
<link rev=made href=mailto:www@openbsd.org>
<meta name="resource-type" content="documento">
<meta name="description" content="página de OpenBSD/hppa">
<meta name="keywords" content="openbsd,hppa">
<meta name="distribution" content="global">
<meta name="copyright" content="Este documento es copyright 1996-2002 de OpenBSD.">
</head>

<body bgcolor="#ffffff" text="#000000" link="#23238e">

<h2>OpenBSD/hppa</h2>

<hr>

Este porte est&aacute; dirigido hacia el soporte de los
siguientes modelos de HP 9000:
705, 710, <strong>712</strong>, <strong>715</strong>, 720,
<strong>725</strong>, 730, <strong>735</strong>, 742, 750,
<strong>755</strong>, A180, A180C, B132L, B132L+, B160L,
B180L, C100, C110, C132L, C160L, C180L, J200, J210, J210XC
(un modelo en negrilla indica que &laquo;funciona con
certeza&raquo;).
Tambi&eacute;n puede existir soporte para otras
configuraciones de equipos similares a &eacute;stas siempre y
cuando est&eacute;n basadas en:
<ul>
<li>procesadores HP PA-RISC 7000, 7100, 7150, 7100LC, 7200,
7300LC;
<li>controladoras de memoria Viper (&iquest;otras?);
<li>controladoras de bus/E/S LASI, ASP, WAX;
<li>y controladoras de bus EISA;
<li>procesador E/S SCSI NCR53C700, NCR53C710, NCR53C720;
<li>controladoras de v&iacute;deo Venom, CRX-8, CRX-24,
HCRX-8, HCRX-24;
<li>teclado y rat&oacute;n HIL o PS/2;
<li>los dispositivos EISA funcionan pero no sirven para el
arranque, a excepci&oacute;n de algunos fabricados por HP para
sistemas 700/800.
</ul>
Sistemas que podr&iacute;an funcionar:
<ul>
<li>sistemas PA2.0 (en modo de 32 bits);
<li>HP 9000 834, 835, 836, 844, 845, 846;
<li>HP 9000 E23, E25, E35, E45, E55;
<li>HP 3000 908, 918, 928, 938;
<li>Hitachi VQ200, VQ210, y otras estaciones de trabajo que no
son de HP;
<li>Precision Book de RDI Computer Corporation (poco probable)
<li>sistemas con placas HP VME y VXI de procesador
&uacute;nico (requieren VME como m&iacute;nimo).
</ul>
<br>
Se necesitan equipos y componentes para este proyecto;  mire
en la <a href="want.html">lista de equipamiento</a> (contacte
con <a href="mailto:mickey@openbsd.org">mickey</a>).

<h3><strong>Estado actual:</strong></h3>
El sistema arranca en modo mono-usuario mediante
<a href=http://hppa.lucifier.net/#boot_lif>im&aacute;genes de
arranque</a>.

<h3><strong>Cronolog&iacute;a:</strong></h3>
Este proyecto se inici&oacute; durante uno de esos d&iacute;as
en los que los &uacute;nicos sistemas operativos de
c&oacute;digo abierto que exist&iacute;an para m&aacute;qinas
HP PA-RISC eran
<a href="http://www.cs.utah.edu/projects/flux/lites/html">Lites</a>
y <a href="http://www.osf.org/mall/os/pa-mklinux">MkLinux</a>.
Estos dos constituyeron una fuente principal de
informaci&oacute;n y de c&oacute;digo para el desarrollo
inicial del porte de OpenBSD/hppa.
<a href="http://www.cs.utah.edu/~mike/hpbsd/hpbsd.html">HPBSD</a>
est&aacute; gravado por c&oacute;digo propietario de HP y
licencia de USL, y no est&aacute; disponible para el
p&uacute;blico.  Uno de los principales beneficios directos de
anteriores esfuerzos para desarrollar un porte es
(adem&aacute;s del c&oacute;digo) el soporte para HP PA-RISC
en <em>GCC</em> y <em>binutils</em>, que han permitido la
r&aacute;pida compilaci&oacute;n de un entorno de herramientas
cruzadas para el desarrollo.
<p>
M&aacute;s tarde, HP decidi&oacute; patrocinar el porte de
<a href="http://www.parisc-linux.org/">Linux</a> para
m&aacute;quinas PA-RISC, lo que supuso la liberaci&oacute;n de
parte de documentaci&oacute;n propietaria, aunque tienen como
objetivo unas clases de m&aacute;quinas 9000 distintas.
<p>
Aqu&iacute; puede ver una cronolog&iacute;a del porte
OpenBSD/hppa hasta el momento actual
<small>(sin fechas, pero use <a href="anoncvs.html">cvs</a>
para informarse sobre qu&eacute; ha ocurrido y
cu&aacute;ndo)</small>:
<ul>
<li>modo mono-usuario
<li>soporte para consola serie
<li>reescritura del controlador <em>sti</em> con las
especificaciones liberadas
<li>carga por <em>/boot</em> de la tabla de s&iacute;mbolos
del n&uacute;cleo del sistema (&iexcl;depuraci&oacute;n
simb&oacute;lica!)
<li>init(8) se ejecuta bien, pero el int&eacute;rprete
(<em>shell</em>) subsiguiente en el modo mono-usuario
<u>sale</u>, lo que probablemente significa que ha encontrado
alg&uacute;n problema mientras se iniciaba
<li><em>root</em> en nfs, <em>swap</em> en nfs
<li>etherneet basada en i82596 (if_ie), en modo de memoria no
en caché.
<li>escrita la mayor parte del c&oacute;digo del n&uacute;cleo
MD
<li>soporte para DDB a excepci&oacute;n de
<em>watchpoints</em> y <em>single-stepping</em>
<li>arranque de disco funciona
<li>controladora de placas de gr&aacute;ficos Stinger (*CRX-*)
<li>adaptadoras de bus LASI, ASP, WAX y EISA
<li>controladores <em>com</em>, <em>lpt</em> y <em>fdc</em>
(<em>fd</em> todav&iacute;a no)
<li>controladora PDC
<li>mecanismo de arranque del n&uacute;cleo funciona
<li>arranque por red funciona a trav&eacute;s de imagen LIF
<li>herramientas cruzadas compilan/funcionan
</ul>

<h4>Documentaci&oacute;n</h4>
<small>(la mayor parte ha sido liberada por HP para el
proyecto
<a href="http://www.parisc-linux.org/">Linux/parisc</a>)</small>:
<ol type="1">
<li>CPUs HP PA-RISC
  <ol type="a">
  <li><a href=http://ftp.parisc-linux.org/docs/PCXL_ers.ps>PA7100LC CPU ERS</a>
  <li><a href=http://ftp.parisc-linux.org/docs/pcxl2_ers.ps>PA7300LC CPU ERS</a>
  </ol>
<li><strong>C&oacute;digo dependiente del procesador /
Interfaz de c&oacute;digo dependientes de la E/S</strong><br>
<small>(cap&iacute;tulos seleccionados de <em>&quot;PA-RISC I/O Architecture Specification&quot;</em>)</small>
  <ol type="a">
  <li><a href=http://ftp.parisc-linux.org/docs/pdc32.pdf>PDC 1.1</a>
  <li><a href=http://ftp.parisc-linux.org/docs/iodc.pdf>IODC 1.1</a>
  <li><a href=http://ftp.parisc-linux.org/docs/ver_nums.pdf>Version and Identification Number Allocation</a>
  <li><a href=http://ftp.parisc-linux.org/docs/data_formats.pdf>Memory Data Formats 2.0</a>
  <li><a href=http://ftp.parisc-linux.org/docs/pdc.pdf>PDC Procedures 2.0</a>
  <li><a href=http://ftp.parisc-linux.org/docs/pdce.pdf>PDC Entry Points 2.0</a>
  <li><a href=http://ftp.parisc-linux.org/docs/os_interface.pdf>OS Interface 2.0</a>
  </ol>
<li><strong>controladoras de bus/puentes
(<em>bridges</em>)/adaptoras</strong>
  <ol type="a">
  <li><a href=http://ftp.parisc-linux.org/docs/lasi_ers.ps>LASI Core Bus Adapter (including lan, scsi, serial, lpt controllers)</a>
  <li><a href=http://ftp.parisc-linux.org/docs/dino_ers.ps>Dino PCI bridge</a>, y <a href=http://ftp.parisc-linux.org/docs/Dino_3_1_Errata.html>Errata</a>
  <li><a href=http://ftp.parisc-linux.org/docs/elroy_ers.ps>Elroy ERS (Edited for Open Source)</a>
  <li>Astro <a href=http://ftp.parisc-linux.org/docs/astro_intro.ps>Overview</a>, <a href=http://ftp.parisc-linux.org/docs/astro_errors.ps>Error handling</a>,<a href=http://puffin.external.hp.com/docs/astro_ioc.ps>R2I Operations</a>, <a href=http://puffin.external.hp.com/docs/astro_regmap.ps>Registers Map</a>, <a href=http://puffin.external.hp.com/docs/astro_runway.ps>Runway Interface</a>, <a href=http://puffin.external.hp.com/docs/astro_sysmap.ps>System Mamory Map</a>
  </ol>
<li><a href=http://ftp.parisc-linux.org/docs/sti.pdf>Stinger graphics</a>
<li><a href=http://www.lsilogic.com/techlib/techdocs/old_storage/770_2_0.pdf>NCR 53C700/710/720 SCSI I/O Processors</a>
<small>(el documento es en realidad para 770, que se supone
compatible)</small>
<li>Controladoras de Ethernet <a href="http://developer.intel.com/design/network/datashts/290219.htm">i82596DX/SX</a> y <a href="http://developer.intel.com/design/network/datashts/290218.htm">i82596CA</a> de Intel.
</ol>

<h4>Herramientas de compilaci&oacute;n cruzada:</h4>
<p>
Las herramientas <em>binutils</em> del &aacute;rbol de OpenBSD
actual no se pueden utilizar para generar herramientas
cruzadas.  Para compilarlas deber&aacute; utilizar un
&aacute;rbol de fuentes de OpenBSD 2.7, ya que con OpenBSD 2.8
y las versiones anteriores no funcionar&aacute;.
<p>
<pre>
cd /usr/src
sudo make TARGET=hppa cross-tools
</pre>
</p>
<p>
El proceso de compilaci&oacute;n de las herramientas cruzadas
puede fallar en la parte de <em>libc</em>;
consid&eacute;relo normal, ya que el soporte para
<em>libc</em> todav&iacute;a no est&aacute; acabado.
</p>
<a name="boot_lif"></a>
<h4>Compilaci&oacute;n del fichero boot.lif usando
herramientas cruzadas:</h4>
<p>
<pre>
cd /sys/arch/hppa/stand
make obj
set cross=(/usr/cross/hppa/usr/bin)
make MACHINE=hppa MACHINE_ARCH=hppa \
	&quot;AS=$cross/as&quot; &quot;CC=$cross/cc&quot; &quot;CXX=$cross/c++&quot; \
	&quot;CPP=$cross/cpp&quot; &quot;LD=$cross/ld&quot; \
	&quot;AR=$cross/ar&quot; &quot;STRIP=$cross/strip&quot; \
	&quot;LORDER=$cross/lorder&quot; &quot;NM=$cross/nm&quot; \
	&quot;RANLIB=$cross/ranlib&quot; &quot;SIZE=$cross/size&quot;
</pre>
</p>
<p>
Una imagen tendr&aacute; un fichero
<a href="http://hppa.lucifier.net/#boot_lif"><em>boot.lif</em></a>
para arrancar en el directorio <em>obj/</em>.
Esa imagen puede incluir una imagen del n&uacute;cleo para
<em>arranque sin disco</em> si ya hab&iacute;a una en
<em>sys/arch/hppa/compile/SHEPHERD_PIE/bsd</em>.
<br>
El proceso de compilaci&oacute;n cruzada del n&uacute;cleo del
sistema es parecido al del arranque;  consulte las opciones y
la configuraci&oacute;n del n&uacute;cleo en
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&apropos=0&sektion=0&manpath=OpenBSD+Current&format=html">config(8)</a>
y
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=options&apropos=0&sektion=0&manpath=OpenBSD+Current&format=html">options(8)</a>.
</p>
<h4>Desarrollo reciente:</h4>
<pre>
BOOT_ADMIN&gt; boot lan isl

Booting





&gt;&gt; OpenBSD/hppa BOOT 0.6
boot&gt; boot bsd
booting lf0a:/bsd: fstat1695744+65536+225280 [168316+57624]=0x22e298 start=0x12
000
[ bsd ELF symbol table not valid: bad magic ]
[ using 231900 bytes of bsd a.out symbol table ]
Copyright (c) 1982, 1986, 1989, 1991, 1993
The Regents of the University of California.  All rights reserved.
Copyright (c) 1995-2001 OpenBSD. All right Reserved.  http://www.OpenBSD.org

OpenBSD 3.0-current (SHEPHERD_PIE) #334: Sat Dec  1 23:28:05 EST 2001
    mickey@lucifier.net:/sys/arch/hppa/compile/SHEPHERD_PIE
HP9000/712/100 (King Gecko) PA-RISC 1.1
real mem = 67108864 (73728 reserved for PROM, 50331648 used by OpenBSD)
avail mem = 55824384
using 1630 buffers containing 6676480 bytes of memory
mainbus0 (root) [flex fff80000]
pdc0 at mainbus0
mem0 at mainbus0 offset ffbf000: viper rev 0, ctrl 40400102&lt;eisa_prf&gt; &gt;&gt; 4040010b
cpu0 at mainbus0 offset ffbe000 irq 31: PCXL rev 6, lev 1, cat A, 80 MHz clock
cpu0: shadows, 128K/128K D/I cache, 64 shared TLB, 8 shared BTLB
lasi1 at mainbus0 offset 500000: rev 3.0
gsc1 at lasi1
com1 at gsc1 offset 5000
ie1 at gsc1 offset 7000: LASI/i82596CA v1.0, address 08:00:09:87:b5:76
lasi0 at mainbus0 offset 100000 irq 28: rev 3.0
gsc0 at lasi0
&quot;Optional RJ-16&quot; at gsc0 (type a, sv 8d) offset 4060 not configured
&quot;Optional RJ-16&quot; at gsc0 (type a, sv 8d) offset 4040 not configured
&quot;PS/2 port&quot; at gsc0 (type a, sv 84) offset 8100 not configured
&quot;PS/2 port&quot; at gsc0 (type a, sv 84) offset 8000 not configured
&quot;floppy controller&quot; at gsc0 (type a, sv 83) offset a000 not configured
harmony0 at gsc0 offset 4000 irq 13
&quot;teleshare tty0&quot; at harmony0 not configured
&quot;teleshare tty1&quot; at harmony0 not configured
lpt0 at gsc0 offset 2000 irq 7
com0 at gsc0 offset 5000 irq 5
ie0 at gsc0 offset 7000 irq 8: LASI/i82596CA v1.0, address 08:00:09:87:b5:75
&quot;Core SCSI&quot; at gsc0 (type a, sv 82) offset 6000 not configured
sti0 at mainbus0 offset 8000000: HPA208LC1280 rev 8.04;7
sti0: 2048x1024 frame buffer, 1280x1024x8 display, offset 0x0
sti0: 8x16 font type 1, 16 bpc, charset 0-255
wsdisplay0 at sti0

</pre>
</p>
<small>informaci&oacute;n obtenida a mano desde la pantalla,
perd&oacute;n por los errores</small>
<hr>
Para usar los ficheros
<a href="http://hppa.lucifier.net/#boot_lif">boot.lif</a>, debe
preparar su servidor y dar instrucciones a su m&aacute;quina
para el arranque desde la red:
<ol>
  <li>Configuraci&oacute;n del servidor</li><br>
    <ul>
    <li>En m&aacute;quinas viejas (705, 7[1235]0, 715 vieja)
	<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rbootd&apropos=0&sektion=0&manpath=OpenBSD+Current&format=html">rbootd</a>
	debe ser configurado e iniciado.<br>
      <ul>
      <li><strong>/etc/<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rbootd&apropos=0&sektion=0&manpath=OpenBSD+Current&format=html">rbootd</a>.conf</strong>
      contiene una sola l&iacute;nea por cada m&aacute;quina
      que se quiera arrancar desde el servidor.  Cada
      l&iacute;nea contiene la direcci&oacute;n ethernet de la
      m&aacute;quina hppa cliente, y el nombre de archivo del
      fichero que se debe cargar desde el servidor de tftp.
      Por ejemplo:
	<pre>
	8:0:9:70:c4:11    <a href="#boot_lif">boot.lif</a>    # 9000/720
	8:0:9:19:fb:a0    <a href="#boot_lif">boot.lif</a>    # 9000/725
	</pre>
      </li>
      </ul>
    </li>
    <li>M&aacute;quinas nuevas (712, 715 nueva, 725);  no
    buscar&aacute; <em>rbootd</em>, pero requiere de una
    configuraci&oacute;n de <strong>bootp</strong>.<br>
      <ul>
      <li><strong>/etc/<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bootptab&apropos=0&sektion=5&manpath=OpenBSD+Current&format=html">bootptab</a></strong>
      contiene un bloque de informaci&oacute;n para cada
      m&aacute;quina.  Por ejemplo:
	<pre>
	# 9000/715
	boron:\
        	ha=0800095f5a6e:\
        	bf=boot.lif:\
        	hd=:\
        	ht=ethernet:\
        	ip=10.0.1.143:\
        	rp=/usr/local/exports/boron/root:\
        	sm=255.255.255.0:\
        	td=/tftpboot:
	</pre>
      </li>
	<li>
	Cree el directorio <em>/tftpboot</em> y ponga
	<a href="#boot_lif">boot.lif</a> en &eacute;l.<br> 
	</li>
	<li>
	Escriba una entrada para su hppa en el fichero
	<strong>/etc/ethers</strong>:<br>
	<pre>
	08:00:09:5f:5a:6e	boron
	</pre>  
	</li>
	<li>
	Escriba una entrada para 'boron' en el fichero
	<strong>/etc/hosts</strong>:<br>
	<pre>
	10.0.1.143	boron
	</pre>  
	</li>
	<li>
	Cree un directorio
	<em>/usr/local/exports/boron/root</em> y ponga
	<a href="http://hppa.lucifier.net/root/dev/MAKEDEV">/dev/MAKEDEV</a>, <a href="http://hppa.lucifier.net/root/sbin/init">/sbin/init</a> y <a href="http://hppa.lucifier.net/root/bin/ksh">/bin/ksh</a>		
	en sus respectivos sitios.
	</li>
	<li>
	Escriba una entrada en <strong>/etc/exports</strong>
	para el directorio ra&iacute;z sea exportado al
	cliente:
	<pre>
	/usr/local/exports/boron/root boron
	</pre>  
	</li>
	<li>
	Recuerde que tendr&aacute; que activar
	<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bootpd&apropos=0&sektion=8&manpath=OpenBSD+Current&format=html">bootpd</a> y <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tftpd&apropos=0&sektion=8&manpath=OpenBSD+Current&format=html">tftpd</a>
	en <em>/etc/inetd.conf</em>, y reiniciar
	<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=inetd&apropos=0&sektion=8&manpath=OpenBSD+Current&format=html">inetd</a>.
	</li>
      	<li>
	Adem&aacute;s, acu&eacute;rdese de activar
	<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=nfsd&apropos=0&sektion=8&manpath=OpenBSD+Current&format=html">nfs_server</a>, <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rarpd&apropos=0&sektion=8&manpath=OpenBSD+Current&format=html">rarpd</a> y <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=portmap&apropos=0&sektion=8&manpath=OpenBSD+Current&format=html">portmap</a> 
	en <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf&apropos=0&sektion=8&manpath=OpenBSD+Current&format=html">/etc/rc.conf</a>.
	</li>
	</ul>
    </li>
    <li>Para m&aacute;s informaci&oacute;n sobre la
    configuraci&oacute;n del servidor para el arranque por red
    en general, v&eacute;ase
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=diskless&apropos=0&sektion=0&manpath=OpenBSD+Current&format=html">diskless(8)</a>.</li>
    </ul>
  <li>Arranque por red del cliente</li><br>
  <ul>
    <li>BOOT_ADMIN<br>
    Para llegar al punto de BOOT_ADMIN, debe pulsar
    <em>\<esc\></em> mientras la m&aacute;quina est&aacute;
    arrancando.  Una vez que haya sondeado los dispositivos
    que arrancan, escriba 'a' para el punto de 'BOOT_ADMIN'.
    </li>
    <li>orden de arranque por red<br>
    Cuando se encuentre en el punto de 'BOOT_ADMIN', escriba:
<pre>
	BOOT_ADMIN&gt; boot lan isl
</pre>
    &iexcl;y ya estar&aacute; iniciando <em>boot.lif</em>!
    </li>
  </ul>
</ol>
<hr>
<a href="plat.html"><img height="24" width="24" src="../back.gif" border="0" alt="OpenBSD"></a> 
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
Originally [OpenBSD: hppa.html,v 1.58 2002/03/08 23:31:08 mickey Exp ]<br>
$Translation: hppa.html,v 1.26 2002/03/09 16:31:46 horacio Exp $<br>
$OpenBSD: hppa.html,v 1.22 2002/03/11 21:41:54 jufi Exp $
</small>

</body>
</html>

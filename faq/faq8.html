<html>
<head>
<title>8.0 - General Questions</title>
<link rev=  "made"          href= "mailto:www@openbsd.org">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 1998-2002 by OpenBSD.">
</head>

<body bgcolor= "#ffffff" text= "#000000">

<img alt="[OpenBSD]" height=30 width=141 src="../images/smalltitle.gif">
<p>
<h2><font color=#e00000>8.0 - General Questions</font><hr></h2>
   
<p>
<ul><h3>Table of Contents</h3>
<!-- li><a href= "#Kerberos"    >8.1 - What are these kerberos warnings when I first login?</a> -->
<li><a href= "#VirtTerms"   >8.2 - How do I change virtual terminals? 
  (I386 ONLY)</a>
<li><a href= "#LostPW"      >8.3 - I forgot my root password..... What 
  do I do!</a>
<li><a href= "#X"           >8.4 - X won't start, I get lots of error 
  messages</a>
<li><a href= "#CVS"         >8.5 - What is CVS, and how do I use 
  it?</a>
<li><a href= "#Ports"       >8.6 - What is the ports tree?</a>
<li><a href= "#Packages"    >8.7 - What are packages?</a>
<li><a href= "#NoFloppy"    >8.8 - Is there any way to use my floppy 
  drive if it's not attached during boot?</a>
<li><a href= "#Bootloader"  >8.9 - OpenBSD Bootloader (<i>i386 
  specific</i>)</a>
<li><a href= "#SKey"        >8.10 - Using S/Key on your OpenBSD 
  system</a>
<li><a href= "#MacTime"     >8.11 - Why is my Macintosh losing so 
  much time?</a>
<li><a href= "#SMP"         >8.12 - Does OpenBSD support SMP?</a>
<li><a href= "#TTY"         >8.13 - I sometimes get Input/output error 
  when trying to use my tty devices</a>
<li><a href= "#Netscape"    >8.14 - Where can I find a Netscape binary 
  for OpenBSD?</a>
<li><a href= "#mg"          >8.15 - How do I use the mg editor?</a>
<li><a href= "#ksh"         >8.16 - Ksh does not appear to read my 
  .profile!</a>
<li><a href= "#motd"        >8.17 - Why does my /etc/motd file get 
  written over when I modified it?</a>
<li><a href= "#wwwsolaris"  >8.18 - Why does www.openbsd.org run on 
  Solaris?</a>
<li><a href= "#PCI"         >8.19 - I'm having problems with PCI devices 
  being detected</a>
<li><a href= "truetype.html">8.20 - Antialiased and TrueType fonts in 
  XFree86</a>
<li><a href= "#Journaling"  >8.21 - Does OpenBSD support any journaling 
  fileystems ?</a>
<li><a href= "#RevDNS"      >8.22 - Reverse DNS or Why is it taking so 
  long for me to log in?</a>
</ul>
<hr> 

<br>

<p>
<!-- a name= ""></a>
<h2></h2>
-->


<br>

<p>
<a name= "VirtTerms"></a>
<a name= "8.2"></a>
<h2>8.2 - How do I change virtual terminals?</h2>

Only the i386 platform supports virtual terminals.

<p>
On i386 systems, simply type <kbd>[Ctrl]-[Alt]-[F1..F4]</kbd>

<p>
You can also use
virtual terminals when using X. For example, If you start X on term 1, and
switch with [Ctrl]-[Alt]-[F2] to term 2, X will seem to disappear and will
not come back by simply switching back to term 1. You must
[Ctrl]-[Alt]-[F5] to get your X display back.

<br>

<p>
<a name= "LostPW"></a>
<a name= "8.3"></a>
<h2>8.3 - I forgot my root password, what do I do now?</h2>

<p>
A few steps to recovery
<ol>
<li>Boot into single user mode. For i386 arch type boot -s at the boot prompt.
<li>mount the drives.
<ul>
<kbd># <b>fsck -p / &amp;&amp; mount -u /</b></kbd>
</ul>
<li>If /usr is not the same partition that / is (and it shouldn't be) then
you will need to mount it, also
<ul>
<kbd># <b>fsck -p /usr &amp;&amp; mount /usr</b></kbd>
</ul>

<li>run <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=passwd&sektion=1">passwd(1)</a>
<li>boot into multiuser mode.. and <i>remember</i> your password!
</ol>

<p>
<a name= "X"></a>
<a name= "8.4"></a>
<h2>8.4 - X won't start, I get lots of error messages</h2>

<p>
If you have X completely set up and you are using an XF86Config that you know 
works then the problem most likely lies in the machdep.allowaperture. You also 
need to make sure that both:

<ul><pre>
option XSERVER
option APERTURE
</pre></ul>

<p>
are in your kernel configuration. [BOTH of these are in the GENERIC kernel] 

<p>
Then you need to edit <i>/etc/sysctl.conf</i> and set 
<b>machdep.allowaperture=2</b>. This will allow X to access the aperture
driver. This would be set up if the question during install about
whether or not you would be running X was answered correctly. OpenBSD
requires for all X servers that the aperture driver be set, because it
controls access to the I/O ports on video boards. 

<p>
For other X problems on the i386, consult the XFree86 Online Documentation at 
<a href= "http://www.xfree86.org/support.html">http://www.xfree86.org/support.html</a>.

<p>
<a name= "CVS"></a>
<a name= "8.5"></a>
<h2>8.5 - What is CVS? and How do I use it?</h2>

<p>
CVS is what the OpenBSD project uses to control changes to the source
code.  CVS stands for Concurrent Versions System. You can read more
about CVS at 
<a href="http://www.cvshome.org/">http://www.cvshome.org/</a>. CVS can
be used by the end user to keep up to date with source changes, and
changes in the ports tree. CVS makes it extremely simple to download the
source via one of the many CVS mirrors for the project.


<h3>How to initially setup your CVS environment</h3>

<p>
You can retrieve 
the sources from one of the OpenBSD AnonCVS servers.
These servers are listed on 
<a href="../anoncvs.html">http://www.openbsd.org/anoncvs.html</a>. 
Once you have chosen a server you need to choose which 
module you are going to retrieve. There are three main modules 
available for checkout from the CVS tree. These are:

<ul>
<li><i>src</i> - The src module has the complete source code for OpenBSD. This includes userland and kernel sources.
<li><i>ports</i> - The ports module holds all you need to have the complete OpenBSD ports tree. To read more on the OpenBSD ports tree, read <a href="faq8.html#Ports">FAQ 8, Ports</a> of the OpenBSD FAQ.
<li><i>xf4</i> - The xf4 module contains the source to compile XFree 4.
</ul>

<p>
Now that you have decided which module that you wish to retrieve,
there is one more step left before you can retrieve it. You must 
decide which method to use. CVS by default retrieves files using 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&sektion=1">ssh(1),</a> 
but some AnonCVS servers allow for the use of 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rsh&sektion=1">rsh.</a> 
For those of you behind a firewall there are also the options of pserver
and some AnonCVS servers run ssh on port 2022. Be sure to check 
<a href="../anoncvs.html">http://www.openbsd.org/anoncvs.html</a> for
which servers support what protocols. Next I will show how to do a
simple source checkout. Here I will be using an AnonCVS server located
in the U.S., but remember that if you are outside of the U.S you need to
use a server that is located nearby.  There are many AnonCVS servers
located throughout the world, so choose one nearest you. I will also be
using ssh to retrieve the files.

<ul><pre>
$ <strong>export CVSROOT=anoncvs@anoncvs.usa.openbsd.org:/cvs</strong>
$ <strong>cvs get src</strong>
Warning: Remote host denied X11 forwarding, perhaps xauth program could not be run on the server side.
cvs checkout: in directory src:
cvs checkout: cannot open CVS/Entries for reading: No such file or directory
cvs server: Updating src
U src/Makefile
[snip]
</pre></ul>

<p>
Notice here also that I set the CVSROOT environmental variable. 
This is the variable that tells 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&sektion=1">cvs(1)</a>
which AnonCVS server to use. This can also be specified using the 
<i>-d</i> option. For example:

<ul>
<pre>
$ <strong>cvs -d anoncvs@anoncvs.usa.openbsd.org:/cvs get src</strong>
</pre>
</ul>

<p>
These commands should be run in <i>/usr</i>, which will then create the
directories of <i>/usr/src</i>, <i>/usr/ports</i>, and <i>/usr/www</i>.
Depending, of course, on which module you checkout. You can download
these modules to anywhere, but if you wanted to do work with them (ie
make build ), it is expected that they be at the place above. 

<h3>Keeping your CVS tree up-to-date</h3>

<p>
Once you have your initial tree setup, keeping it up-to-date is the easy
part. You can update your tree at any time you choose, some AnonCVS
servers update more often then others, so again check 
<a href="../anoncvs.html">http://www.openbsd.org/anoncvs.html</a>.  In
this example I will be updating my www module from
anoncvs.usa.openbsd.org.  Notice the -q option that I use, this makes
the output not so verbose coming from the server. 

<ul><pre>
$ <strong>echo $CVSROOT</strong>
anoncvs@anoncvs.usa.openbsd.org:/cvs
$ <strong>cvs -q up -Pd www</strong>
Warning: Remote host denied X11 forwarding, perhaps xauth program could not be run on the server side.
U www/want.html
M www/faq/faq8.html
ericj@oshibana:~&gt;
</pre></ul>

<h3>Other cvs options</h3>

<p>
For some, bandwidth and time are serious problems when updating
repositories such as these. So CVS has a -z[1-9] option which uses gzip to
compress the data. To use it, do -z[compression-level], for instance, -z3
for a compression level of 3.

<p>
<a name= "Ports"></a>
<a name= "8.6"></a>
<h2>8.6 - What is the ports tree?</h2>

<p>
The ports tree is a set of Makefiles that download, patch, configure and
install userland programs so you can run them in OpenBSD environment
without having to do all that by hand. You can get the ports tree from
any of the OpenBSD FTP servers in
<kbd>/pub/OpenBSD/3.1/ports.tar.gz</kbd>. The most recent ports are
available via the 'ports' cvs tree, or
<kbd>/pub/OpenBSD/snapshots/ports.tar.gz</kbd>.  For most of you
however, packages will be a much better option. Packages are created
from ports and are already compiled and ready to use. To read more on
packages read <a href="#Packages">FAQ 8, Packages</a>.

<h3>Important note about keeping your system and ports in sync</h3>
OpenBSD has three "active" versions at any point in time:
<ul>
<li><a href="../orders.html">Release</a>: What is on the CD.
<li><a href="../stable.html">Stable</a>: Release, plus security and 
  reliability enhancements<br>
<li><a href="upgrade-minifaq.html">Current</a>: The development version 
  of OpenBSD.
</ul>
<strong>DO NOT mix versions of Ports and OpenBSD!</strong>
<p>
If your system is Release, use the Release version of the ports tree.
Don't try to use a -Current version of the Ports tree on a -Release or
-Stable system.  Not only is it not likely to work, you will irritate
people when you ask for help about why "nothing seems to work!"  Note
that there is a <a href="../stable.html">-Stable</a> branch of the Ports
tree as well, where critical fixes to -Release ports will be made.  

<p>
Yes, this really does mean a wonderful new port will not typically
work on your "older" system -- even if that system was -current just a
few weeks ago.

<p>
If you do not have the ports tree installed, you can download it via any
of OpenBSD's <a href="../ftp.html">FTP servers</a>, or of course, from
the <a href=../orders.html>CDROM</a>.  The file is
<kbd>ports.tar.gz</kbd>, and you want to untar this in the /usr
directory, which will create /usr/ports, and all the directories under
it.  For example:

<pre>
     $ <strong>ftp ftp://ftp.openbsd.org/pub/OpenBSD/3.1/ports.tar.gz</strong>
     $ <strong>sudo cp ports.tar.gz /usr</strong>
     $ <strong>cd /usr; sudo tar xfz ports.tar.gz</strong>
</pre>

<p>
A snapshot of the ports tree is also created daily and can be downloaded
from any of the <a href="../ftp.html">OpenBSD FTP servers</a> as
<kbd>/pub/OpenBSD/snapshots/ports.tar.gz</kbd>.  If you are installing a
snapshot of OpenBSD, you should use a matching snapshot of ports.
Again, make sure you keep your ports tree and your OpenBSD system in
sync.

<h3>What ports are available? and how do i find them?</h3>

<p>
Use the ports tree to search for keywords. To do this use <kbd>make
search key="searchkey"</kbd>. Here is an example of a search for 'samba':

<ul><pre>
$ <strong>make search key=&quot;samba&quot;</strong>
Port:   samba-2.2.2
Path:   net/samba
Info:   SMB and CIFS client and server for UNIX
Maint:  Daniel Hartmeier <daniel@benzedrine.cx>
Index:  net
B-deps: devel/autoconf
R-deps:
Archs:  any

Port:   ADMsmb-0.2
Path:   /usr/ports/security/ADMsmb
Info:   Samba security scanner
Maint:  dugsong@monkey.org
Index:  security
B-deps:
R-deps:
Archs:  any
</pre></ul>

<h3>Installing Ports</h3>

<p>
Ports are set up to be EXTREMELY easy to make and install. Here is an
example install for someone wanting to install the X11 program xfig.
You'll notice the dependencies are automatically detected and completed:

<p>
First you need to cd to the dir of the program you want. If you are
searching for a program, you can either update your locate database, or
use the search function talked about below. Once you are in the dir of
the program you want, you can just type <kbd>make install</kbd>. For
example. <br>

<ul>
<pre>
$ <strong>sudo make install</strong>
===&gt;  Extracting for xfig-3.2.2
===&gt;  xfig-3.2.2 depends on shared library: jpeg.62. - /usr/local/lib/libjpeg.so.62.0 found
===&gt;  xfig-3.2.2 depends on shared library: Xaw3d.6. - not found
===&gt;  Verifying install for Xaw3d.6. in /usr/ports/x11/Xaw3d
&gt;&gt; Xaw3d-1.3.tar.gz doesn't seem to exist on this system.
&gt;&gt; Attempting to fetch from ftp://crl.dec.com/pub/X11/contrib/widgets/Xaw3d/R6.1/.
Connected to crl.dec.com.
220 crl.dec.com FTP server (Digital UNIX Version 5.60) ready.
331 Guest login ok, send ident as password.
230 Guest login ok, access restrictions apply.
Remote system type is UNIX.
Using binary mode to transfer files.
200 Type set to I.
250 CWD command successful.
250 CWD command successful.
Retrieving pub/X11/contrib/widgets/Xaw3d/R6.1/Xaw3d-1.3.tar.gz
local: Xaw3d-1.3.tar.gz remote: Xaw3d-1.3.tar.gz
227 Entering Passive Mode (192,58,206,2,5,14)
150 Opening BINARY mode data connection for Xaw3d-1.3.tar.gz (0.0.0.0,0) (290277 bytes).
100% |**************************************************|   283 KB    00:00 ETA
226 Transfer complete.
290277 bytes received in 101.09 seconds (2.80 KB/s)
221 Goodbye.
===&gt;  Extracting for Xaw3d-1.3
/bin/mkdir -p /usr/ports/x11/Xaw3d/work/xc/lib/Xaw3d/X11/Xaw3d
cd /usr/ports/x11/Xaw3d/work/xc/lib/Xaw3d/X11/Xaw3d; ln -sf ../../*.h .
===&gt;  Patching for Xaw3d-1.3
===&gt;  Configuring for Xaw3d-1.3
mv -f Makefile Makefile.bak
imake -DUseInstalled -I/usr/X11R6/lib/X11/config
make Makefiles
[snip]
</pre></ul>

<h3>Using Flavors</h3>
<p>
Many of the applications in the ports tree support different install
options, called <i>flavors</i>.  If a port comes in multiple flavors,
you can use these options simply by setting an environment variable
before you compile the port.  If multiple features are needed, the
FLAVOR variable can be set to a space-delimited list of the supported
and desired flavors. Currently, many ports have flavors that include
database support, support for systems without X, or network additions
like SSL and IPv6.

<ul>
<pre>
$ <strong>pwd</strong>
/usr/ports/net/mtr
$ <strong>make show=FLAVORS</strong>
curses
$ <strong>env FLAVOR="curses" make</strong>
===>  mtr-0.42-curses depends on: gmake-3.79.1 - found
===>  Checking files for mtr-0.42-curses
>> mtr-0.42.tar.gz doesn't seem to exist on this system.
>> Attempting to fetch /usr/ports/distfiles/mtr-0.42.tar.gz from ftp://ftp.bitwizard.nl/mtr/.
[snip]
$ <strong>sudo env FLAVOR="curses" make install</strong>
===>  Faking installation for mtr-0.42-curses
===>  Building package for mtr-0.42-curses
Creating package /usr/ports/packages/i386/All/mtr-0.42-curses.tgz
Using SrcDir value of /usr/ports/net/mtr/w-mtr-0.42-curses/fake-i386-curses/usr/local
Creating gzip'd tar ball in '/usr/ports/packages/i386/All/mtr-0.42-curses.tgz'
===>  Installing mtr-0.42-curses from /usr/ports/packages/i386/All/mtr-0.42-curses.tgz
</pre>
</ul>

<h3>Listing Installed ports/packages</h3>
<p>
You can see a list of both ports and packages by using the pkg_info command.
<ul>
<pre>
$ <strong>/usr/sbin/pkg_info</strong>
zsh-4.0.4           The Z shell.
screen-3.9.11       A multi-screen window manager.
emacs-21.1          GNU editing macros.
tcsh-6.10.00        An extended C-shell with many useful features.
bash-1.14.7         The GNU Borne Again Shell.
zip-2.3             Create/update ZIP files compatible with pkzip.
ircii-20011210      An enhanced version of ircII, the Internet Relay Chat client
ispell-3.2.06       An interactive spelling checker.
tin-1.4.5           TIN newsreader (termcap based)
procmail-3.22       A local mail delivery agent.
strobe-1.06         Fast scatter/gather TCP port scanner
lsof-4.61p1         Lists information about open files.
ntp-4.1.72          Network Time Protocol Implementation.
ncftp-3.0.4         ftp replacement with advanced user interface
nmh-1.0.4           The New MH mail handling program
bzip2-1.0.2         A block-sorting file compressor
</pre>
</ul>


<h3>Other Information</h3>

<p>
More information about the ports can be found in the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ports&sektion=7">ports(7)</a> 
man page and on the <a href="../ports.html">Ports page</a>

<p>
Our ports tree is constantly being expanded, and if you would like to
help please see: 
<a href="../porting.html">http://www.openbsd.org/porting.html</a>

<br>

<p>
<a name= "Packages"></a>
<a name= "8.7"></a>
<h2>8.7 - What are packages?</h2>

<p>
Packages are the precompiled binaries of some of the most used programs.
They are ready for use on an OpenBSD system. Again, like the ports,
packages are very easy to maintain and update. Packages are constantly
being added so be sure to check each release for additional packages.

<p>
Here is a list of tools used in managing packages.<br>
<ul>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_add">pkg_add(1)</a> 
  - a utility for installing software package distributions
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_create">pkg_create(1)</a> 
  - a utility for creating software package distributions
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_delete">pkg_delete(1)</a>
  - a utility for deleting previously installed software package distributions
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_info">pkg_info(1)</a>
  - a utility for displaying information on software packages
</ul>

<h3>Where to find packages</h3>

<p>
If you are a smart user and bought one of the 
<a href="../orders.html">OpenBSD CD</a>, then packages can be found on
both CDs depending on your architecture. If you don't have an OpenBSD CD
in your possession you can download packages from any of the ftp
mirrors. You can get a list of mirrors 
<a href="../ftp.html">http://www.openbsd.org/ftp.html</a>. Packages are
located at <i>/pub/OpenBSD/3.1/packages</i> from there packages are
broken down depending on architecture.

<h3>Installing Packages</h3>

To install packages, the utility 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_add">pkg_add(1)</a> 
is used.  pkg_add(1) is an extremely easy utility to use, in the
following two examples pkg_add(1) will be used to install a package. The
first example will show pkg_add(1) installing a package that resides on
a local disk, the second example will show an installation of a package
via ftp. In both examples screen-3.9.11 will be installed.

<ul>Installing via local disk
<pre>
$ <strong>sudo pkg_add -v screen-3.9.11.tgz</strong>
Requested space: 749864 bytes, free space: 2239117312 bytes in /var/tmp/instmp.cpsHA27596
Running install with PRE-INSTALL for `screen-3.9.11'
extract: Package name is screen-3.9.11
extract: CWD to /usr/local
extract: /usr/local/bin/screen-3.9.11
extract: execute 'ln -sf screen-3.9.11 /usr/local/bin/screen'
extract: /usr/local/man/man1/screen.1
extract: /usr/local/info/screen.info
extract: execute '[ -f /usr/local/info/dir ] || sed -ne '1,/Menu:/p' /usr/share/info/dir > /usr/local/info/dir'
extract: execute 'install-info /usr/local/info/screen.info /usr/local/info/dir'
extract: /usr/local/lib/screen/screencap
extract: /usr/local/lib/screen/screenrc
extract: CWD to .
Running mtree for `screen-3.9.11'
mtree -q -U -f +MTREE_DIRS -d -e -p /usr/local
Running install with POST-INSTALL for `screen-3.9.11'

+---------------
| The file /etc/screenrc has been created on your system.
| You may want to verify/edit its contents
|
| The file /usr/local/lib/screen/screencap contains a
| termcap like description of the screen virtual terminal.
| You may use it to update your terminal database.
| See <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=termcap&sektion=5">termcap(5)</a>.
+---------------

Attempting to record package into `/var/db/pkg/screen
Package `screen-3.9.11' registered in `/var/db/pkg/screen-3.9.11'
</pre></ul>

<p>
In this example the <b>-v</b> flag was used to give a more verbose
output, this option is not needed, but is helpful for debugging and was
used here to give a little more insight into what pkg_add(1) is actually
doing. Notice however, that there are some valid messages given out
mentioning <i>/etc/screenrc</i>. Messages like this will be given to you
whether or not you use the <b>-v</b> flag.

<ul>Installing via ftp
<pre>
$ <strong>sudo pkg_add ftp://ftp.openbsd.org/pub/OpenBSD/3.1/packages/i386/screen-3.9.11.tgz</strong>
&gt;&gt;&gt; ftp -o - ftp://ftp.openbsd.org/pub/OpenBSD/3.1/packages/i386/screen-3.9.11.tgz

+---------------
| The file /etc/screenrc has been created on your system.
| You may want to verify/edit its contents
|
| The file /usr/local/lib/screen/screencap contains a
| termcap like description of the screen virtual terminal.
| You may use it to update your terminal database.
| See termcap(5).
+---------------
</pre></ul>

<p>
In this example you can see that I installed the i386 package, you
should substitute this with your architecture. Notice: Not all
architectures have the same packages. Some ports don't work on certain
architectures. In this example the <b>-v</b> flag wasn't used, so only
NEEDED messages are shown.

<h3>Viewing and Deleting Installed Packages</h3>

<p>
The utility 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_info">pkg_info(1)</a>
is used to view a list of packages that are already installed on your
system. This is usually needed to find out the correct name of a package
before you remove that package. To see what packages are installed on
your system simple use:

<ul><pre>
$ <strong>pkg_info</strong>
mpg123-0.59r       mpeg audio 1/2 layer 1, 2 and 3 player
nmap-2.54BETA25    port scanning large networks
ircii-20011210     enhanced version of ircII (internet relay chat)
screen-3.9.11      multi-screen window manager
unzip-5.42         extract, list &amp; test files in a ZIP archive
ntp-4.1.72 	   Network Time Protocol implementation
icb-5.0.9          Internet CB - mostly-defunct chat client
</pre></ul>

<p>
To delete a package, simple take the proper name of the package as shown
by pkg_info(1) and use 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_delete">pkg_delete(1)</a>
to remove the package. In the below example, the screen package is being
removed. Notice that on some occasions there are instructions of extra
objects that need to be removed that pkg_delete(1) did not remove for
you. As with the pkg_add(1) utility, you can use the <b>-v</b> flag to
get more verbose output.

<ul><pre>
$ <strong>sudo pkg_delete screen-3.9.11</strong>

+---------------
| To completely deinstall the screen-3.9.11 package you need to perform
| this step as root:
|
|           rm -f /etc/screenrc
|
| Do not do this if you plan on re-installing screen-3.9.11
| at some future time.
+---------------
</pre></ul>

<p>
<a name= "NoFloppy"></a>
<a name= "8.8"></a>
<h2>8.8 -  Is there any way to use my floppy drive if it's not attached 
during boot?</h2>

<p>
Sure. You need to add "flags 0x20" at the end of the fd* entry and
recompile your kernel. The line should be read:

<ul>
<pre>  fd*     at fdc? drive ? flags 0x20</pre>
</ul>

<p>
After that you would be able to use the floppy drive all the times. It
doesn't matter if you plugged it in after boot.

<p>
<a name= "Bootloader"></a>
<a name= "8.9"></a>
<h2>8.9 - Boot time Options - Using the OpenBSD bootloader</h2>

<p>
When booting your OpenBSD system, you have probably noticed the boot
prompt.

<p>
<ul>boot&gt;</ul>

<p>
For most people, you won't have to do anything here. It will
automatically boot if no commands are given. But sometimes problems
arise, or special functions are needed. That's where these options will
come in handy. To start off, you should read through the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot&sektion=8&arch=i386">boot(8)</a>
man page. Here we will go over the most common used commands for the
bootloader.

<p>
To start off, if no commands are issued, the bootloader will
automatically try to boot <strong>/bsd</strong>. If that fails it will
try <strong>/obsd</strong>, and if that fails, it will try
<strong>/bsd.old</strong>. You can specify this by hand by typing:

<ul>
<p>
boot&gt; <strong>boot wd0a:/bsd</strong>
</ul>
or
<ul>
boot&gt; <strong>b /bsd</strong>
</ul>

<p>
This will work if device wd0a is configured as your root device.

<p>
Here is a brief list of options you can use with the OpenBSD kernel.
<ul>
<li><strong>-a</strong> : This will allow you to specify an alternate
  root device after booting the kernel.
<li><strong>-c</strong> : This allows you to enter the boot time
  configuration. Check the <a href="faq5.html#BootConfig"> Boot Time
  Config </a>section of the faq.
<li><strong>-s</strong> : This is the option to boot into single user
  mode.
<li><strong>-d</strong> : This option is used to dump the kernel into
  ddb. Keep in mind that you must have DDB built into the kernel.
</ul>

<p>
These are entered in the format of:
<strong>boot [ image [-acds]]</strong>

<p>
For further reading you can read 
<a href="http://www.OpenBSD.org/cgi-bin/man.cgi?query=boot_i386&sektion=8">boot_i386(8)</a>
man page

<p>
<a name= "SKey"></a>
<a name="8.10"></a>
<h2>8.10 - S/Key</h2>

<p>
S/Key is a ``one-time password'' scheme. This allows for one-time
passwords for use on un-secured channels. This can come in handy for
those who don't have the ability to use ssh or any other encrypted
channels. OpenBSD's S/Key implementation can use a variety of algorithms
as the one-way hash. The following algorithms are available:

<ul>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=md4&sektion=3">md4</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=md5&sektion=3">md5</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sha1&sektion=3">sha1</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rmd160&sektion=3">rmd160</a>.
</ul>

<h3>Setting up S/Key - The first steps </h3>

<p>
To start off the file <i>/etc/skeykeys</i> must exist. If this file is
not in existence, have the super-user create it. This can be done simply
by doing:

<ul>
<strong><pre>
# touch /etc/skeykeys
</pre></strong>
</ul>

<p>
Once that file is in existence, you can initialize your S/Key. To do
this you will have to use
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=skeyinit&sektion=1">skeyinit(1)</a>.
With skeyinit(1), you will first be prompted for your password to the
system. This is the same password that you used to log into the system.
Running skeyinit(1) over an insecure channel is completely not
recommended, so this should be done over a secure channel (such as ssh)
or the console. Once you have authorized yourself with your system
password you will be asked for yet another password.  This password is
the S/Key <i>secret password</i>, and is <strong>NOT</strong> your
system password. Your secret password must be at least 10 characters.
We suggest using a memorable phrase containing several words as the
secret password.  Here is an example user being added.


<ul>
<pre>
$ <strong>skeyinit ericj</strong>
[Adding ericj]
Reminder - Only use this method if you are directly connected
   or have an encrypted channel.  If you are using telnet
   or rlogin, exit with no password and use skeyinit -s.
Enter secret password:
Again secret password:

ID ericj skey is otp-md5 99 oshi45820             
Next login password: HAUL BUS JAKE DING HOT HOG
</pre>
</ul>

<p>
One line of particular importance in here is <i>ID ericj skey is otp-md5
99 oshi45820</i>. This gives a lot of information to the user. Here is a
breakdown of the sections and their importance.

<ul>
<li><i>otp-md5</i> - This shows which one-way was used to create your 
  One-Time Password (otp).
<li><i>99</i> - This is your sequence number. This is a number from 100 
  down to 1. Once it reaches one, another secret password must be 
  created.
<li><i>oshi45820</i> - This is your key.
</ul>

<p>
But of more immediate importance is your password. Your password
consists of 6 small words, combined together this is your password,
spaces and all.

<h3>Actually using S/Key to login.</h3>

<p>
By now your skey has been initialized, and you have your password.
You're ready to login. Here is an example session using S/Key to
login.  Starting with OpenBSD 3.0, S/Key logins work differently.
For OpenBSD 3.0 and above you append <b>:skey</b> to your login
name.  For versions of OpenBSD previous to 3.0 you use <b>s/key</b>
for the password at which time you are prompted for your S/Key
password (the exception to this is ftpd(8) which will always present
an S/Key challenge for S/Key-enabled user prior to OpenBSD &lt; 3.0).
The examples below assume OpenBSD 3.0 or higher.

<ul>
<pre>
$ <strong>ftp localhost</strong>
Connected to localhost.
220 oshibana.shin.ms FTP server (Version 6.5/OpenBSD) ready.
Name (localhost:ericj): ericj:skey
331- otp-md5 96 oshi45820
331 S/Key Password: 
230- OpenBSD 3.0 (OSHIBANA) #8: Tue Dec 22 19:20:16 EDT 2001
230-
230- Welcome to OpenBSD: The proactively secure Unix-like operating system.
230-
230- Please use the sendbug(1) utility to report bugs in the system.
230- Before reporting a bug, please try to reproduce it with the latest
230- version of the code.  With bug reports, please try to ensure that
230- enough information to reproduce the problem is enclosed, and if a
230- known fix for it exists, include that as well.
230-
230 User ericj logged in.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; quit
221 Goodbye.
</pre>
</ul>

<p>
Note that I appended ":skey" to my username.  This tells ftpd that I
want to authenticate using S/Key.  Some of you might have noticed that
my sequence number has changed to <i>otp-md5 96 oshi45820</i>. This is
because by now I have used S/Key to login several times. But how do you
get your password after you've logged in once? Well to do this, you'll
need to know what sequence number you're using and your key. As you're
probably thinking, how can you remember which sequence number you're on?
Well this is simple, use 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=skeyinfo&sektion=1">skeyinfo(1)</a>,
and it will tell you what to use. For example here, I need to generate
another password for a login that I might have to make in the future.
(remember I'm doing this from a secure channel). 

<ul>
<pre>
$ <strong>skeyinfo</strong>
95 oshi45820
</pre>
</ul>

<p>
An even better way is to use <strong>skeyinfo -v</strong>, which outputs
a command suitable to be run in the shell.  For instance:
<ul>
<pre>
$ <strong>skeyinfo -v</strong>
otp-md5 95 oshi45820
</pre>
</ul>

<p>
Not only is <i>otp-md5</i> a description of the hash used, it is also
an alternate name for the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=skey&sektion=1">skey(1)</a> 
command.  So, the simplest way to generate the next S/Key password is
simply:

<ul>
<pre>
$ <strong>`skeyinfo -v`</strong>
Reminder - Do not use this program while logged in via telnet or rlogin.
Enter secret password:
NOOK CHUB HOYT SAC DOLE FUME
</pre>
</ul>

Note the backticks in the above example.

<p>
I'm sure many of you won't always have a secure connection to create
these passwords, and creating them over an insecure connection isn't
feasible, so how can you create multiple passwords at one time? Well you
can supply skey(1) with a number of how many passwords you want created.
This can then be printed out and taken with you wherever you go.

<ul>
<pre>
$ <strong>otp-md5 -n 5 95 oshi45820</strong>
Reminder - Do not use this program while logged in via telnet or rlogin.
Enter secret password:
91: SHIM SET LEST HANS SMUG BOOT
92: SUE ARTY YAW SEED KURD BAND
93: JOEY SOOT PHI KYLE CURT REEK
94: WIRE BOGY MESS JUDE RUNT ADD
95: NOOK CHUB HOYT SAC DOLE FUME
</pre>
</ul>

<p>
Notice here though, that the bottom password should be the first used,
because we are counting down from 100.

<h4>Using S/Key with telnet(1), ssh(1), and rlogin(1)</h4>

<p>
Using S/Key with telnet(1), ssh(1), or rlogin(1) is done in pretty much
the same fashion as with ftp--you simply tack ":skey" to the end of your
username.
Example:

<ul>
<pre>
$ <strong>telnet localhost</strong>
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.

OpenBSD/i386 (oshibana) (ttyp2)

login: ericj:skey
otp-md5 98 oshi45821
S/Key Password: <strong>SCAN OLGA BING PUB REEL COCA</strong>
Last login: Thu Oct  7 12:21:48 on ttyp1 from 156.63.248.77
Warning: no Kerberos tickets issued.
OpenBSD 3.0 (OSHIBANA) #4: Thu Dec  2 23:36:16 EDT 2001

Welcome to OpenBSD: The proactively secure Unix-like operating system.

Please use the sendbug(1) utility to report bugs in the system.
Before reporting a bug, please try to reproduce it with the latest
version of the code.  With bug reports, please try to ensure that
enough information to reproduce the problem is enclosed, and if a
known fix for it exists, include that as well.

You have mail.
$
</pre></ul>

<p>
<a name= "MacTime"></a>
<a name="8.11"></a>
<h2>8.11 - Why is my Macintosh losing so much time?</h2>

<p>
This is caused by a hardware bug. OpenBSD uses clock interrupts to keep
track of the current time, but these interrupts have the lowest priority
in Apple's architecture. So, under heavy load, (such as disk or network
activity) clock interrupts will be lost and the Unix clock will not
advance as it should.

<p>        
MacOS gets around the time problem by always reading the hardware clock.
OpenBSD only reads the hardware clock at boot time and thereafter
ignores it. You may notice that, at shutdown, the kernel is not
confident enough to write the Unix time back into the hardware clock
because this time loss problem is well known. 

<p>
The best solution is to run ntpd (found in the ports collection) and
just deal with the occasional lossage.  Sometimes the lossage is so bad
that even ntpd is afraid to skip the time. In this case, add the -g
option to ntpd in /etc/rc.securelevel to force tracking. 

<p>
Another simpler but less precise solution is to run rdate(8) on a
regular basis, for example by having a crontab entry for it, preferably
with the <strong>-a</strong> option so there is no "jump" in time.
Another good place to launch
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rdate&sektion=8">rdate(8)</a>
is in your <i>/etc/ppp/ppp.linkup</i> file if you are not permanently
connected and are a PPP user.  

<p>
See also:
<a href="http://www.macbsd.com/macbsd/macbsd-docs/faq/faq-3.html#ss3.17">  
http://www.macbsd.com/macbsd/macbsd-docs/faq/faq-3.html#ss3.17</a>

<p>
<a name= "SMP"></a>
<a name="8.12"></a>
<h2>8.12 - Does OpenBSD support SMP?<br>
(Symmetric Multi-Processor)</h2>

<p>
Not at this time.  Work is on-going, there is an 
<a href="../smp.html">OpenBSD SMP project</a>, though there is nothing
usable yet, nor is there any time schedule for OpenBSD SMP support.

<p>
On most platforms, OpenBSD will run on an SMP system, but only utilizing
one processor.  The exception to this is the SPARC platform --
OpenBSD/sparc will not run on some multi-processor SPARC systems at all
(General rule: one MBus module always works.  Multiple MBus modules will
work as long as they are single processor modules and 
<a href="../sparc.html">supported</a>, of course).  Multi-processor
SPARC64 systems run as long as the base machine is 
<a href="../sparc64.html">supported</a>.

<p>
<b>How can I help?</b><br>
<ul>
<li>Write code.  There is lots of work to do.
<li>Donate hardware.  The goal of the OpenBSD SMP project is to support
as many platforms as possible, including 
<a href="../sparc.html">SPARC</a>, 
<a href="../sparc64.html">SPARC64</a>, 
<a href="../alpha.html">Alpha</a>, 
<a href="../macppc.html">MacPPC</a> 
and of course, the <a href="../i386.html">i386</a>.  
Donations of <a href="../want.html">desired 
hardware</a> are welcome!<br>
<li>Don't offer to "test".  The SMP project is not part of the core
OpenBSD project right now for a reason -- it isn't ready for production
use yet, or even general "testing".  Informing the developers that it
didn't work on your hardware without code to make it work isn't useful
at this point.  <a href="faq4.html#SendDmesg">Send in your dmesg</a>, if
a developer sees something interesting in your hardware, they can
contact you for testing.
</ul>

<p>
<a name= "TTY"></a>
<a name="8.13"></a>
<h2>8.13 - I get Input/output error when trying to use my tty devices</h2>
<p>
You need to use /dev/cuaXX for connections initiated from the OpenBSD
system, the /dev/ttyXX devices are intended only for terminal or dial-in
usage.  While it was possible to use the tty devices in the past, the
OpenBSD kernel is no longer compatible with this usage.

<p> From 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cua&sektion=4">cua(4)</a>:
<p>
For hardware terminal ports, dial-out is supported through matching
device nodes called calling units.  For instance, the terminal called
/dev/tty03 would have a matching calling unit called /dev/cua03. These
two devices are normally differentiated by creating the calling unit
device node with a minor number 128 greater than the dial-in device
node.  <i>Whereas the dial-in device (the tty) normally requires a
hardware signal to indicate to the system that it is active, the
dial-out device (the cua) does not, and hence can communicate unimpeded
with a device such as a modem</i>.  This means that a process like
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=getty&sektion=8">getty(8)</a>
will wait on a dial-in device until a connection is established.
Meanwhile, a dial-out connection can be established on the dial-out
device (for the very same hardware terminal port) without disturbing
anything else on the system.  The
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=getty&sektion=8">getty(8)</a>
process does not even notice that anything is happening on the
terminal port.  If a connecting call comes in after the dial-out connection
has finished, the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=getty&sektion=8">getty(8)</a>
process will deal with it properly, without having noticed the
intervening dial-out action.

<a name= "Netscape"></a>
<a name="8.14"></a>
<h2>8.14 - Where can I find a Netscape binary for OpenBSD?</h2>

<p>
There is no OpenBSD Netscape binary. However since OpenBSD supports
binary emulation of many other operating systems we are able to use
other binaries.

<ul>
<li>For I386 systems, it is best to use the BSDI binary.
<li>For SPARC systems, it is best to use the SUN-OS binary.
</ul>

<p>
Using the <a href="../ports.html">Ports System</a> you can install these
with no hassle.  The Navigator Port and Communicator Ports are located
at <i>/usr/ports/www/netscape</i> once you have the ports tree
installed.

<p>
<a name= "mg"></a>
<a name="8.15"></a>
<h2>8.15 - How do I use the mg editor which is now part of OpenBSD?</h2>
<p>
Mg is a micro Emacs-style text editor.  Micro means that it's small
(Emacs is very large!) For the basics, read the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mg&sektion=1">mg(1)</a>
manual page and the 
<a href="http://www.openbsd.org/cgi-bin/cvsweb/src/usr.bin/mg/tutorial?rev=1.2">tutorial</a>,
as included with the source code.  For more interesting questions (such
as, "I don't have a Meta key!") check out the
<a href="http://www.lerner.co.il/emacs/faq_toc.html">Emacs FAQ</a>.  

<p>
Note that since mg is a small Emacs implementation, which is mostly
similar to the text editor features of Emacs 17, it does not implement
many of Emacs' other functionality.  (Including mail and news
functionality, as well as modes for Lisp, C++, Lex, Awk, Java, etc...)

<p>
<a name= "ksh"></a>
<a name="8.16"></a>
<p>
<h2>8.16 - Ksh does not appear to read my .profile!</h2>
<p>
There are two possible reasons for this.
<ul>
<li>.profile is not owned by the user
This is easy to fix.  For <b>username</b>,
<p>
 <ul><tt>
 # <b>chown username ~username/.profile</b>
 </tt></ul>
<p>
<li>You are using ksh from within X Window System
<p>
Under xterm, argv[0] for ksh is not prepended with a
dash.  Prepending - to argv[0] will cause csh and ksh to know they should
interpret their login files.
(For csh that's .login, with a separate .cshrc that is always run when
csh starts up.  With ksh, this is more noticeable because there is only
one startup script, .profile.  This file is ignored unless the shell is
a login shell.)
<p>
To fix this, add the line <i>XTerm*loginShell: true</i>
to the file <i>.Xdefaults</i> in your home directory.  Note, this file
does not exist by default, you may have to create it.
<p>
 <ul><tt>
 $ <b>echo "XTerm*loginShell: true" &gt;&gt; ~/.Xdefaults</b>
 </tt></ul>
<p>
You may not have had to do this on other systems, as some installations
of X Window System come with this setting as default.  OpenBSD has
chosen to follow the XFree86 behavior.
</ul>

<p>
<a name= "motd"></a>
<a name="8.17"></a>
<h2>8.17 - Why does my /etc/motd file get written over when I modified it?</h2>

<p>
The <i>/etc/motd</i> file is edited upon every boot of the system,
replacing the first line with the systems kernel version information.
When editing this file, make sure that you start 2 lines from the top,
to keep <i>/etc/rc</i> from deleting these lines when it edits
<i>/etc/motd</i> upon boot.

<p>
<a name= "wwwsolaris"></a>
<a name="8.18"></a>
<h2>8.18 - Why does www.openbsd.org run on Solaris?</h2>

<p>
Although none of the developers think it is particularly relevant, this
question comes up frequently enough in the mailing lists that it is
answered here.  <i>www.openbsd.org</i> and the main OpenBSD ftp site are
hosted at a SunSITE at the University of Alberta, Canada.   These sites
are hosted on a large Sun system, which has access to lots of storage
space and Internet bandwidth.  The presence of the SunSITE gives the
OpenBSD group access to this bandwidth.  This is why the main site runs
here.  Many of the OpenBSD mirror sites run OpenBSD, but since they do
not have guaranteed access to this large amount of bandwidth, the group
has chosen to run the main site at the University of Alberta SunSITE.

<p>
<a name= "PCI"></a>
<a name="8.19"></a>
<h2>8.19 - I'm having problems with my PCI devices being detected</h2>

<p>
There exists a condition where some machines might not detect some PCI 
devices properly, or might freeze while detecting multiple NIC's in one 
machine. This is the fault of PCIBIOS, and involves a simple workaround 
to make it work properly.  Simply enter the boot time configuration and 
disable PCIBIOS. An example is below:

<ul>
<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<pre>
boot&gt; <b>boot -c</b>
Copyright (c) 1982, 1986, 1989, 1991, 1993
        The Regents of the University of California.  All rights reserved.
Copyright (c) 1995-2002 OpenBSD. All rights reserved.  http://www.OpenBSD.org

OpenBSD 3.1 (RAMDISK_CD) #242: Sat Apr 13 15:35:54 MDT 2002
    deraadt@i386.openbsd.org:/usr/src/sys/arch/i386/compile/RAMDISK_CD
cpu0: Intel Pentium III (Coppermine) ("GenuineIntel" 686-class, 128KB L2 cache)
1 GHz
cpu0: FPU,V86,DE,PSE,TSC,MSR,PAE,MCE,CX8,SYS,MTRR,PGE,MCA,CMOV,PAT,PSE36,MMX,FXS
R,SIMD
real mem  = 267956224 (261676K)
avail mem = 243347456 (237644K)
using 3296 buffers containing 13500416 bytes (13184K) of memory
User Kernel Config
UKC&gt; <b>disable pcibios</b>
UKC&gt; <b>quit</b>
[... snip ...]
</pre>
                </td>
        </tr>
</table>
</ul>

<p>
Once this is done, you can follow the directions in 
<a href="./faq5.html#Building">FAQ 5, Building a Kernel</a> to create a
new kernel so that you don't have to worry about this in the future.

<p>
<a name= "TrueType"></a>
<a name="8.20"></a>
<h2>8.20 - Antialiased and TrueType fonts in XFree86</h2>
<p>
See <a href="truetype.html">this document</a>.

<p>
<a name= "Journaling"></a>
<a name="8.21"></a>
<h2>8.21 - Does OpenBSD support any journaling filesystems ?</h2>
<p>
No it doesn't. We use a different mechanism to achieve similar results
that is called <a href="faq14.html#SoftUpdates">Soft Updates</a>. Please
read in FAQ 14 to get more details.  

<p>
<a name= "RevDNS"></a>
<h2>8.22 - Reverse DNS <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<small>- or -</small><br>
Why is it taking so long for me to log in?</h2>
<p>
Many new users to OpenBSD experience a two minute login delay when using
services such as 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&sektion=1">ssh,</a> 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp&sektion=1">ftp,</a> or 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=telnet&sektion=1">telnet.</a>  
This can also be experienced when using a proxy, such as 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp-proxy&sektion=8">ftp-proxy,</a>
or when sending mail out from a workstation through 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sendmail&sektion=8">sendmail.</a>
<p>
This is almost always due to a reverse-DNS problem.  DNS is Domain Name
Services, the system the Internet uses to convert a name, such as 
"www.openbsd.org" into a numeric IP address.  Another task of DNS is
the ability to take a numeric address and convert it back to a "name",
this is "Reverse DNS".
<p>
In order to provide better logging, OpenBSD performs a reverse-DNS 
lookup on any machine that that attaches to it in many different ways, 
including 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&sektion=1">ssh,</a>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp&sektion=1">ftp,</a> 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=telnet&sektion=1">telnet,</a>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sendmail&sektion=8">sendmail</a> or
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp-proxy&sektion=8">ftp-proxy.</a>
Unfortunately, in some cases, the machine that is making the connection
does not have a proper reverse DNS entry.

<p>
<h3>An example of this situation:</h3> 
A user sets up an OpenBSD box as a firewall and gateway to their
internal home network, mapping all their internal computers to one
external IP using <a href="faq6.html#NAT">NAT.</a> They may also use it
as an outbound mail relay.  They follow the installation guidelines, and
are very happy with the results, except for one thing -- every time they
try to attach to the box in any way, they end up with a two minute delay
before things happen.

<p>
<h3>What is going on:</h3>
From a workstation behind the NAT of the gateway with an 
<a href="http://www.geektools.com/rfc/rfc1918.txt">unregistered IP</a> 
address of 192.168.1.35, the user uses 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&sektion=1">ssh</a>
to access the gateway system.  The 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&sektion=1">ssh</a>
client prompts for username and password, and sends 
them to the gateway box.  The gateway then tries to figure out who 
is trying to log in by performing a reverse DNS lookup of 
192.168.1.35.  The problem is 192.168.0.0 addresses are for private
use, so a properly configured DNS server outside your network 
knows it should have no information about those addresses.  Some will 
quickly return an error message, in these cases, OpenBSD will assume 
there is no more information to be gained, and and it will quickly 
give up and just admit the user.  Other DNS servers will not return 
ANY response. In this case you will find yourself waiting for the OpenBSD 
name resolver to time out, which takes about two minutes before the 
login will be permitted to continue.  In the case of 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp-proxy&sektion=8">ftp-proxy</a>, some
ftp clients will timeout before the reverse DNS query times out, leading
to the impression that ftp-proxy isn't working.
<p>
This can be quite annoying.  Fortunately, it is an easy thing to fix.
<p>
<h3>Fix, using <tt>/etc/hosts</tt>:</h3>
The simplest fix is to populate your 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hosts&sektion=5"><tt>/etc/hosts</tt></a> 
file with all the workstations
you have in your internal network, and ensure that your 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=resolv.conf&sektion=5"><tt>/etc/resolv.conf</tt></a> 
file contains the line <tt>lookup file bind</tt>
which ensures that the resolver knows to start with the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hosts&sektion=5"><tt>/etc/hosts</tt></a>
file,
and failing that, to use the DNS servers specified by the "nameserver" 
lines in your 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=resolv.conf&sektion=5"><tt>/etc/resolv.conf</tt></a>
file.<p>

Your <tt>/etc/hosts</tt> file will look something like this:

<ul> <table border=0 width="800"> <tr> <td nowrap bgcolor="#EEEEEE">
<pre>
::1 localhost.in.example.org localhost
127.0.0.1 localhost.in.example.org localhost
192.168.1.1 gw.in.example.org gw
192.168.1.20 scrappy.in.example.org scrappy
192.168.1.35 shadow.in.example.org shadow
</pre>
</td></tr></table></ul>
Your <tt>resolv.conf</tt> file will look something like this:
<ul> <table border=0 width="800"> <tr> <td nowrap bgcolor="#EEEEEE">
<pre>
search in.example.org 
nameserver 24.2.68.33
nameserver 24.2.68.34
lookup file bind
</pre>
</td></tr></table></ul>
A common objection to this is "But, I use DHCP for my internal network!
How can I configure my <tt>/etc/hosts</tt>?"  Rather easily, actually.
Just enter lines for all the addresses your DHCP server is going to 
give out, plus any static devices:
<ul> <table border=0 width="800"> <tr> <td nowrap bgcolor="#EEEEEE">
<pre>
::1 localhost.in.example.org localhost
127.0.0.1 localhost.in.example.org localhost
192.168.1.1 gw.in.example.org gw
192.168.1.20 scrappy.in.example.org scrappy
192.168.1.35 shadow.in.example.org shadow
192.168.1.100 d100.in.example.org d100
192.168.1.101 d101.in.example.org d101
192.168.1.102 d102.in.example.org d102
         [... snip ...] 
192.168.1.198 d198.in.example.org d198
192.168.1.199 d199.in.example.org d199
</pre>
</td></tr></table></ul>

In this case, I am assuming you have the DHCP range set to 192.168.1.100 
through 192.168.1.199, plus the three static definitions as listed at
the top of the file.
<p>
If your gateway must use DHCP for configuration, you may well find you
have a problem -- 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dhclient&sektion=8">dhclient</a>
will overwrite your <tt>/etc/resolv.conf</tt> every time the lease is
renewed, which will remove the "lookup file bind" line.  This can be
solved by putting the line "lookup file bind" in the file
<tt>/etc/resolv.conf.tail</tt>.

<p>
<h3>Fix, using a local DNS server</h3>
Details on this are somewhat beyond the scope of this document, but the
basic trick is to setup your favorite DNS server, and make sure it knows
it is authoritative for both forward and reverse DNS resolution for all
nodes in your network, and make sure your computers (including your
gateway) know to use it as a DNS server.  Some details on the BIND
v4.9.8 name server included with OpenBSD can be found 
<a href="faq6.html#DNS">here.</a>

<p>
<font color= "#0000e0">
<a href= "index.html">[Back to Main Index]</a>
<a href= "faq7.html">[To Section 7.0 - Keyboard controls]</a>
<a href= "faq9.html">[To Section 9.0 - Tips for linux users]</a>
</font>

<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../images/back.gif" border= "0" alt= "[back]"></a> 
<a href= "mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>$OpenBSD: faq8.html,v 1.100 2002/07/12 02:51:35 nick Exp $</small>

</body>
</html>

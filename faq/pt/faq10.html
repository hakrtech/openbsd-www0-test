<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>10 - Administração do Sistema</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 1998-2007 by OpenBSD.">
</head>

<body bgcolor= "#ffffff" text= "#000000">

<a href="../../pt/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif" border="0">
</a>
<p>
<font color= "#0000e0">
<a href= "index.html">[Índice da FAQ]</a>
<a href= "faq9.html">[Seção 9 - Migração para OpenBSD]</a>
<a href="faq11.html">[Seção 11 - O sistema X Window]</a>
</font>

<h1><font color="#e00000">10 - Administração do Sistema</font></h1>
<hr>

<p>
<h3>Conteúdo</h3>
<ul>
<li><a href="#wheel"         >10.1 - Quando eu tento me tornar root
    através do su, ele diz que estou no grupo errado.</a>
<li><a href="#DupFS"         >10.2 - Como duplicar um sistema de
    arquivos?</a>
<li><a href="#rc"            >10.3 - Como eu inicio daemons ao mesmo
    tempo que o sistema inicializa? (Visão geral do rc(8))</a>
<li><a href="#RelayingDenied">10.4 - Por que os usuários recebem a
    mensagem "relaying access denied" quando estão enviando correio
    eletrônico remotamente através do OpenBSD?</a>
<li><a href="#POP"           >10.5 - Eu configurei o POP, mas recebo
    erros quando acesso meu correio eletrônico através do POP. O que
    posso fazer?</a>
<li><a href="#SendmailDNS"   >10.6 - Por que o Sendmail ignora o arquivo
    /etc/hosts?</a>
<li><a href="#HTTPS"         >10.7 - Configuração de um Servidor HTTP
    Seguro com ssl(8)</a>
<li><a href="#vipw"          >10.8 - Eu fiz mudanças no arquivo
    /etc/passwd com um editor, mas as mudanças não tiveram efeito. Por
    quê?</a>
<li><a href="#AddDelUser"    >10.9 - Como eu adiciono um usuário? ou,
    como excluir um usuário?</a>
<li><a href="#FTPOnly"       >10.10 - Como eu crio uma conta somente
    para ftp?</a>
<li><a href="#Quotas"        >10.11 - Configuração de quotas de disco
    para usuários</a>
<li><a href="#Kerberos"      >10.12 - Configuração de Clientes e
    Servidores KerberosV</a>
<li><a href="#AnonFTP"       >10.13 - Configuração de um servidor FTP
    anônimo</a>
<li><a href="#ftpchroot"     >10.14 - Como confinar usuários em seus
    diretórios pessoais no ftpd(8)</a>
<li><a href="#Patches"       >10.15 - Como aplicar correções no OpenBSD</a>
<li><a href="#httpdchroot"   >10.16 - Me fala sobre o chroot(2) no
    Apache?</a>
<li><a href="#rootshell"     >10.17 - Posso mudar o shell do usuário
    root?</a>
<li><a href="#ksh"           >10.18 - O que mais posso fazer com o ksh?</a>
<li><a href="#Dir"           >10.19 - Serviços de diretório</a>
<ul>
  <li><a href="#Dir.available" >10.19.1 - Quais serviços de diretório
      estão disponíveis?</a>
  <li><a href="#YP_secure"     >10.19.2 - Considerações de segurança
      sobre YP</a>
  <li><a href="#YP_server"     >10.19.3 - Configuração de um servidor YP</a>
  <li><a href="#YP_client"     >10.19.4 - Configuração de um cliente YP</a>
</ul>
</ul>

<hr>

<p>
<a name= "wheel"></a>
<h2>10.1 - Por que ele diz que estou no grupo errado quando eu tento
usar o su para me tornar root?</h2>

<p>
Usuários que já existem precisam ser adicionados ao grupo
<kbd>&quot;wheel&quot;</kbd> manualmente.
Isso é feito por razões de segurança, e você deve ser cuidadoso com
quem você permite o acesso. No OpenBSD, usuários que estão no grupo
<kbd>wheel</kbd> têm permissão para usar o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=su&amp;sektion=1">su(1)</a>,
um programa do espaço de usuário para se tornar root. Usuários que não
estão no grupo <kbd>&quot;wheel&quot;</kbd> não podem usar o su(1).
Este é um exemplo de uma entrada no arquivo <kbd>/etc/group</kbd> para
colocar o usuário <b>ericj</b> no grupo <kbd>&quot;wheel&quot;</kbd>.

<p>
Se você está adicionando um novo usuário com o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&amp;sektion=8">adduser(8)</a>,
você pode colocá-lo no grupo wheel respondendo wheel para a pergunta
"<tt>Invite <i>user</i> into other groups:</tt>". Isso o adiciona
ao /etc/group, que fica parecido com:

<blockquote><pre>
wheel:*:0:root,ericj
</pre></blockquote>

<p>
Se você está procurando uma maneira de permitir aos usuários acesso
limitado aos privilégios de super usuário, sem colocá-los no grupo
<kbd>&quot;wheel&quot;</kbd>, use o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sudo&amp;sektion=8">sudo(8)</a>.

<p>
<a name= "DupFS"></a>
<h2>10.2 - Como duplicar um sistema de arquivos?</h2>

<p>
Para duplicar seu sistema de arquivos, use o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dump&amp;sektion=8">dump(8)</a>
e o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=restore&amp;sektion=8">restore(8)</a>.
Por exemplo, para duplicar tudo que esteja no diretório <kbd>SRC</kbd>
para o diretório <kbd>DST</kbd>, faça um:

<blockquote><pre>
# <b>cd /SRC; dump 0f - . | (cd /DST; restore -rf - )</b>
</pre></blockquote>

<p>
dump é projetado para fornecer possibilidades de backup, e ele pode
ser exagerado se você apenas quer duplicar uma parte de um (ou todo o)
sistema de arquivos. O comando
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tar&amp;sektion=1">tar(1)</a>
pode ser mais rápido para essa operação. O formato é muito parecido com:

<blockquote><pre>
# <b>cd /SRC; tar cf -  . | (cd /DST; tar xpf - )</b>
</pre></blockquote>

<p>
<a name= "rc"></a>
<h2>10.3 - Como eu inicio daemons ao mesmo tempo que o
sistema inicializa? (Visão geral do rc(8))</h2>

O OpenBSD usa o estilo
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc&amp;sektion=8">rc(8)</a>
de inicialização. Esse estilo usa alguns arquivos-chave para a
inicialização.

<ul>
  <li>/etc/rc - Script principal. Não deve ser editado.
  <li>/etc/rc.conf - Arquivo de configuração usado pelo <i>/etc/rc</i>
      para definir os parâmetros de inicialização para o sistema.
      Não deve ser editado.
  <li>/etc/rc.conf.local - Arquivo de configuração que sobrescreve
      as configurações no /etc/rc.conf, assim você não precisa alterar o
      próprio /etc/rc.conf, o que é importante no momento da atualização
      de versão do seu sistema.
  <li>/etc/netstart - Script usado para inicializar a rede. Não deve ser
      editado.
  <li>/etc/rc.local - Script usado para a administração local. É onde
      novos daemons ou informações específicas da máquina devem ser
      guardados.
  <li>/etc/rc.securelevel - Script que executa comandos que precisam ser
      executados antes das mudanças do nível de segurança. Veja
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=init&amp;sektion=8">init(8)</a>
  <li>/etc/rc.shutdown - Script executado no momento que o sistema está
      sendo desligado. Coloque nesse arquivo qualquer coisa que você
      quer que seja executada antes do shutdown. Veja
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.shutdown&amp;sektion=8">rc.shutdown(8)</a>
</ul>

<h3>Como o rc(8) funciona?</h3>

<p>
Os arquivos principais que o administrador de sistema deve se concentrar
são: <i>/etc/rc.conf</i> (como guia), <i>/etc/rc.conf.local</i> (para
alterações), <i>/etc/rc.local</i> e <i>/etc/rc.shutdown</i>.
Para compreender o funcionamento do processo rc(8), veja o fluxo:

<p>
Depois que o kernel é inicializado, o <i>/etc/rc</i> é iniciado:
<ul>
  <li>Sistemas de arquivos são verificados.
  <li>Variáveis de configuração padrão são lidas do arquivo
      <i>/etc/rc.conf</i> e então as alterações àquelas variáveis são
      lidas do arquivo <i>/etc/rc.conf.local</i>.
      Configurações no rc.conf.local sobrescrevem aquelas do rc.conf.
  <li>Sistemas de arquivos são montados
  <li>O diretório <i>/tmp</i> é limpado e quaisquer arquivos de editor
      são preservados
  <li>Configura a rede através do <i>/etc/netstart</i>
  <ul>
    <li>Ativa suas interfaces.
    <li>Configura o nome da máquina, nome de domínio, etc.
  </ul>
  <li>Inicia os daemons do sistema
  <li>Faz várias outras verificações (quotas, savecore, etc.)
  <li>Daemons locais são executados através do <i>/etc/rc.local</i>
</ul>

<h3>Inicialização de Daemons e Serviços do OpenBSD</h3>

<p>
A maioria dos daemons e serviços contidos no OpenBSD são controlados na
inicialização pelas variáveis definidas no arquivo de configuração
<i>/etc/rc.conf</i>.
Dê uma olhada no arquivo
<a href="http://www.openbsd.org/cgi-bin/cvsweb/~checkout~/src/etc/rc.conf?content-type=text/plain">/etc/rc.conf</a>.
Você verá linhas similares a esta:

<blockquote><pre>
ftpd_flags=NO           # for non-inetd use: ftpd_flags="-D"
</pre></blockquote>

<p>
Uma linha igual a essa mostra que o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8">ftpd(8)</a>
não é carregado com o sistema (pelo menos não como um daemon através do
rc(8); o ftpd na maioria das vezes é executado pelo
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=inetd&amp;sektion=8">inetd(8)</a>,
veja a
<a href="faq10.html#AnonFTP">FAQ sobre FTP anônimo</a> para ler mais
sobre isso).
Cada linha tem um comentário que mostra os sinalizadores para o uso
normal daquele daemon ou serviço.
Isso não significa que você deve executar aquele daemon ou serviço com
aqueles sinalizadores.
Leia a página de manual referente ao assunto para ver como você pode
ter aquele daemon ou serviço carregando de qualquer forma que você
quiser.

<p>
Nós recomendamos fortemente que você nunca toque no <i>/etc/rc.conf</i>.
No lugar, crie o arquivo <i>/etc/rc.conf.local</i>, copie de
<i>/etc/rc.conf</i> apenas as linhas que você precisa alterar, e
ajuste-as do modo que quiser.
Isso torna as futuras atualizações de versão fáceis -- todas as
modificações estão em um arquivo.
De fato, o <a href="../upgrade46.html">processo de atualização de
versão</a> padrão assume que você não modificou o <i>/etc/rc.conf</i>
e sobrescreve-o com a nova versão do arquivo.

<p>
Por exemplo, esta é a linha padrão relacionada ao httpd(8).

<blockquote><pre>
httpd_flags=NO          # for normal use: "" (or "-DSSL" after reading ssl(8))
</pre></blockquote>

<p>
Aqui você pode ver que para carregar o httpd normalmente nenhum
sinalizador é necessário, então uma linha como <tt>httpd_flags=""</tt>
adicionada ao <i>/etc/rc.conf.local</i> cumpre a tarefa.
Mas para carregar o httpd com ssl ativo (consulte a
<a href="#HTTPS">FAQ sobre SSL</a> ou
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssl&amp;sektion=8">ssl(8)</a>),
você começaria com uma linha como <tt>httpd_flags="-DSSL"</tt>, embora
você possa precisar adicionar outros parâmetros por outros motivos.

<h3>Inicialização de daemons e a configuração local</h3>

<p>
Para outros daemons que você deseja instalar no seu sistema através
de pacotes ou outros meios, você deve usar o arquivo
<i>/etc/rc.local</i>.
Por exemplo, eu instalei um daemon que se situa em
/usr/local/sbin/daemonx, e quero que ele carregue no momento da
inicialização. Eu colocarei uma entrada no <i>/etc/rc.local</i> igual a
esta:

<blockquote><pre>
if [ -x /usr/local/sbin/daemonx ]; then
             echo -n ' daemonx';       /usr/local/sbin/daemonx
fi
</pre></blockquote>

<p>
(Se o daemon não se destaca automaticamente durante a inicialização,
lembre-se de adicionar um "&amp;" no fim da linha de comando.)

<p>
A partir de agora esse daemon será carregado no inicialização. Você será
capaz de ver qualquer erro na inicialização, sendo que uma inicialização
normal, sem erros, deve mostrar uma linha como esta:

<blockquote><pre>
Starting local daemons: daemonx.
</pre></blockquote>

<h3>rc.shutdown</h3>

<p>
<i>/etc/rc.shutdown</i> é um script que é executado no desligamento.
Qualquer tarefa que você queira fazer antes do sistema ser desligado
deve ser adicionada nesse arquivo. Se você usa o apm, você pode também
definir &quot;powerdown=YES&quot;. Isso é o equivalente do
&quot;shutdown -p&quot;.

<p>
<a name= "RelayingDenied"></a>
<h2>10.4 - Por que os usuários recebem a mensagem "relaying denied"
quando estão enviando correio eletrônico remotamente através do OpenBSD?</h2>

<p>
Tente isto:

<blockquote><pre>
# <b>grep relay-domains /etc/mail/sendmail.cf</b>
</pre></blockquote>

<p>
A saída talvez se pareça com esta:

<blockquote><pre>
FR-o /etc/mail/relay-domains
</pre></blockquote>

<p>
Se esse arquivo não existe, crie-o. Você precisa especificar as máquinas
que estão enviando correio eletrônico remotamente, com a seguinte
sintaxe:

<blockquote><pre>
.domain.com    #Allow relaying for/to any host in domain.com
sub.domain.com #Allow relaying for/to sub.domain.com and any host in that domain
10.2           #Allow relaying from all hosts in the IP net 10.2.*.*
</pre></blockquote>

<p>
Não se esqueça de enviar um sinal 'HangUP' para o sendmail (um sinal
que faz com que a maioria dos daemons leiam novamente seus arquivos
de configuração):

<blockquote><pre>
# <b>kill -HUP `head -1 /var/run/sendmail.pid`</b>
</pre></blockquote>

<p>

<h3>Para mais informações</h3>

<p>
<ul>
<li><a href="http://www.sendmail.org/~ca/email/relayingdenied.html">http://www.sendmail.org/~ca/email/relayingdenied.html</a>
<li><a href="http://www.sendmail.org/tips/relaying.php">http://www.sendmail.org/tips/relaying.php</a>
<li><a href="http://www.sendmail.org/antispam/">http://www.sendmail.org/antispam/</a>
</ul>

<p>
<a name= "POP"></a>
<h2>10.5 - Eu configurei o POP, mas recebo erros quando acesso meu
correio eletrônico através do POP. O que posso fazer?</h2>

<p>
A maioria dos problemas relacionados ao POP são problemas com arquivos
temporários e arquivos bloqueados. Se seu servidor POP envia uma
mensagem de erro do tipo:

<blockquote><pre>
-ERR Couldn't open temporary file, do you own it?
</pre></blockquote>

<p>
Tente configurar suas permissões do seguinte modo:

<blockquote><pre>
permissões em  /var
drwxrwxr-x   2 bin     mail     512 May 26 20:08 mail


permissões em  /var/mail
-rw-------   1 username   username        0 May 26 20:08 username
</pre></blockquote>

<p>
Outra coisa para verificar é se o usuário é realmente o dono de seu
arquivo em /var/mail. Normalmente esse deve ser o caso (por exemplo, o
dono de /var/mail/joe deveria ser o próprio usuário joe), mas se não
está definido corretamente, essa pode ser a causa do problema!

<p>
Normalmente, deixar o /var/mail com permissão de escrita para o grupo
"mail" cria alguns problemas de segurança. É provável que você nunca
terá problemas com ele, mas pode ter! (especialmente se seu sítio é de
grande volume, como um "ISP", ...) Existem vários servidores POP que
você pode instalar diretamente através da coleção de portes. Se
possível, use o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=popa3d&amp;sektion=8">popa3d</a>,
que está disponível na instalação base do OpenBSD.
Também poderia ser o caso de uma seleção incorreta das opções para
o seu daemon pop. Ou você precisa apenas mudar o diretório em que ele
faz o bloqueio (embora o bloqueio somente seria de valor para o daemon
POP).

<p>
<b>Nota:</b> O OpenBSD não tem um grupo com o nome &quot;mail&quot;.
Você precisa criá-lo em seu arquivo <i>/etc/group</i> se você precisa
dele. Uma entrada como:

<blockquote><pre>
mail:*:6:
</pre></blockquote>

<p>

seria o suficiente.

<a name="SendmailDNS"></a>
<h2>10.6 - Por que o Sendmail ignora o arquivo <tt>/etc/hosts</tt>?</h2>

<p>
Por padrão, o Sendmail usa o serviço DNS para a resolução de nomes, e
não o arquivo <tt>/etc/hosts</tt>. Esse comportamento pode ser alterado
através do uso do arquivo <tt>/etc/mail/service.switch</tt>.

<p>
Se você deseja consultar o arquivo hosts antes dos servidores DNS,
crie o arquivo <tt>/etc/mail/service.switch</tt> e coloque nele a
seguinte linha:

<blockquote><pre>
hosts       files dns
</pre></blockquote>

<p>
Se você deseja consultar SOMENTE o arquivo hosts, use o seguinte:

<blockquote><pre>
hosts       files
</pre></blockquote>

<p>
Envie ao Sendmail um sinal HUP:

<blockquote><pre>
# <b>kill -HUP `head -1 /var/run/sendmail.pid`</b>
</pre></blockquote>

<p>
e as mudanças terão efeito.


<p>
<a name= "HTTPS"></a>
<h2>10.7 - Configuração de um servidor HTTP seguro com SSL(8)</h2>

<p>
O OpenBSD é distribuído com bibliotecas RSA e um servidor httpd
que suporta SSL. Para o uso com o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&amp;sektion=8">httpd(8)</a>,
você primeiro precisa ter um certificado. O certificado será mantido em
<i>/etc/ssl/</i>, com a chave correspondente em
<i>/etc/ssl/private/</i>.
As etapas descritas aqui são, em partes, retiradas da página de manual
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssl&amp;sektion=8">ssl(8)</a>;
utilize-a para obter mais informação.
Esta parte da FAQ é somente sobre a criação de um certificado RSA para
servidores Web, ela não descreve certificados de servidores DSA.
Para mais informações sobre como fazer isso, leia a página de manual
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssl&amp;sektion=8">ssl(8)</a>.

<p>
Para começar, você precisa criar o certificado e a chave do seu servidor
usando o OpenSSL:

<blockquote><pre>
# <b>openssl genrsa -out /etc/ssl/private/server.key 1024</b>
</pre></blockquote>

<p>
Ou, se você deseja que a chave seja encriptada com uma frase secreta que
você terá que digitar quando iniciar os servidores

<blockquote><pre>
# <b>openssl genrsa -des3 -out /etc/ssl/private/server.key 1024</b>
</pre></blockquote>

<p>
O próximo passo é gerar uma Requisição de Assinatura de Certificado, que
é utilizada para permitir que uma Autoridade de Certificação
(CA - "Certifying Authority") assine seu certificado. Para fazer isso,
use o comando:

<blockquote><pre>
# <b>openssl req -new -key /etc/ssl/private/server.key -out /etc/ssl/private/server.csr</b>
</pre></blockquote>

<p>
O arquivo <i>server.csr</i> pode então ser enviado a uma Autoridade de
Certificação que assinará a chave. Uma das Autoridades de Certificação
é a <b>Thawte Certification</b>, que você pode encontrar no endereço
<a href="http://www.thawte.com/">http://www.thawte.com/</a>.

<p>
Se você não pode fazer isso, ou simplesmente quer assinar o certificado
você mesmo, o seguinte comando pode ser usado.

<blockquote><pre>
# <b>openssl x509 -req -days 365 -in /etc/ssl/private/server.csr \
       -signkey /etc/ssl/private/server.key -out /etc/ssl/server.crt</b>
</pre></blockquote>

<p>
Com os arquivos <i>/etc/ssl/server.crt</i> e
<i>/etc/ssl/private/server.key</i> no lugar certo, você deve então
iniciar o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&amp;sektion=8">httpd(8)</a>
com o sinalizador <b>-DSSL</b> (veja a <a href="#rc">seção sobre o
rc(8)</a> nesta faq), ativando assim as transações https na porta 443 da
sua máquina.

<p>
<a name= "vipw"></a>
<h2>10.8 - Eu editei o arquivo /etc/passwd, mas as mudanças não tiveram
efeito. Por quê?</h2>

<p>
Se você editou diretamente o arquivo <i>/etc/passwd</i>, suas mudanças
serão perdidas.
O OpenBSD gera dinamicamente o arquivo <i>/etc/passwd</i> com o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pwd_mkdb&amp;sektion=8">pwd_mkdb(8)</a>.
O arquivo de senhas principal no OpenBSD é o <i>/etc/master.passwd</i>.
De acordo com o pwd_mkdb(8),

<blockquote><pre>
FILES
     /etc/master.passwd  current password file
     /etc/passwd         a 6th Edition-style password file
     /etc/pwd.db         insecure password database file
     /etc/pwd.db.tmp     temporary file
     /etc/spwd.db        secure password database file
     /etc/spwd.db.tmp    temporary file
</pre></blockquote>

<p>
Em um arquivo de senhas tradicional do Unix, como o /etc/passwd, tudo e
inclusive a senha criptografada do usuário está disponível para qualquer
um no sistema (e é o primeiro alvo para programas como o "Crack").
O 4.4BSD introduziu o arquivo master.passwd, que possui um formato
estendido (com opções adicionais além daquelas fornecidas pelo
/etc/passwd) e somente pode ser lido pelo usuário root. Para acesso
rápido aos dados, as chamadas de bibliotecas que acessam esses dados
normalmente leem os arquivos /etc/pwd.db e /etc/spwd.db.

<p>
O OpenBSD inclui uma ferramenta para a edição do arquivo de senhas.
Essa ferramenta é chamada
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>.
Vipw usa o vi (ou seu editor favorito definido por $EDITOR) para
editar o arquivo /etc/master.passwd. Após a modificação, ele recria
/etc/passwd, /etc/pwd.db e /etc/spwd.db, conforme as mudanças que você
tenha feito.
Vipw também se encarrega de bloquear esses arquivos, de modo que se
alguém tentar mudá-los ao mesmo tempo, o acesso é negado.

<p>
<a name= "AddDelUser"></a>
<h2>10.9 - Qual é a melhor forma de adicionar e excluir usuários?</h2>

<p>
O OpenBSD fornece dois comandos para a adição fácil de usuários no
sistema:

<ul>
<li><a href="#adduser">adduser(8)</a>
<li><a href="#user">user(8)</a>
</ul>

Você também pode adicionar manualmente os usuários, usando o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>,
mas na maioria das operações isso é mais difícil.

<a name="adduser"></a>
<p>
A forma mais fácil de adicionar um usuário no OpenBSD é usando o script
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&amp;sektion=8">adduser(8)</a>.
Você pode configurar o adduser(8) através da edição do arquivo
<i>/etc/adduser.conf</i>.
O adduser(8) permite verificações consistentes em <i>/etc/passwd</i>,
<i>/etc/group</i> e no banco de dados de shell. Ele cria as entradas
e o diretório $HOME para você. É possível enviar uma mensagem de
boas vindas ao usuário. Este é um exemplo de usuário, <b>testuser</b>,
sendo adicionado no sistema.
Ele(a) terá o diretório $HOME em <i>/home/testuser</i>, fará parte
do grupo <b>guest</b>, e terá o shell <i>/bin/ksh</i>.

<blockquote><pre>
# <b>adduser</b>
Use option ``-silent'' if you don't want to see all warnings and questions.

Reading /etc/shells
Reading /etc/login.conf
Check /etc/master.passwd
Check /etc/group

Ok, let's go.
Don't worry about mistakes. I will give you the chance later to correct any input.
Enter username []: <b>testuser</b>
Enter full name []: <b>Test FAQ User</b>
Enter shell csh ksh nologin sh [sh]: <b>ksh</b>
Uid [1002]: <b><i>Enter</i></b>
Login group testuser [testuser]: <b>guest</b>
Login group is ``guest''. Invite testuser into other groups: guest no 
[no]: <b>no</b>
Login class auth-defaults auth-ftp-defaults daemon default staff 
[default]: <b><i>Enter</i></b>
Enter password []: <b><i>Digite a senha e tecle Enter</i></b>
Enter password again []: <b><i>Digite a senha e tecle Enter</i></b>

Name:        testuser
Password:    ****
Fullname:    Test FAQ User
Uid:         1002
Gid:         31 (guest)
Groups:      guest
Login Class: default
HOME:        /home/testuser
Shell:       /bin/ksh
OK? (y/n) [y]: <b>y</b>
Added user ``testuser''
Copy files from /etc/skel to /home/testuser
Add another user? (y/n) [y]: <b>n</b>
Goodbye!
</pre></blockquote>

<p>
Para excluir usuários você deve usar o utilitário
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rmuser&amp;sektion=8">rmuser(8)</a>.
Este remove toda a existência de um usuário. Ele remove qualquer
entrada no
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=crontab&amp;sektion=1">crontab(1)</a>,
o diretório $HOME (se o usuário em questão for o proprietário do
diretório) e suas mensagens de correio eletrônico.
Naturalmente, ele também remove as entradas nos arquivos
<i>/etc/passwd</i> e <i>/etc/group</i>. O próximo exemplo é a remoção do
usuário que foi adicionado acima. Repare que você será perguntado pelo
nome, e se quer ou não remover o diretório pessoal do usuário.

<blockquote><pre>
# <b>rmuser</b>
Enter login name for user to remove: <b>testuser</b>
Matching password entry:

testuser:$2a$07$ZWnBOsbqMJ.ducQBfsTKUe3PL97Ve1AHWJ0A4uLamniLNXLeYrEie:1002
:31::0:0:Test FAQ User:/home/testuser:/bin/ksh

Is this the entry you wish to remove? <b>y</b>
Remove user's home directory (/home/testuser)? <b>y</b>
Updating password file, updating databases, done.
Updating group file: done.
Removing user's home directory (/home/testuser): done.
</pre></blockquote>

<a name="user"></a>
<h3>Como adicionar usuários através do user(8)</h3>

<p>
Estas ferramentas são menos interativas que o comando
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&amp;sektion=8">adduser(8)</a>,
o que as tornam fáceis de serem usadas em scripts.

<p>
A lista completa de ferramentas:
<ul>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=group&amp;sektion=8">group(8)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=groupadd&amp;sektion=8">groupadd(8)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=groupdel&amp;sektion=8">groupdel(8)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=groupinfo&amp;sektion=8">groupinfo(8)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=groupmod&amp;sektion=8">groupmod(8)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=user&amp;sektion=8">user(8)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8">useradd(8)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=userdel&amp;sektion=8">userdel(8)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=userinfo&amp;sektion=8">userinfo(8)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=usermod&amp;sektion=8">usermod(8)</a>
</ul>

<h4>Como adicionar usuários</h4>

<p>
Sendo que o comando user(8) não é interativo, a maneira mais fácil de
adicionar eficientemente usuários é através do comando adduser(8). O
comando <i>/usr/sbin/user</i> é apenas uma interface para o resto dos
comandos <i>/usr/sbin/user*</i>. Portanto, os comandos seguintes podem
ser utilizados como <b>user add</b> ou <b>useradd</b>, de modo que
depende da sua escolha qual utilizar, e não altera o resultado dos
comandos.

<p>
Neste exemplo, nós estamos adicionando o mesmo usuário com as mesmas
especificações do usuário que foi adicionado
<a href="#adduser">acima</a>.
O comando useradd(8) é muito mais fácil de usar se você sabe a
configuração padrão antes de adicionar o usuário. Essas configurações
estão localizadas em <i>/etc/usermgmt.conf</i>, e podem ser visualizadas
com o comando:

<blockquote><pre>
$ <b>user add -D</b>
group           users
base_dir        /home
skel_dir        /etc/skel
shell           /bin/csh
inactive        0
expire          Null (unset)
range           1000..60000
</pre></blockquote>

<p>
As configurações acima serão as utilizadas, a menos que você especifique
uma configuração diferente com as opções da linha de comando. Por
exemplo, no nosso caso, queremos que o usuário pertença ao grupo
<b>guest</b>, e não ao grupo <b>users</b>.
Um pequeno obstáculo ao adicionar usuários é que as senhas precisam
ser especificadas na linha de comando. As senhas devem ser
criptografadas, então primeiro você precisa usar o utilitário
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=encrypt&amp;sektion=1">encrypt(1)</a>
para criar a senha. Por exemplo: as senhas do OpenBSD usam por padrão
o algoritmo Blowfish em 6 "rounds".
Esta é uma linha de exemplo para criar uma senha encriptada para ser
especificada ao useradd(8).

<blockquote><pre>
$ <b>encrypt -p -b 6</b>
Enter string:
$2a$06$YOdOZM3.4m6MObBXjeZtBOWArqC2.uRJZXUkOghbieIvSWXVJRzlq
</pre></blockquote>

<p>
Agora que temos nossa senha encriptada, já estamos prontos para
adicionar o usuário.

<blockquote><pre>
# <b>user add -p '$2a$06$YOdOZM3.4m6MObBXjeZtBOWArqC2.uRJZXUkOghbieIvSWXVJRzlq' -u 1002 \
-s /bin/ksh -c "Test FAQ User" -m -g guest testuser</b>
</pre></blockquote>

<p>
<b>Nota:</b> Tenha certeza que você está usando '&nbsp;' (aspas simples)
em ambos os lados da senha, e não &quot;&nbsp;&quot; (aspas duplas),
já que estas serão interpretadas pelo shell antes de serem enviadas
para o user(8). Em adição, tenha certeza de especificar a opção
<b>-m</b> se você quer que o diretório pessoal do usuário seja criado
e os arquivos de <i>/etc/skel</i> sejam copiados para lá.

<p>
Para ver se o usuário foi criado corretamente, podemos usar vários
utilitários diferentes. Abaixo estão alguns comandos que você pode
usar para verificar rapidamente se tudo foi criado corretamente.

<blockquote><pre>
$ <b>ls -la /home</b>
total 14
drwxr-xr-x   5 root      wheel   512 May 12 14:29 .
drwxr-xr-x  15 root      wheel   512 Apr 25 20:52 ..
drwxr-xr-x  24 ericj     wheel  2560 May 12 13:38 ericj
drwxr-xr-x   2 testuser  guest   512 May 12 14:28 testuser
$ <b>id testuser</b>
uid=1002(testuser) gid=31(guest) groups=31(guest)
$ <b>finger testuser</b>
Login: testuser                         Name: Test FAQ User
Directory: /home/testuser               Shell: /bin/ksh
Last login Sat Apr 22 16:05 (EDT) on ttyC2
No Mail.
No Plan.
</pre></blockquote>

<p>
Em adição a tais comandos, o user(8) provê seu próprio utilitário para
mostrar as características do usuário, chamado de userinfo(8).

<blockquote><pre>
$ <b>userinfo testuser</b>
login   testuser
passwd  *
uid     1002
groups  guest
change  Wed Dec 31 19:00:00 1969
class
gecos   Test FAQ User
dir     /home/testuser
shell   /bin/ksh
expire  Wed Dec 31 19:00:00 1969
</pre></blockquote>

<h4>Como excluir usuários</h4>

<p>
Para remover usuários com a hierarquia de comandos user(8), você usa
o comando userdel(8). Ele é muito simples, mas um comando útil. Para
remover o usuário criado no último exemplo, basta executar:

<blockquote><pre>
# <b>userdel -r testuser</b>
</pre></blockquote>

<p>
Note a opção <b>-r</b>, que precisa ser especificada se você quer que o
diretório pessoal do usuário também seja excluído. Alternativamente,
você pode especificar <b>-p</b> e não <b>-r</b>, e assim a conta do
usuário será bloqueada, mas nenhuma informação será eliminada.

<p>
<a name= "FTPOnly"></a>
<h2>10.10 - Como eu crio uma conta somente para ftp (que não seja
FTP anônimo)?</h2>

<p>
Existem alguns meios de se fazer isso, mas um modo muito comum é
adicionar "<tt>/usr/bin/false</tt>" no arquivo "<tt>/etc/shells</tt>".
Então quando você configurar o shell dos usuários para
"<tt>/usr/bin/false</tt>", eles não serão capazes de iniciar uma sessão
interativa no sistema, mas serão capazes de usar o serviço ftp.
Você talvez queira também restringir o acesso
<a href="#ftpchroot">confinando os usuários em seus diretórios pessoais
no ftpd</a>.


<p>
<a name= "Quotas"></a>
<h2>10.11 - Configuração de quotas de disco</h2>

<p>
Quotas são utilizadas para limitar o espaço de disco disponível para os
usuários. O sistema pode ser muito útil em situações onde você tem
recursos limitados. Quotas podem ser configuradas por usuário e/ou por
grupo.

<p>
O primeiro passo para configurar as quotas é ter certeza que
"<tt>option QUOTA</tt>" está na <a href="faq5.html#Options">configuração
do kernel</a>. Essa opção está no kernel GENERIC. Depois disso, você
precisa marcar no
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fstab&amp;sektion=5"><tt>/etc/fstab</tt></a>
os sistemas de arquivos que terão as quotas ativadas.
As palavras-chave <tt>userquota</tt> e <tt>groupquota</tt> devem ser
usadas para marcar cada sistema de arquivos que você vai utilizar
quotas.
Por padrão, os arquivos <tt>quota.user</tt> e <tt>quota.group</tt>
serão criados na raiz daquele sistema de arquivo para guardar
informações sobre quotas. Esse padrão pode ser modificado especificando
o nome do arquivo com a opção quota em <tt>/etc/fstab</tt>, como em
"<tt>userquota=/var/quotas/quota.user</tt>".
Este é um exemplo de <tt>/etc/fstab</tt> que tem um sistema de arquivos
com quotas ativas, e o arquivo de quotas em uma localização não padrão:

<blockquote><pre>
/dev/wd0a / ffs rw,userquota=/var/quotas/quota.user 1 1
</pre></blockquote>

<p>
Agora é hora de configurar as quotas do usuário. Para esse fim, nós
utilizamos o utilitário
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=edquota&amp;sektion=8">edquota(8)</a>.
Um uso simples é "<tt>edquota&nbsp;&lt;usuário&gt;</tt>". edquota(8)
utiliza o vi(1) para editar as quotas, a menos que a variável de
ambiente EDITOR esteja definida para um editor diferente. Por exemplo, o
comando:

<blockquote><pre>
# <b>edquota ericj</b>
</pre></blockquote>

<p>
Mostra uma saída similar a esta:

<blockquote><pre>
Quotas for user ericj:
/: KBytes in use: 62, limits (soft = 0, hard = 0)
        inodes in use: 25, limits (soft = 0, hard = 0)
</pre></blockquote>

<p>
Para adicionar limites, faça a edição para obter um resultado similar a
este:

<blockquote><pre>
Quotas for user ericj:
/: KBytes in use: 62, limits (soft = 1000, hard = 1050)
        inodes in use: 25, limits (soft = 0, hard = 0)
</pre></blockquote>

<p>
Note que a alocação de quotas está em blocos de 1k.
Nesse caso, o limite mínimo está fixado em 1000k e o limite máximo em
1050k. Um limite mínimo é um limite onde o usuário é avisado quando o
ultrapassa, e tem um período de graça para reduzir seu uso do disco para
abaixo do seu limite. Os períodos de graça podem ser configurados usando
a opção <b>-t</b> do edquota(8). Depois que o perído de graça termina,
o limite mínimo é manipulado como limite máximo. O resultado é uma falha
de alocação.

<p>
Agora que as quotas estão configuradas, você precisa ativá-las.
Para fazer isso, use o comando
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=quotaon&amp;sektion=8">quotaon(8)</a>.
Por exemplo:

<blockquote><pre>
# <b>quotaon -a</b>
</pre></blockquote>

<p>
Esse comando lê o <tt>/etc/fstab</tt> para ativar os sistemas de
arquivos com as opções de quota. Agora que as quotas estão funcionando,
você pode vê-las usando o comando
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=quota&amp;sektion=1">quota(1)</a>.
O uso do comando "<tt>quota &lt;usuário&gt;</tt>" mostra-lhe a
informação do usuário. Quando chamado sem nenhum argumento, o comando
quota(1) mostra-lhe suas estatísticas de quota. Por exemplo:

<blockquote><pre>
# <b>quota ericj</b>
</pre></blockquote>

<p>
Mostra um resultado como este:

<blockquote><pre>
Disk quotas for user ericj (uid 1001): 
     Filesystem  blocks   quota   limit   grace   files   quota   limit   grace
              /      62    1000    1050              27       0       0        
</pre></blockquote>

<p>
Por padrão, as quotas configuradas em <tt>/etc/fstab</tt> são
carregadas na inicialização. Para desligá-las, use:

<blockquote><pre>
# <b>quotaoff -a</b>
</pre></blockquote>

<p>
<a name= "Kerberos"></a>
<h2>10.12 - Configuração de Clientes e Servidores KerberosV</h2>

<p>
O OpenBSD inclui o KerberosV como um componente pré-instalado do sistema
padrão.

<p>
Para mais informações sobre o KerberosV a partir do seu sistema
OpenBSD, use o comando:
<blockquote><pre>
# <b>info heimdal</b>
</pre></blockquote>


<p>
<a name= "AnonFTP"></a>
<h2>10.13 - Configuração de um servidor FTP anônimo</h2>

<p>
O FTP anônimo permite que usuários sem contas acessem arquivos no seu
computador através do Protocolo de Transferência de Arquivos (FTP -
"File Transfer Protocol"). Esta seção oferece um resumo sobre como
configurar um servidor FTP anônimo, seu registro de dados, etc.

<h3>Criação de uma conta FTP</h3>

<p>
Para começar, você precisa ter uma conta <i>ftp</i> em seu sistema.
Essa conta não deve ter uma senha usável. Neste exemplo, nós iremos
configurar o diretório de início de sessão como /home/ftp, mas você
pode colocá-lo em qualquer lugar que quiser.
Quando o ftp anônimo é utilizado, o daemon ftp vai se confinar
(chroot) no diretório pessoal do usuário <i>ftp</i>. Para saber mais
sobre isso, leia as páginas de manual
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8">ftpd(8)</a> e
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chroot&amp;sektion=2">chroot(2)</a>.
Este é um exemplo de como criar o usuário <i>ftp</i>.
Para isso, usaremos o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&amp;sektion=8">adduser(8)</a>.
Nós também precisamos adicionar /usr/bin/false no nosso arquivo
<i>/etc/shells</i>; esse será o &quot;shell&quot; que daremos ao
usuário <i>ftp</i>.
Isso não permite que ele inicie sessão, mesmo dando uma senha vazia.
Para isso, você pode simplesmente fazer o seguinte:

<blockquote><pre>
echo /usr/bin/false &gt;&gt; /etc/shells
</pre></blockquote>

Depois disso, você está pronto para adicionar o usuário <i>ftp</i>:

<blockquote><pre>
# <b>adduser</b>
Use option ``-silent'' if you don't want to see all warnings and questions.

Reading /etc/shells
Reading /etc/login.conf
Check /etc/master.passwd
Check /etc/group

Ok, let's go.
Don't worry about mistakes. I will give you the chance later to correct any input.
Enter username []: <b>ftp</b>
Enter full name []: <b>anonymous ftp</b>
Enter shell csh false ksh nologin sh tcsh zsh [sh]: <b>false</b>
Uid [1002]: <b><i>Enter</i></b>
Login group ftp [ftp]: <b><i>Enter</i></b>
Login group is ``ftp''. Invite ftp into other groups: guest no 
[no]: <b>no</b>
Login class auth-defaults auth-ftp-defaults daemon default staff 
[default]: <b><i>Enter</i></b>
Enter password []: <b><i>Enter</i></b>
Set the password so that user cannot logon? (y/n) [n]: <b>y</b>

Name:        ftp
Password:    ****
Fullname:    anonymous ftp
Uid:         1002
Gid:         1002 (ftp)
Groups:      ftp
Login Class: default
HOME:        /home/ftp
Shell:       /usr/bin/false
OK? (y/n) [y]: <b>y</b>
Added user ``ftp''
Copy files from /etc/skel to /home/ftp
Add another user? (y/n) [y]: <b>n</b>
Goodbye!
</pre></blockquote>

<h3>Configuração do diretório</h3>

<p>
Junto com o usuário, isso criou o diretório <i>/home/ftp</i>. É o que
queremos, mas existem algumas mudanças que temos que fazer para torná-lo
pronto para o ftp anônimo. Novamente, essas mudanças são explicadas na
página de manual
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8">ftpd(8)</a>.

<p>
Você <b>não</b> precisa criar o diretório /home/ftp/usr ou
/home/ftp/bin.
<ul>
<li><i>/home/ftp</i> - Esse é o diretório principal. Seu proprietário
    deve ser o root, e deve ter a permissão 555.
<li><i>/home/ftp/etc</i> - É totalmente opcional e não é recomendado,
    sendo que ele somente serve para dar informações sobre os usuários
    existentes no sistema. Se você quer que seu diretório ftp anônimo
    pareça ter usuários reais associados aos arquivos, você deve copiar
    os arquivos /etc/pwd.db e /etc/group para esse diretório. Esse
    diretório deve estar no modo 511, e os dois arquivos devem estar no
    modo 444. Eles são usados para mostrar os nomes dos proprietários no
    lugar dos números. Não existem senhas guardadas no arquivo pwd.db,
    elas estão todas no spwd.db, então não copie este arquivo.
<li><i>/home/ftp/pub</i> - Esse é o diretório para colocar os arquivos
    que você deseja compartilhar. Esse diretório também deve estar no
    modo 555.
</ul>

<p>
Note que todos esses diretórios devem ser de propriedade de ''root''.
Esta é uma lista de como os diretórios devem se parecer após criados.

<blockquote><pre>
# pwd
/home
# ls -laR ftp
total 5
dr-xr-xr-x  5 root  ftp    512 Jul  6 11:33 .
drwxr-xr-x  7 root  wheel  512 Jul  6 10:58 ..
dr-x--x--x  2 root  ftp    512 Jul  6 11:34 etc
dr-xr-xr-x  2 root  ftp    512 Jul  6 11:33 pub

ftp/etc:
total 43
dr-x--x--x  2 root  ftp    512 Jul  6 11:34 .
dr-xr-xr-x  5 root  ftp    512 Jul  6 11:33 ..
-r--r--r--  1 root  ftp    316 Jul  6 11:34 group
-r--r--r--  1 root  ftp  40960 Jul  6 11:34 pwd.db

ftp/pub:
total 2
dr-xr-xr-x  2 root  ftp  512 Jul  6 11:33 .
dr-xr-xr-x  5 root  ftp  512 Jul  6 11:33 ..
</pre></blockquote>

<h3>Inicialização do servidor e do registro de dados</h3>

<p>
Você pode escolher como iniciar o ftpd, tanto pelo
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=inetd&amp;sektion=8">inetd(8)</a>
ou a partir dos scripts
<a href="#rc">rc</a>.
Estes exemplos mostram nosso daemon sendo iniciado a partir do
inetd.conf.
Mas, antes, precisamos nos familiarizar com algumas das opções do ftpd.
A linha padrão do <i>/etc/inetd.conf</i> é:

<blockquote><pre>
<b>ftp             stream  tcp     nowait  root    /usr/libexec/ftpd       ftpd -US</b>
</pre></blockquote>

<p>
Como você pode ver, o ftpd é executado com <i>-US</i>. Isso registra as
conexões anônimas em <i>/var/log/ftpd</i> e as sessões concorrentes em
<i>/var/run/utmp</i>. Desse modo, poderemos ver essas sessões com o
comando who(1). É possível que alguns queiram apenas ter um servidor
anônimo, e desativar o ftp para usuários. Para isso, você deve executar
o ftpd com a opção <i>-A</i>. Aqui temos uma linha que inicia o ftpd
somente para conexões anônimas. Ele também usa <i>-ll</i> para fazer o
registro de cada conexão usando o syslog, junto com os comandos "get",
"retrive", etc. do ftp.

<blockquote><pre>
<b>ftp             stream  tcp     nowait  root    /usr/libexec/ftpd       ftpd -llUSA</b>
</pre></blockquote>

<p>
<b>Nota:</b> Para aqueles que usam servidores ftp de ALTO tráfego,
pode-se não querer executar o ftpd a partir do inetd.conf. A melhor
opção é comentar a linha ftpd do inetd.conf e iniciar o ftpd a partir do
rc.conf.local usando a opção <i>-D</i>.
Isso inicia o ftpd como um daemon, e será mais simples e rápido
do que iniciar pelo inetd.
Esta é uma linha de exemplo para iniciá-lo a partir do rc.conf.local:

<blockquote><pre>
ftpd_flags="-DllUSA"           # for non-inetd use: ftpd_flags="-D"
</pre></blockquote>

<p>
Evidentemente, somente funciona se você retirou (comentou) o ftpd do
<i>/etc/inetd.conf</i> e fez com que o inetd lesse novamente o arquivo
de configuração.

<h3>Outros arquivos importantes</h3>

<ul>
<li><i>/etc/ftpwelcome</i> - Contém a mensagem de bem-vindo para as
    pessoas que se conectarem ao seu servidor ftp.
<li><i>/etc/motd</i> - Contém a mensagem que as pessoas veem após terem
    se conectado corretamente ao seu servidor ftp.
<li><i>.message</i> - Esse arquivo pode ser colocado em qualquer
    diretório. Ele é mostrado quando o usuário entra naquele
    diretório.
</ul>


<p>
<a name= "ftpchroot"></a>
<h2>10.14 - Como confinar usuários em seus diretórios pessoais no ftpd(8)</h2>

<p>
Por padrão, quando os usuários se conectam por ftp, eles podem ir para
qualquer diretório que tenham acesso no sistema de arquivos.
Isso pode não ser desejável em certas ocasiões.
É possível restringir o que os usuários podem ver em uma sessão ftp,
confinando os usuários em seus diretórios pessoais usando o chroot.

<p>
Se você quer permitir conexões ftp somente em chroot, utilize a opção
<b>-A</b> do
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8">ftpd(8)</a>.

<p>
Se você quer usar o chroot de maneira mais fina, a
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login.conf&amp;sektion=5">
infraestrutura de capacidades de início de sessão</a> e o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8">ftpd(8)</a>
do OpenBSD tornam isso fácil.
<p>

Os usuários em uma classe de início de sessão com a variável
<tt>ftp-chroot</tt> definida são confinados automaticamente.
Adicionalmente, você pode adicionar um nome de usuário no arquivo
<b>/etc/ftpchroot</b> para confinar apenas os usuários que tenham seus
nomes nesse arquivo.
Um usuário somente precisa ser listado em um desses lugares.


<p>
<a name= "Patches"></a>
<h2>10.15 - Como aplicar correções no OpenBSD</h2>

<p>
Mesmo no OpenBSD, erros acontecem.
Alguns problemas podem levar à problemas de confiabilidade (ou seja,
algumas vezes pode fazer com que o sistema pare de funcionar como
desejado). Outros problemas podem levar à vulnerabilidades de segurança
(que pode permitir que outros "usem" seu computador de maneira
não desejada).
Quando uma falha crítica é encontrada, a correção é integrada na
árvore de código fonte <i>-current</i>, e as correções são lançadas para
as <a href="faq5.html#Flavors">releases suportadas</a> do OpenBSD.
Essas correções aparecem na <a href="../../errata.html">página Web das
erratas</a>, e são separadas em correções "commom", aplicáveis em
todas as <a href="../../pt/plat.html">plataformas</a>, e em correções
aplicáveis em uma ou mais plataformas, mas não em todas.

<p>
Note, no entanto, que as correções não adicionam novas funcionalidades
no OpenBSD, e são feitas somente para correções importantes de
confiabilidade ou problemas de segurança, que devem ser conduzidos
de maneira correta nos sistemas afetados (que frequentemente NÃO são
todos os sistemas, dependendo dos propósitos).

<p>
Existem três jeitos de atualizar seu sistema com código fonte corrigido:

<ul>
<li><b>Atualizar a versão do seu sistema para a versão
    <a href="../current.html"><i>-current</i></a>.</b>
    Como todas as correções são aplicadas na base de código fonte
    <i>-current</i>, atualizar seu sistema para a última snapshot
    disponível é uma boa forma de aplicar o código fonte corrigido.
    Entretanto, usar a versão <i>-current</i> não é para qualquer um.
<li><b>Atualizar seu sistema para a versão
    <a href="../../pt/stable.html"><i>-stable</i></a>.</b>
    Isso é feito através do download ou atualização da árvore de
    código fonte usando o ramo <i>-stable</i> apropriado, e recompilando
    o kernel e os utilitários do resto do sistema.
    Em geral, esse é provavelmente o modo mais fácil, mas leva um tempo
    para a recompilação, e o "checkout" completo do código fonte pode
    levar um bom tempo se você tem uma banda de rede limitada.
<li><b>Corrigir, compilar e instalar os arquivos afetados
    individualmente.</b>
    Isso é o que usaremos no nosso exemplo abaixo.
    Enquanto isso requer menos banda de rede e tipicamente menos tempo
    que um checkout/update através do cvs(1) e a compilação do código
    fonte, algumas vezes é a opção mais difícil, já que não existe um
    conjunto universal de instruções a seguir.
    Algumas vezes você deve corrigir, recompilar e instalar um
    aplicativo, outras vezes você tem que recompilar seções inteiras
    da árvore se o problema está em um arquivo de biblioteca.
</ul>

Novamente, corrigir arquivos individuais não é sempre simples, então
pense seriamente em seguir o ramo
<a href="../../pt/stable.html"><i>-stable</i></a> (ou "patch") do
OpenBSD.
Misturar e combinar soluções de correção podem ser feitas se você
entende como tudo funciona, mas novos usuários devem escolher um método
a seguir.

<h3>Quais são as diferenças entre as correções da página das erratas
e aquelas que estão na árvore CVS?</h3>

<p>
Todas as correções postadas na
<a href="../../errata.html">página Web das erratas</a> são correções
feitas na árvore de código fonte da release indicada. Correções na
árvore CVS atual também incluem outras mudanças que não são desejadas em
um sistema de produção.
Isto é importante: se você instalar uma snapshot, fizer o download da
árvore de código fonte no momento em que você obteve a snapshot, e
tentar aplicar uma correção usando um arquivo de correção publicado,
você vai ver que ele não é aplicado, já que o código pode ter mudado.



<h3>Como aplicar as correções.</h3>

<p>
As correções do OpenBSD são distribuídas como diffs unificadas
("Unified diffs"), que são arquivos de texto que guardam as diferenças
em relação ao código fonte original. Elas <b>NÃO</b> são distribuídas
em formato binário. Isso significa que para aplicar as correções no
seu sistema, você precisa ter o código fonte da versão
<b>RELEASE</b> do OpenBSD à vossa disposição.
Geralmente, você deve ter à disposição a árvore de código fonte
completa. Se você está usando a versão release adquirida em um CD-ROM
oficial, as árvores de código fonte estão disponíveis no disco 3, elas
também estão disponíveis como arquivos nos
<a href="../../ftp.html">servidores FTP</a>.
Iremos assumir que você tem a árvore de código fonte completa à
disposição.

<p>
No nosso exemplo, nós vamos olhar a correção 001 para o OpenBSD 3.6,
relacionada ao driver
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=st&amp;sektion=4">st(4)</a>,
que controla drives de fitas magnéticas ("tape drives").
Sem esta correção, restaurar dados de backups é um pouco difícil.
As pessoas que usam um drive de fitas magnéticas <i>precisam</i> desta
correção; no entanto, aquelas que não utilizam podem não ter uma
necessidade particular de instalar a correção.
Vamos olhar a correção:

<blockquote><pre>
# <b>more 001_st.patch</b>
Apply by doing:
        cd /usr/src
        patch -p0 < 001_st.patch

Rebuild your kernel.

Index: sys/scsi/st.c
===================================================================
RCS file: /cvs/src/sys/scsi/st.c,v
retrieving revision 1.41
retrieving revision 1.41.2.1
diff -u -p -r1.41 -r1.41.2.1
--- sys/scsi/st.c       1 Aug 2004 23:01:06 -0000       1.41
+++ sys/scsi/st.c       2 Nov 2004 01:05:50 -0000       1.41.2.1
@@ -1815,7 +1815,7 @@ st_interpret_sense(xs)
        u_int8_t skey = sense->flags & SSD_KEY;
        int32_t info;
 
-       if (((sense->flags & SDEV_OPEN) == 0) ||
+       if (((sc_link->flags & SDEV_OPEN) == 0) ||
            (serr != 0x70 && serr != 0x71))
                return (EJUSTRETURN); /* let the generic code handle it */
</pre></blockquote>

Como você pode ver, no começo do arquivo de correção é incluído breves
instruções sobre como aplicá-lo.
Vamos assumir que você colocou esse arquivo de correção no diretório
<tt>/usr/src</tt>, e as etapas seguintes serão usadas:

<blockquote><pre>
# <b>cd /usr/src</b>
# <b>patch -p0 < 001_st.patch</b>
Hmm...  Looks like a unified diff to me...
The text leading up to this was:
--------------------------
|Apply by doing:
|        cd /usr/src
|        patch -p0 < 001_st.patch
|
|Rebuild your kernel.
|
|Index: sys/scsi/st.c
|===================================================================
|RCS file: /cvs/src/sys/scsi/st.c,v
|retrieving revision 1.41
|retrieving revision 1.41.2.1
|diff -u -p -r1.41 -r1.41.2.1
|--- sys/scsi/st.c      1 Aug 2004 23:01:06 -0000       1.41
|+++ sys/scsi/st.c      2 Nov 2004 01:05:50 -0000       1.41.2.1
--------------------------
Patching file sys/scsi/st.c using Plan A...
Hunk #1 succeeded at 1815.              <i>&lt;-- Olhe essa mensagem!</i>
done
</pre></blockquote>

Note a mensagem "<tt>Hunk #1 succeeded</tt>" acima.
Isso indica que a correção foi aplicada corretamente.
Muitas correções são mais complexas que essa, e envolvem múltiplos
"hunks" e múltiplos arquivos. Você deve se assegurar que todos os
"hunks" foram aplicados com sucesso em todos os arquivos.
Se eles não foram aplicados com sucesso, normalmente isso significa
que sua árvore de código fonte está com problemas, você não seguiu as
instruções com cuidado, ou seu arquivo de correção estava corrompido.
As correções são sensíveis em relação aos espaços em branco -- copiar
e colar a partir do seu navegador frequentemente transforma
caracteres tab em espaços ou altera de outra forma o espaço em branco
de um arquivo, tornando a correção inutilizável.

<p>
Neste ponto, você pode
<a href="faq5.html#Building">compilar o kernel</a> da maneira habitual,
instalá-lo e reinicializar o sistema.

<p>
Nem todas as correções são para o kernel.
Em alguns casos, você terá que recompilar utilitários
individualmente. Em outras vezes, será necessário recompilar todos os
utilitários ligados estaticamente em uma biblioteca corrigida.
Siga o guia no cabeçalho do arquivo de correção, e se você estiver em
dúvida, recompile o sistema inteiro.

<p>
Correções que são irrelevantes ao seu sistema em particular não
precisam ser aplicadas -- usualmente.
Por exemplo, se você não tem um drive de fitas magnética no seu sistema,
você não se beneficiará com a correção acima.
No entanto, assume-se que as correções sejam aplicadas "em ordem"
-- é possível que uma última correção dependa de uma correção aplicada
anteriormente.
Seja consciente a respeito disso se você selecionou o método de
escolher quais correções aplicar, e, se está em dúvida, aplique todas
elas, em ordem.


<a name="httpdchroot"></a>
<h2>10.16 - Me fala sobre o chroot(2) no Apache?</h2>

<p>
No OpenBSD, o servidor
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&amp;sektion=8">httpd(8)</a>
Apache é
"<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chroot&amp;sektion=2">chroot(2)</a>ado"
por padrão. Enquanto é um grande passo do ponto de vista da segurança,
isso pode criar problemas se você não estiver preparado.

<h3>O que é um chroot?</h3>

Um aplicativo
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chroot&amp;sektion=2">chroot(2)</a>ado
é trancado em um diretório específico e não pode passar para o resto
da árvore de diretórios, e vê esse diretório como seu diretório raiz
"<tt>/</tt>" ("root").
No caso do httpd(8), o programa inicia, abre os arquivos de registro,
ouve em suas portas TCP (mas não aceita dados ainda), e lê sua
configuração. Continuando, ele se tranca em <i>/var/www</i> e perde os
privilégios, e então passa a aceitar as requisições.
Isso significa que todos os arquivos servidos e usados pelo Apache
precisam estar no diretório <i>/var/www</i>.
Na configuração padrão do OpenBSD, todos os arquivos no diretório
<i>/var/www</i> estão em modo apenas para leitura para o usuário que
está executando o Apache, o <i>www</i>.
Isso ajuda consideravelmente na segurança -- se existir algum problema
de segurança com o Apache, o dano será confinado a um único diretório
com permissões "apenas para leitura" e sem recursos que possam causar
algum dano.

<h3>O que isso significa para o administrador?</h3>

<p>
Para sermos diretos, "chroot(2)ar" o Apache é uma coisa que não é feita
por padrão na maioria dos outros sistemas operacionais.
Muitas aplicações e configurações do sistema não funcionam em
chroot(2) sem algumas modificações.
No mais, é preciso estar ciente que segurança e conveniência
frequentemente não possuem objetivos compatíveis.
A implementação do Apache no OpenBSD não sacrifica a segurança em
favor das vantagens ou da "facilidade".

<ul>
<li><b>Hierarquia histórica do sistema de arquivos:</b> Servidores que
    foram atualizados a partir de versões antigas do OpenBSD podem ter
    arquivos Web localizados nos diretórios dos usuários, o que
    claramente não funciona em um ambiente "chroot(2)ado", já que o
    httpd(8) não pode alcançar o diretório <i>/home</i>.
    Os administradores também podem acabar descobrindo que a partição
    /var/www é muito pequena para armazenar todos os arquivos Web.
    Suas opções são de reestruturar ou não usar o chroot(2). Você pode,
    naturalmente, usar ligações simbólicas nos diretórios pessoais dos
    usuários apontando para subdiretórios em <i>/var/www</i>, mas você
    NÃO pode usar ligações em <i>/var/www</i> apontando para outras
    partes do sistema de arquivos -- isso não funciona por causa do
    chroot(2). Note que se você quer que seus usuários tenham
    <a href="faq10.html#ftpchroot">acesso ao FTP "chroot(2)ado"</a>,
    isso não funciona, já que o chroot do FTP (novamente) impede
    que você acesse os alvos das ligações simbólicas. Uma solução para
    isso é não usar <i>/home</i> como base para os diretórios pessoais
    dos seus usuários, e usar no lugar algo similar a
    <i>/var/www/users</i>. Ligações simbólicas podem ser usadas dentro
    do chroot(2), mas elas devem ser relativas, não absolutas.

<li><b>Rotação dos arquivos de registro:</b> Normalmente, a rotação de
    arquivos de registro é feita renomeando os arquivos antigos, e então
    enviando ao httpd(8) um sinal SIGUSR1 para fazer com que o Apache
    feche os arquivos de registro antigos e abra os novos arquivos.
    Isso não é mais possível, porque o httpd(8) não tem a possibilidade
    de abrir arquivos de registro para a escrita, já que os privilégios
    foram perdidos. O httpd(8) precisa ser parado e reiniciado.
    Algumas vezes leva alguns segundos para que todos os processos
    filhos sejam terminados, e isso precisa acontecer antes que o
    httpd(8) possa ser reiniciado; então, uma maneira possível de fazer
    a rotação dos arquivos de registro é a seguinte:

<blockquote><pre>
# <b>apachectl stop</b>
    <i>renomeie seus arquivos de registro</i>
# <b>apachectl start ; sleep 10 ; apachectl start</b>
</pre></blockquote>

    Sim, a última linha tenta reiniciar o Apache imediatamente, e, em
    caso de falha, ele espera alguns segundos e tenta novamente.
    E sim, isso significa que, por alguns segundos e em todas as vezes
    que você fizer a rotação de arquivos de registro, seu servidor Web
    estará indisponível. Enquanto isso possa parecer chato, qualquer
    tentativa de permitir que o httpd(8) abra novamente os arquivos após
    ser "chroot(2)ado" vai contra o propósito do chroot!
    Existem também outras estratégias disponíveis, incluindo fazer o
    registro de dados em um
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pipe&amp;sektion=2">pipe(2)</a>,
    e usar um programa externo para fazer a rotação na outra ponta do
    pipe(2).

<li><b>Módulos Apache existentes:</b> Praticamente todos carregam,
    no entanto, alguns podem não funcionar corretamente no chroot(2), e
    muitos têm problemas com o
    "<tt><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=apachectl&amp;sektion=8">apachectl</a>
    restart</tt>", gerando um erro que faz com que o httpd(8) termine
    sua execução.

<li><b>CGIs existentes:</b> A maioria NÃO funciona como deve. Eles
    podem precisar de programas ou bibliotecas que estão fora de
    <i>/var/www</i>. Alguns podem ser corrigidos através da compilação
    e ligação estática (não necessitando de bibliotecas em outros
    diretórios), a maioria pode ser corrigida através da cópia de
    arquivos requeridos no diretório <i>/var/www</i>, mas isso não é
    algo trivial e requer algum conhecimento do programa.

<li><b>Opções de montagem do sistema de arquivos:</b>
    Por padrão, no OpenBSD, sua partição <i>/var</i> é montada com as
    opções <tt>nosuid</tt> e <tt>nodev</tt>.
    Se você tentar usar uma aplicação dentro do chroot, você pode
    precisar ter que mudar aquelas opções.
    Normalmente, talvez você precise fazer isso mesmo se você não usa a
    opção chroot.

<li><b>Resolução de nomes:</b>
    O httpd(8) dentro do chroot(2) não é capaz de usar os arquivos
    do sistema <i>/etc/hosts</i> ou <i>/etc/resolv.conf</i>. Então, se
    você tem aplicações que requerem resolução de nomes, você vai
    precisar copiar o arquivo <i>/var/www/etc/hosts</i> e/ou
    <i>/var/www/etc/resolv.conf</i> para o ambiente chroot(2). Note que
    algumas aplicações esperam a resolução do "localhost" para
    funcionar.

</ul>

Em alguns casos, a aplicação ou a configuração pode ser alterada para
ser executada dentro do chroot(2).
Em outros casos, você simplesmente terá que desabilitar essa
funcionalidade usando a opção <tt>-u</tt> do httpd(8) no
<i><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf.local&amp;sektion=8">/etc/rc.conf.local</a></i>.

<h3>Exemplo de chroot(2) de uma aplicação: wwwcount</h3>
Como exemplo de um processo que pode ser usado para fazer o chroot de
uma aplicação, nós vamos olhar o caso do wwwcount, um contador simples
de páginas Web, disponível através dos
<a href="faq15.html#PkgMgmt">pacotes</a>.
Embora seja um programa eficaz, ele não sabe nada sobre o Apache
"chroot(2)ado", e não funciona "chroot(2)ado" em sua configuração
padrão.

<p>
Primeiro, nós instalamos o pacote
<a href="http://www.muquit.com/muquit/software/Count/Count.html">wwwcount</a>.
Nós configuramos e testamos, e descobrimos que ele parece não funcionar:
o Apache nos retorna uma mensagem dizendo "Internal Server Error".

O primeiro passo consiste em parar e reiniciar o Apache com o comutador
<tt>-u</tt> para verificar se o problema vem do chroot(2), e não da
configuração do sistema.

<blockquote><pre>
# <b>apachectl stop</b>
/usr/sbin/apachectl stop: httpd stopped
# <b>httpd -u</b>
</pre></blockquote>

Após fazer isso, nós constatamos que o contador funciona corretamente,
devido à mudança de dono em um diretório que o Apache (e os CGIs que
ele executa) pode escrever nos arquivos.
Assim, temos definitivamente um problema de chroot, então paramos e
reiniciamos novamente o Apache, usando o chroot por padrão:

<blockquote><pre>
# <b>apachectl stop</b>
/usr/sbin/apachectl stop: httpd stopped
# <b>httpd</b>
</pre></blockquote>

<p>
Um bom ponto de partida pode ser supor que o wwwcount usa algumas
bibliotecas e outros arquivos que ele não pode acessar estando em
chroot.
Nós podemos usar o comando
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ldd&amp;sektion=1">ldd(1)</a>
para descobrir as dependências dinâmicas do CGI em questão:

<blockquote><pre>
# <b>cd /var/www/cgi-bin/</b>
# <b>ldd Count.cgi</b>
Count.cgi:
        Start    End      Type Open Ref GrpRef Name
        1c000000 3c007000 exe  1    0   0      /var/www/cgi-bin/Count.cgi
        0c085000 2c0be000 rlib 0    1   0      /usr/lib/libc.so.50.1
        08713000 08713000 rtld 0    1   0      /usr/libexec/ld.so
</pre></blockquote>

Certo, esse é um problema, dois arquivos que não estão disponíveis no
ambiente chroot(2).
Então nós copiamos para o ambiente:

<blockquote><pre>
# <b>mkdir -p /var/www/usr/lib /var/www/usr/libexec</b>
# <b>cp /usr/lib/libc.so.50.1 /var/www/usr/lib</b>
# <b>cp /usr/libexec/ld.so /var/www/usr/libexec</b>
</pre></blockquote>

e tentamos usar o contador novamente.

<p>
Bem, agora o programa está em execução e nos enviando as mensagens de
erro diretamente: "Unable to open config file for reading".
Nós fizemos um progresso, mas ainda não terminamos.
O arquivo de configuração fica normalmente em
<tt>/var/www/wwwcount/conf</tt>,
mas dentro do ambiente chroot ele deve ser procurado em
<tt>/wwwcount/conf</tt>.
Nós temos duas opções: uma é recompilar o programa para fazer ele
funcionar com a nova localização dos arquivos, a outra é mover os
arquivos de dados.
Como nós instalamos a partir de um pacote, vamos apenas mover os
arquivos de dados.
Para usar a mesma configuração em chroot(2) ou não, iremos usar
uma ligação simbólica:

<blockquote><pre>
# <b>mkdir -p /var/www/var/www</b>
# <b>cd /var/www/var/www</b>
# <b>ln -s ../../wwwcount wwwcount</b>
</pre></blockquote>

Repare que a ligação simbólica é pensada para funcionar dentro do
chroot. Novamente, nós testamos... e descobrimos mais um problema.
Agora o wwwcount está reclamando que não pode achar os arquivos
"strip image" que ele utiliza para mostrar as mensagens.
Após um pouco de pesquisa, descobrimos que aqueles arquivos são
armazenados em <tt>/usr/local/lib/wwwcount</tt>, então nós temos que
copiá-los no ambiente chroot, como de hábito.

<blockquote><pre>
# <b>tar cf - /usr/local/lib/wwwcount | (cd /var/www; tar xpf - )</b>
</pre></blockquote>

nós testamos novamente... e ele funcionou!

<p>
Note que somente copiamos os arquivos que são absolutamente necessários
para o bom funcionamento.
Geralmente, somente o mínimo possível de arquivos necessários para
executar uma aplicação deve ser copiado no ambiente chroot.

<h3>Devo utilizar o chroot?</h3>
No exemplo acima, o programa é relativamente simples, e ainda assim
encontramos diferentes tipos de problemas.

<p>
<i>Nem toda aplicação pode ou deve ser "chroot(2)ada".</i>

<p>
O objetivo é um servidor Web seguro, o chroot(2) é apenas uma ferramenta
para alcançar isso, não é o objetivo por si só.
Lembre-se, a configuração inicial do Apache em chroot(2) do OpenBSD
é onde o usuário que está executando o programa httpd(8) não pode
executar nenhum programa, não pode alterar nenhum arquivo, e não pode
assumir outra identidade de usuário.
Perdendo essas restrições, você perde parte da sua segurança, usando
ou não o chroot.

<p>
Algumas aplicações são relativamente simples, e utilizar o chroot(2)
faz sentido. Outras são muito complexas, e não valem o esforço
necessário para colocá-las em chroot(2), ou o tempo que você vai levar
para copiar uma boa parte do sistema para o chroot, e no final acaba-se
perdendo o benefício do ambiente chroot(2).
Por exemplo, o programa OpenWebMail precisa ser capaz de ler e escrever
no diretório de correio eletrônico, no diretório pessoal do usuário, e
também precisa ser capaz de funcionar usando qualquer usuário no
sistema. Tentar colocá-lo em chroot será inútil, já que você será
obrigado a desativar todos os benefícios do uso do chroot(2).
Mesmo com uma aplicação tão simples como o contador, ele precisa
escrever no disco (para guardar sua contagem), então <i>parte</i> do
benefício do chroot(2) é perdida.

<p>
Qualquer aplicação que deve funcionar com privilégios de root é inútil
no escopo do chroot(2), já que o root pode sair do chroot(2).

<p>
Não se esqueça que, se o processo de colocar sua aplicação em chroot é
muito difícil, você não pode atualizar ou instalar uma nova versão do
sistema na frequência que deveria.
Isso pode acabar tornando seu sistema MENOS seguro que um sistema mais
atualizado e com o chroot desativado.

<a name="rootshell"></a>
<h2>10.17 - Posso mudar o shell do usuário root?</h2>
Algumas vezes é dito que não se deve mudar o shell do usuário root,
apesar de não existir razão para não fazer isso no OpenBSD.

<p>
O shell padrão para o usuário <i>root</i> no OpenBSD é o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1">ksh</a>.

<p>
Uma diretiva Unix tradicional é usar para o root somente shells
compilados estaticamente, porque se seu sistema entra em modo usuário
único, partições não-raiz não são montadas, e shells ligados
dinamicamente não são capazes de acessar as bibliotecas situadas na
partição <tt>/usr</tt>. Isso não é realmente um problema significante
no OpenBSD, já que o sistema pergunta por um shell quando ele
entra em modo usuário único, e o shell por padrão é o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sh&amp;sektion=1">sh</a>.

Os três shells padrão do OpenBSD
(<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=csh&amp;sektion=1">csh</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sh&amp;sektion=1">sh</a>
e
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1">ksh</a>)
são todos ligados estaticamente, e são utilizáveis no modo usuário
único.


<a name="ksh"></a>
<h2>10.18 - O que mais posso fazer com o <i>ksh</i>?</h2>
No OpenBSD,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1">ksh</a>
é o <a href="http://web.cs.mun.ca/~michael/pdksh/">pdksh</a>,
o shell Korn em Domínio Público ("Public Domain Korn Shell"), e é o
mesmo binário que o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sh&amp;sektion=1">sh</a>.

<p>
Usuários confortáveis com o shell <i>bash</i>, utilizado na maioria das
vezes em sistemas Linux, provavelmente acharão o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1">ksh</a>
muito familiar. O ksh(1) oferece a maioria das opções encontradas no
shell <i>bash</i>, incluindo a completação de comandos através da tecla
tab, edição de linha de comando e acesso ao histórico através das teclas
direcionais, e CTRL-A/CTRL-E para pular para o começo ou fim da linha de
comando. Se você deseja outras opções do shell <i>bash</i>, o próprio
<i>bash</i> pode ser instalado através dos
<a href="faq15.html#PkgMgmt">pacotes</a>
ou através dos <a href="faq15.html#Ports">portes</a>.

<p>
O prompt de comando do <i>ksh</i> pode ser facilmente alterado para
fornecer mais informações do que o prompt padrão "$ ", através da
configuração da variável <tt>PS1</tt>. Por exemplo, ao inserir a
seguinte linha:

<blockquote><pre>
export PS1='$PWD $ '
</pre></blockquote>

no seu arquivo <tt>/etc/profile</tt>, produz-se o seguinte prompt de
comando:

<blockquote><pre>
/home/nick $
</pre></blockquote>

Veja o arquivo
<a href="http://www.openbsd.org/cgi-bin/cvsweb/~checkout~/src/etc/ksh.kshrc?content-type=text/plain"><tt>/etc/ksh.kshrc</tt></a>,
que inclui muitas opções úteis e exemplos, e pode ser executado em seu
arquivo <tt>.profile</tt> de usuário.

<p>
O shell ksh(1) do OpenBSD foi melhorado. Vários "caracteres especiais"
para a sequência primária de prompt, PS1, similares àqueles usados no
shell bash, foram adicionados.
Por exemplo:
<blockquote>
<tt>\e - </tt>Insere um caractere de escape ASCII.<br>
<tt>\h - </tt>O nome da máquina, sem o nome de domínio.<br>
<tt>\H - </tt>O nome completo da máquina, incluindo o nome de domínio.<br>
<tt>\n - </tt>Insere um caractere de nova linha.<br>
<tt>\t - </tt>O horário atual, no formato HH:MM:SS de 24 horas.<br>
<tt>\u - </tt>O nome do usuário atual.<br>
<tt>\w - </tt>O diretório de trabalho atual. $HOME é abreviado como `~'.<br>
<tt>\W - </tt>O nome base do diretório de trabalho atual.<br>
<tt>\$ - </tt>Mostra "#" para os usuários root, e "$" para os outros.
</blockquote>

(veja a página de manual
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1">ksh(1)</a>
para obter mais detalhes, e muito, muito mais caracteres especiais!
Também note que o caractere "$" tem um significado especial dentro de
aspas duplas, então manipule-o com cuidado)

<p>
Você pode usar o seguinte comando:
<blockquote><pre>
export PS1="\n\u@\H\n\w \\$ "
</pre></blockquote>
para ter um prompt de comando excessivamente detalhado, mas de certa
forma útil.


<p>
<a name="Dir"></a>
<h2>10.19 - Serviços de diretório</h2>

<p>
O OpenBSD pode ser usado como servidor e cliente de banco de dados
contendo credenciais de usuários, informações de grupos e outros dados
relacionados à rede.

<p>
<a name="Dir.available"></a>
<h3>10.19.1 - Quais serviços de diretório estão disponíveis?</h3>

<p>
Naturalmente, você pode usar vários serviços de diretório no OpenBSD.
Mas o YP é o único que pode ser acessado diretamente usando as funções
da biblioteca padrão de C como
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=getpwent&amp;sektion=3"
>getpwent(3)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=getgrent&amp;sektion=3"
>getgrent(3)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gethostbyname&amp;sektion=3"
>gethostbyname(3)</a> e outras.
Assim, se você mantém seus dados em um banco de dados YP, você não
precisa copiá-lo para arquivos de configuração locais como
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=master.passwd&amp;sektion=5"
>master.passwd(5)</a> antes de você poder utilizá-lo,
por exemplo, para autenticar usuários do sistema.

<p>
YP é um serviço de diretório compatível com o
NIS ("Network Information System", ou Sistema de Informação da Rede) da
Sun Microsystems.
Veja
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=yp&amp;sektion=8">yp(8)</a>
para uma visão geral sobre as páginas de manual disponíveis.
Seja cuidadoso, alguns sistemas operacionais possuem serviços de
diretório com nomes parecidos, mas todos são incompatíveis; por
exemplo, NIS+.

<p>
Para usar outros serviços de diretório, exceto o YP, você precisa
popular arquivos de configuração locais a partir do diretório, ou você
precisa de um "frontend" YP para o diretório.
Por exemplo, você pode usar o porte <tt>sysutils/login_ldap</tt> quando
escolher o primeiro, enquanto o daemon
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ypldap&amp;sektion=8"
>ypldap(8)</a> fornece o último.

<p>
Para algumas aplicações, a simples sincronização de um pequeno número
de arquivos de configuração entre um grupo de máquinas usando
ferramentas como
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cron&amp;sektion=8"
>cron(8)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=scp&amp;sektion=1"
>scp(1)</a> ou <tt>rsync</tt> (disponível no portes) se torna uma
alternativa fácil e robusta para um serviço de diretório completo.

<a name="YP_secure"></a> 
<h3>10.19.2 - Considerações de segurança sobre YP</h3>

<p>
Por razões de compatibilidade, todas as características de segurança
embutidas na implementação de YP do OpenBSD estão <em>desativadas</em>,
por padrão.
Mesmo quando elas estão todas ativadas, o protocolo NIS ainda é
de natureza insegura por duas razões:
Todos os dados, incluindo dados sensíveis como dispersões de senhas,
são transmitidos sem encriptação na rede, e nem o cliente nem o
servidor podem verificar confiavelmente a identidade um do
outro.

<p>
Dessa forma, antes de ativar qualquer servidor YP, você deve considerar
se essas falhas de segurança são aceitáveis no seu contexto.
Em particular, YP é inadequado se atacantes em potencial têm acesso
físico à sua rede.
Qualquer um com acesso root em qualquer computador conectado no seu
segmento de rede com tráfego YP pode enganar o seu domínio YP e
recuperar seus dados.
Em alguns casos, passar o tráfego YP por túneis SSL ou IPSec pode ser
uma opção, ou você pode considerar a combinação de YP com autenticação
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=kerberos&amp;sektion=8"
>kerberos(8)</a>.

<a name="YP_server"></a> 
<h3>10.19.3 - Configuração de um servidor YP</h3>

<ol>
<li><p>
Um servidor YP serve um grupo de clientes chamado de um "domínio".
Você primeiro deve selecionar um nome de domínio; ele pode ser uma
string arbitrária e não precisa estar relacionado em nenhuma forma com
nomes de domínio DNS.
Escolher um nome aleatório, como "Eepoo5vi", pode melhorar marginalmente
a segurança, embora o efeito seja de segurança por obscuridade.
Caso você precise manter vários domínios YP diferentes, provavelmente
é melhor escolher nomes descritivos como "vendas",
"marketing" e "pesquisa" para evitar erros de administração do sistema
causados pela obscuridade.

Também note que algumas versões do SunOS requerem o uso do nome de
domínio DNS da máquina, então sua escolha pode ser restrita em uma rede
que inclui tais máquinas.

<p>
Use o utilitário
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=domainname&amp;sektion=1"
>domainname(1)</a> para definir um nome de domínio, e coloque-o no
arquivo
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=defaultdomain&amp;sektion=5"
>defaultdomain(5)</a> para defini-lo automaticamente durante a
inicialização do sistema.

<blockquote><pre>
echo "puffynet" > /etc/defaultdomain
domainname `cat /etc/defaultdomain`
</pre></blockquote>

<li><p>
    Inicialize o servidor YP usando o comando interativo

<blockquote><pre>
ypinit -m
</pre></blockquote>

    Neste ponto ainda não é necessário especificar os servidores
    escravos.
    Para adicionar servidores escravos, você deve executar novamente o
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ypinit&amp;sektion=8"
    >ypinit(8)</a> usando a opção <tt>-u</tt>.

    Configurar ao menos um servidor escravo para cada domínio é útil
    para evitar as interrupções de serviço, pois o servidor mestre pode
    desligar-se ou perder a conectividade de rede; em particular, os
    processos clientes tentando acessar os mapas YP ficarão bloqueados
    indefinidamente até que eles recebam a informação requerida. Assim,
    interrupções de serviço YP tipicamente fazem com que as máquinas
    clientes fiquem inutilizáveis até que o serviço YP volte a
    funcionar.

<li><p>
    Decida onde guardar os arquivos fonte usados para gerar seus mapas
    YP.
    Manter a configuração do servidor separada da configuração servida
    ajuda a controlar quais informações serão servidas e quais não
    serão, então o <tt>/etc</tt> padrão na maioria das vezes não é
    a melhor escolha.

    <p>
    A única inconveniência causada por mudar o diretório fonte é
    que você não será capaz de adicionar, remover e modificar usuários
    e grupos no domínio YP usando utilitários como
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=user&amp;sektion=8"
    >user(8)</a> e
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=group&amp;sektion=8"
    >group(8)</a>.
    No lugar, você terá que editar os arquivos de configuração com um
    editor de texto.

    <p>
    Para definir o diretório fonte, edite o arquivo
    <tt>/var/yp/`domainname`/Makefile</tt>
    e mude a variável <tt>DIR</tt>; por exemplo

<blockquote><pre>
DIR=/etc/yp/src/puffynet
</pre></blockquote>

<li><p>
    Considere a personalização de outras variáveis em
    <tt>/var/yp/`domainname`/Makefile</tt>. Veja
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=Makefile.yp&amp;sektion=8"
    >Makefile.yp(8)</a> para obter mais detalhes.

    <p>
    Por exemplo, mesmo no caso de você utilizar o diretório fonte
    padrão, <tt>/etc</tt>, você usualmente não precisa ter todas as
    contas e grupos existentes no servidor em todas as suas máquinas
    cliente.
    Em particular, não servir a conta do root e, assim, manter a
    dispersão da senha do root confidencial é, frequentemente,
    benéfico para a segurança.
    Revise os valores de <tt>MINUID</tt>, <tt>MAXUID</tt>,
    <tt>MINGID</tt> e <tt>MAXGID</tt> e ajuste-os de acordo com as suas
    necessidades.

    <p>
    Se todos os seus clientes YP usam OpenBSD ou FreeBSD, exclua as
    senhas encriptadas dos mapas <tt>passwd</tt> definindo
    <tt>UNSECURE=""</tt> em
    <tt>/var/yp/`domainname`/Makefile</tt>.

    <p>
    A prática anterior de editar o arquivo modelo
    <tt>/var/yp/Makefile.yp</tt> não é mais recomendada. Mudanças
    naquele arquivo afetam todos os domínios inicializados após a
    mudança, mas não afetam domínios inicializados antes da mudança,
    dessa forma essa prática é propensa a erros:
    você tem o risco de que as mudanças não tenham efeito, e o risco
    de esquecê-las e delas afetarem outros domínios mais tarde, para
    os quais essas mudanças nunca foram pretendidas.

<li><p>
    Crie o diretório fonte e popule-o com os arquivos de configuração
    que você necessita. Veja
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=Makefile.yp&amp;sektion=8"
    >Makefile.yp(8)</a> para aprender sobre quais mapas YP requerem
    quais arquivos fonte.
    Para o formato de arquivos de configuração individuais, consulte
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=passwd&amp;sektion=5"
    >passwd(5)</a>,
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=group&amp;sektion=5"
    >group(5)</a>,
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hosts&amp;sektion=5"
    >hosts(5)</a> e outros, e olhe nos exemplos em <tt>/etc</tt>.

<li><p>
    Crie a versão inicial dos seus mapas YP utilizando os comandos

<blockquote><pre>
cd /var/yp
make
</pre></blockquote>

    Não se preocupe com as mensagens de erro do
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=yppush&amp;sektion=8"
    >yppush(8)</a> por enquanto.
    O servidor YP não está em execução ainda.

<li><p>
    YP utiliza o
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rpc&amp;sektion=3"
    >rpc(3)</a> ("remote procedure calls", ou
    chamadas de procedimento remoto) para comunicar-se com os
    clientes, então é necessário ativar o
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=portmap&amp;sektion=8"
    >portmap(8)</a>.
    Para fazer isso, edite o
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf.local&amp;sektion=8"
    >rc.conf.local(8)</a> e defina <tt>portmap=YES</tt>.
    Isso iniciará o portmapper na próxima inicialização.
    Você pode evitar a reinicialização iniciando-o manualmente:

<blockquote><pre>
echo "portmap=YES" >> /etc/rc.conf.local
portmap
</pre></blockquote>

<li><p>
    Considere o uso do recurso de segurança
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=securenet&amp;sektion=5"
    >securenet(5)</a> ou o
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ypserv.acl&amp;sektion=5"
    >ypserv.acl(5)</a> do daemon servidor YP.
    Mas esteja atento ao fato de que ambos somente fornecem controle de
    acesso baseado em IP.
    Dessa forma, eles somente ajudam enquanto atacantes em potencial
    não possuem acesso físico ao hardware do segmento de rede
    transmitindo seu tráfego YP nem acesso root em qualquer máquina
    conectada a esses segmentos de rede.

<li><p>
    Finalmente, inicie o daemon servidor YP:

<blockquote><pre>
ypserv
</pre></blockquote>

    Ele será reiniciado automaticamente durante a inicialização contanto
    que o diretório <tt>/var/yp/`domainname`</tt> continue existindo.

<li><p>
    Para testar o novo servidor, considere torná-lo o seu próprio
    cliente, seguindo as instruções na primeira parte da próxima seção.
    Caso você não queira usar seus próprios mapas, você pode desativar
    a parte do cliente após o teste, com os seguintes comandos:

<blockquote><pre>
pkill ypbind
rm -rf /var/yp/binding
</pre></blockquote>

<li><p>
    Se você deseja permitir que usuários mudem suas senhas a partir de
    máquinas clientes, então você precisa ativar
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=yppasswdd&amp;sektion=8"
    >yppasswdd(8)</a>:

<blockquote><pre>
echo 'yppasswdd_flags="-d /etc/yp/src/puffynet"' >> /etc/rc.conf.local
rpc.yppasswdd
</pre></blockquote>

Caso você deixe o diretório fonte no <tt>/etc</tt> padrão, use apenas
<tt>yppasswdd_flags=""</tt>.

<li><p>
    Lembre-se que a cada vez que você muda um arquivo incluído por um
    mapa YP, você deve gerar novamente seus mapas YP.

<blockquote><pre>
cd /var/yp
make
</pre></blockquote>

    Isso atualiza todos os arquivos de banco de dados em
    <tt>/var/yp/`domainname`</tt>, com uma exceção:
    o arquivo <tt>ypservers.db</tt>, que lista todos os servidores YP,
    mestres e escravos, associados ao domínio, é criado diretamente com
    <tt>ypinit -m</tt> e modificado exclusivamente por
    <tt>ypinit -u</tt>.
    No caso de você excluí-lo acidentalmente, execute <tt>ypinit -u</tt>
    para recriá-lo a partir do zero.
</ol>

<a name="YP_client"></a> 
<h3>10.19.4 - Configuração de um cliente YP</h3>

Configurar um cliente YP envolve duas partes distintas.
Em primeiro lugar, você precisa de um daemon cliente YP em execução,
conectando a sua máquina cliente ao servidor YP.
Ao finalizar os passos seguintes, você será capaz de recuperar dados
de um servidor YP, mas aqueles dados ainda não serão usados pelo
sistema:

<ol>
<li><p>
    Igual no servidor, você precisa definir um nome de domínio e ativar
    o portmapper:

<blockquote><pre>
echo "puffynet" > /etc/defaultdomain
domainname `cat /etc/defaultdomain`
echo "portmap=YES" >> /etc/rc.conf.local
portmap
</pre></blockquote>

<li><p>
    É recomendado o fornecimento de uma lista de servidores YP no
    arquivo de configuração <tt>/etc/yp/`domainname`</tt>.
    Caso contrário, o daemon cliente YP usará emissões ("broadcasts")
    de rede para encontrar os servidores YP para seu domínio.
    Especifique de maneira explícita os servidores que são mais
    robustos e marginalmente menos abertos à ataques.
    Se você não configurou os servidores escravos, apenas coloque o
    nome de máquina do servidor mestre em <tt>/etc/yp/`domainname`</tt>.

<li><p>
    O daemon cliente YP é chamado de
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ypbind&amp;sektion=8"
    >ypbind(8)</a>.
    A inicialização manual criará o diretório <tt>/var/yp/binding</tt>,
    como ele será automaticamente reiniciado na inicialização.

<blockquote><pre>
ypbind
</pre></blockquote>

<li><p>
    Se tudo ocorrer bem, você deve ser capaz de consultar o servidor YP
    usando o
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ypcat&amp;sektion=1"
    >ypcat(1)</a> e ver seu mapa de senha como resposta.

<blockquote><pre>
ypcat passwd
bob:*:5001:5000:Bob Nuggets:/home/bob:/usr/local/bin/zsh
...
</pre></blockquote>

    Outras ferramentas úteis para a depuração da sua configuração YP
    incluem
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ypmatch&amp;sektion=1"
    >ypmatch(1)</a> e
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=yptest&amp;sektion=8"
    >yptest(8)</a>.
</ol>

A segunda parte da configuração de um cliente YP envolve a edição de
arquivos de configuração locais, tais como certos mapas YP usados
por várias instalações do sistema.
Nem todos os servidores servem todos os mapas padrão suportados pelo
sistema operacional, alguns servidores servem mapas adicionais, que não
fazem parte do padrão, e você não tem meios de forçar o uso de todos
aqueles mapas.
Quais dos mapas disponíveis serão ou não serão usados, e para quais
propósitos eles serão usados, é responsabilidade do administrador de
sistema da máquina cliente.

<p>
Para uma lista de mapas YP padrão e seus usos, veja
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=Makefile.yp&amp;sektion=8"
>Makefile.yp(8)</a>.
Os casos mais comuns de uso incluem:

<ul>
<li><p>
    Se você quer incluir todas as contas de usuário do domínio YP,
    acrescente o marcador YP padrão no arquivo de senhas mestre e
    recompile o banco de dados de senhas:

<blockquote><pre>
echo '+:*::::::::' >> /etc/master.passwd
pwd_mkdb -p /etc/master.passwd
</pre></blockquote>

    Para detalhes sobre inclusão e exclusão seletiva de contas de
    usuário, veja
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=passwd&amp;sektion=5"
    >passwd(5)</a>.
    Para testar se a inclusão funciona, use o utilitário
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=id&amp;sektion=1"
    >id(1)</a>.

<li><p>
    Se você quer incluir todos os grupos de um domínio YP, acrescente
    o marcador YP padrão no arquivo de grupo:

<blockquote><pre>
echo '+:*::' >> /etc/group
</pre></blockquote>

    Para detalhes sobre a inclusão seletiva de grupo, veja
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=group&amp;sektion=5"
    >group(5)</a>.

<li><p>
    Se você está distribuindo nomes de máquina via YP, você agora deve
    revisar o
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=resolv.conf&amp;sektion=5"
    >resolv.conf(5)</a> e verificar se a ordem de procura de nome de
    serviço está correta.
    A maioria dos usuários utilizarão uma linha como esta:

<blockquote><pre>
lookup file yp bind
</pre></blockquote>
</ul>


<p>
<font color= "#0000e0">
<a href= "index.html">[Índice da FAQ]</a>
<a href= "faq9.html">[Seção 9 - Migração para OpenBSD]</a>
<a href="faq11.html">[Seção 11 - O sistema X Window]</a>
</font>

<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../../images/back.gif" border= "0" alt="[voltar]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: faq10.html,v 1.148 ]<br>
$Translation: faq10.html,v 1.11 2009/11/07 08:41:06 alan Exp $<br>
-->
$OpenBSD: faq10.html,v 1.10 2009/11/08 22:09:17 tobias Exp $
</small>
</body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>4 - Guia de instalação do OpenBSD 4.5</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 1998-2009 by OpenBSD.">
</head>

<!-- Passes validator.w3.org.  Please keep it this way -->

<body bgcolor= "#ffffff" text= "#000000">

<a href="../../pt/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif"
border="0">
</a>
<p>

<font color= "#0000e0">
<a href="index.html">[Índice da FAQ]</a>
<a href="faq3.html">[Seção 3 - Primeiros passos com o OpenBSD]</a>
<a href="faq5.html">[Seção 5 - Construção do Sistema a partir do Código Fonte]</a>
</font>

<h1><font color="#e00000">4 - Guia de Instalação do OpenBSD 4.5</font></h1>
<hr>

<p>
<h3>Conteúdo</h3>
<ul>
<li><a href="#Overview"		>4.1 - Visão geral do processo de
    instalação do OpenBSD</a>
<li><a href="#Checklist"	>4.2 - Lista de verificações antes da
    instalação</a>
<li><a href="#MkInsMedia"	>4.3 - Como criar uma mídia
    inicializável de instalação do OpenBSD</a>
    <ul>
    <li><a href="#UnixFlop"		>4.3.1 - Criação de disquetes no
        Unix</a>
    <li><a href="#DosFlop"		>4.3.2 - Criação de disquetes no
        Windows</a>
    <li><a href="#MkCD-ROM"		>4.3.3 - Criação do CD de
	inicialização</a>
    </ul>
<li><a href="#Boot"		>4.4 - Inicialização da mídia de
    instalação do OpenBSD</a>
<li><a href="#Install"		>4.5 - Como fazer a instalação</a>
  <ul>
  <li><a href="#Start"			>4.5.1 - Início da instalação</a>
  <li><a href="#Disks"			>4.5.2 - Configuração dos discos</a>
  <li><a href="#Hostname"		>4.5.3 - Configuração do nome de
      máquina do sistema</a>
  <li><a href="#Network"		>4.5.4 - Configuração da rede</a>
  <li><a href="#InstMedia"		>4.5.5 - Escolha da mídia de
      instalação</a>
  <li><a href="#Filesets"		>4.5.6 - Escolha dos pacotes
      de arquivos</a>
  <li><a href="#Finish"		 	>4.5.7 - Finalização</a>
  </ul>

<li><a href="#FilesNeeded"	>4.6 - Quais arquivos são necessários
    para a instalação?</a>
<li><a href="#Partitioning"	>4.7 - Quanto de espaço eu preciso para
    uma instalação do OpenBSD?</a>
<li><a href="#Multibooting"	>4.8 - Inicialização múltipla com
    OpenBSD</a>
<li><a href="#SendDmesg"	>4.9 - Como enviar o seu dmesg para
    dmesg@openbsd.org após a instalação</a>
<li><a href="#AddFileSet"	>4.10 - Como adicionar um pacote de
    arquivos após a instalação</a>
<li><a href="#bsd.rd"		>4.11 - O que é 'bsd.rd'?</a>
<li><a href="#InstProb"		>4.12 - Problemas comuns de instalação</a>
  <ul>
  <li><a href="#cpq16m"			>4.12.1 - Meu Compaq só
      reconhece 16M de RAM</a>
  <li><a href="#noboot"			>4.12.2 - Meu i386 não
      inicializa após a instalação</a>
  <li><a href="#sshhang"		>4.12.3 - Minha máquina
      inicializa, mas para no procedimento ssh-keygen</a>
  <li><a href="#noftplist"		>4.12.4 - Eu recebi a mensagem
      "Failed to change directory" enquanto fazia a instalação</a>
  <li><a href="#blankfdisk"		>4.12.5 - Minha tabela de
      partições do fdisk está corrompida ou vazia!</a>
  <li><a href="#noflopcd"               >4.12.6 - Eu não tenho um drive
      de disquete ou CD-ROM na minha máquina</a>
  </ul>

<li><a href="#site"		>4.13 - Personalização do processo de
    instalação</a>
<li><a href="#Multiple"		>4.14 - Como eu instalo em vários
    sistemas similares?</a>
<li><a href="#getdmesg"		>4.15 - Como eu obtenho o dmesg(8) para
    relatar um problema de instalação?</a>
</ul>
<hr>

<p>
<a name= "Overview"></a>
<h2>4.1 - Visão geral do processo de instalação do OpenBSD</h2>

<p>
O OpenBSD possui um robusto e adaptável procedimento de instalação
baseado em modo texto, e pode ser instalado a partir de um único
disquete.
A maioria das plataformas possuem um procedimento de instalação similar;
no entanto, elas se diferenciam em alguns detalhes.
Em todo caso, é aconselhável que você leia o documento INSTALL,
específico da sua plataforma, no diretório <i>plataforma</i> do CD-ROM
ou no sítio FTP (por exemplo, <tt>i386/INSTALL.i386</tt>,
<tt>mac68k/INSTALL.mac68k</tt> ou <tt>sparc/INSTALL.sparc</tt>).

<p>
O processo de instalação do OpenBSD usa um kernel especial com um
conjunto de utilitários e scripts de instalação embutidos em um
disco de RAM pré-carregado. Após esse kernel ser inicializado, o
sistema operacional é extraído de alguns arquivos
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tar&amp;sektion=1">tar(1)</a>
(<tt>.tgz</tt>).
Existem diversas maneiras de inicializar esse kernel de instalação:

<ul>
<li><b>Disquetes:</b>
Imagens de disquetes são disponibilizadas para a criação de disquetes de
instalação em outro sistema <a href="#UnixFlop">compatível com Unix</a>,
ou em um sistema <a href="#DosFlop">Windows</a>.
Os nomes dos arquivos são tipicamente <tt>floppy45.fs</tt>, embora
diversas plataformas possuam múltiplas imagens de disquete disponíveis.

<li><b>CD-ROM:</b>
Em diversas plataformas, uma imagem de CD-ROM (<tt>cd45.iso</tt> apenas
para inicializar, ou <tt>install45.iso</tt> para a instalação completa)
é disponibilizada para a criação de um CD-ROM inicializável.

<li><b>Partição existente:</b>
O <a href="#bsd.rd">disco de RAM</a> do kernel pode ser utilizado para a
inicialização a partir de uma partição já existente do OpenBSD, para uma
atualização de versão ou reinstalação.

<li><b>Rede:</b> Algumas plataformas suportam inicialização pela rede
(por exemplo, usando <a href="faq6.html#PXE">PXE</a> ou outro
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=diskless&amp;sektion=8">método de inicialização pela rede</a>).

<li><b>Escrever uma imagem do sistema de arquivos para o disco
(miniroot):</b> uma imagem do sistema de arquivos pode ser escrita em
uma partição existente e então ser inicializada.

<li><b>Fita inicializável:</b> Algumas plataformas suportam
inicialização a partir de fitas.
Essas fitas podem ser criadas seguindo as instruções do arquivo
INSTALL.<i>plataforma</i>.

</ul>

Nem todas as <a href="../../pt/plat.html">plataformas</a> suportam todos
os métodos de inicialização:

<ul>
<li><a href="../../alpha.html"><b>alpha:</b></a> Disquete, CD-ROM, rede,
escrever uma imagem de disquete no disco.

<li><a href="../../amd64.html"><b>amd64:</b></a> Disquete, CD-ROM,
<a href="faq6.html#PXE">rede</a>.

<li><a href="../../armish.html"><b>armish:</b></a>
Varia por máquina.

<li><a href="../../hp300.html"><b>hp300:</b></a> CD-ROM, rede.

<li><a href="../../hppa.html"><b>hppa:</b></a> Rede.

<li><a href="../../i386.html"><b>i386:</b></a> Disquete, CD-ROM,
<a href="faq6.html#PXE">rede</a>.

<li><a href="../../landisk.html"><b>landisk:</b></a> miniroot, instalar
utilizando outro computador.

<li><a href="../../mac68k.html"><b>mac68k:</b></a> Inicializar
utilizando ferramentas que funcionam no Mac OS. Veja detalhes em
<a href="ftp://ftp.openbsd.org/pub/OpenBSD/4.5/mac68k/INSTALL.mac68k">INSTALL.mac68k</a>.

<li><a href="../../macppc.html"><b>macppc:</b></a> CD-ROM, rede.

<li><a href="../../mvme68k.html"><b>mvme68k:</b></a> Rede, fita
inicializável.

<li><a href="../../mvme88k.html"><b>mvme88k:</b></a> Rede, fita
inicializável.

<li><a href="../../sparc.html"><b>sparc:</b></a> Disquete, CD-ROM, rede,
escrever uma imagem em uma partição swap existente, fita inicializável.

<li><a href="../../sparc64.html"><b>sparc64:</b></a> Disquete
(somente U1/U2), CD-ROM, rede, escrever uma imagem em uma partição
existente.

<li><a href="../../vax.html"><b>vax:</b></a> Disquete, Rede.

<li><a href="../../zaurus.html"><b>zaurus:</b></a> Inicializar bsd.rd
a partir de uma partição Linux. Veja detalhes em
<a href="ftp://ftp.openbsd.org/pub/OpenBSD/4.5/zaurus/INSTALL.zaurus">INSTALL.zaurus</a>.

</ul>

Todas as plataformas podem usar um <a href="#bsd.rd">bsd.rd</a> para
reinstalar ou fazer uma atualização de versão.

<p>
Uma vez que o kernel estiver carregado, você possui diversas opções para
obter os <a href="#FilesNeeded">pacotes de arquivos de instalação</a>.
Lembre-se, nem todas as plataformas suportam todas as opções.

<ul>
<li><b>CD-ROM:</b>
Nós preferimos que você use o
<a href="../../orders.html">conjunto de CD-ROMs oficiais</a>, mas você
também pode usar o arquivo <tt>install45.iso</tt> ou pode também fazer
o seu próprio CD-ROM.

<li><b>FTP:</b>
Qualquer <a href="../../ftp.html">espelho FTP</a>
do OpenBSD ou seu próprio servidor FTP local com os pacotes de arquivos.

<li><b>HTTP:</b>
Qualquer <a href="../../ftp.html#http">espelho HTTP</a>
do OpenBSD ou seu próprio servidor HTTP local com os pacotes de
arquivos.

<li><b>Partição local:</b>
Em muitos casos, você pode instalar os pacotes de arquivos a partir de
outra partição do seu próprio disco rígido local.
Por exemplo, em <a href="../../i386.html">i386</a>, você pode instalar a
partir de uma partição FAT ou de um CD-ROM formatado em ISO9660, Rock
Ridge ou Joliet.
Em alguns casos, você terá que montar manualmente o sistema de arquivos
antes de utilizá-lo.

<li><b>NFS:</b>
Algumas plataformas suportam o uso de pontos de montagem NFS para
armazenar os pacotes de arquivos.

<li><b>Fita:</b>
Os pacotes de arquivos também podem ser lidos pelo sistema a partir de
uma fita suportada. Detalhes sobre a criação da fita estão no documento
<tt>INSTALL.</tt><i>plataforma</i>.
</ul>

<a name="Checklist"></a>
<h2>4.2 - Lista de verificações antes da instalação</h2>

<p>
Antes de você começar a instalação, você deve ter uma ideia do que
precisa para terminá-la.

Você deve conhecer pelo menos os seguintes itens:
<ul>
<li>Nome da máquina
  <li>Hardware instalado e disponível
  <ul>
  <li>Verifique a compatibilidade do seu hardware na página de
      compatibilidades
  <li>Se for ISA, você também precisa saber as configurações do
      hardware, e confirmá-las quando o OpenBSD requerir.
  </ul>
<li>Método de instalação a ser usado (CD-ROM, FTP, etc.)
<li>Foi encontrado um erro sério, como o sistema será corrigido?
  <ul>
  <li>Se feito localmente, você necessitará ter
      <a href="#Partitioning">espaço suficiente</a> disponível para a
      árvore de código fonte e para construí-la.
  <li>Senão, você precisará ter acesso a outra máquina para construir
      uma nova <a href="faq5.html#Release">release</a> corrigida.
  </ul>
<li>Layout desejado do disco
  <ul>
  <li>Existe a necessidade de os dados serem armazenados em outro local?
  <li>O OpenBSD deverá coexistir com outro SO neste sistema?
      Se sim, como ambos serão inicializados?
      Você precisará instalar um "gerenciador de inicialização"?
  <li>O disco inteiro será utilizado pelo OpenBSD, ou deseja manter uma
      partição/SO existente (ou espaço para uso futuro)?
  <li>Como você deseja subparticionar a parte do OpenBSD no seu disco?
  </ul>
<li>Configurações de rede, se você não usa DHCP:
  <ul>
  <li>Nome de domínio
  <li>Endereço(s) do(s) Servidor(es) de Nomes (DNS)
  <li>Endereço IP e máscara de rede para cada placa de rede
  <li>Endereço do roteador (gateway)
  </ul>
<li>Você pretende usar o sistema X Window?
</ul>


<a name="MkInsMedia"></a>
<h2>4.3 - Como criar uma mídia inicializável de instalação do OpenBSD</h2>

<p>
Como exemplo, nós vamos ver as imagens de instalação disponíveis para
as plataformas
<a href="../../i386.html">i386</a> e
<a href="../../sparc.html">sparc</a>.

<p>
A plataforma <a href="../../i386.html">i386</a> possui seis imagens de
disco, separadas para a instalação, que podem ser escolhidas:

<ul>
<li><b><tt>floppy45.fs</tt></b> (PC Desktop) suporta várias placas de
    rede PCI e ISA, suporte a IDE e adaptadores SCSI simples, e algumas
    placas PCMCIA. A maioria dos usuários usam essa imagem para
    inicializar a partir de um disquete.
<li><b><tt>floppyB45.fs</tt></b> (Servidores) suporta diversos
    controladores RAID e alguns adaptadores SCSI menos comuns. No
    entanto, o suporte para diversos adaptadores SCSI e muitas placas
    de rede EISA e ISA foi removido.
<li><b><tt>floppyC45.fs</tt></b> (Laptops) suporta diversos
    dispositivos CardBus e PCMCIA encontrados em muitos laptops.
<li><b><tt>cd45.iso</tt></b> é uma imagem ISO9660 que pode ser usada
    para criar um CD inicializável na maioria dos softwares de criação
    de CD-ROMs, na maioria das plataformas.
    Essa imagem é a que contém a maior seleção de drivers de
    dispositivos, e é usualmente a escolha mais recomendada se o seu
    hardware pode inicializar a partir do CD-ROM.
<li><b><tt>cdemu45.iso</tt></b> é uma imagem ISO9660 que usa emulação
    de um disquete de 2.88M para a inicialização. Espera-se que poucos
    usuários necessitem dessa imagem -- a maioria deve usar a
    <tt>cd45.iso</tt>, use somente a <tt>cdemu45.iso</tt> se a
    <tt>cd45.iso</tt> não funcionar.
<li><b><tt>install45.iso</tt></b> é uma imagem ISO9660 que contém todos
    os arquivos da instalação padrão.
    Esse arquivo pode ser usado para criar um CD que pode fazer sozinho
    a instalação do OpenBSD.
</ul>

Sim, existem situações em que pode ser necessário um disco de instalação
para dar suporte a um adaptador SCSI, e outro disco para dar suporte a
sua placa de rede. Felizmente, esse é um evento raro, e na maioria das
vezes pode ser contornado.

<p>
A plataforma <a href="../../sparc.html">sparc</a> possui quatro imagens
de disco, separadas para instalação, que podem ser escolhidas:

<ul>
<li><b><tt>floppy45.fs:</tt></b> Suporte para sistemas com disquete.
<li><b><tt>cd45.iso</tt></b> Uma imagem ISO usada para criar seu próprio
    CD para inicializar sistemas SPARC que possuem CD-ROM.
<li><b><tt>miniroot45.fs</tt></b> Pode ser escrito em uma partição swap
    e inicializado.
<li><b><tt>install45.iso</tt></b> é uma imagem ISO9660 que contém todos
    os arquivos da instalação padrão.
    Esse arquivo pode ser usado para criar um CD que pode fazer sozinho
    a instalação do OpenBSD.
</ul>

<a name="MkFlop"></a>
<a name="UnixFlop"></a>
<h3>4.3.1 - Criação de disquetes no Unix</h3>

<p>
Para criar um disquete formatado, use o comando
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdformat&amp;sektion=1&amp;arch=i386">fdformat(1)</a>
tanto para formatar quanto para verificar blocos defeituosos.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  # <b>fdformat /dev/rfd0c</b>
  Format 1440K floppy `/dev/rfd0c'? (y/n): y
  Processing VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV done.
</pre></td></tr></table>

<p>
Se a sua saída for parecida com a do exemplo acima, então o seu
disco está OK. No entanto, se você não vê TODOS os "V"s, então o disco
está provavelmente com problemas; tente outra vez com um disco novo.

<p>
Note que certos sistemas compatíveis com o Unix possuem diferentes
comandos para formatar disquetes.
Consulte a documentação do seu sistema para verificar o procedimento
exato.

<p>
Agora que você já possui um disquete limpo e formatado, é hora de
escrever a imagem de instalação nele.
Para isso, você pode usar o utilitário
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&amp;sektion=0">dd(1)</a>.
Um exemplo de uso do <tt>dd(1)</tt>:

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  # <b>dd if=floppy45.fs of=/dev/rfd0c bs=32k</b>
</pre></td></tr></table>

<p>
Uma vez que a imagem foi escrita, verifique com o comando
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cmp&amp;sektion=1">cmp(1)</a>
para ter certeza de que a imagem copiada é igual a original.
Se o disquete for igual à imagem original, você verá somente um outro
prompt.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  # <b>cmp /dev/rfd0c floppy45.fs</b>
</pre></td></tr></table>

<a name="DosFlop"></a>
<h3>4.3.2 - Criação de disquetes no Windows</h3>

<p>
Esta seção descreve como escrever as imagens de instalação em disquetes
no Windows.
Você pode pegar as ferramentas mencionadas abaixo no diretório
<a href="ftp://ftp.openbsd.org/pub/OpenBSD/4.5/tools/">tools</a>,
em qualquer espelho FTP.

<p>
Para preparar o disquete no Windows, primeiramente use uma ferramenta
nativa para formatar o disquete, verificando se o disco não contém
setores ruins.

<p>
Para escrever a imagem de instalação no disquete preparado, você pode
usar o <tt>ntrw.exe</tt>.

<p>
Exemplo de uso do <i>ntrw</i>:
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  C:\> <strong>ntrw floppy45.fs a:</strong>
  3.5", 1.44MB, 512 bytes/sector
  bufsize is 9216
  1474560 bytes written
</pre></td></tr></table>

<a name="MkCD-ROM"></a>
<h3>4.3.3 - Criação de um CD-ROM</h3>

<p>
Você pode criar um CD-ROM usando o arquivo <tt>cd45.iso</tt> ou
<tt>install45.iso</tt>.
Os detalhes exatos ficam por conta do leitor, que deve decidir quais
ferramentas usar para a criação do CD.

<p>
Algumas ferramentas do OpenBSD são:
<ul>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mkhybrid&amp;sektion=8">mkhybrid(8)</a>
<li><a href="http://cdrecord.berlios.de/old/private/cdrecord.html">cdrecord</a>,
    parte do pacote cdrtools encontrado no <a href="faq15.html">Sistema
    de Pacotes e Portes do OpenBSD</a>.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cdio&amp;sektion=1">cdio(1)</a>,
    com a opção de gravação "track at once" (tao).
</ul>

<a name="Boot"></a>
<h2>4.4 - Inicialização da mídia de instalação do OpenBSD</h2>

<h3>Inicialização em i386/amd64</h3>

Inicializar uma imagem de instalação em plataformas i386 e amd64 não é
nenhuma novidade para muitas pessoas.
Se você está usando um disquete, simplesmente insira-o no drive e
inicialize seu sistema.
A imagem será então carregada, desde que a sua BIOS esteja configurada
para inicializar pelo disquete.
Se deseja inicializar pelo CD, você deve ir na BIOS do sistema e
configurar as opções de inicialização para permitir a inicialização pelo
CD. Algumas BIOS antigas não possuem essa opção, nesse caso você deve
utilizar um disquete para inicializar a imagem de instalação.
Não se preocupe; mesmo que você use o disquete para inicializar, você
ainda pode instalar pelo CD se ele é suportado pelo OpenBSD (ou seja,
praticamente todos os drives IDE).

<p>
Você também pode instalar inicializando o <a href="#bsd.rd">bsd.rd</a>
a partir de uma partição existente do OpenBSD, ou pela rede, usando o
<a href="faq6.html#PXE">processo de inicialização PXE</a>.

<h3>Inicialização em sparc/sparc64</h3>

<b>NOTA:</b>
Na plataforma <a href="../../sparc64.html">sparc64</a>, somente as
máquinas SBus (Ultra 1, Ultra 2) são inicializáveis a partir do
disquete.

<p>
Para inicializar por disquete, coloque o disquete com a imagem de
instalação do OpenBSD dentro do drive. Então use os comandos abaixo para
inicializar:

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  ok <b>boot floppy</b>
</pre></td></tr></table>

<p>
Para inicializar por CD-ROM, coloque o CD-ROM do OpenBSD dentro do
drive. Normalmente, você pode inicializar a partir do drive de CD-ROM de
um sistema Sun digitando '<tt>boot cdrom</tt>' no prompt de
inicialização:

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  ok <b>boot cdrom</b>
</pre></td></tr></table>

<p>
Naturalmente, isso funciona somente no novo modo de comando.
Se você está no prompt de modo de comando antigo (seta para direita),
digite 'n' para ir para o novo modo de comando.
(Se você está usando um sparc antigo, pré-sun4c, você provavelmente
não terá o novo modo de comando. Nesse caso, você precisa testar.)
Se você possui múltiplas unidades de CD-ROM, você precisa inicializar a
partir da unidade correta; tente <tt>probe-scsi</tt>
(ou <tt>probe-ide</tt> em sistemas mais novos) do novo modo de comando.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  ok <b>probe-scsi</b>

  Target 0
    Unit 0   Disk     QUANTUM LIGHTNING 365S
  Target 1
    Unit 0   Removable Disk     QUANTUM EMPIRE_1080S
  Target 3
    Unit 0   Removable Disk     Joe's CD-ROM
</pre></td></tr></table>

<p>
Determine a partir de qual unidade de CD-ROM você quer inicializar.
Preste atenção no número ("target") da unidade.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  ok <b>boot /sbus/esp/sd@X,0</b>
</pre></td></tr></table>


<a name="Install"></a>
<h2>4.5 - Como fazer a instalação</h2>
<a name="Start"></a>
<h3>4.5.1 - Início da instalação</h3>
<!-- XXXrelease -->
Qualquer que seja o meio de inicialização, agora é hora de usá-lo.
Durante o processo de inicialização, o kernel e todos os programas
usados para a instalação do OpenBSD são carregados na memória.
Os problemas mais comuns durante a inicialização são disquetes com
problemas ou um drive desalinhado. O disquete de inicialização é
fortemente compactado -- qualquer setor ruim pode causar problemas.

<p>
Em qualquer ponto durante a instalação do OpenBSD, você pode terminar
o processo de instalação em andamento pressionando CTRL-C, e
reinicializar novamente a instalação digitando <tt>install</tt> no
prompt de comando sem reinicializar a máquina.

<p>
Quando a sua inicialização é bem sucedida, você verá várias mensagens de
texto rolando em sua tela. Esse texto, em azul e branco em várias
arquiteturas, é o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dmesg&amp;sektion=8">dmesg</a>,
o kernel mostrando para você quais dispositivos foram encontrados,
e suas localizações. Não se preocupe em lembrar desse texto, uma cópia
dele é salva em <tt>/var/run/dmesg.boot</tt>.

<p>
Então, você verá o seguinte:

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  root on rd0a swap on rd0b dump on rd0b
  erase ^?, werase ^W, kill ^U, intr ^C, status ^T
  (I)nstall, (U)pgrade or (S)hell? <b>i</b>
</pre></td></tr></table>

<p>
E com isso, nós temos nossa primeira pergunta. Na maioria das vezes,
você tem as três opções mostradas:
<ul>
<li><b>Install:</b> Carrega o OpenBSD, sobrescrevendo quaisquer dados
    que estejam na partição. Note que é possível deixar partições
    intactas nesse processo, tal como uma <tt>/home</tt>, mas
    de qualquer maneira, suponha que tudo mais será sobrescrito.
<li><b>Upgrade:</b> Instala um novo conjunto de <a href="#FilesNeeded">
    arquivos de instalação</a> na máquina, mas não sobrescreve nenhuma
    configuração, nenhum dado de usuário ou programas adicionais.
    Nenhuma formatação de disco é realizada, os diretórios <tt>/etc</tt>
    e <tt>/var</tt> não são sobrescritos. Algumas notas importantes:
    <ul>
    <li>Você não tem a opção de instalar o arquivo <tt>etc45.tgz</tt>.
        Depois de instalar, você terá que
        <a href="../upgrade45.html#etcUpdates">mesclar manualmente</a>
        as mudanças de <tt>etc45.tgz</tt> em seu sistema antes de você
        considerá-lo completamente funcional. Essa é uma etapa
        importante que deve ser feita, senão serviços chaves (tais como
        <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4">pf(4)</a>)
        podem não funcionar.

    <li>O processo de atualização de versão não é projetado para saltar
        versões! Isso frequentemente funciona, mas não é suportado.
        Para o OpenBSD 4.5, atualizar do 4.4 para o 4.5 é a única
        atualização de versão recomendada.
        Se você quer atualizar uma versão mais antiga, atualize primeiro
        para as versões intermediárias ou, se seu sistema está muito
        desatualizado, considere fazer uma reinstalação completa.
    </ul>
    <!-- XXXversion -->
    Mais informações sobre atualizações entre versões podem ser
    encontradas no
    <a href="../upgrade45.html">Guia de Atualização de versão do
    OpenBSD 4.5</a>.

<li><b>Shell:</b> Às vezes você precisa executar reparos ou fazer a
    manutenção em um sistema que não inicializa (ou não deve
    inicializar) um kernel normal.
    Essa opção permite que você realize a manutenção do seu sistema.
    Vários utilitários importantes estão disponíveis na mídia de
    inicialização.
</ul>

Ocasionalmente, você não verá a opção "Upgrade" listada.
Depois do <i>"dia da marcação"</i>, não é possível atualizar a versão
diretamente; você deve reinstalar o sistema do zero.

<p>
Neste exemplo, nós faremos uma instalação, mas o processo de atualização
de versão é similar.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Welcome to the OpenBSD/i386 4.5 install program.

  This program will help you install OpenBSD. At any prompt except password
  prompts you can escape to a shell by typing '!'. Default answers are shown
  in []'s and are selected by pressing RETURN.  At any time you can exit this
  program by pressing Control-C, but exiting during an install can leave your
  system in an inconsistent state.

  Terminal type: [vt220] <b><i>Enter</i></b>
  kbd(8) mapping? ('L' for list) [none] <b><i>Enter</i></b>
</pre></td></tr></table>


<p>
Na maioria dos casos, o terminal padrão é o mais apropriado; no entanto,
se você está usando um <a href="faq7.html#SerCon">console serial</a>
para instalar, não escolha o padrão, responda adequadamente.

<p>
Se você não escolher o layout do seu teclado, US é assumido por padrão.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  IS YOUR DATA BACKED UP? As with anything that modifies disk contents, this
  program can cause SIGNIFICANT data loss.

  It is often helpful to have the installation notes handy. For complex disk
  configurations, relevant disk hardware manuals and a calculator are useful.

  Proceed with install? [no] <b>y</b>
</pre></td></tr></table>

<p>
Se você escolher a opção padrão aqui, o processo de instalação é
interrompido e você é levado a um prompt de comando.

<p>
As notas de instalação referenciadas aqui podem ser encontradas
no CD de instalação e nos servidores FTP, no arquivo
<tt>INSTALL.<i>&lt;plat&gt;</i></tt>, onde <i>&lt;plat&gt;</i> é a sua
<a href="../../pt/plat.html">plataforma</a>; por exemplo, <tt>i386</tt>.

<a name="Disks"></a>
<h3>4.5.2 - Configuração dos discos</h3>

<i><b>Nota importante:</b>
Usuários com um disco rígido grande (maior do que era comum quando seu
computador foi fabricado) talvez queiram ver
<a href="faq14.html#LargeDrive">esta seção</a> antes de continuar.</i>

<p>
A configuração de discos no OpenBSD pode variar entre as plataformas.
Para <a href="../../i386.html">i386</a>,
<a href="../../amd64.html">amd64</a>,
<a href="../../macppc.html">macppc</a>,
<a href="../../zaurus.html">zaurus</a> e
<a href="../../armish.html">armish</a>, a configuração dos discos
é feita em duas etapas.
Primeiro, a fatia do disco rígido referente ao OpenBSD é definida
utilizando o fdisk(8), então essa fatia é subdividida em partições
OpenBSD usando o disklabel(8).

<p>
Alguns usuários se confundem com a terminologia utilizada aqui. Isso
acontece porque nós estamos usando a palavra "partição" em dois sentidos
diferentes.
Existem duas camadas de particionamento nas plataformas do OpenBSD
citadas acima, a primeira, que pode ser considerada a partição
do sistema operacional, permite que múltiplos SOs em um computador
definam seus espaços em disco, e a segunda, onde a partição
OpenBSD é subparticionada em sistemas de arquivos individuais.
A primeira camada é visível como uma partição do disco para o DOS,
Windows e qualquer outro SO que use esse tipo de particionamento,
a segunda camada da partição somente é visível pelo OpenBSD e SOs
que podem ler diretamente o seu sistema de arquivos.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Cool!  Let's get to it.

  You will now initialize the disk(s) that OpenBSD will use. To enable all
  available security features you should configure the disk(s) to allow the
  creation of separate filesystems for /, /tmp, /var, /usr, and /home.

  Available disks are: wd0.
  Which one is the root disk? (or done) [wd0] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
O disco raiz (root) é de onde o sistema é inicializado e onde
normalmente a swap reside. Discos IDE são mostrados como <tt>wd0</tt>,
<tt>wd1</tt>, etc., discos SCSI e dispositivos RAID são mostrados como
<tt>sd0</tt>, <tt>sd1</tt> e assim por diante. Todos os discos que o
OpenBSD localizou são mostrados aqui -- se você possui um disco que não
foi exibido aqui, você possui um hardware não-suportado ou mal
configurado.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Do you want to use *all* of wd0 for OpenBSD? [no] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Se você responder "yes" a essa pergunta, todo o disco será alocado
para o OpenBSD. O resultado será um "Master Boot Record" (Registro de
Inicialização Mestre) válido e uma tabela de partições escrita no disco
-- uma partição, do tamanho do disco rígido inteiro, configurada com o
tipo de partição OpenBSD e marcada como partição inicializável.
Essa é a escolha mais comum para usuários que usam o OpenBSD como
sistema de produção; no entanto, existem alguns sistemas em que isso não
pode ser feito.
Muitos sistemas Compaq, muitos laptops, alguns Dell e outros sistemas,
usam uma partição de "maintenance" ou "Suspend to Disk", que deve ser
mantida intacta. Se o seu sistema possui uma partição, de qualquer
tipo, que não pode ser apagada, não escolha "yes" na pergunta acima.
Porém, se seu sistema possui um disco novo que nunca foi usado, você
provavelmente irá responder "yes" (ou usar a opção "update" do fdisk),
assim você terá um registro mestre e assinatura de inicialização
válidos.

<p>
Para o objetivo deste exemplo, nós assumimos que o disco será dividido
entre o OpenBSD e uma partição pré-existente do Windows 2000, assim
deixaremos a opção padrão "no", o que nos fará usar o programa
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&amp;sektion=8&amp;arch=i386">fdisk(8)</a>.
Você pode obter mais informações sobre o fdisk(8)
<a href="faq14.html#fdisk">aqui</a>.

<p>
<b>Nota:</b>
Se você disser "Y" para a pergunta "Do you want to use *all* of wd0 for
OpenBSD?" (Você deseja usar todo o wd0 para o OpenBSD?), ou se você está
usando uma plataforma que não usa o fdisk (sparc64, por exemplo), você
não vai passar por esta etapa, e irá pular diretamente para a
<a href="#disklabel">criação do "disklabel"</a>.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  You will now create a single MBR partition to contain your OpenBSD data. This
  partition must have an id of 'A6'; must *NOT* overlap other partitions; and
  must be marked as the only active partition.

  The 'manual' command describes all the fdisk commands in detail.

  Disk: wd0       geometry: 2434/255/63 [39102336 Sectors]
  Offset: 0       Signature: 0xAA55
              Starting         Ending         LBA Info:
   #: id      C   H   S -      C   H   S [       start:        size ]
  -------------------------------------------------------------------------------
  *0: 0B      0   1   1 -    195 254  63 [          63:     3148677 ] Win95 FAT-32
   1: 00      0   0   0 -      0   0   0 [           0:           0 ] unused      
   2: 00      0   0   0 -      0   0   0 [           0:           0 ] unused      
   3: 00      0   0   0 -      0   0   0 [           0:           0 ] unused      
  Enter 'help' for information
  fdisk: 1&gt; <b>help</b>
          help            Command help list
          manual          Show entire OpenBSD man page for fdisk
          reinit          Re-initialize loaded MBR (to defaults)
          setpid          Set the identifier of a given table entry
          disk            Edit current drive stats
          edit            Edit given table entry
          flag            Flag given table entry as bootable
          update          Update machine code in loaded MBR
          select          Select extended partition table entry MBR
          swap            Swap two partition entries
          print           Print loaded MBR partition table
          write           Write loaded MBR to disk
          exit            Exit edit of current MBR, without saving changes
          quit            Quit edit of current MBR, saving current changes
          abort           Abort program without saving current changes
  fdisk: 1&gt; 
</pre></td></tr></table>

<p>
Alguns comandos que merecem explicação:
<ul>
<li><b><tt>r</tt></b> ou <b><tt>reinit</tt>:</b> Limpa a tabela de
    partições existente, cria uma grande partição OpenBSD cobrindo o
    disco inteiro, marca a partição como ativa e instala o código MBR
    do OpenBSD. Equivalente a dizer "yes" na pergunta
    "<tt>use *all* of ...</tt>".
    Você certamente quer fazer isso em um disco novo.
<li><b><tt>p</tt></b> ou <b><tt>print:</tt></b> Mostra a tabela de
    partições atual em setores. "<tt>p m</tt>" mostra a tabela de
    partições em megabytes, "<tt>p g</tt>" mostra a tabela de partições
    em gigabytes.
<li><b><tt>e</tt></b> ou <b><tt>edit:</tt></b> edita ou altera uma
    entrada da tabela.
<li><b><tt>f</tt></b> ou <b><tt>flag:</tt></b> Marca a partição
    como ativa, de onde o OpenBSD será inicializado.
<li><b><tt>u</tt></b> ou <b><tt>update:</tt></b> Atualiza o MBR com
    o código de inicialização do OpenBSD, similar ao "<tt>reinit</tt>",
    exceto que esse comando não altera a tabela de partições existente.
<li><b><tt>exit</tt></b> e <b><tt>quit:</tt></b> Cuidado com esse
    comando, pois certos usuários ainda não se habituaram ao uso do
    "exit" e "quit", que possuem significados diferentes.
</ul>

Vale a pena ressaltar aqui o seguinte, um erro neste ponto resulta em
perdas significantes de dados. Se você for fazer isso em um disco
rígido com dados importantes, pode valer a pena praticar em um drive
sem dados significativos, além de também possuir um backup.

<p>
Nosso disco possui uma partição de 1.5G para o Windows 2000 (usando
sistema de arquivos FAT). Olhando as informações acima, podemos ver
que a partição do Windows ocupa até o cilindro 195 do disco rígido.
Então, vamos alocar o resto do disco para o OpenBSD, iniciando no
cilindro 196. Você também pode calcular o início do setor do OpenBSD,
que é 3148740, adicionando o início do setor da partição existente (63)
com o seu tamanho (3148677).

<p>
Você pode editar o layout do disco utilizando a notação
"Cylinder/Heads/Sectors" ou a notação em setores brutos.
Qual é a mais fácil depende do que você quer fazer; no nosso caso,
trabalhar em torno de uma partição existente, usar o formato
CHS (Cylinder/Heads/Sectors) é provavelmente a forma mais fácil.
Se você está criando uma partição nova, usar somente setores brutos
pode ser mais fácil.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  fdisk: 1> <b>e 1</b>
              Starting         Ending         LBA Info:
   #: id      C   H   S -      C   H   S [       start:        size ]
  -------------------------------------------------------------------------------
   1: 00      0   0   0 -      0   0   0 [           0:           0 ] unused      
  Partition id ('0' to disable)  [0 - FF]: [0] (? for help) <b>a6</b>
  Do you wish to edit in CHS mode? [n] <b>y</b>
  BIOS Starting cylinder [0 - 2433]: [0] <b>196</b>
  BIOS Starting head [0 - 254]: [0] <b><i>Enter</i></b>
  BIOS Starting sector [1 - 63]: [0] <b>1</b>
  BIOS Ending cylinder [0 - 2433]: [0] <b>2433</b>
  BIOS Ending head [0 - 254]: [0] <b>254</b>
  BIOS Ending sector [1 - 63]: [0] <b>63</b>
  fdisk:*1&gt; <b>p</b>
  Disk: wd0       geometry: 2434/255/63 [39102336 Sectors]
  Offset: 0       Signature: 0xAA55
              Starting         Ending         LBA Info:
   #: id      C   H   S -      C   H   S [       start:        size ]
  -------------------------------------------------------------------------------
  *0: 0B      0   1   1 -    195 254  63 [          63:     3148677 ] Win95 FAT-32
   1: A6    196   0   1 -   2433 254  63 [     3148740:    35953470 ] OpenBSD     
   2: 00      0   0   0 -      0   0   0 [           0:           0 ] unused      
   3: 00      0   0   0 -      0   0   0 [           0:           0 ] unused      
  fdisk:*1&gt; <b>p m</b>
  Disk: wd0       geometry: 2434/255/63 [19093 Megabytes]
  Offset: 0       Signature: 0xAA55
              Starting         Ending         LBA Info:
   #: id      C   H   S -      C   H   S [       start:        size ]
  -------------------------------------------------------------------------------
  *0: 0B      0   1   1 -    195 254  63 [          63:        1537M] Win95 FAT-32
   1: A6    196   0   1 -   2433 254  63 [     3148740:       17555M] OpenBSD     
   2: 00      0   0   0 -      0   0   0 [           0:           0M] unused      
   3: 00      0   0   0 -      0   0   0 [           0:           0M] unused      
  fdisk:*1&gt; 
</pre></td></tr></table>

<a name="trackoffset"></a>
<p>
Em plataformas que usam fdisk, é importante que a primeira partição
salte a primeira trilha do disco, <i>nesse caso</i>, iniciando no setor
<tt>63</tt>.
Isso pode variar de arquitetura para arquitetura e sistema de disco
para sistema de disco.
Se uma partição OpenBSD é criada iniciando no setor <tt>0</tt>, a
tabela de partições terminará em cima da <a href="faq14.html#Boot386">
"Partição Boot Record"</a> da partição OpenBSD, sobrescrevendo-a.
O sistema ainda poderá ser inicializado, mas a manutenção ficará muito
difícil, e tal configuração não é <i>recomendada ou suportada</i>.

<p>
Note que o prompt indica mudanças ainda não salvas, marcando com um
asterisco ('<tt>*</tt>'). Como podemos ver com a saída
de <tt>p&nbsp;m</tt>, nós não alteramos a partição do Windows,
conseguimos alocar o resto do disco para o OpenBSD com sucesso, e as
partições não se sobreporam. Estamos terminando. Quase.

<p>
O que nós ainda não fizemos foi marcar a partição como ativa, para que
a máquina possa ser inicializada na próxima reinicialização:

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  fdisk:*1> <b>f 1</b>
  Partition 1 marked active.
  fdisk:*1&gt; <b>p</b>
  Disk: wd0       geometry: 2434/255/63 [39102336 Sectors]
  Offset: 0       Signature: 0xAA55
              Starting         Ending         LBA Info:
   #: id      C   H   S -      C   H   S [       start:        size ]
  -------------------------------------------------------------------------------
   0: 0B      0   1   1 -    195 254  63 [          63:     3148677 ] Win95 FAT-32
  *1: A6    196   0   1 -   2433 254  63 [     3148740:    35953470 ] OpenBSD     
   2: 00      0   0   0 -      0   0   0 [           0:           0 ] unused      
   3: 00      0   0   0 -      0   0   0 [           0:           0 ] unused      
  fdisk:*1&gt;
</pre></td></tr></table>

<p>
E agora, nós estamos prontos para salvar as mudanças:

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  fdisk:*1> <b>w</b>
  Writing MBR at offset 0.
  wd0: no disk label
  fdisk: 1&gt; <b>q</b>
</pre></td></tr></table>

<p>

<a name="disklabel"></a>
<h3>Criação do "disklabel"</h3>
O próximo passo é usar o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=disklabel&amp;sektion=8">disklabel(8)</a>
para dividir a partição OpenBSD.
Mais detalhes de uso do disklabel(8) podem ser encontrados na
<a href="faq14.html#disklabel">FAQ 14, disklabel</a>.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Here is the partition information you chose:
  
  Disk: wd0       geometry: 2586/240/63 [39100320 Sectors]
  Offset: 0       Signature: 0xAA55
           Starting       Ending       LBA Info:
   #: id    C   H  S -    C   H  S [       start:      size   ]
  ------------------------------------------------------------------------
   0: 0B    0   1  1 -  202 239 63 [          63:     3069297 ] Win95 FAT-32
  *1: A6  203   0  1 - 2585 239 63 [     3069360:    36030960 ] OpenBSD
   2: 00    0   0  0 -    0   0  0 [           0:           0 ] unused
   3: 00    0   0  0 -    0   0  0 [           0:           0 ] unused

  You will now create an OpenBSD disklabel inside the OpenBSD MBR
  partition. The disklabel defines how OpenBSD splits up the MBR partition
  into OpenBSD partitions in which filesystems and swap space are created.

  The offsets used in the disklabel are ABSOLUTE, i.e. relative to the
  start of the disk, NOT the start of the OpenBSD MBR partition.

  # Inside MBR partition 1: type A6 start 3148740 size 35953470
  Treating sectors 3148740-39102210 as the OpenBSD portion of the disk.

  You can use the 'b' command to change this.

  Initial label editor (enter '?' for help at any prompt)
  > <b>?</b>
  Available commands:
    ? [command] - show help                  n [part] - set mount point
    a [part]    - add partition              p [unit] - print partitions
    b           - set OpenBSD boundaries     q        - quit & save changes
    c [part]    - change partition size      r        - display free space
    D           - reset label to default     s [path] - save label to file
    d [part]    - delete partition           u        - undo last change
    e           - edit drive parameters      w        - write label to disk
    g [d | u]   - [d]isk or [u]ser geometry  X        - toggle expert mode
    l [unit]    - print disk label header    x        - exit & lose changes
    M           - disklabel(8) man page      z        - delete all partitions
    m [part]    - modify partition

  Suffixes can be used to indicate units other than sectors:
          'b' (bytes), 'k' (kilobytes), 'm' (megabytes), 'g' (gigabytes)
          'c' (cylinders), '%' (% of total disk), '&' (% of free space).
  Values in non-sector units are truncated to the nearest cylinder boundary.
  > 
</pre></td></tr></table>

<p>
Novamente, alguns comandos que merecem um pouco de atenção:
<ul>
<li><b><tt>p</tt></b> - Exibe na tela o particionamento atual, você
    pode usar os modificadores <tt>k, m</tt> ou <tt>g</tt> para
    kilobytes, megabytes ou gigabytes.

<li><b><tt>D</tt></b> - Limpa qualquer particionamento existente, cria
    um novo particionamento padrão que cobre apenas a partição OpenBSD
    atual. Isso é útil no caso do disco já possuir um particionamento,
    e a partição OpenBSD for recriada com um tamanho diferente
    -- o particionamento antigo pode não ser removido, e pode
    causar confusão.

<li><b><tt>m</tt></b> - Modifica uma entrada existente no
    particionamento. Nunca superestime o que isso pode fazer por você.
    Enquanto ele pode alterar o tamanho de uma partição "disklabel", ele
    NÃO altera o sistema de arquivos do disco rígido.
    Usar essa opção e esperar que ele redimensione magicamente o tamanho
    da partição é uma boa maneira de perder grandes quantidades de
    dados. No entanto, essa opção e o
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=growfs&amp;sektion=8">growfs(8)</a>
    podem ser usados para aumentar o tamanho de uma partição.
</ul>

<p>
Dividir o seu disco de maneira apropriada é muito importante. A resposta
à pergunta "Como eu devo particionar meu sistema?" é "Exatamente como
você precisa". Isso varia de aplicação para aplicação.
Não há nenhuma resposta universal. Se você está inseguro de como quer
particionar o seu sistema, veja
<a href="#Partitioning">esta discussão</a>.

<p>
Nesse sistema, nós temos mais de 17G disponíveis para o OpenBSD. Isso
é muito espaço, e é muito provável que nós não vamos utilizá-lo no
total. Mas, nós não vamos usar valores muito pequenos. Melhor termos
algumas centenas de megabytes não utilizados do que alguns kilobytes
sobrando.

<p>
No disco raiz, uma partição 'a' <b>deve</b> ser criada para o sistema
de arquivos raiz (/).
O processo de instalação não continuará se ela não estiver disponível.
Geralmente, você irá querer também uma partição
<a href="faq14.html#Swap">swap</a> 'b'; você pode deixá-la inativa se
tem certeza que a memória do seu sistema nunca vai se esgotar.
Se uma partição 'b' existe no disco raiz, ela é automaticamente usada
para swap.
Partições swap em outros discos terão que ser adicionadas manualmente
no arquivo <i>/etc/fstab</i>.

<p>
Após pensar um pouco, nós decidimos criar apenas as partições separadas
e recomendadas para os sistemas de arquivos (<tt>/, /tmp, /var, /usr,
/home</tt>), junto com a partição de swap:
<ul>
<li><i><b>wd0a: /</b></i> (root) - 150M. Isso é mais do que suficiente.
<li><i><b>wd0b: </b></i>(swap) - 300M.
<li><i><b>wd0d: /tmp</b></i> - 120M. A <tt>/tmp</tt> é usada durante a
    criação de alguns softwares, 120M será o bastante para a maioria das
    ocasiões.
<li><i><b>wd0e: /var</b></i> - 80M. Se esse fosse um servidor Web ou
    de correio eletrônico, nós faríamos essa partição bem maior, mas
    esse não é o nosso caso.
<li><i><b>wd0g: /usr</b></i> - 6G. Nós queremos que essa partição seja
    grande para guardar alguns aplicativos de usuários, além de
    possibilitar atualizações e reconstruções do sistema através do
    código fonte, se necessário ou desejado. A
    <a href="faq15.html#Ports">Árvore de Portes</a> estará aqui também,
    a qual necessita de 250M de espaço antes dos portes serem
    construídos. Se você está planejando construir muitos aplicativos a
    partir do código fonte, usando o <a href="faq15.html#Ports">portes</a>
    em vez dos <a href="faq15.html#PkgMgmt">pacotes</a> pré-compilados,
    você pode necessitar de mais espaço aqui.
<li><i><b>wd0h: /home</b></i> - 4G. Isso deixará bastante espaço para
    os arquivos dos usuários.
</ul>

Agora, se você adicionar as partições acima, você vai ver que ainda
sobram 6G de espaço não utilizado! O espaço não utilizado
não causa nenhum problema, e nos dá a flexibilidade de ampliarmos
alguma partição no futuro, se necessário. A <i>/tmp</i> precisa
de mais espaço? Crie uma nova partição no espaço vazio, formate a nova
partição com o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=newfs&amp;sektion=8"
>newfs(8)</a> e modifique o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fstab&amp;sektion=5"
><i>/etc/fstab</i></a> para montar a nova partição em <i>/tmp</i>.
Problema resolvido.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  > <b>p m</b>
  #             size        offset  fstype [fsize bsize  cpg]
  OpenBSD area: 1537.5M-19092.9M; size: 17555.4M; free: 17555.4M
    c:      19092.9M          0.0M  unused      0     0      
    i:       1498.7M          0.0M  MSDOS                   
  &gt; <b>a a</b>
  offset: [3148740] <b><i>Enter</i></b>
  size: [35953470] <b>150m</b>
  Rounding to cylinder: 321300
  FS type: [4.2BSD] <b><i>Enter</i></b>
  mount point: [none] <b>/</b>
  &gt; <b>a b</b>
  offset: [3470040] <b><i>Enter</i></b>
  size: [35632170] <b>300m</b>
  Rounding to cylinder: 626535
  FS type: [swap] <b><i>Enter</i></b>
  &gt; <b>a d</b>
  offset: [4096575] <b><i>Enter</i></b>
  size: [35005635] <b>120m</b>
  Rounding to cylinder: 257040
  FS type: [4.2BSD] <b><i>Enter</i></b>
  mount point: [none] <b>/tmp</b>
  &gt; <b>a e</b>
  offset: [4353615] <b><i>Enter</i></b>
  size: [34748595] <b>80m</b>
  Rounding to cylinder: 176715
  FS type: [4.2BSD] <b><i>Enter</i></b>
  mount point: [none] <b>/var</b>
  &gt; <b>a g</b>
  offset: [4530330] <b><i>Enter</i></b>
  size: [34571880] <b>6g</b>
  Rounding to cylinder: 12594960
  FS type: [4.2BSD] <b><i>Enter</i></b>
  mount point: [none] <b>/usr</b>
  &gt; <b>a h</b>
  offset: [17125290] <b><i>Enter</i></b>
  size: [21976920] <b>4g</b>
  Rounding to nearest cylinder: 8401995
  FS type: [4.2BSD] <b><i>Enter</i></b>
  mount point: [none] <b>/home</b>
  &gt; <b>p m</b>
  OpenBSD area: 1537.5M-19092.9M; size: 17555.4M; free: 6628.4M
  
  16 partitions:
  #             size        offset  fstype [fsize bsize  cpg]
    a:           156.9M          1537.5M  4.2BSD   2048 16384    1 # /
    b:           305.9M          1694.4M    swap                   
    c:         19092.9M             0.0M  unused      0     0      
    d:           125.5M          2000.3M  4.2BSD   2048 16384    1 # /tmp
    e:            86.3M          2125.8M  4.2BSD   2048 16384    1 # /var
    g:          6149.9M          2212.1M  4.2BSD   2048 16384    1 # /usr
    h:          4102.5M          8362.0M  4.2BSD   2048 16384    1 # /home
    i:          1537.4M             0.0M   MSDOS                   
  &gt; <b>q</b>
  Write new label?: [y] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Você pode notar que a partição <i>c</i> parece ter sido ignorada.
Essa partição é o seu disco rígido inteiro; não tente alterá-la.
Você pode notar também que a partição <i>i</i> não foi definida por nós;
essa é a partição pré-existente do Windows 2000. Partições não são
atribuídas a alguma letra em particular -- com exceção de
<i>a</i> (raiz), <i>b</i> (swap) e <i>c</i> (disco inteiro), o restante
das partições (até a letra <i>p</i>) estão disponíveis para uso como
você desejar.

<h3>Configuração dos pontos de montagem e formatação dos seus sistemas
de arquivos</h3>

Agora vem a configuração final dos seus pontos de montagem. Se você
configurou os pontos de montagem através do
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=disklabel&amp;sektion=8">disklabel(8)</a>,
este passo consiste em verificar as suas seleções; se não, você pode
especificá-los agora.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Mount point for wd0d (131584 KBytes)? (or 'none' or 'done') [/tmp] <b><i>Enter</i></b>
  Mount point for wd0e (90624 KBytes)? (or 'none' or 'done') [/var] <b><i>Enter</i></b>
  Mount point for wd0g (6656 MBytes)? (or 'none' or 'done') [/usr] <b><i>Enter</i></b>
  Mount point for wd0h (4096 MBytes)? (or 'none' or 'done') [/home] <b><i>Enter</i></b>
  Mount point for wd0d (131584 KBytes)? (or 'none' or 'done') [/tmp] <b>done</b>
  No more disks to initialize.
 
  OpenBSD filesystems:
  wd0a /
  wd0d /tmp
  wd0e /var
  wd0g /usr
  wd0h /home

  The next step *DESTROYS* all existing data on these partitions!
  Are you really sure that you're ready to proceed? [no] <b>y</b>
  newfs: reduced number of fragments per cylinder group from 20080 to 19992 to enl
  arge last cylinder group
  /dev/rwd0a: 156.9MB in 321300 sectors of 512 bytes
  5 cylinder groups of 39.05MB, 2499 blocks, 5120 inodes each
  newfs: reduced number of fragments per cylinder group from 16064 to 15992 to enl
  arge last cylinder group
  /dev/rwd0d: 125.5MB in 257040 sectors of 512 bytes
  5 cylinder groups of 31.23MB, 1999 blocks, 4096 inodes each
  newfs: reduced number of fragments per cylinder group from 11040 to 10992 to enl
  arge last cylinder group
  /dev/rwd0e: 86.3MB in 176712 sectors of 512 bytes
  5 cylinder groups of 21.47MB, 1374 blocks, 2816 inodes each
  /dev/rwd0g: 6149.9MB in 12594960 sectors of 512 bytes
  31 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0h: 4102.5MB in 8401992 sectors of 512 bytes
  21 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each

 /dev/wd0a on /mnt type ffs (rw, asynchronous, local, ctime=Tue Oct 21 00:36:28 2
  008)
  /dev/wd0h on /mnt/home type ffs (rw, asynchronous, local, nodev, nosuid)
  /dev/wd0d on /mnt/tmp type ffs (rw, asynchronous, local, nodev, nosuid)
  /dev/wd0g on /mnt/usr type ffs (rw, asynchronous, local, nodev)
  /dev/wd0e on /mnt/var type ffs (rw, asynchronous, local, nodev)
</pre></td></tr></table>

<p>
Você talvez queira saber por que o instalador pergunta outra vez pelos
pontos de montagem. Isso permite que você conserte erros ou enganos nos
pontos de montagem especificados durante a criação do particionamento.
Por exemplo, o processo de instalação apaga automaticamente todos
os pontos de montagem duplicados que você tenha especificado durante
a configuração do particionamento. O programa disklabel permite que
você entre em tais duplicatas, permitindo assim que estas sejam
verificadas antes de sair do programa. Apagar pontos de montagem
duplicados resulta em partições sem pontos de montagem, nestas você deve
atribuir novos pontos de montagem se deseja utilizar o espaço.

<p>
Observe que a pergunta "Are you really sure that you are ready to
proceed?" (Você tem certeza que deseja continuar?) por padrão está
configurada para "no" (não), assim você terá que dizer deliberadamente
para continuar e formatar as suas partições.
Se você escolher não, você simplesmente seria jogado em uma linha de
comando e poderia reiniciar novamente o processo de instalação digitando
"install", ou reinicializando seu computador com um disco de
inicialização.

<p>
Neste ponto, todas as partições são formatadas para você. Isso pode
levar algum tempo dependendo do tamanho das partições e da velocidade do
disco.

<a name="Hostname"></a>
<h3>4.5.3 - Configuração do nome de máquina do sistema</h3>
<p>
Agora você deve configurar o nome de máquina do sistema. Esse valor,
junto com o nome de domínio DNS (especificado
<a href="#Network">abaixo</a>), são salvos no arquivo
<tt>/etc/myname</tt>, que é usado durante a inicialização para
configurar o nome de máquina do sistema. Se você não configurar o nome
de domínio do seu sistema, o valor padrão 'my.domain' é usado.

<p>
É importante que você configure esse nome agora, porque ele será usado
na geração das chaves criptográficas para o seu sistema na primeira
inicialização depois da instalação. Essa geração não depende de a
rede estar configurada ou não.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  System hostname (short form, e.g. 'foo'): <b>puffy</b>
</pre></td></tr></table>

<a name="Network"></a>
<h3>4.5.4 - Configuração da rede</h3>

<p>
Agora é hora de configurar a sua rede. A rede deve ser configurada se
você está planejando fazer uma instalação baseada em FTP ou NFS,
considerando que estas são baseadas nas informações que você especificar
neste ponto.
Aqui está uma caminhada completa através da seção de configuração da
rede do processo de instalação.
No nosso exemplo, nós vamos conectar uma interface (fxp0) a um modem
a cabo, configurada para usar DHCP; e a outra interface será para nossa
rede interna, configurada estaticamente.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Configure the network? [yes] <b><i>Enter</i></b>
  Available interfaces are: fxp0 xl0.
  Which one do you wish to initialize? (or 'done') [fxp0] <b>xl0</b>
  Symbolic (host) name for xl0? [puffy] <b><i>Enter</i></b>
  The media options for xl0 are currently
          media: Ethernet autoselect (100baseTX full-duplex)
  Do you want to change the media options? [no] <b><i>Enter</i></b>
  IPv4 address for xl0? (or 'dhcp') <b>192.168.1.254</b>
  Netmask? [255.255.255.0] <b><i>Enter</i></b>
  IPv6 address for xl0? (or 'rtsol' or 'none') [none] <b><i>Enter</i></b>
  Available interfaces are: fxp0.
  Which one do you wish to initialize? (or 'done') [fxp0] <b><i>Enter</i></b>
  Symbolic (host) name for fxp0? [puffy] <b><i>Enter</i></b>
  The media options for fxp0 are currently
          media: Ethernet autoselect (10baseT half-duplex)
  Do you want to change the media options? [no] <b><i>Enter</i></b>
  IPv4 address for fxp0? (or 'none' or 'dhcp') <b>dhcp</b>
  Issuing hostname-associated DHCP request for fxp0.
  DHCPDISCOVER on fxp0 to 255.255.255.255 port 67 interval 1
  DHCPOFFER from 73.34.136.1
  DHCPREQUEST on fxp0 to 255.255.255.255 port 67
  DHCPACK from 73.34.136.1
  bound to 69.241.244.76 -- renewal in 1800 seconds.
  IPv6 address for fxp0? (or 'rtsol' or 'none') [none] <b><i>Enter</i></b>
  No more interfaces to initialize.
  DNS domain name? (e.g. 'bar.com') [my.domain] <b>exemplo.com</b>
  DNS nameserver? (IP address or 'none') [68.87.77.130 68.87.72.130 68.87.75.194] <b><i>Enter</i></b>
  Use the nameserver now? [yes] <b><i>Enter</i></b>
  Default route? (IP address, 'dhcp' or 'none') [dhcp] <b><i>Enter</i></b>
  Edit hosts with ed? [no] <b><i>Enter</i></b>
  Do you want to do any manual network configuration? [no] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
<b>NOTA: </b>Somente <b>uma</b> interface de rede pode ser configurada
utilizando DHCP durante a instalação. Se você tentar configurar mais de
uma interface para usar DHCP, você encontrará erros. Você terá que
configurar manualmente as outras interfaces DHCP após a instalação.

<p>
Agora vamos definir a senha para o usuário root:
<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
Password for root account? (will not echo) <b><i>pAssWOrd</i></b>
Password for root account? (again) <b><i>pAssWOrd</i></b>
</pre></td></tr></table>
<p>
Use uma senha segura para o usuário root. Você poderá criar outros
usuários depois que o sistema for inicializado. Extraído de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=passwd&amp;sektion=1">passwd(1)</a>:
<pre>
    The new password should be at least six characters long and not purely
    alphabetic.  Its total length must be less than _PASSWORD_LEN (currently
    128 characters).  A mixture of both lower and uppercase letters, numbers,
    and meta-characters is encouraged.
</pre>

<a name="InstMedia"></a>
<h3>4.5.5 - Escolha da mídia de instalação</h3>

<p>
Após configurar a rede, o programa de instalação dar-lhe-á a
oportunidade de fazer ajustes manuais na configuração.

<p>
Em seguida, você terá a oportunidade de escolher sua mídia de
instalação. As opções são listadas abaixo.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Let's install the sets!
  Location of sets? (cd disk ftp http or 'done') [cd] <b><i>Enter</i></b>
  Available CD-ROMs are: cd0.
</pre></td></tr></table>

<p>
Neste exemplo, nós vamos instalar a partir do CD-ROM. Será mostrada
uma lista de todos os dispositivos no seu computador que foram
identificados como CD-ROM. A maioria das pessoas possuem somente um.
Se você necessitar, certifique-se de qual dispositivo será usado para
fazer a instalação do OpenBSD.

<p>
<b>NOTA: </b>
Nem todas as plataformas suportam todas as opções. Neste caso,
a plataforma OpenBSD/i386 não suporta instalação via NFS, por isso
essa opção não está na lista.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Available CD-ROMs are: cd0.
  Which one contains the install media? (or 'done') [cd0] <b><i>Enter</i></b>
  Pathname to the sets?  (or 'done') [4.5/i386] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Aqui, você será perguntado por qual diretório contém os arquivos
de instalação, que é <tt>4.5/i386/</tt> no CD-ROM oficial ou no CD
construído a partir da imagem <tt>install45.iso</tt>.

<a name="Filesets"></a>
<h3>4.5.6 - Escolha dos pacotes de arquivos.</h3>

<p>
Agora é a hora de escolher quais arquivos serão instalados. Você pode
conseguir uma descrição desses arquivos na
<a href="#FilesNeeded">próxima seção</a>. Os arquivos que o programa
de instalação encontra são mostrados na tela. O seu trabalho é informar
quais arquivos você quer instalar. Por padrão, todos pacotes de arquivos
não-X são selecionados; no entanto, alguns usuários avançados talvez
queiram instalar somente o mínimo requerido para executar o OpenBSD, que
são os arquivos <tt>base45.tgz</tt>, <tt>etc45.tgz</tt> e <tt>bsd</tt>.
A maioria das pessoas vão querer instalar o conjunto padrão de pacotes
de arquivos ou todos os pacotes de arquivos. O exemplo abaixo é o da
instalação completa.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Select sets by entering a set name, a file name pattern or 'all'. De-select
  sets by prepending a '-' to the set name, file name pattern or 'all'. Selected
  sets are labeled '[x]'.

          [X] bsd
          [X] bsd.rd
          [ ] bsd.mp
          [X] base45.tgz
          [X] etc45.tgz
          [X] misc45.tgz
          [X] comp45.tgz
          [X] man45.tgz
          [X] game45.tgz
          [ ] xbase45.tgz
          [ ] xetc45.tgz
          [ ] xshare45.tgz
          [ ] xfont45.tgz
          [ ] xserv45.tgz
  Set name? (or 'done') [bsd.mp] <b>all</b>

          [X] bsd
          [X] bsd.rd
          [X] bsd.mp
          [X] base45.tgz
          [X] etc45.tgz
          [X] misc45.tgz
          [X] comp45.tgz
          [X] man45.tgz
          [X] game45.tgz
          [X] xbase45.tgz
          [X] xetc45.tgz
          [X] xshare45.tgz
          [X] xfont45.tgz
          [X] xserv45.tgz
</pre></td></tr></table>

<p>
Você pode fazer todos os tipos de coisas aqui -- "<tt>-x*</tt>"
removeria todos os componentes do X, se você mudasse de ideia.
Nesse caso, nós selecionamos todos os arquivos. Embora o sistema
funcione com poucos pacotes de arquivos, começar com a seleção padrão ou
instalar todos os pacotes de arquivos é mais recomendado.
Mais detalhes sobre a seleção dos pacotes podem ser encontrados
<a href="#FilesNeeded">aqui</a>.

<p>
Após escolher os pacotes de arquivos que deseja instalar, você será
questionado para confirmar se deseja que esses pacotes de arquivos sejam
extraídos e instalados.
Uma barra de progresso informar-lhe-á quanto tempo isso levará.
Esse tempo depende do sistema em que o OpenBSD está sendo instalado,
os arquivos que serão instalados e a velocidade da mídia utilizada.
Esta parte pode levar de poucos minutos a algumas horas.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Set name? (or 'done') [done] <b><i>Enter</i></b>
  Ready to install sets? [yes] <b><i>Enter</i></b>
  Getting bsd ...
  100% |**************************************************|  6539 KB    00:01    
  Getting bsd.rd ...
  100% |**************************************************|  5461 KB    00:01    
  Getting bsd.mp ...
  100% |**************************************************|  6558 KB    00:01    
  Getting base45.tgz ...
  100% |**************************************************| 46941 KB    00:29    
  Getting etc45.tgz ...
  100% |**************************************************|   501 KB    00:00    
  Getting misc45.tgz ...
  100% |**************************************************|  2866 KB    00:01    
  Getting comp45.tgz ...
  100% |**************************************************| 87874 KB    00:43    
  Getting man45.tgz ...
  100% |**************************************************|  8032 KB    00:07    
  Getting game45.tgz ...
  100% |**************************************************|  2555 KB    00:01    
  Getting xbase45.tgz ...
  100% |**************************************************|  9761 KB    00:05    
  Getting xetc45.tgz ...
  100% |**************************************************| 75214       00:00    
  Getting xshare45.tgz ...
  100% |**************************************************|  2698 KB    00:05    
  Getting xfont45.tgz ...
  100% |**************************************************| 34745 KB    00:16    
  Getting xserv45.tgz ...
  100% |**************************************************| 19478 KB    00:09    
  Location of sets? (cd disk ftp http or 'done') [done] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Neste ponto você pode adicionar arquivos de outras fontes
(incluindo <a href="#site">arquivos personalizados</a>) se desejar, ou
digitar '<tt>done</tt>' se você já instalou todos os pacotes de
arquivos que necessita.

<a name="Finish"></a>
<h3>4.5.7 - Finalização</h3>

Em seguida, você será questionado sobre algumas coisas sobre seu
sistema instalado. A primeira é se o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&amp;sektion=8">sshd(8)</a>
deve ser iniciado na inicialização do seu sistema.
Geralmente, você vai querer o sshd(8) funcionando, mas ocasionalmente
talvez não queira. Se o seu uso do sistema não necessitar do sshd(8), há
uma pequena vantagem teórica de segurança nisso.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Start sshd(8) by default? [yes] <b>y</b>
</pre></td></tr></table>

<p>
(Se você mudar de ideia mais tarde, altere o
<a href="faq10.html"><tt>/etc/rc.conf.local</tt></a> ou
<tt>/etc/rc.conf</tt>.)

<p>
Você terá a opção de executar o
<a href="faq6.html#OpenNTPD">OpenNTPD</a> na inicialização do
seu sistema.
O OpenNTPD é uma maneira simples de manter o relógio do seu sistema
corretamente sincronizado, e a configuração padrão é suficiente para
a maioria dos usuários.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Start ntpd(8) by default? [no] <b>yes</b>
  NTP server? (hostname or 'default') [default] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Se você tem um servidor de horas local, você pode especificá-lo aqui,
se você escolher "default", o OpenNTPD usa <tt>pool.ntp.org</tt>,
uma enorme coleção de servidores de horas de acesso livre.
(Se você mudar de ideia mais tarde, altere o
<a href="faq10.html"><tt>/etc/rc.conf.local</tt></a> e/ou
<tt>/etc/ntpd.conf</tt>.)

<p>
Em algumas plataformas, lhe é perguntado se deseja executar o X.
Se você responder 'Y', o <tt>/etc/sysctl.conf</tt> será
modificado para incluir as linhas <tt>machdep.allowaperture=1</tt> ou
<tt>machdep.allowaperture=2</tt>, dependendo da sua plataforma.
Algumas plataformas não fazem esta pergunta. Se você não pretende
executar o X ou não tem certeza, responda 'N', se mudar de ideia basta
editar o arquivo <tt>/etc/sysctl.conf</tt>. Existe uma vantagem de
segurança em deixar o driver <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xf86&amp;sektion=4">xf86(4)</a>
desabilitado, pois os motores gráficos das placas de vídeo dos
computadores modernos podem ser usados para alterar a memória, sem
controle do processador.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Do you expect to run the X Window System? [no] <b>y</b>
</pre></td></tr></table>

<p>
Em seguida, você será questionado se quer usar um
<a href="faq7.html#SerCons">console serial</a> com este computador,
em vez de um teclado e um monitor.
Se você escolher "<tt>yes</tt>" e responder outras questões simples, o
<tt><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot.conf&amp;sektion=8">/etc/boot.conf</a></tt>
e o
<tt><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ttys&amp;sektion=5">/etc/ttys</a></tt>
serão editados corretamente para você.
A maioria dos usuários escolherão o padrão: <b><tt>no</tt></b>.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Change the default console to com0? [no] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
A sua última tarefa é configurar o fuso horário ("time zone").
Dependendo de onde a sua máquina vive, existem diversas respostas
válidas a essa pergunta. No exemplo que se segue, nós usamos
<tt>US/Eastern</tt>, mas poderíamos ter usado <tt>EST5EDT</tt> ou
<tt>US/Michigan</tt> e teríamos o mesmo resultado. Ao digitar
<tt>?</tt>, o prompt mostra uma lista com possíveis escolhas.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Saving configuration files......done.
  Generating initial host.random file ......done.
  What timezone are you in? ('?' for list) [Canada/Mountain] <b>?</b>
  Africa/      Chile/       GB-Eire      Israel       NZ-CHAT      UCT
  America/     Cuba         GMT          Jamaica      Navajo       US/
  Antarctica/  EET          GMT+0        Japan        PRC          UTC
  Arctic/      EST          GMT-0        Kwajalein    PST8PDT      Universal
  Asia/        EST5EDT      GMT0         Libya        Pacific/     W-SU
  Atlantic/    Egypt        Greenwich    MET          Poland       WET
  Australia/   Eire         HST          MST          Portugal     Zulu
  Brazil/      Etc/         Hongkong     MST7MDT      ROC          posix/
  CET          Europe/      Iceland      Mexico/      ROK          posixrules
  CST6CDT      Factory      Indian/      Mideast/     Singapore    right/
  Canada/      GB           Iran         NZ           Turkey       zone.tab
  What timezone are you in? ('?' for list) [Canada/Mountain] <b>US</b>
  What sub-timezone of 'US' are you in? ('?' for list) <b>?</b>
  Alaska          Central         Hawaii          Mountain        Samoa
  Aleutian        East-Indiana    Indiana-Starke  Pacific
  Arizona         Eastern         Michigan        Pacific-New
  Select a sub-timezone of 'US' ('?' for list): <b>Eastern</b>
  Setting local timezone to 'US/Eastern'...done.
</pre></td></tr></table>

<p>
Se você está preocupado com a precisão no horário, talvez você queira
ler <a href="faq8.html#NTPerror">isto</a>.

<p>
As últimas etapas são para que seu sistema crie o diretório
<tt>/dev</tt> (o que pode levar algum tempo em alguns sistemas,
especialmente aqueles que possuem pouca quantidade de RAM), e para
instalar os blocos de inicialização ("boot blocks").

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Making all device nodes...done.
  Installing boot block...
  boot: /mnt/boot
  proto: /usr/mdec/biosboot
  device: /dev/rwd0c
  /usr/mdec/biosboot: entry point 0
  proto bootblock size 512
  /mnt/boot is 3 blocks x 16384 bytes
  fs block shift 2; part offset 3148740; inode block 24, offset 1832
  using MBR partition 1: type 166 (0xa6) offset 3148740 (0x300bc4)
  done.

  CONGRATULATIONS! Your OpenBSD install has been successfully completed!
  To boot the new system, enter halt at the command prompt. Once the
  system has halted, reset the machine and boot from the disk.
  # <b>halt</b>
  syncing disks... done

  The operating system has halted.
  Please press any key to reboot.
</pre></td></tr></table>

<p>
O OpenBSD agora está instalado no seu sistema e pronto para a primeira
inicialização, mas antes que você a faça...

<p>

<h4>Antes da reinicialização</h4>
Neste ponto, seu sistema está instalado e pronto para ser inicializado
e configurado para o serviço. Entretanto, antes disso, é
melhor você verificar a <a href="../../errata.html">página Errata</a>
para ver se existe alguma falha que possa causar-lhe algum dano.

<p>
Um truque que você pode usar "antes da primeira inicialização" é
executar:
<pre>
    # <b>/mnt/usr/sbin/chroot /mnt</b>
</pre>
no prompt de shell.
Isso ajusta seus pontos de montagem para ser o que seriam em uma
inicialização normal do seu novo sistema instalado. Você pode agora
fazer configurações básicas do seu sistema, como adicionar usuários,
mudar pontos de montagem, etc.

<h4>Depois da reinicialização</h4>

<p>
Umas das primeiras coisas que você deve ler, depois de instalar o seu
sistema, é
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=afterboot&amp;sektion=8">afterboot(8)</a>.

<p>
Você também pode achar os seguintes links úteis:
<ul>
<li><a href="faq10.html#AddDelUser">Como adicionar usuários no OpenBSD</a>
<li><a href="faq6.html#Setup">Configuração Inicial da Rede</a>
<li><a href="faq2.html#ManPages">Páginas de manual dos comandos
    populares/mais usados</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi">Páginas de manual
    do OpenBSD na Web</a>
<li><a href="faq15.html">O Sistema de Pacotes e Portes do OpenBSD para a
    instalação de software</a>
</ul>

<h4>Uma última coisa...</h4>
Os desenvolvedores do OpenBSD pedem que você
<a href="#SendDmesg">envie uma cópia do seu dmesg</a>. Isso é realmente
muito apreciado por eles e, no final das contas, por todos os usuários.

<p>
<a name= "FilesNeeded"></a>
<h2>4.6 - Quais arquivos são necessários para a instalação?</h2>
<!-- XXXrelease -->

<p>
A instalação completa do OpenBSD é dividida em vários
<i>pacotes de arquivos</i> separados.
Nem todos os aplicativos necessitam de todos os pacotes de arquivos.
Aqui você tem uma visão geral de cada um deles:
<p>
<ul>
  <li><b><i>bsd</i></b>		- Esse é o kernel. <b>Necessário</b>
  <li><b><i>bsd.mp</i></b>	- Kernel para os sistemas com
      múltiplos processadores (SMP) (somente para algumas plataformas)
  <li><b><i>bsd.rd</i></b> 	- <a href="#bsd.rd">Kernel de disco
      RAM</a>
  <li><b><i>base45.tgz</i></b>	- Contém o sistema base do OpenBSD
      <b>Necessário</b>
  <li><b><i>etc45.tgz</i></b>	- Contém todos os arquivos de /etc
      <b>Necessário</b>
  <li><b><i>comp45.tgz</i></b>	- Contém o compilador e suas
      ferramentas, cabeçalhos e bibliotecas.
      <b>Recomendado</b>
  <li><b><i>man45.tgz</i></b>    - Contém as páginas de manual
      <b>Recomendado</b>
  <li><b><i>misc45.tgz</i></b>   - Contém informações diversas,
      documentos sobre configuração
  <li><b><i>game45.tgz</i></b>   - Contém jogos para o OpenBSD
  <li><b><i>xbase45.tgz</i></b>  - Contém as bibliotecas e utilitários
      da base do X11
  <li><b><i>xetc45.tgz</i></b>   - Contém os arquivos de configuração
      /etc/X11 e /etc/fonts
  <li><b><i>xfont45.tgz</i></b>  - Contém o servidor de fontes do X11 e
      fontes
  <li><b><i>xserv45.tgz</i></b>  - Contém os servidores X do X11
  <li><b><i>xshare45.tgz</i></b> - Contém páginas de manual,
      configurações locais, arquivos de inclusão, etc. para o X
</ul>

Os pacotes <b>etc45.tgz</b> e <b>xetc45.tgz</b> não são instalados
como parte de uma atualização de versão, somente como parte de uma
instalação completa, assim nenhuma personalização que você fez é
perdida. Você tem que atualizar manualmente seus diretórios
<tt>/etc</tt>, <tt>/dev</tt> e <tt>/var</tt>.

<a name="FilesNeededX"></a>
<h3>Por que eu tenho que instalar o xbase45.tgz?</h3>
Mesmo se você não tem a intenção de executar o X, alguns
<a href="faq15.html">pacotes</a> de terceiros precisam que as
bibliotecas ou outros utilitários em <b>xbase45.tgz</b> estejam
instalados no seu sistema.
Essa dependência pode ser facilmente resolvida instalando
xbase45.tgz; o resto do X não é necessário.
Muitas pessoas insistem em não instalar o xbase45.tgz em seus sistemas,
sem ter uma razão válida:

<ul>
<li>Por si só, instalar o xbase45.tgz não causa a execução de nenhum
    programa no sistema.
<li>Por si só, instalar o xbase45.tgz em um sistema não influencia
    o risco de problemas externos de segurança.
<li>Se alguém já ESTÁ no seu sistema, ele pode instalar o que ele
    quiser, então a presença ou ausência do pacote de arquivos
    xbase45.tgz não muda a situação.
<li>As únicas partes do xbase45.tgz que estão em execução são as partes
    requeridas pelo seu aplicativo.
<li>O espaço exigido pelo xbase45.tgz é relativamente pequeno:
    cerca de 30M.
</ul>

As pessoas às vezes perdem um monte de tempo e esforços tentando
escolher partes do xbase45.tgz e usar somente os arquivos que elas
precisam para instalar algum aplicativo.
Isso não é somente sem sentido, como também é um esforço que tem que ser
repetido a cada ciclo de atualização de versão, o que significa que
provavelmente você não atualizará corretamente a versão do seu sistema,
criando problemas de segurança REAIS.

<p>
SE você precisa do xbase45.tgz, simplesmente instale-o.
Isso não vai lhe causar nenhum prejuízo maior que a aplicação
necessitando dele causaria.
Note que compilar a partir do código frequentemente exige que mais
partes do X estejam instaladas, mas os pontos acima ainda são
aplicáveis.


<p>
<a name="Partitioning"></a>
<a name= "SpaceNeeded"></a>  <!-- XXXobsolete tag -->
<h2> 4.7 - Quanto de espaço eu preciso para uma instalação do OpenBSD?</h2>
<!-- XXXrelease -->

<p>
Obviamente, a resposta para essa pergunta varia com base no tipo de uso
pretendido para seu sistema. Entretanto, estes números podem ser
usados como um ponto de <i>partida</i>:

<blockquote><pre>
(root)             60MB
/usr               500MB (sem o X) ou 660MB (com o X)
/var               25MB
/tmp               50MB
swap               32MB
</pre></blockquote>

Aqueles são os tamanhos mínimos sugeridos para o sistema de arquivos
de uma instalação completa.
Esses números incluem tamanho extra para permitir o uso de um típico
sistema desktop conectado à Internet, mas não muito mais do que isso.

<p>
Mantenha em mente os seguintes fatos:
<ul>
<li>Esses são valores mínimos.
    Os discos são relativamente baratos hoje em dia, tentar espremer seu
    sistema em um disco pequeno raramente é necessário. Para aplicações
    de propósito especial, os números acima podem ser menores, mas é
    melhor você testar antes.
<li>Esses números NÃO incluem a árvore de portes.
<li>Se você planeja instalar uma parte significativa de software de
    terceiros, faça uma partição <tt>/usr</tt> grande. Esse tamanho
    depende dos aplicativos, é claro.
<li>Para sistemas que manipulam grandes quantidades de correio
    eletrônico ou páginas Web (armazenados em <tt>/var/mail</tt> e
    <tt>/var/www</tt>, respectivamente), você irá fazer a sua partição
    <tt>/var</tt> bem grande, ou colocá-los em partições separadas.
<li>Para sistemas multiusuários que geram grandes quantidades de
    arquivos de registro, você irá fazer a sua partição <tt>/var</tt>
    com um tamanho cômodo, ou criar uma partição separada para os
    arquivos de registro (<tt>/var/log</tt>).
<li>Se você planeja <a href="faq5.html">recompilar seu kernel e o
    sistema a partir do código fonte</a>,
    você deverá fazer sua partição <tt>/usr</tt> grande, 4G é um bom
    tamanho.
<li>Compilar alguns <a href="faq15.html#Ports">portes</a> a partir do
    código fonte pode consumir uma grande quantidade de espaço das
    suas partições <tt>/usr</tt> e <tt>/tmp</tt>, essa é outra razão
    pela qual aconselhamos que você use
    <a href="faq15.html#PkgMgmt">pacotes pré-compilados</a>.
<li>A partição <tt>/tmp</tt> é usada na compilação de portes, entre
    outras coisas; um bom tamanho para /tmp depende do que você vai
    fazer com ela. 50M pode ser um bom tamanho para a maioria dos
    usuários, mas alguns aplicativos requerem 100M ou mais de espaço na
    <tt>/tmp</tt>.

<li>A partição 'b' do seu primeiro disco se torna automaticamente a
    partição swap do sistema.
    Muitas pessoas seguem a velha regra de que sua partição swap deve
    ser duas vezes o tamanho da memória principal. Essa regra não faz
    sentido.
    Os sistemas modernos possuem bastante espaço para swap, porém é
    preferível que seu sistema nunca faça swap.
    Você não quer seu sistema funcionando sempre com RAM+swap, você deve
    ter, de preferência, bastante RAM no sistema, assim ele não precisa
    fazer swap.
    Se você está usando um dispositivo flash como disco, você
    provavelmente não vai querer nenhuma partição swap.
    Use o que for apropriado para as suas necessidades.
    Se você pensar errado, é possível adicionar posteriormente outra
    partição swap em <i>/etc/fstab</i> ou
    <a href="faq14.html#SwapFile">fazer swap em um arquivo</a>.
<li>A swap e o <tt>/var</tt> são utilizados para armazenar core dumps
    do sistema em um evento de
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=crash&amp;sektion=8">crash(8)</a>.
    Se isso é importante para você, seu espaço swap deve ser um pouco
    maior que sua memória principal. Após a reinicialização,
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=savecore&amp;sektion=8">savecore(8)</a>
    tenta salvar o conteúdo da sua swap no arquivo
    <tt>/var/crash</tt>, então se isso for importante para você, sua
    partição <tt>/var</tt> deve ter uma grande quantidade de
    <i>espaço livre</i> para esses arquivos de dump.
    Mas sejamos realistas, poucos desenvolvedores quererão analisar o
    seu arquivo de dump de 1GB, então se você não pretende investigar o
    erro localmente, isso não é uma preocupação.
<li>Alguns poucos editores usam <tt>/var/tmp</tt> como espaço de
    partida, e esse diretório precisa ser tão grande ou maior que o
    enorme arquivo que você editar.
    Se você planeja editar arquivos de 500M, sua partição <tt>/var</tt>
    ou <tt>/var/tmp</tt> precisa ser maior do que você provavelmente
    tinha planejado.
</ul>

<p>
Há diversas razões para usar sistemas de arquivos separados em vez
de colocar tudo em uma ou duas partições:

<ul>
<li><b>Segurança</b>: Você pode marcar alguns sistemas de arquivos
    como 'nosuid', 'nodev', 'noexec', 'readonly', etc. Isso é feito pelo
    processo de instalação se você usar as partições descritas acima.
<li><b>Estabilidade</b>: Um usuário, ou um programa qualquer, pode
    encher o sistema de arquivos com lixo se tiver permissões de
    escrever nele. Seus programas principais que, é claro, executam em
    diferentes partições, não sofrerão com isso.
<li><b>Velocidade</b>: Um sistema de arquivos que é escrito muitas
    vezes pode começar a ficar muito fragmentado. (Felizmente, o sistema
    de arquivos ffs que o OpenBSD usa não tem tendência à
    fragmentação.)
<li><b>Integridade</b>: Se um sistema de arquivos se corromper por
    alguma razão, os seus outros sistemas de arquivos continuarão em
    bom estado.
<li><b>Tamanho</b>: Muitas máquinas possuem limites de áreas no disco
    de onde a ROM pode carregar o kernel. Em alguns casos, esse limite
    pode ser muito pequeno (504M para alguns 486 antigos), em outros
    casos, um limite muito maior (por exemplo, 2G, 8G, ou 128G em
    sistemas i386). Enquanto o kernel pode terminar em qualquer lugar
    dentro da partição raiz, a partição raiz deve estar dentro dessa
    área. Para mais detalhes, veja
    <a href="faq14.html#LargeDrive">esta seção</a>.
    Um bom guia pode ser manter a sua partição / completamente abaixo de
    2G, a menos que você saiba que sua plataforma (e máquina particular)
    pode manipular mais (ou menos) do que isso.
</ul>

<p>
Algumas considerações adicionais sobre particionamento:
<ul>
 <li>Para sua primeira tentativa em um sistema experimental, uma grande
     partição <tt>/</tt> e a swap pode ser mais fácil se você não sabe
     de quanto espaço necessita. Fazendo isso você estará sacrificando
     algumas características de segurança do OpenBSD que requerem
     sistemas de arquivos separados para
     <tt>/, /tmp, /var, /usr</tt> e <tt>/home</tt>.
     Entretanto, você provavelmente não colocará sua primeira instalação
     como um sistema de produção.
 <li>Um sistema exposto à Internet, ou a outras forças hostis, deve
     ter um <tt>/var</tt> separado (e até mesmo um <tt>/var/log</tt>
     separado) para o sistema de registro.
 <li>Uma partição <tt>/home</tt> pode ser muito útil. Nova versão
     do sistema operacional? Limpe e reinstale tudo, deixando a sua
     partição <tt>/home</tt> intacta. Lembre-se de salvar uma cópia
     dos seus arquivos de configuração!
 <li>Uma partição separada para qualquer coisa que acumule grandes
     quantidades de arquivos que necessitam ser removidos: pode
     ser mais rápido formatar e recriar do que apagar os arquivos. Veja
     a FAQ <a href="faq5.html#ProbObjPt">Construção a partir do
     código fonte</a> para um exemplo (<tt>/usr/obj</tt>).
 <li>Se você deseja reconstruir o seu sistema a partir do código fonte,
     por qualquer razão, o código fonte encontra-se em
     <tt>/usr/src</tt>. Se você não deseja criar uma partição separada
     para <tt>/usr/src</tt>, tenha certeza que <tt>/usr</tt> tem espaço
     suficiente.
 <li>Um fato geralmente esquecido: você <b>não</b> precisa alocar
     todo o espaço em disco quando você configura o sistema! Visto
     que agora você vai achar um desafio comprar um disco rígido novo
     menor que 20GB, pode fazer sentido deixar uma parte do seu disco
     desalocado. Se você mudar o tamanho de uma partição, você pode
     alocar uma nova partição a partir do seu espaço não utilizado,
     <a href="faq10.html#DupFS">duplicar</a> a partição existente para a
     nova partição, mudar o
     <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fstab&amp;sektion=5">/etc/fstab</a>
     para apontar para a nova partição, remontar, e você terá mais
     espaço.
 <li>Se você fizer as suas partições muito próximas do tamanho mínimo
     requerido, provavelmente você lamentará mais tarde, quando for a
     hora de fazer a atualização de versão do seu sistema.
 <li>Se você fizer partições muito grandes, tenha em mente que sempre
     que for executar a verificação do sistema de arquivos utilizando o
     <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fsck&amp;sektion=8">fsck(8)</a>,
     ele irá requerer 1MB de RAM por gigabyte do sistema de arquivos,
     além de consumir muito tempo e às vezes ser impraticável em
     sistemas antigos e muito lentos
     (veja <a href="faq14.html#LargeDrive">esta seção</a>).
 <li>Se você permitir que usuários escrevam em <tt>/var/www</tt>
     (ou seja, páginas Web pessoais), você talvez deseje colocá-lo em
     uma partição separada, assim você pode usar
     <a href="faq10.html#Quotas">quotas</a> para restringir o espaço
     utilizado pelos usuários, e se a partição ficar cheia, nenhuma
     outra parte do seu sistema será comprometida.
<li>Você talvez queira criar uma partição <tt>/altroot</tt>, como
    descrito em
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=daily&amp;sektion=8">daily(8)</a>.
    Isso pode fazer uma cópia diária da sua partição <tt>/</tt>,
    dando a você uma cópia extra do seu kernel e arquivos de
    configuração do diretório <tt>/etc</tt> se alguma coisa acontecer na
    sua partição raiz.
    Obviamente, a partição <tt>/altroot</tt> precisa ser tão grande
    quanto <tt>/</tt>.
    Se você tem um segundo disco rígido e algo duplicando o resto do seu
    disco, como
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=raid&amp;sektion=4">raid(4)</a>
    baseado em software ou uma cópia periódica usando
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dump&amp;sektion=8">dump(8)</a
    >/<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=restore&amp;sektion=8">restore(8)</a>,
    esse disco pode ser inicializado depois da remoção do disco primário.
</ul>


<p>
<a name= "Multibooting"></a>
<h2>4.8 - Inicialização múltipla com OpenBSD</h2>

Inicialização múltipla é ter diversos sistemas operacionais em um só
computador, e meios de selecionar qual SO é para inicializar. Isso
<i>não</i> é uma tarefa trivial! Se você não compreender o que está
fazendo, você pode acabar apagando grandes quantidades de dados do seu
computador. Novos usuários do OpenBSD são <i>fortemente</i>
incentivados a começar em uma máquina dedicada, com um disco rígido sem
dados, e então praticar as suas configurações em um sistema de testes
antes de se aventurar em uma configuração de inicialização múltipla em
uma máquina em produção. A <a href="faq14.html">FAQ 14</a> possui mais
informações sobre o processo de inicialização do OpenBSD.

<p>
Somente uma das quatro partições MBR <i>primárias</i> pode ser usada
para inicializar o OpenBSD (ou seja, partições estendidas não
funcionam).

<p>
Estas são as diversas opções de inicialização múltipla:

<h3>Marcar a partição ativa</h3>
Esta é, provavelmente, a mais negligenciada e, às vezes, a melhor
solução para inicialização múltipla. Simplesmente utilize o SO onde você
está atualmente para marcar a partição, que você quer inicializar por
padrão na próxima inicialização, como ativa.
Praticamente todos os SOs oferecem um programa
para fazer isso; o do OpenBSD é o
<a href="faq14.html#fdisk">fdisk(8)</a>, programas com nomes similares
existem para sistemas Windows 9x e DOS, e para muitos outros sistemas
operacionais. Isso pode ser altamente desejável para SOs que levam muito
tempo para desligar ou reinicializar -- você pode marcar e dar início
ao processo de reinicialização, e então sair de perto, pegar um copo de
café, voltar e ver o sistema inicializado do jeito que você queria --
sem ter que esperar pelo Momento Mágico de selecionar o próximo SO.

<h3>Disquete de inicialização</h3>
Se você possui um sistema onde não usa frequentemente o OpenBSD
(ou não deseja que usuários deste computador notem qualquer alteração),
considere a utilização de um disquete de inicialização. Simplesmente
use um dos
<a href="#MkFlop">disquetes de instalação padrão do OpenBSD</a>,
e crie o arquivo <tt>/etc/boot.conf</tt> (sim, você também tem que
criar o diretório <tt>/etc</tt> no seu disquete) com o conteúdo:

<pre>
	 boot hd0a:/bsd
</pre>

para fazer com que o sistema inicialize a partir do disco rígido 0,
partição OpenBSD 'a', arquivo de kernel <tt>/bsd</tt>. Note que você
também pode inicializar a partir de outros discos rígidos, com uma linha
como: "<tt>boot hd2a:/bsd</tt>", para inicializar a partir do terceiro
disco rígido do seu sistema. Para inicializar o OpenBSD, coloque seu
disquete dentro do drive e reinicialize a máquina. Para inicializar
outro SO, retire o disquete do drive e reinicialize.

<p>
Nesse caso, o programa
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot&amp;sektion=8&amp;arch=i386">boot(8)</a>
é carregado a partir do disquete e procura e lê o arquivo
<tt>/etc/boot.conf</tt>. A linha contendo "<tt>boot hd0a:/bsd</tt>"
instrui o boot(8) a partir de onde ele deve carregar o kernel -- nesse
caso, o primeiro HD que a BIOS vê. Mantenha em mente que somente um
pequeno arquivo (<tt>/boot</tt>) é carregado a partir do disquete -- o
sistema carrega o kernel do disco rígido, adicionando somente 5 segundos
ao processo de inicialização.

<h3>Windows NT/2000/XP NTLDR</h3>

Para inicialização múltipla entre OpenBSD e Windows NT/2000/XP, você
pode usar NTLDR, o carregador de inicialização que o NT usa. Para
inicialização múltipla com NT, você precisa ter uma cópia do seu
"Partition Boot Record" (PBR) do OpenBSD. Depois de executar o
"installboot", você pode copiar o arquivo usando o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&amp;sektion=1">dd(1)</a>
e seguir um procedimento similar ao seguinte:

<pre>
	# <strong>dd if=/dev/rsd0a of=openbsd.pbr bs=512 count=1</strong>
</pre>

Nota: Este é um bom momento para lembrá-lo para não digitar comandos
cegamente (sem saber o que eles fazem). O comando acima não funciona
diretamente em muitos computadores, ficando para o leitor a tarefa de
adaptá-lo a sua máquina.

<p>
Agora inicialize o NT e coloque <tt>openbsd.pbr</tt> em C:. Adicione uma
linha como esta no fim de <tt>C:\BOOT.INI</tt>:

<pre>
	c:\openbsd.pbr="OpenBSD"
</pre>

<p>
Quando você reinicializar, você pode selecionar o OpenBSD a partir do
menu do carregador do NT.
Há muito mais informação disponível sobre NTLDR em
<a href="http://www.tburke.net/info/ntldr/ntldr_hacking_guide.htm">
"NTLDR Hacking Guide"</a>.

<p>
No Windows XP você pode editar as informações de inicialização usando
uma interface gráfica (GUI); consulte o
<a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;289022">
"XP Boot.ini HOWTO"</a>.

<p>
Programas que fazem uma grande parte desse trabalho estão disponíveis,
por exemplo, o
<a href="http://www.winimage.com/bootpart.htm">BootPart</a>.
Esse programa pode ser executado no Windows NT/2000/XP. Ele busca o
PBR do OpenBSD, coloca-o na sua partição NT/2000/XP e adiciona-o
no <tt>C:\BOOT.INI</tt>.

<p>
Nota: O carregador de inicialização do Windows NT/2000/XP só é capaz
inicializar sistemas operacionais que se encontram no primeiro disco
rígido. Você não pode usar o carregador de inicialização do Windows para
carregar o OpenBSD a partir de um disco secundário.

<h3>Windows Vista</h3>

<p>
Com o Vista, a Microsoft descartou o suporte ao NTLDR em favor de seu
mais novo armazenamento "Boot Configuration Data" (BCD), utilizado para
controlar o ambiente de inicialização. Já que o <tt>BOOT.INI</tt> não
está mais disponível para personalização, um utilitário de linha de
comando, <tt>bcdedit</tt>, tomou seu lugar.

<p>
Uma vez que o PBR do OpenBSD está copiada na partição do sistema Vista,
os três comandos seguintes são requeridos para selecionar e inicializar
o OpenBSD quando o sistema é reiniciado:

<p>
<blockquote><pre>
C:\Windows\system32> bcdedit /create /d "OpenBSD/i386 4.6" /application bootsector
The entry {05a763ce-d81b-11db-b3ec-000000000000} was successfully created.

C:\Windows\System32>
</pre></blockquote>

<p>
O GUID retornado aqui, <tt>05a763ce-d81b-11db-b3ec-000000000000</tt>,
é mostrado por razões ilustrativas. Tome nota do GUID mostrado quando
você executa esse comando, já que esse valor precisa ser copiado nos
comandos seguintes. Copiar o GUID mostrado acima simplesmente não
vai funcionar.

<p>
Os dois comandos seguintes também são requeridos:

<p>
<blockquote><pre>
C:\Windows\system32> bcdedit /set {05a763ce-d81b-11db-b3ec-000000000000} device boot
The operation completed successfully.

C:\Windows\system32> bcdedit /set {05a763ce-d81b-11db-b3ec-000000000000} path \openbsd.pbr
The operation completed successfully.

C:\Windows\system32>
</pre></blockquote>

<p>
Note o nome do caminho absoluto do arquivo PBR importado. Não adicione
uma letra de drive, pois é assumido que o arquivo foi colocado na
partição do sistema.
<tt>bcdedit</tt> não queixa-se de uma especificação explícita de drive,
mas o gerenciador de inicialização vai recusar-se a seguir adiante
dizendo que ele não pode resolver o caminho do nome designado.

<p>
Após a reinicialização, o Vista é listado por primeiro no gerenciador
de inicialização, seguido do OpenBSD. Selecionar uma das duas entradas
inicializa o sistema operacional correspondente.

<p>
Para mais informações, consulte a ajuda do <tt>bcdedit</tt> digitando:

<p>
<blockquote><pre>
C:\Windows\system32> bcdedit /?
</pre></blockquote>

<p>
ou pesquisando na documentação e no sítio Web da Microsoft. Uma boa
introdução pode ser encontrada neste artigo
<a href="http://technet.microsoft.com/en-us/library/cc721886%28WS.10%29.aspx">
Frequently Asked Questions</a> no TechNet.
 
<p>
Para aqueles que acham a configuração manual assustadora,
<a href="http://neosmart.net/dl.php?id=1">EasyBCD</a> fornece uma
alternativa em GUI.

<h3>Windows 7</h3>

<p>
A Microsoft tem aperfeiçoado o BCD desde o lançamento do Vista para
permitir que múltiplas versões do Windows sejam inicializadas através do
<tt>bcdedit</tt>. Por causa desse maior controle, cinco comandos são
requeridos para configurar um ambiente de inicialização múltipla com o
OpenBSD.

<p>
Depois de copiar o PBR do OpenBSD na partição do sistema do Windows 7,
digite o seguinte comando para inicializar o registro necessário:

<p>
<blockquote><pre>
C:\Windows\system32> bcdedit /create /d "OpenBSD/i386 4.6" /application bootsector
The entry {0154a872-3d41-11de-bd67-a7060316bbb1} was successfully created.

C:\Windows\system32>
</pre></blockquote>

<p>
Como avisado antes, o GUID
<tt>{0154a872-3d41-11de-bd67-a7060316bbb1}</tt>
é dependente de sistema. Anote o valor que você recebeu ao executar o
comando e copie-o nos comandos seguintes:

<p>
<blockquote><pre>
C:\Windows\system32> bcdedit /set {0154a872-3d41-11de-bd67-a7060316bbb1} device boot
The operation completed successfully.

C:\Windows\system32> bcdedit /set {0154a872-3d41-11de-bd67-a7060316bbb1} path \openbsd.pbr
The operation completed successfully.

C:\Windows\system32> bcdedit /set {0154a872-3d41-11de-bd67-a7060316bbb1} device partition=c:
The operation completed successfully.

C:\Windows\system32> bcdedit /displayorder {0154a872-3d41-11de-bd67-7060316bbb1} /addlast
The operation completed successfully.

C:\Windows\system32>
</pre></blockquote>

<p>
No momento em que isto é escrito, o Windows 7 ainda não foi lançado
oficialmente. Seria prudente aos usuários consultar a documentação e o
sítio Web da Microsoft para obter informações atuais. Os detalhes podem
ter sido mudados.

<h3>Outros carregadores de inicialização</h3>

<p>
Alguns carregadores de inicialização que os usuários do OpenBSD usam com
sucesso são: <a href="http://gag.sourceforge.net/">GAG</a>,
<a href="http://www.ranish.com/part/">The Ranish Partition Manager</a>
e o <a href="http://www.gnu.org/software/grub/">GRUB</a>.

<p>
<h3>OpenBSD e Linux (i386)</h3>
<!-- XXXversion -->

<p>
Por favor, consulte
<a href="ftp://ftp.openbsd.org/pub/OpenBSD/4.5/i386/INSTALL.linux">INSTALL.linux</a>,
que possui instruções sobre como fazer o OpenBSD funcionar com Linux.

<h3>Problemas com o fuso horário</h3>
O OpenBSD espera que o relógio em tempo real do computador esteja
configurado para UTC ("Universal Coordinated Time", ou Tempo Universal
Coordenado).
Outros sistemas operacionais esperam que o relógio esteja
configurado para o horário local.
Isso pode ser um grande problema se você estiver usando ambos os
sistemas no mesmo computador.
Um dos sistemas precisará ser adaptado.
Mais informações sobre como fazer isso estão na
<a href="faq8.html#TimeZone">FAQ 8 - Por que meu relógio está atrasado
várias horas?</a>

<a name= "SendDmesg"></a>
<h2>4.9 - Como enviar o seu dmesg para dmesg@openbsd.org depois da
instalação</h2>

<p>
Apenas para lembrar, é importante para os desenvolvedores do OpenBSD
saber qual hardware funciona, e qual não funciona perfeitamente.

<p>
Uma citação de /usr/src/etc/root/root.mail
<blockquote><pre>
If you wish to ensure that OpenBSD runs better on your machines, please do us
a favor (after you have your mail system configured!) and type something like:
 # dmesg | mail -s "Sony VAIO 505R laptop, apm works OK" dmesg@openbsd.org
so that we can see what kinds of configurations people are running.  As shown,
including a bit of information about your machine in the subject or the body
can help us even further.  We will use this information to improve device driver
support in future releases.  (Please do this using the supplied GENERIC kernel,
not for a custom compiled kernel, unless you're unable to boot the GENERIC
kernel.  If you have a multi-processor machine, dmesg results of both GENERIC.MP
and GENERIC kernels are appreciated.)  The device driver information we get from
this helps us fix existing drivers. Thank you!
</pre></blockquote>

<p>
Certifique-se de enviar a mensagem de correio eletrônico a partir de uma
conta que esteja habilitada para receber mensagens dos desenvolvedores,
para que eles possam entrar em contato se tiverem algo que queiram
testar ou mudar, a fim de tornar funcional no OpenBSD.
Não é importante enviar a mensagem a partir da mesma máquina que está
executando o OpenBSD; se essa máquina for incapaz de receber a mensagem,
basta executar

<pre>
$ dmesg | mail your-account@yourmail.dom
</pre>
E então encaminhar a mensagem para
<pre>
 dmesg@openbsd.org
</pre>
onde <tt>your-account@yourmail.dom</tt> é a sua conta de correio
eletrônico.

<p>
<b>NOTAS</b>

<ul>
<li>Por favor, só mande o dmesg do kernel GENERIC.
    Kernels personalizados, que possuem drivers de dispositivos
    removidos, não são úteis.
<li>Se você possui um sistema multiprocessado e usa o kernel
    GENERIC.MP, é muito importante para os desenvolvedores verem a saída
    do seu dmesg, tanto do kernel GENERIC quanto do kernel GENERIC.MP,
    então por favor, mande ambos em mensagens separadas.
<li>Os dmesgs são recebidos por uma máquina que usa
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=spamd&amp;sektion=8">spamd</a>
    para rejeitar spams. Isso faz com que a sua mensagem não seja
    recebida por um período de tempo. Tenha paciência, depois de meia
    hora ou até uma hora, nós a receberemos.
</ul>

<p>
O método acima é bastante simples, mas se você não configurou o seu
sistema de correio eletrônico no OpenBSD, você pode salvar a sua saída
do dmesg em um arquivo de texto e mandar para os desenvolvedores do
OpenBSD.

<pre>
$ dmesg > ~/dmesg.txt
</pre>

Então transfira o arquivo (usando FTP/scp/disquete/pombo-correio/...)
para o sistema que você normalmente usa para correio eletrônico. Como a
saída do dmesg que você envia é processada automaticamente, tenha
certeza de verificar os seguintes itens quando usar clientes/sistemas
de correio eletrônico alternativos.
<ul>
<li>Configure o seu correio eletrônico para enviar mensagens somente em
    texto plano; não use HTML na formatação da sua mensagem.
<li>Desabilite qualquer função de quebra de linha.
    Muitos clientes de correio eletrônico são configurados para inserir
    quebra de linha quando chegam na coluna 72 (a norma para listas
    de discussão).
<li>Tenha certeza de que seu cliente de correio eletrônico não reformata
    a mensagem.
<li>Não mande a saída do seu dmesg em anexo.
    Coloque a saída do seu dmesg no corpo da mensagem.
</ul>


<a name="AddFileSet"></a>
<h2>4.10 - Como adicionar um pacote de arquivos após a instalação</h2>
<!-- XXXversion -->
"Oh não! Eu esqueci de adicionar um pacote de arquivos durante a
instalação!"
<p>
Às vezes você acha que necessita realmente só de <tt>comp45.tgz</tt>
(ou algum outro componente do sistema) após a instalação, você então
verifica que necessita de outros pacotes de arquivos. Boa notícia: há
duas maneiras fáceis de instalar pacotes de arquivos após a instalação
inicial:

<h3>Usar o processo de atualização de versão</h3>
Simplesmente inicialize com uma mídia de instalação (CD-ROM ou Disquete)
e escolha "Upgrade" (em vez de "Install"). Quando você ver a lista de
pacotes de arquivos para instalação, escolha somente os pacotes de
arquivos que você não escolheu na primeira instalação, selecione a
origem, e então deixe eles serem instalados para você.

<h3>Usar o tar(1)</h3>
Os pacotes de arquivos de instalação são simples arquivos tar, e você
pode expandí-los manualmente a partir da raiz do sistema de arquivos:

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  # cd /
  # tar xzvphf comp45.tgz
</pre></td></tr></table>

<p>
Não se esqueça da opção <tt>'p'</tt> no comando acima, a fim de
restaurar corretamente as permissões dos arquivos!
<p>
Um erro comum é pensar que você pode usar o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_add&amp;sektion=1">pkg_add(1)</a>
para adicionar pacotes de arquivos não instalados. Isso não funciona.
pkg_add(1) é a
<a href="faq15.html#PkgMgmt">ferramenta de gerenciamento de pacotes</a>
para instalar software de terceiros. Essa ferramenta manipula arquivos
de pacotes, não arquivos tar genéricos como os pacotes de instalação.

<p>
Se você está instalando o pacote de arquivos <tt>xbase</tt> pela
primeira vez no seu sistema, usando o tar(1) e sem reinicializar, o
cache de bibliotecas compartilhadas precisa ser atualizado usando o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ldconfig&amp;sektion=8"
>ldconfig(8)</a>
após a instalação.
Para adicionar todas as bibliotecas do X no cache:

<blockquote><pre>
# <b>ldconfig -m /usr/X11R6/lib</b>
</pre></blockquote>

Alternativamente, você pode apenas reinicializar seu sistema, e isso
será feito automaticamente pelo script de inicialização
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc&amp;sektion=8"
>rc(8)</a>.

<a name="bsd.rd"></a>
<h2>4.11 - O que é 'bsd.rd'?</h2>

<b><tt>bsd.rd</tt></b> é um "Disco RAM" do kernel. Esse arquivo é muito
útil; muitos desenvolvedores têm cuidados para mantê-lo sempre na
raiz dos seus sistemas.

<p>
Chamá-lo de "disco de RAM do kernel" descreve o sistema de arquivos raiz
do kernel -- ao contrário de um disco físico, os utilitários disponíveis
depois da inicialização do <tt>bsd.rd</tt> são armazenados no kernel, e
são executados a partir de um sistema de arquivos baseado em RAM.
<tt>bsd.rd</tt> também inclui um conjunto de utilitários para que você
faça a manutenção e a instalação do seu sistema.

<p>
Em algumas plataformas, <tt>bsd.rd</tt> é realmente a técnica
preferida para instalação -- você coloca esse kernel em um sistema
de arquivos existente, inicializa-o e executa a instalação a partir
dele. Na maioria das plataformas, se você está executando uma versão
antiga do OpenBSD, você pode pegar por FTP uma versão nova de
<tt>bsd.rd</tt>, reinicializar a máquina com ele e instalar uma nova
versão do OpenBSD sem usar uma mídia removível para isso.

<p>
Aqui está um exemplo de inicialização com <tt>bsd.rd</tt> em um sistema
i386:

<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Using Drive: 0 Partition: 3
  reading boot.....
  probing: pc0 com0 com1 apm mem[639k 255M a20=on]
  disk: fd0 hd0+
  &gt;&gt; OpenBSD/i386 BOOT 3.02
  boot&gt; <b>boot hd0a:/bsd.rd</b>
<i>. . . normal boot to install . . .</i>
</pre></td></tr></table>

Como indicado, você será levado ao programa de instalação, mas você
também pode executar um shell para fazer a manutenção do seu sistema.
<p>
A regra geral para inicializar com <tt>bsd.rd</tt> é mudar o seu kernel
de <tt>/bsd</tt> para <tt>bsd.rd</tt> através dos meios usados em sua
plataforma.

<a name="InstProb"></a>
<h2>4.12 - Problemas comuns de instalação</h2>

<a name="cpq16m"></a>
<h3>4.12.1 - Meu Compaq só reconhece 16M RAM</h3>
<i>Alguns</i> sistemas Compaq possuem um problema onde toda a RAM do
sistema não é detectada corretamente pelo
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot&amp;sektion=8&amp;arch=i386">
carregador de inicialização de segundo estágio do OpenBSD</a>, e somente
16M são detectados e utilizados pelo OpenBSD. Isso pode ser corrigido
pela criação/edição do arquivo
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot.conf&amp;sektion=8&amp;arch=i386"><tt>/etc/boot.conf</tt></a>,
ou especificando comandos depois de "<tt>boot></tt>", antes que
o OpenBSD seja carregado. Se você possui uma máquina com 64M de RAM,
mas o OpenBSD só reconhece os primeiros 16M, o comando que você usaria
seria:

<pre>
	 machine mem +0x3000000@0x1000000
</pre>
Para adicionar 48M (<tt>0x3000000</tt>) após os primeiros 16M
(<tt>0x1000000</tt>). Tipicamente, se você tivesse uma máquina com esse
problema, você primeiramente especificaria o comando acima no prompt
<tt>boot></tt> no momento da instalação por disquete/CD-ROM, carregaria
o sistema, reinicializaria e criaria o arquivo <tt>/etc/boot.conf</tt>
com a linha de comando acima, para que nas próximas inicializações toda
a memória RAM disponível seja reconhecida.

<p>
Sabe-se também que uma atualização da ROM soluciona esse problema em
<i>alguns</i> sistemas.

<a name="noboot"></a>
<h3>4.12.2 - Meu i386 não inicializa após a instalação</h3>
Sua instalação parece ter ocorrido perfeitamente, mas na primeira
inicialização você não vê nem sinal do OpenBSD. Há algumas razões
comuns para esse problema:

<ul>
<li><b>Nenhuma partição foi marcada como ativa no fdisk(8).</b>
    Para solucionar esse problema, reinicialize a sua máquina, usando um
    disquete de inicialização ou outra mídia, e "marque" a partição como
    "ativa" (inicializável).
    Veja <a href="faq14.html#fdisk">aqui</a> e
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&amp;sektion=8&amp;arch=i386">aqui</a>.

<li><b>Nenhum carregador de inicialização válido foi colocado no
    disco.</b>
    Se você respondeu "Y" para a questão "Use entire disk for OpenBSD?"
    durante a instalação, ou usou a opção "<tt>reinit</tt>" no fdisk(8),
    o registro de inicialização do OpenBSD foi instalado no
    "Master Boot Record" do disco; caso contrário, o código de
    inicialização mestre está intocado. Isso é um problema se nenhum
    outro registro de inicialização existir. Uma solução é inicializar
    outra vez com a mídia de instalação, entrar em um prompt do shell e
    executar
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&amp;sektion=8&amp;arch=i386">fdisk(8)</a>
    para atualizar o código MBR a partir da linha de comando:
<pre>
    # fdisk -u wd0
</pre>
    Nota: a opção "update" do modo interativo ("-e") do fdisk não
    escreve os bytes de assinatura requeridos para tornar o disco
    inicializável.

<li><b> Em algumas raras ocasiões, algo pode dar errado na instalação
    do carregador de inicialização de segundo estágio.</b>
    A reinstalação do carregador de inicialização de segundo estágio
    é discutida <a href="faq14.html#InstBoot">aqui</a>.
</ul>

<a name="sshhang"></a>
<h3>4.12.3 - Minha (velha e lenta) máquina inicializa, mas para no
procedimento de ssh-keygen</h3>
É provável que a sua máquina esteja funcionando muito bem, mas está
levando algum tempo para realizar o processo de geração de chaves do
ssh. Uma SPARCStation2 ou um Macintosh Quadra pode levar
<i>várias horas</i> para terminar os três passos do
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-keygen&amp;sektion=1">ssh-keygen(1)</a>.
Deixe-o terminar; isso só é feito uma vez por instalação.

<p>
Note que o tamanho padrão da chave cresceu no OpenBSD 3.8, então os
tempos de geração estão mais demorados do que costumavam ser.
Usuários de máquinas lentas talvez queiram gerar suas chaves em outro
computador, e então colocá-las em um arquivo
<a href="#site">site45.tgz</a> e instalá-las com o resto do sistema.


<a name="noftplist"></a>
<h3>4.12.4 - Eu recebi a mensagem "Failed to change directory" enquanto
fazia a instalação</h3>

Ao fazer uma instalação FTP de um
<a href="faq5.html#Flavors">snapshot</a> durante o estágio <i>-beta</i>
de desenvolvimento do OpenBSD, você pode ver isto:

<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>

  Display the list of known ftp servers? [no] <b>yes</b>
  Getting the list from 192.128.5.191 (ftp.openbsd.org)... FAILED
  Failed to change directory.
  Server IP address or hostname?
</pre></td></tr></table>

Isso é normal e esperado durante o ciclo de pré-liberação. O programa
de instalação procura pela lista de FTP no servidor FTP primário
em um diretório que ainda não está disponível antes da
<a href="faq1.html#Next">data de liberação</a>, então você recebe
a mensagem acima.

<p>
Simplesmente use uma
<a href="../../ftp.html">lista de espelhos FTP</a>
para encontrar o seu espelho favorito, e especifique manualmente o nome
quando for preciso.

<p>
<b>Nota: Você não deve ver isso se estiver instalando uma versão
<i>-release</i> ou a partir de um CD-ROM.</b>

<a name="blankfdisk"></a>
<h3>4.12.5 - Minha tabela de partições do fdisk está corrompida ou
vazia!</h3>
Ocasionalmente, o usuário consegue um sistema que funciona, mas
quando executa <tt>fdisk wd0</tt>, ele vê uma tabela de partições
completamente vazia (ou, algumas vezes, bagunçada). Isso geralmente é
causado por ter sido criada uma partição no
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&amp;sektion=8&amp;arch=i386">fdisk(8)</a>
com um offset de zero setores, ao invés de <a href="#trackoffset">um
offset com uma trilha</a> (nota: é assumida aqui uma plataforma
<a href="../../i386.html">i386</a> ou
<a href="../../amd64.html">amd64</a>.
Outras plataformas requerem tamanhos diferentes de offset, e algumas
NÃO precisam de offset).
O sistema então <a href="faq14.html#Boot386">inicializa</a> usando o
PBR, e não o MBR.

<p>
Ao passo que essa configuração pode funcionar, ela pode também ser um
problema durante manutenções, devendo ser consertada.
Para consertar isso, o sistema de arquivos do disco deve geralmente
ser recriado do zero (no entanto, se você REALMENTE sabe o que está
fazendo, você pode apenas recriar o rótulo de disco (disklabel) e o MBR,
e apenas perder e ter que reconstruir a primeira partição OpenBSD no
disco).

<a name="noflopcd"></a>
<h3>4.12.6 - Eu não tenho um drive de disquete ou CD-ROM na minha
máquina</h3>
Algumas pessoas talvez queiram executar o OpenBSD em computadores que
não possuem nenhum jeito óbvio de instalar o OpenBSD.
Estas são algumas dicas e técnicas que você pode usar para instalar o
OpenBSD nesses sistemas.
<ul>
<li>Inicialização pela rede, usando <a href="faq6.html#PXE">PXE</a>
    (i386 ou amd64) ou
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=diskless&amp;sektion=8">diskless(8)</a>
    (outras plataformas).

<li>Drive USB de disquete ou CD-ROM externo, se a sua máquina pode
    inicializar a partir de um.

<li>Disco rígido ou disco Flash USB, se a sua máquina pode, novamente,
    inicializar a partir de um dispositivo USB.
    Prepare o dispositivo em outro computador, como descrito em
    <a href="faq14.html#flashmemBoot">FAQ 14</a>.
    Inicialize a partir dele, mas escolha o kernel bsd.rd, e então
    instale como de hábito.
    Você também pode colocar, previamente, os conjuntos de arquivos na
    mídia flash.

<li>Em último caso, se nenhuma das coisas acima é adequada, você pode
    retirar o disco do sistema de destino, usar adaptadores disponíveis
    para instalar em um computador "normal", instalar o OpenBSD, e então
    colocar o disco de volta no sistema de destino.
    O OpenBSD então inicializa na máquina de destino, embora você
    tenha que, possivelmente, ajustar a configuração de rede.
</ul>

Em todos os casos, lembre-se que a máquina tinha um SO instalado nela
antes, e normalmente foi pensado para que o SO pudesse ser instalado
novamente.
Como isso foi originalmente pensado para ser feito irá, frequentemente,
fornecer a você uma boa ideia sobre como você pode instalar o OpenBSD.


<a name="site"></a>
<h2>4.13 - Personalização do processo de instalação</h2>
<!-- XXXversion -->

<h3>arquivo <tt>siteXX.tgz</tt></h3>
Os scripts de instalação/atualização de versão do OpenBSD permitem a
seleção de um pacote de arquivos criado pelo usuário, chamado
"<tt>siteXX.tgz</tt>", onde XX é a versão (por exemplo, 45). O arquivo
<tt>siteXX.tgz</tt> é, como os outros
<a href="#FilesNeeded">pacotes de arquivos</a>,
comprimido com
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gzip&amp;sektion=1">gzip(1)</a>
e
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tar&amp;sektion=1">tar(1)</a>,
com a raiz em '/', e descomprimido como qualquer outro
pacote de arquivos com as opções <tt>xzphf</tt>. Esse pacote de
arquivos é instalado por último, depois de todos os outros pacotes de
arquivos.

<p>
Esse pacote de arquivos habilita o usuário a adicionar e/ou sobrescrever
arquivos instalados nos conjuntos 'normais' e, assim, personalizar a
instalação ou a atualização de versão.

<p>
Você também pode criar e utilizar pacotes de instalação específicos para
cada máquina, nomeados como <tt>siteXX-<i>&lt;hostname&gt;.tgz</i></tt>;
"<tt>site45-puffy.tgz</tt>" por exemplo.
Isso possibilita instalações personalizadas, atualizações de versão, ou
recuperação do sistema.

<p>
Alguns exemplos de uso de um arquivo <tt>siteXX.tgz</tt>:
<ul>
<li>Crie um arquivo siteXX.tgz que contenha todas as mudanças que
    você fez desde a primeira instalação do OpenBSD. Então, se você
    tiver que recriar o sistema, simplesmente selecione o arquivo
    siteXX.tgz durante a reinstalação e todas as suas mudanças serão
    replicadas no novo sistema.

<li>Crie uma série de diretórios específicos para cada máquina, cada
    um com um arquivo siteXX.tgz que contenha arquivos específicos para
    cada uma delas. A instalação (por exemplo, máquinas com diferentes
    placas de vídeo) de uma categoria pode ser feita selecionando o
    arquivo siteXX.tgz apropriado.

<li>Coloque os arquivos que você personaliza rotineiramente em um mesmo
    siteXX.tgz -- arquivos
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&amp;sektion=8"><tt>/etc/skel</tt></a>,
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5"><tt>/etc/pf.conf</tt></a>,
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&amp;sektion=8"><tt>/var/www/conf/httpd.conf</tt></a>,
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf.local&amp;sektion=8"><tt>/etc/rc.conf.local</tt></a>,
    etc.
</ul>

<h3><tt>Scripts install.site</tt>/<tt>upgrade.site</tt></h3>
Como último passo no processo de instalação/atualização de versão, o
script procura no diretório raiz do sistema recém-instalado/atualizado
por <tt>install.site</tt> ou <tt>upgrade.site</tt>, conforme apropriado
para o processo atual, e executa esse script num ambiente
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chroot&amp;sektion=8">chroot</a>ado
para a raiz do sistema instalado/atualizado. Lembre-se: a atualização
de versão é feita a partir de um sistema de arquivos inicializado, então
o seu sistema de arquivos alvo está realmente montado no diretório
<tt>/mnt</tt>. No entanto, por causa do chroot, o script pode ser
escrito como se estivesse executando na raiz "normal" do seu sistema de
arquivos. Pelo fato de que esse script é executado após todos os
arquivos estarem instalados, você tem uma grande parte da funcionalidade
do sistema completo quando o script é executado.
Mantenha em mente que você está executando um kernel mínimo, nem todos
os recursos estão disponíveis e, devido à problemas de espaço, as
coisas que funcionam hoje podem não funcionar em uma versão futura.

<p>
Note que o script <tt>install.site</tt> deve estar em um arquivo
<tt>siteXX.tgz</tt>, enquanto que o script <tt>upgrade.site</tt>
pode ser colocado no diretório raiz antes da atualização de versão, ou
pode ser colocado em um arquivo <tt>siteXX.tgz</tt>.

<p>
Os scripts podem ser utilizados para fazer muitas coisas:
<ul>
<li>Remover arquivos que estão instalados/atualizados, mas que
    você não os quer presentes no sistema.
<li>Remover/atualizar/instalar <a href="faq15.html#PkgMgmt">pacotes</a>
    que você deseja no sistema instalado (pode não funcionar com todos
    os pacotes!).
<li>Fazer um <a href="faq14.html#Backup">backup/arquivamento imediato</a>
    do novo sistema antes de você expô-lo ao resto do mundo.
<li>Usar o <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rdate&amp;sektion=8">rdate(8)</a>
    para configurar a hora do sistema.
</ul>

<p>
A combinação dos arquivos <tt>siteXX.tgz</tt> e
<tt>install.site/upgrade.site</tt> tem o objetivo de dar aos usuários
amplas capacidades de personalização sem precisar construir seus
próprios pacotes de instalação.

<p>
Nota: se você for fazer a sua instalação a partir de um servidor http,
você precisa adicionar <tt>site*.tgz</tt> ao arquivo <tt>index.txt</tt>
no diretório fonte, para que ele fique disponível na hora da instalação.
Isso não é necessário para ftp ou outras formas de instalação.


<a name="Multiple"></a>
<h2>4.14 - Como eu instalo em vários sistemas similares?</h2>
Aqui estão algumas ferramentas que você pode usar quando tem que
instalar vários sistemas similares do OpenBSD.

<h3>Arquivos <tt>siteXX.tgz</tt> e <tt>install/upgrade.site</tt></h3>
Veja o artigo <a href="#site">acima</a>.

<h3>Restauração a partir do dump(8)</h3>
Na maioria das plataformas, a mídia de inicialização inclui o programa
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=restore&amp;sektion=8">restore(8)</a>,
que pode ser usado para recuperar backups feitos com
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dump&amp;sektion=8">dump(8)</a>.
Assim, você pode inicializar a partir de um
<a href="#MkFlop">disquete</a>,
<a href="../../orders.html">CD</a> ou
<a href="#bsd.rd">bsd.rd</a>, executar o
<a href="faq14.html#fdisk">fdisk</a>,
o <a href="faq14.html#disklabel">disklabel</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=restore&amp;sektion=8">restaurar</a>
as configurações desejadas a partir de uma fita ou outra mídia, e
instalar os
<a href="faq14.html#InstBoot">blocos de inicialização</a>.
Mais detalhes <a href="faq14.html#Backup">aqui</a>.

<h3>Imagem de disco</h3>
Infelizmente não há nenhum pacote conhecido de software que crie
imagem de discos com suporte ao FFS, e que crie imagens contendo apenas
o espaço ativo do arquivo. A maioria das soluções existentes tratam a
partição OpenBSD como "genérica", e podem fazer uma imagem do disco
inteiro. Isso geralmente é o objetivo, porém há um grande desperdício
de espaço -- uma partição <tt>/home</tt> de 10G requer 10G de espaço na
imagem, mesmo que não haja um único arquivo na partição.
Enquanto que você pode instalar tipicamente uma imagem do drive em um
grande drive, você não pode utilizar diretamente o espaço extra, e você
não pode instalar uma imagem em um drive menor.

<p>
Se essa é uma situação aceitável, você pode utilizar o comando
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&amp;sektion=1">dd</a>,
o qual permite copiar o conteúdo inteiro de um disco para outro, setor
a setor. Isso proporcionaria a mesma funcionalidade de programas
comerciais, porém a custo zero.

<a name="getdmesg"></a>
<h2>4.15 - Como eu obtenho o dmesg(8) para relatar um problema de
instalação?</h2>
Ao <a href="../../report.html">relatar um problema</a> é necessário
incluir o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dmesg&amp;sektion=8">dmesg(8)</a>.
Entretanto, quando você necessita de fazer isso é porque o sistema não
está funcionando normalmente ou não instalou, então você não possui
o disco, a rede, ou outros recursos necessários para que você possa
pegar o dmesg e enviá-lo à
<a href="../../mail.html">lista de discussão</a> apropriada.
Há outras maneiras, no entanto:

<ul>
<li><b>Disquete:</b> Os discos de inicialização e o CD-ROM possuem
ferramentas que possibilitam gravar o seu dmesg em um disquete MSDOS
para depois ser lido em outra máquina. Coloque um disquete formatado em
MSDOS no drive e execute os comandos abaixo:

<pre>
     mount -t msdos /dev/fd0a /mnt
     dmesg >/mnt/dmesg.txt
     umount /mnt
</pre>
Se você tiver um outro sistema OpenBSD, você pode fazer isso em um
disquete compatível com o sistema de arquivos do OpenBSD --
frequentemente, o disquete de inicialização tem bastante espaço para
conter o dmesg. Nesse caso, tire a opção "<tt>-t msdos</tt>" acima.

<p>
<li><b>Console Serial:</b>
Usar um console serial e capturar a saída em outro computador
é o melhor caminho para capturar informações de diagnóstico -
particularmente se o computador trava logo após a inicialização.
Em um segundo computador, você necessita de um cabo serial apropriado
(como um cabo null-modem) e um programa emulador de terminal para
capturar a saída da tela em um arquivo.

<p>
Informações gerais sobre a configuração de console serial são discutidas
em <a href="faq7.html#SerCon">outra parte nesta FAQ</a>; para capturar o
registro da instalação, os seguintes comandos usualmente são
suficientes.

<p><b>i386</b>

<p>
No prompt do carregador de inicialização, digite

<p>
<blockquote>
<pre>
boot> <b>set tty com0</b>
</pre>
</blockquote>

<p>
Isso diz ao OpenBSD para usar a primeira porta serial (também chamada
de COM1 ou COMA na documentação do PC) como um console serial.
A taxa padrão de comunicação é 9600 (baud rate).

<p><b>Sparc/Sparc64</b>

<p>
Essas máquinas usam automaticamente um console serial se iniciadas
sem um teclado. Se você possui um teclado e um monitor conectados, você
pode forçar o sistema a usar um console serial com o seguinte comando no
prompt <tt>ok</tt>.

<p>
<blockquote>
<pre>
ok <b>setenv input-device ttya</b>
ok <b>setenv output-device ttya</b>
ok <b>reset</b>
</pre>
</blockquote>

</ul>
<p>

<font color= "#0000e0">
<a href="index.html">[Índice da FAQ]</a>
<a href="faq3.html">[Seção 3 - Primeiros passos com o OpenBSD]</a>
<a href="faq5.html">[Seção 5 - Construção do Sistema a partir do Código Fonte]</a>
</font>

<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../../images/back.gif"
border= "0" alt= "[voltar]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: faq4.html,v 1.284 ]<br>
$Translation: faq4.html,v 1.24 2009/10/13 19:21:11 alan Exp $<br>
-->
$OpenBSD: faq4.html,v 1.16 2009/10/17 15:58:26 ajacoutot Exp $
</small>
</body>
</html>

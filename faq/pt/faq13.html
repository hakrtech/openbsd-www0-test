<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>13 - Multimídia</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
</head>

<!--
Copyright (c) 2005-2007 Steven Mestdagh <steven@openbsd.org>

Permission to use, copy, modify, and distribute this documentation for
any purpose with or without fee is hereby granted, provided that the
above copyright notice and this permission notice appear in all copies.

THE DOCUMENTATION IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL
WARRANTIES WITH REGARD TO THIS DOCUMENTATION INCLUDING ALL IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE
AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS DOCUMENTATION
-->

<body bgcolor= "#ffffff" text= "#000000">

<a href="../../pt/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif" border="0">
</a>
<p>
<font color= "#0000e0">
<a href= "index.html">[Índice da FAQ]</a>
<a href= "faq12.html">[Seção 12 - Questões Específicas de Hardware e Plataforma]</a>
<a href= "faq14.html">[Seção 14 - Configuração dos Discos]</a>
</font>

<h1><font color="#e00000">13 - Multimídia</font></h1><hr>

<h3>Conteúdo</h3>
<ul>
<li><a href="#confaudio"  >13.1 - Como eu configuro meu dispositivo de
    áudio?</a>
<li><a href="#playaudio"  >13.2 - Execução de diversos formatos de áudio</a>
<li><a href="#playCD"     >13.3 - Como escutar CDs de áudio no OpenBSD?</a>
<li><a href="#recordaudio">13.4 - Posso usar o OpenBSD para gravar
    amostras de áudio?</a>
<li><a href="#audioprob"  >13.5 - O que posso fazer se eu tenho
    problemas com o áudio?</a>
<li><a href="#midi"	  >13.6 - Como eu uso meus instrumentos MIDI?</a>
<li><a href="#lossyaudio" >13.7 - Me fala sobre codificação Ogg Vorbis e
    MP3?</a>
<li><a href="#playDVD"    >13.8 - Como eu posso assistir DVDs de vídeo
    no OpenBSD?</a>
<li><a href="#burnCD"     >13.9 - Como gravar CDs e DVDs?</a>
<ul>
  <li><a href="#burnIntro">13.9.1 - Introdução e configuração básica</a>
  <li><a href="#writeCD"  >13.9.2 - Gravação de CDs</a>
  <li><a href="#writeDVD" >13.9.3 - Gravação de DVDs</a>
</ul>
<li><a href="#convert"    >13.10 - Quero meus arquivos multimídia no
    formato FOO.</a>
<li><a href="#streaming"  >13.11 - É possível reproduzir fluxo contínuo
    de dados ("streaming") no OpenBSD?</a>
<li><a href="#javaplugin" >13.12 - Posso usar um plugin Java no meu
    navegador? (somente i386 &amp; amd64)</a>
<li><a href="#flashplugin">13.13 - Posso usar um plugin Flash no meu
    navegador? (somente i386)</a>
<!--
<li><a href="#camera"     >13.xx - Can I use my digital camera under OpenBSD?</a>
<li><a href="#scanner"    >13.yy - How do I set up and use my scanner?</a>
-->
</ul>
<hr>

<a name="confaudio"></a>
<h2>13.1 - Como eu configuro meu dispositivo de áudio?</h2>

Os dispositivos no OpenBSD relacionados ao áudio são:
<tt>/dev/audio</tt>, <tt>/dev/sound</tt>, <tt>/dev/audioctl</tt>
e <tt>/dev/mixer</tt>.
Para uma visão geral sobre a camada de driver de áudio, leia a
página de manual
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=audio&amp;sektion=4">audio(4)</a>.

<p>
Todos os drivers de áudio suportados já estão incluídos no kernel
GENERIC, então não existe a necessidade de uma configuração extra ou a
instalação de drivers.
Para encontrar opções do seu dispositivo específico de som, você precisa
descobrir que chip de som você possui. Os chips suportados podem ser
encontrados na página sobre compatibilidade de hardware da sua
<a href="../../pt/plat.html">plataforma</a>.
Quando você já tem o OpenBSD funcionando, procure o driver de som na
saída do comando
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dmesg&amp;sektion=8">dmesg(8)</a>,
e leia a página de manual referente para encontrar informações mais
específicas, como opções e outros detalhes sobre o driver.
Um exemplo de chip de áudio na saída do dmesg é:

<blockquote><pre>
auich0 at pci0 dev 31 function 5 "Intel 82801BA AC97" rev 0x04: irq 10, ICH2 AC97
ac97: codec id 0x41445360 (Analog Devices AD1885)
ac97: codec features headphone, Analog Devices Phat Stereo
audio0 at auich0
</pre></blockquote>

<p>
A base do OpenBSD possui duas ferramentas para a monitoração e
configuração de dispositivos de áudio. O
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=audioctl&amp;sektion=1">audioctl(1)</a>
é usado para os parâmetros de processamento de áudio, como a
codificação, taxa de amostragem e número de canais; enquanto o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mixerctl&amp;sektion=1">mixerctl(1)</a>
é usado para a mixagem dos parâmetros, como a fonte do canal, nível de
ganho e mute.

<p>
O seguinte comando usa o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=audioctl&amp;sektion=1">audioctl(1)</a>
para mostrar os parâmetros de processamento padrão de um dispositivo de
áudio.

<blockquote><pre>
$ <strong>audioctl -f /dev/audio</strong>
...
</pre></blockquote>

Note que <tt>-f /dev/audio</tt> foi usado explicitamente.
Abrir o <tt>/dev/audio</tt> faz com que o dispositivo de áudio
volte aos parâmetros padrão, que é o que queremos ver.

<p>
O
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=audioctl&amp;sektion=1">audioctl(1)</a>
é útil também para explorar as capacidades de um dispositivo de áudio.
Por exemplo, para ver se um dispositivo suporta algumas taxas de
amostragem comuns, você pode simplesmente tentar definir a taxa de
reprodução:

<blockquote><pre>
$ <strong>audioctl play.rate=48000</strong>
play.rate: -> 48000
$ <strong>audioctl play.rate=44100</strong>
play.rate: -> 44100
$ <strong>audioctl play.rate=22050</strong>
audioctl: set failed: Invalid argument
$ <strong>audioctl play.rate=8000</strong>
audioctl: set failed: Invalid argument
$ 
</pre></blockquote>

Esse dispositivo suporta taxas de reprodução de 48000 e 44100 Hz, mas
não suporta 22050 ou 8000.
Note que se uma taxa de amostragem não é suportada, nem sempre existe
uma mensagem de erro, mas a taxa de amostragem retornada não é aquela
que foi desejada.

<blockquote><pre>
$ <strong>audioctl play.rate=48000</strong>
play.rate: -> 48000
$ <strong>audioctl play.rate=44100</strong>
play.rate: -> 48000
$ <strong>audioctl play.rate=22050</strong>
play.rate: -> 48000
$ <strong>audioctl play.rate=8000</strong>
play.rate: -> 48000
$ 
</pre></blockquote>

Esse dispositivo suporta somente reprodução de 48000 Hz.

<p>
Hardware de áudio normalmente é capaz de fazer, no mínimo, alguma
mixagem.
Executar o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mixerctl&amp;sektion=1">mixerctl(1)</a>
sem argumentos lista os controles de mixer do dispositivo e as
configurações atuais.

<blockquote><pre>
$ <strong>mixerctl</strong>
...
</pre></blockquote>

Alguns dispositivos possuem poucos controles, outros possuem cem ou
mais.
Note que nem toda opção, de cada chip de áudio, chega ao lado de fora.
Então podem existir, por exemplo, mais saídas listadas do que saídas
disponíveis fisicamente em uma placa de áudio ou placa-mãe.

<p>
Existem alguns controles que são comuns para muitos dispositivos:

<ul>
<li><tt>outputs.master</tt> controla o nível de saída de reprodução
<li><tt>inputs.dac</tt> controla o nível do DAC ("digital to
    analog converter", ou conversor de digital para analógico),
    usado durante a execução de um arquivo de áudio
<li><tt>record.source</tt> controla quais entradas são mixadas no
    ADC ("analog to digital converter", ou conversor de analógico para
    digital), usado durante gravações
<li><tt>record.volume</tt> ou <tt>record.record</tt> controla o nível
    de entrada do ADC
</ul>

Os controles de um dispositivo de áudio podem ser nomeados
diferentemente.
Por exemplo, pode não existir um <tt>outputs.master</tt>, demonstrado
acima, mas pode exitir um <tt>outputs.outputs</tt> que faz a mesma
coisa.
Normalmente, os controles possuem um nome com sentido, mas algumas vezes
é preciso tentar diferentes configurações para ver qual efeito cada
controle possui.

<p>
Alguns dispositivos usam o que é conhecido como EAPD, que faz o
desligamento ("power down") do amplificador externo.
No entanto, esse é apenas outro botão liga/desliga.
Ele é provavelmente chamado de "power down" porque é frequentemente
usado para economizar energia, o que significa que esse tipo de
controle é mais encontrado em laptops.
Algumas vezes é necessário definir controles com <tt>eapd</tt> ou
<tt>extamp</tt> em seus nomes para <tt>on</tt>, para ter um sinal de
saída.

<p>
Como um exemplo básico do uso do mixerctl para definir o volume do
canal direito e esquerdo para 200, você pode usar

<blockquote><pre>
$ <strong>mixerctl outputs.master=200,200</strong>
outputs.master: 255,255 -&gt; 207,207
</pre></blockquote>

Veja que o valor se tornou 207.
A razão disso é que esse dispositivo de áudio tem um codec
AC'97, que usa somente 5 bits para o controle do volume, gerando
somente 32 valores possíveis.
Outro hardware pode ter resolução diferente.

<p>
Para desmutar ("unmute") o canal mestre, você deve usar

<blockquote><pre>
$ <strong>mixerctl outputs.master.mute=off</strong>
outputs.master.mute: on -&gt; off
</pre></blockquote>

<p>
Para fazer com que as mudanças tenham efeito em cada reinicialização,
edite o arquivo <i>/etc/mixerctl.conf</i>; por exemplo:

<blockquote><pre>
$ <strong>cat /etc/mixerctl.conf</strong>
outputs.master=200,200
outputs.master.mute=off
outputs.headphones=160,160
outputs.headphones.mute=off
</pre></blockquote>


<a name="playaudio"></a>
<h2>13.2 - Execução de diversos formatos de áudio</h2>

<h3>Áudio digitalizado</h3>

<h4>Formato de áudio sem perda (AU, PCM, WAV, FLAC, TTA)</h4>

Alguns dos formatos de áudio sem perda podem ser executados sem a
necessidade de programas de terceiros, contanto que eles contenham
as amostras digitais não-comprimidas nos blocos de bytes.
Esses formatos incluem Sun audio (AU), arquivos PCM brutos (sem os
cabeçalhos) e RIFF WAV.

<p>
O OpenBSD vem com o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=aucat&amp;sektion=1">aucat(1)</a>,
um programa para gravar e executar áudio não-comprimido.
O exemplo seguinte executa um arquivo WAV.

<blockquote><pre>
$ <strong>aucat -i filename.wav</strong>
</pre></blockquote>

<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=aucat&amp;sektion=1">aucat(1)</a>
com a opção -i suporta tanto arquivos sem cabeçalho quanto áudio WAV.
aucat também executa arquivos de áudio Sun, onde os dados de áudio são
codificados como 8 kHz monaural mulaw, que é a codificação mais comum
para esse tipo de arquivo de áudio.

<p>
Também é possível executar dados de áudio não-comprimidos enviando-os
diretamente para o dispositivo de áudio.
Para fazer isso, você deve saber seus parâmetros principais: tipo
de codificação, número de canais, taxa de amostragem, bits por amostra.
Se você não sabe isso, você pode achá-los com o utilitário
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=file&amp;sektion=1">file(1)</a>:

<blockquote><pre>
$ <strong>file music.au</strong>
music.au:  Sun/NeXT audio data: 16-bit linear PCM, stereo, 44100 Hz
</pre></blockquote>

<blockquote><pre>
$ <strong>file music.wav</strong>
music.wav: Microsoft RIFF, WAVE audio data, 16 bit, stereo 44100 Hz
</pre></blockquote>

As únicas coisas restantes para saber sobre esses arquivos de exemplo
é se eles usam ordenação de byte "little endian" e quantização linear
assinada.
Você pode descobrir isso através da leitura do cabeçalho com o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hexdump&amp;sektion=1">hexdump(1)</a>.
Se você está usando um arquivo sem cabeçalho (bruto), não existe uma
maneira de saber antecipadamente os parâmetros.
Configure os seguintes parâmetros usando o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=audioctl&amp;sektion=1">audioctl(1)</a>.

<blockquote><pre>
play.encoding=slinear_le
play.rate=44100
play.channels=2
play.precision=16
</pre></blockquote>

Próximo passo, passe o arquivo de áudio para o dispositivo de som:

<blockquote><pre>
$ <strong>cat music.au > /dev/sound</strong>
</pre></blockquote>

Se você aplicou corretamente as configurações, você deve estar ouvindo
o que esperava.

<p>
Nota: Sempre use <tt>/dev/sound</tt>, e não <tt>/dev/audio</tt>,
se você quer que as configurações aplicadas com o audioctl
permaneçam no lugar.

<p>
Existem outros utilitários que você pode usar, como o
<tt>audio/waveplay</tt>, em forma de pacote e no portes.
Naturalmente, programas populares como o XMMS também são capazes de
reproduzir esses arquivos, e também outros formatos de áudio.

<p>
Tirando os comentados acima, existem formatos de áudio que usam
compressão de dados sem perda.
Exemplos: "Free Lossless Audio Codec" (FLAC) e TTA.
A implementação FLAC foi portada para o OpenBSD e pode ser encontrada
em <tt>audio/flac</tt>, em forma de pacote e portes.

<h4>Formatos de áudio usando compressão com perda (Ogg Vorbis, MP3,
WMA, AAC)</h4>

Métodos de compressão com perdas são frequentemente usados para áudio
e outros arquivos de mídia.
A ideia é que uma quantidade de dados é removida durante a compressão,
mas de um modo que o resultado, comprimido, é ainda utilizável e tem
uma boa qualidade para ser reproduzido.
A vantagem é que essas técnicas proporcionam taxas altas de compressão,
resultando em requerimentos reduzidos de espaço em disco e banda de
rede.

<p>
Um bom exemplo é o formato livre, aberto e sem patentes,
<a href="http://www.vorbis.com/">Ogg Vorbis</a>.
Para reproduzir arquivos Ogg Vorbis, você pode usar o utilitário ogg123,
que é encontrado no pacote <tt>audio/vorbis-tools</tt>. Por exemplo:

<blockquote><pre>
$ <strong>ogg123 music.ogg</strong>

Audio Device:   Sun audio driver output

Playing: music.ogg
Ogg Vorbis stream: 2 channel, 44100 Hz
Time: 00:02.95 [02:21.45] of 02:24.40  (133.1 kbps)  Output Buffer  87.5%
</pre></blockquote>

Naturalmente, existem plugins Ogg Vorbis para muitos outros programas
de áudio.

<p>
Um outro exemplo é a popular codificação "MPEG-1 Audio Layer 3" (MP3),
que tem, no entanto, problemas de licenciamento e patente.
Muitas ferramentas podem reproduzir arquivos MP3, basta procurar na
seção <tt>audio</tt> do sistema de pacotes e portes, e escolher uma
que você gosta.

<p>
E quanto ao formato proprietário "Windows Media Audio" (WMA)? Arquivos
desse tipo podem ser reproduzidos usando o <tt>x11/mplayer</tt>, que usa
o sistema <a href="http://ffmpeg.sourceforge.net">FFmpeg</a>.

<p>
Um bom ponto de partida para aprender mais sobre os diferentes
formatos de áudio é este artigo da Wikipédia:
<a href="http://en.wikipedia.org/wiki/Audio_file_format">Formatos
de arquivos de áudio</a>.


<h3>Som sintetizado</h3>

<h4>MIDI</h4>

O protocolo "Musical Instrument Digital Interface" (MIDI) é
controlado pelos <a href="#midi">dispositivos MIDI</a>.
Se você não possui um sintetizador MIDI, mas deseja reproduzir um
arquivo MIDI padrão (SMF), você pode usar um programa para
renderizar os dados MIDI, gerando arquivos de áudio.
Por padrão, o porte <tt>audio/timidity</tt> renderiza arquivos
MIDI e os reproduz no dispositivo de áudio:

<blockquote><pre>
$ <strong>timidity file.mid</strong>
</pre></blockquote>

<h4>MOD</h4>

Um módulo de trilha sonora ("Soundtracker") é um formato binário que
mistura amostras de áudio com ordens sequenciadas, tornando possível a
reprodução de partes longas de música digital, com uma qualidade
aceitável.

<p>
O modo mais fácil de reproduzir arquivos MOD, no OpenBSD, é
provavelmente usando o programa XMMS, disponível através dos
pacotes e portes.
Você deve instalar o subpacote <tt>-mikmod</tt> do XMMS para fazer ele
usar a biblioteca de som MikMod, que suporta os formatos MOD, S3M, IT e
o módulo XM.

<p>
Você também encontra vários "trackers" na seção <tt>audio</tt>
da coleção de pacotes e portes; por exemplo, tracker, soundtracker.
Com esses trackers, você pode reproduzir os arquivos como também gerar
seus próprios módulos.
Note, no entanto, que nem todos os formatos de tracker são suportados
pelas ferramentas na árvore de portes.
Você é sempre bem-vindo para <a href="../ports/index.html">submeter
um porte</a> do seu programa de tracker predileto.


<a name="playCD"></a>
<h2>13.3 - Como escutar CDs de áudio no OpenBSD?</h2>

É possível reproduzir CDs de áudio tanto com o drive de CD reproduzindo
o disco e enviando o áudio analógico para a placa de som, ou lendo os
dados de áudio e enviando as amostras digitais para a placa de som
através do barramento PCI.

<p>
Para escutar um CD de áudio usando a saída analógica do seu drive de
CD-ROM, você pode:
<ul>
<li>Usar a saída de fones de ouvido, normalmente na parte da frente do
    seu drive.
<li>Conectar a saída de áudio, da parte traseira, na sua placa de áudio.
    Sim, esse é um cabo suplementar que aparece depois dos cabos de
    dados (SCSI/IDE) e de alimentação.
</ul>

<p>
Um utilitário de linha de comando, chamado
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cdio&amp;sektion=1">cdio(1)</a>,
foi incluído na base do sistema. Executado sem parâmetros, ele entra
em modo interativo. Se você quer reproduzir imediatamente o CD, use o
comando

<blockquote><pre>
$ <strong>cdio play</strong>
</pre></blockquote>

<p>
Isso reproduz a partir do primeiro drive de CD-ROM, <tt>cd0</tt>,
por padrão.
Note que o usuário executando o cdio deve ter permissões para ler o
dispositivo de CD-ROM (por exemplo, <tt>/dev/rcd0c</tt>).
Como esse dispositivo pode ser lido somente pelo root ou pelo grupo
operator, por padrão, um modo mais conveniente para a utilização é
adicionar o usuário no grupo operator através do ajuste da linha do
grupo no <tt>/etc/group</tt>.
Alternativamente, você pode modificar as permissões do dispositivo
conforme necessário.

<p>
Note que você talvez precise ter que desmutar a entrada de CD no mixer.
Igual às saídas, o nome atual dessa entrada pode variar entre os
sistemas, mas você usará um comando como este:

<blockquote><pre>
$ <strong>mixerctl inputs.cd.mute=off</strong>
</pre></blockquote>

Também é possível que não exista uma conexão analógica entre seu
drive de CD e o dispositivo de áudio.
Nesse caso você pode usar o comando <tt>cdplay</tt> do <tt>cdio</tt>
para enviar os dados do CD de áudio para a placa de som através
do barramento PCI.

<blockquote><pre>
$ <strong>cdio cdplay</strong>
</pre></blockquote>

<p>
Se você prefere uma bela interface gráfica, existem vários reprodutores
de CD, baseados no X11, na coleção de pacotes e portes.
Procure na seção <tt>audio</tt>.


<a name="recordaudio"></a>
<h2>13.4 - Posso usar o OpenBSD para gravar amostras de áudio?</h2>

Sim.
A maioria dos dispositivos suporta gravação.

O <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=aucat&amp;sektion=1">aucat(1)</a>
vem com o OpenBSD e pode ser usado para gravação.

<blockquote><pre>
$ <strong>aucat -o file.wav</strong>
</pre></blockquote>

O comando acima inicia a gravação de um arquivo no formato WAV.
Pressione [CTRL]-C para terminar a gravação.
O arquivo conterá amostras estéreo assinadas de 16 bits, amostradas em
44.1 kHz.
Outros formatos de amostragem, taxas de amostragem e número de canais,
podem ser gravados.
Veja o manual para mais detalhes.

<p>
Use o aucat para reproduzir o arquivo:

<blockquote><pre>
$ <strong>aucat -i file.wav</strong>
</pre></blockquote>

<p>
Se a gravação aparentemente funcionar, mas a reprodução da gravação foi
silenciosa ou não foi a esperada, o mixer provavelmente precisa de
algumas configurações.
Tenha certeza que você selecionou o dispositivo correto para gravar
e que a fonte está desmutada.

Você pode definir os parâmetros necessários usando o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mixerctl&amp;sektion=1">mixerctl(1)</a>.
Por exemplo:

<blockquote><pre>
inputs.mic.mute=off
inputs.mic.preamp=on
inputs.mic.source=mic0
record.source=mic
record.volume=255,255
record.volume.mute=off
record.mic=255
record.mic.mute=off
</pre></blockquote>

Essas são as configurações para a gravação a partir de um microfone.
A pré-amplificação precisa estar ativada, caso contrário o som gravado
pode ser um belo silêncio em alguns sistemas.
No entanto, a pré-amplificação pode ser um pouco alta em outros
sistemas.

<a name="audioprob"></a>
<h2>13.5 - O que posso fazer se eu tenho problemas com o áudio?</h2>


<p>
Se você não escuta nada quando reproduz algum áudio, é possível que
exista um controle do mixer em uma regulagem baixa ou está
simplesmente mutado.
Veja a seção
<a href="#confaudio">13.1 - Como eu configuro meu dispositivo de áudio</a>
para configurar o mixer.
Por favor, desmute <b>todas</b> as entradas e saídas antes de relatar
um problema.

<p>
Se o som está distorcido, pode ser que sua placa de som somente suporte
um conjunto único limitado de taxas de amostragem.
Veja a seção
<a href="#confaudio">13.1 - Como eu configuro meu dispositivo de áudio</a>
para exemplos sobre a determinação de quais parâmetros o seu dispositivo
de áudio suporta.

<p>
Se o seu dispositivo suporta somente poucas taxas de amostragem,
existem aplicativos na coleção de pacotes e portes que fazem a
reamostragem de taxa.
Isso permite que você reproduza áudio com diferentes taxas de amostragem
das que o seu dispositivo suporta.
Por exemplo, o <tt>x11/mplayer</tt> tem a opção "<tt>-srate</tt>" para
especificar uma taxa de amostragem de saída desejada.
Você deve definir isso para a taxa que seu dispositivo de som suporta.
O <tt>artsd</tt> e alguns jogos do KDE suportam opções parecidas.
Leia a documentação específica do seu aplicativo de áudio para
descobrir se ele suporta reamostragem de taxa.

<p>
Reamostragem de taxa pode ser feita com o <tt>aucat</tt>.
Por exemplo:

<blockquote><pre>
$ <strong>mpg321 -s file.mp3 | aucat -r 22050 -i -</strong>
</pre></blockquote>

O comando acima reproduz um arquivo de áudio MP3, com taxa de
amostragem de 22050 Hz, usando o <tt>mpg321</tt> e o <tt>aucat</tt>.

<p>
Se você ainda está enfrentando problemas, estas são algumas coisas
para considerar:

<ul>
<li>
Algumas placas ISA antigas possuem particularidades:
  <ul>
  <li>Algumas precisam ser configuradas com um endereço de E/S e um
      valor IRQ diferente para evitar conflitos com outro hardware.
      Você pode facilmente tentar combinações diferentes usando o
      <a href="faq5.html#BootConfig">User Kernel Configuration (UKC)</a>.
  <li>É possível que um driver não-otimizado foi vinculado ao
      dispositivo de som, e você pode obter melhores resultados usando
      outro driver. Isso não é o tipo de coisa fácil de achar, mas olhe
      cuidadosamente a saída do seu
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dmesg&amp;sektion=8">dmesg(8)</a>
      e procure as linhas onde os drivers de áudio foram vinculados. Se
      você ver mais que um driver de som vinculado (ou tentando
      vincular-se), teste-os um de cada vez, desabilitando um e deixando
      outro ativado, usando o
      <a href="faq5.html#BootConfig">User Kernel Configuration (UKC)</a>.
  </ul>
<li>
Busque informações sobre seu dispositivo de som. Use a documentação, ou
use uma ferramenta de buscas na Internet para encontrar as
especificações. Para os dispositivos
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ac97&amp;sektion=4">ac97(4)</a>
e
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=azalia&amp;sektion=4">azalia(4)</a>,
procure a documentação tanto do controlador quanto do codec.
Isso pode ajudar a encontrar a causa do problema.
</ul>

<p>
Se você acredita que seu dispositivo deve estar funcionando, mas por
qualquer que seja a razão não está, então é hora de um pouco de
depuração.
Os seguintes passos podem determinar se os dados estão sendo
processados pelo DAC.

<blockquote><pre>
$ <strong>cat > /dev/audio < /dev/zero &</strong>
[1] 9926
$ <strong>audioctl play.{seek,samples,errors}</strong>
play.seek=48000
play.samples=3312000
play.errors=0
$ <strong>audioctl play.{seek,samples,errors}</strong>
play.seek=57600
play.samples=7065600
play.errors=0
$ <strong>audioctl play.{seek,samples,errors}</strong>
play.seek=48000
play.samples=9379200
play.errors=0
$ <strong>kill %1</strong>
$ <strong>fg %1</strong>
cat > /dev/audio < /dev/zero
Terminated
</pre></blockquote>

Aqui nós vemos que os dados processados aumentaram o contador
<tt>play.samples</tt> a cada vez que nós verificamos, então os dados
estão fluindo.
Nós também vemos, através do <tt>play.seek</tt>, que o dispositivo está
mantendo dados suficientes no buffer, assim o dispositivo não causou
um "underrun" em nenhuma amostra (observando <tt>play.errors</tt>).
Isso é bom.

<p>
Note que mesmo se temos alto-falantes plugados quando executamos o
teste acima, você não deve ter ouvido nada.
O teste envia zeros para o dispositivo, que é silêncio para todas
as codificações padrão suportadas atualmente.

<p>
Já que nós sabemos que o dispositivo pode processar dados, é uma boa
ideia verificar novamente as configurações do mixer.
Tenha certeza de que todas as saídas e entradas estão desmutadas e em
um nível razoável.

<p>
Se nesse ponto você ainda está tendo problemas, é provavelmente a hora
de <a href="http://www.openbsd.org/report.html">enviar um relato do
problema</a>.
Junto com a informação normal de relato de problema, como um dmesg
completo e a descrição do problema, inclua também a saída padrão do
<tt>mixerctl -v</tt> e a saída do teste de processamento DAC acima.


<a name="midi"></a>
<h2>13.6 - Como eu uso meus instrumentos MIDI?</h2>

O protocolo "Musical Instrument Digital Interface" (MIDI) fornece
um meio padronizado e eficiente de representar a informação de
desempenho musical como dados eletrônicos.
Um arquivo MIDI contém somente as instruções necessárias para o
sintetizador reproduzir os sons, em vez dos sons.
Mais informações:
<a href="http://www.harmony-central.com/MIDI/Doc/tutorial.html">
Tutorial sobre MIDI e Síntese de Música</a>.

<!-- <h3>Devices setup</h3> -->

<p>
Para reproduzir dados MIDI, um sintetizador conectado à porta MIDI da
máquina é necessário. Similarmente, para gravar dados MIDI um
instrumento MIDI é necessário (por exemplo, um teclado MIDI).
Certas placas de som contêm sintetizadores MIDI embutidos, que
são conectados como portas MIDI.
Instrumentos MIDI avançados podem conter múltiplas subpartes
(sintetizadores, controle de superfícies, etc.), e elas aparecem
como múltiplas portas MIDI no OpenBSD.

<p>
Quando você já tem o OpenBSD funcionando, procure as portas MIDI na
saída do comando dmesg(8).
Um exemplo de portas MIDI em uma saída do dmesg é:

<blockquote><pre>
midi0 at pcppi0: &lt;PC speaker&gt;
umidi0 at uhub2 port 2 configuration 1 interface 0 "Roland Roland XV-2020" rev 1.10/1.00 addr 2
midi1 at umidi0: &lt;USB MIDI I/F&gt;
umidi1 at uhub1 port 2 configuration 1 interface 1 "Evolution Electronics Ltd. USB Keystation 61es" rev 1.00/1.25 addr 3
midi2 at umidi1: &lt;USB MIDI I/F&gt;
</pre></blockquote>

Ele mostra três portas MIDI, correspondendo a:

<ul>
<li> <tt>/dev/rmidi0</tt> - o alto-falante do PC
<li> <tt>/dev/rmidi1</tt> - sintetizador conectado via USB
<li> <tt>/dev/rmidi2</tt> - um teclado MIDI mestre
</ul>

Para testar seu teclado MIDI, você pode usar o utilitário
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hexdump&amp;sektion=1">hexdump(1)</a>
para mostrar os dados MIDI que você está tocando nele:

<blockquote><pre>
$ <strong>hexdump -e '1/1 "%02x\n"' &lt;/dev/rmidi2 </strong>
90
3c
71
...
</pre></blockquote>

A saída do teclado pode ser conectada à entrada do sintetizador,
da seguinte maneira:

<blockquote><pre>
$ <strong>cat -u /dev/rmidi1 &gt;/dev/rmidi2</strong>
</pre></blockquote>

Agora você pode escutar no sintetizador aquilo que você está
tocando no teclado MIDI.
Informação adicional daquilo que você toca é capturada de /dev/rmidi1
e enviada para /dev/rmidi2 em tempo real.
Leia a página de manual
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=midi&amp;sektion=4">midi(4)</a>
para mais informações.

<!-- <h3>Playing, recording MIDI sequences</h3> -->

<p>
O utilitário principal para reproduzir arquivos MIDI padrão é o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=midiplay&amp;sektion=1">midiplay(1)</a>.
Reproduzir um arquivo MIDI padrão, nesse exemplo usando o sintetizador,
é tão fácil quanto:

<blockquote><pre>
$ <strong>midiplay -d 1 file.mid</strong>
</pre></blockquote>

Note que nós especificamos o número de dispositivo MIDI 1
(ou seja, <tt>/dev/rmidi1</tt>) como um parâmetro porque o dispositivo
de número 0 é usado por padrão.

<p>
Para gravar arquivos MIDI você pode usar o utilitário <tt>smfrec</tt>
do porte <tt>audio/midish</tt>, por exemplo:

<blockquote><pre>
$ <strong>smfrec -d /dev/rmidi1 -i /dev/rmidi2 file.mid</strong>
</pre></blockquote>

grava o que é tocado no teclado (<tt>/dev/rmidi2</tt>) enquanto
envia em tempo real para o sintetizador (<tt>/dev/rmidi1</tt>), dessa
forma você pode escutar o que você está tocando.
Operações mais complicadas como edição, roteamento, mixagem e
transformação de dados MIDI, podem ser feitas usando o utilitário
<tt>rmidish</tt> do porte <tt>audio/midish</tt>.

<a name="lossyaudio"></a>
<h2>13.7 - Me fala sobre codificação Ogg Vorbis e MP3?</h2>

Esses formatos já foram mencionados em
<a href="#playaudio">Execução de diversos formatos de áudio</a>.
Nesta seção, fornecemos uma breve introdução a respeito da codificação
de tais arquivos.
Se você está interessado em aprender como esses codecs de compressão
de áudio funcionam, mais informações podem ser encontradas nos
artigos da Wikipédia sobre
<a href="http://en.wikipedia.org/wiki/Vorbis">Vorbis</a> e
<a href="http://en.wikipedia.org/wiki/MP3">MP3</a>.

<h3>Ogg Vorbis</h3>

Codificar o formato de áudio raw, WAV ou AIFF, para
<a href="http://www.vorbis.com/">Ogg Vorbis</a>, pode ser feito
com o utilitário <b>oggenc</b>, que faz parte do pacote
<tt>audio/vorbis-tools</tt>, disponível através do sistema de
pacotes e portes do OpenBSD.

<p>
Digamos que você possui vários arquivos WAV prontos para serem
codificados, que você, por exemplo, extraiu do seu álbum favorito a
partir do CD.
Para codificar todos esses arquivos, usando uma taxa de bits de
aproximadamente 192 kbps, você pode usar um comando igual a este:
<blockquote><pre>
$ <strong>oggenc *.wav -b 192</strong>
</pre></blockquote>

Uma vez terminado, isso lhe dá um conjunto de arquivos .ogg no seu
diretório atual. Mais exemplos, incluindo opções de codificação, podem
ser encontrados na página de manual do oggenc.

<h3>MPEG-1 Audio Layer 3 (MP3)</h3>

Se por alguma razão você quer usar o formato MP3, você pode usar
o <a href="http://lame.sourceforge.net/">"Lame ain't an MP3 encoder" (LAME)</a>,
uma ferramenta educacional utilizada para aprender sobre a
codificação MP3.
Lame é incluído na árvore de portes do OpenBSD.
Note que devido à patentes do MP3, você não encontra esse pacote
no <a href="../../orders.html">conjunto oficial de CDs</a>.

<p>
A seguir, um exemplo simples da codificação de um arquivo WAV com uma
taxa de bits de 192 kbps:
<blockquote><pre>
$ <strong>lame -b 192 track01.wav track01.mp3</strong>
</pre></blockquote>

Para todas as opções e detalhes, consulte a página de manual que vem
junto com o lame.


<a name="playDVD"></a>
<h2>13.8 - Como eu posso assistir DVDs de vídeo no OpenBSD?</h2>

O OpenBSD suporta mídia de DVD através do sistema de arquivos
ISO 9660, que também é usado em CD-ROMs, e, desde o OpenBSD 3.8,
também através do novo sistema de arquivos
<a href="http://www.osta.org/specs/">Universal Disk Format (UDF)</a>,
que é encontrado em alguns DVDs.
No entanto, quase todos os discos de DVD-Video e DVD-ROM usam o formato
ponte UDF, que é uma combinação dos sistemas de arquivos
DVD MicroUDF (subsistema do UDF 1.02) e ISO 9660.
Esse formato é utilizado para propósitos de compatibilidade com
formatos antigos.

<p>
Como a maioria dos computadores com drives de DVD-ROM usam decodificação
por software, é recomendado ter no mínimo um Pentium II de 350-MHz, ou
uma CPU equivalente, para assistir vídeos com uma boa qualidade.

<p>
Alguns reprodutores populares de mídia, que suportam a leitura de DVD,
foram portados para o OpenBSD.
Exemplos são: <a href="http://www.dtek.chalmers.se/groups/dvd/">ogle</a>,
<a href="http://www.mplayerhq.hu/">mplayer</a>,
<a href="http://www.xine-project.org/">xine</a> e
<a href="http://kaffeine.sourceforge.net/">kaffeine</a>.
Leia as instruções de instalação que vêm junto com esses pacotes,
porque essas ferramentas podem necessitar de uma configuração posterior.
Com esses utilitários, é possível assistir o DVD através do acesso
direto ao dispositivo bruto.
Naturalmente, é também possível montar um DVD usando o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mount_cd9660&amp;sektion=8">mount_cd9660(8)</a>,
e reproduzir os arquivos dele ou qualquer outro sistema de arquivos
montado.

<p>
<b>Notas:</b>
<ul>
<li>Quase todos os DVDs que você compra são encriptados usando o
    "Content Scrambling System" (CSS).
    Para ser possível reproduzir esses DVDs encriptados, você pode usar
    a biblioteca <b>libdvd</b>, também disponível através dos pacotes
    e portes.
<li>Esteja atento ao fato de que o código de região pode estar
    presente no(s) seu(s) disco(s) de DVD.
    Esse não deve ser um problema ao reproduzir os DVDs em um
    computador.
</ul>


<a name="burnCD"></a>
<h2>13.9 - Como gravar CDs e DVDs?</h2>

<a name="burnIntro"></a>
<h3>13.9.1 - Introdução e configuração básica</h3>

Você primeiro deve ter certeza que seu gravador de CD/DVD foi
reconhecido e configurado pelo kernel.
A maioria dos dispositivos SCSI são suportados. Dispositivos IDE/ATAPI
e USB são suportados através da emulação SCSI. Você encontrará
rapidamente seu dispositivo na saída do
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dmesg&amp;sektion=8">dmesg(8)</a>.
Apenas procure as linhas começando com "cd", por exemplo

<blockquote><pre>
cd0 at scsibus0 targ 0 lun 0: &lt;TOSHIBA, CD-ROM XM-5702B, 2826&gt; SCSI0 5/cdrom removable
cd1 at scsibus1 targ 4 lun 0: &lt;PLEXTOR, CD-R PX-R412C, 1.04&gt; SCSI2 5/cdrom removable
</pre></blockquote>

<h4>Mas o <tt>cdrecord -scanbus</tt> não funciona!</h4>

Sim. O OpenBSD utiliza um espaço de nomeamento de dispositivo diferente
daquele do sistema operacional para o qual o utilitário cdrecord foi
escrito.
Todos os dispositivos configurados devem estar na saída do dmesg,
como mencionado acima.
A informação que você precisa está ali.

<h4>Error: <tt>mount_cd9660: /dev/cd2c on /mnt/cdrom: No such file or directory</tt></h4>

Por padrão, o instalador do OpenBSD cria somente dois nós de
dispositivos de cd, <tt>cd0</tt> e <tt>cd1</tt>.
Para usar o seu dispositivo <tt>cd2</tt>, você precisa criar o nó de
dispositivo para ele.
O modo recomendado para fazer isso é usando o script
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=MAKEDEV&amp;sektion=8">MAKEDEV(8)</a>
(selecione sua plataforma específica):

<blockquote><pre>
# <strong>cd /dev</strong>
# <strong>./MAKEDEV cd2</strong>
</pre></blockquote>

Nos próximos passos, acessaremos o gravador de CD/DVD através do
dispositivo de caractere <i>bruto</i>, e <b>não</b> o dispositivo de
<i>bloco</i>.

<h4>Verificação da operação de gravação do CD/DVD</h4>

É recomendado verificar se o seu gravador de CD/DVD está funcionando
corretamente.
Neste exemplo, usarei este gravador de DVD USB 2.0:

<blockquote><pre>
cd2 at scsibus2 targ 1 lun 0: &lt;LITE-ON, DVDRW LDW-851S, GS0C&gt; SCSI0 5/cdrom removable
</pre></blockquote>

Tente usá-lo montando um CD/DVD nele.
Se desejado, você também pode verificar a taxa de transferência que você
está tendo quando copia arquivos para o seu disco rígido.
O comando
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=time&amp;sektion=1">time(1)</a>
é um bom assistente nessa parte.

<p>
Se alguma coisa está ocorrendo de forma errada e você está recebendo
erros durante essa fase, é melhor resolver o problema e não começar
a gravar o CD/DVD ainda.

<h3>Eu quero gravar um CD! Podemos começar?</h3>

Antes de começar, é uma boa ideia manter em mente algumas palavras de
aviso:

<ul>
<li>Não execute tarefas que fazem uso intensivo do disco enquanto está
    gravando um CD/DVD. Fazer isso pode reduzir a quantidade de dados
    indo para o seu gravador de CD/DVD. Se a quantidade de dados diminui
    muito, e o gravador ficar esperando muito tempo, seu buffer executa
    vazio. Esse fenômeno também é conhecido como "buffer underrun".
<li>Evite choques durante a gravação, já que isso pode fazer com que o
    raio laser saia da pista, o que pode levar a erros no disco.
<li>Nem todos os gravadores de DVD suportam todos os formatos de DVD;
    veja abaixo.
</ul>

<a name="writeCD"></a>
<h3>13.9.2 - Gravação de CDs</h3>

<h4>Criação de CD-ROMs de dados</h4>

Primeiramente, você precisa criar um sistema de arquivos ISO 9660 para
colocar no CD-ROM.
Para fazer isso, você pode usar o utilitário
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mkhybrid&amp;sektion=8">mkhybrid(8)</a>
do sistema base, ou o utilitário mkisofs, que vem com o
<a href="faq15.html#PkgMgmt">pacote</a> cdrtools e que faz um trabalho
melhor com grandes árvores de arquivos.
No exemplo a seguir, usaremos o mkhybrid, embora o uso do mkisofs seja
parecido.

<p>
Para um exemplo de uso, digamos que eu queira guardar o código fonte do
kernel do OpenBSD em uma imagem ISO 9660:

<blockquote><pre>
$ <strong>mkhybrid -R -o sys.iso /usr/src/sys</strong>

Using ALTQ_RMC.000;1 for  /usr/src/sys/altq/altq_rmclass_debug.h (altq_rmclass.h)
...
Using IEEE8021.00H;1 for  /usr/src/sys/net80211/ieee80211_amrr.c (ieee80211.c)
 10.89% done, estimate finish Sat Nov  3 08:01:23 2007
 21.78% done, estimate finish Sat Nov  3 08:01:28 2007
...
 87.12% done, estimate finish Sat Nov  3 08:01:31 2007
 98.01% done, estimate finish Sat Nov  3 08:01:32 2007
Total translation table size: 0
Total rockridge attributes bytes: 896209
Total directory bytes: 2586624
Path table size(bytes): 11886
Max brk space used 0
45919 extents written (89 Mb)
</pre></blockquote>

<p>
A opção <tt>-R</tt> diz ao <tt>mkhybrid</tt> para criar extensões
"Rock Ridge" na imagem ISO 9660.
O "Rock Ridge Interchange Protocol" foi criado para suportar as
semânticas do sistema de arquivos POSIX em sistemas de arquivos
ISO 9660, como nomes longos de arquivo, propriedade, permissões,
ligações de arquivo, ligações simbólicas, nós de dispositivos,
hierarquias profundas de arquivos (mais de 8 níveis de subdiretórios),
etc.

<p>
Se você quer que os nomes longos de arquivos no seu CD-ROM sejam
legíveis no sistema Windows ou DOS, você deve adicionar o sinalizador
<tt>-J</tt>, para também incluir as extensões Joliet na imagem
ISO 9660.

<p>
Após criar o sistema de arquivos, você pode verificá-lo
<a href="faq14.html#MountImage">montando a imagem ISO 9660</a>.
Se tudo está correto, você agora está pronto para gravar o CD-R(W).
A maneira mais fácil de se fazer isso é usando o utilitário
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cdio&amp;sektion=1">cdio(1)</a>.

<p>
Se você está usando mídias regraváveis, como um CD-RW, você precisa
apagar a mídia antes de gravá-la.

<blockquote><pre>
# <strong>cdio -f cd1c blank</strong>
</pre></blockquote>

Você agora está pronto para gravar a imagem criada no exemplo acima em
um CD-R(W) virgem. Você pode usar um comando similar a este:

<blockquote><pre>
# <strong>cdio -f cd1c tao sys.iso</strong>
</pre></blockquote>

Com as opções especificadas acima, estamos dizendo ao cdio para usar
o segundo dispositivo de CD-ROM como o gravador de CD.

<p>
Para verificar se o CD-ROM foi gravado corretamente, você pode montá-lo
e verificar se todas as coisas estão lá.
Para montar o sistema de arquivos, você deve usar o dispositivo de
<i>bloco</i> para o drive CD-ROM, que neste caso ainda é o gravador
de CD:

<blockquote><pre>
# <strong>mount /dev/cd1c /mnt/cdrom</strong>
</pre></blockquote>


<h4>Criação de CDs de áudio</h4>

Para gravar CDs de áudio, você pode usar o
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cdio&amp;sektion=1">cdio(1)</a>
com a opção <tt>tao -a</tt>.

<p>
Como um exemplo, vou fazer uma cópia de segurança de um dos meus CDs de
música. Isso envolve dois passos:

<ol>
<li>Extrair as faixas de áudio do CD original.
Por exemplo:
<blockquote><pre>
# <strong>cdio -f cd1c cdrip</strong>
</pre></blockquote>
Esse comando extrai uma série de arquivos WAV do seu drive de CD-ROM
para o seu disco.
<li>Gravar as faixas de áudio em um CD virgem.
Por exemplo:
<blockquote><pre>
# <strong>cdio -f cd1c tao -a *.wav</strong>
</pre></blockquote>
</ol>


<a name="writeDVD"></a>
<h3>13.9.3 - Gravação de DVDs</h3>

Existem algumas coisas importantes sobre DVD que você deve saber antes
de tentar gravar seus próprios DVDs.

<p>
<b>Notas importantes:</b>
<ul>
<li>Se você realmente quer saber tudo sobre DVD, minha sugestão é que
    você comece lendo o abrangente documento
    <a href="http://www.dvddemystified.com/dvdfaq.html">FAQ DVD</a>.
<li>Esta seção foi testada de forma muito limitada e, certamente, nós
    não tentamos todas as combinações possíveis de gravador e mídia.
    No entanto, temos tido, ou soubemos de, experiências positivas com
    todos os formatos de DVD mencionados abaixo.
    Você é bem-vindo para
    <a href="mailto:faq@openbsd.org">nos informar</a> sobre seus
    sucessos ou falhas.
</ul>

<h4>Diferentes formatos de DVD</h4>

Existem vários formatos diferentes de DVD. Os mais usados são os
formatos DVD-R, DVD-RW, DVD+R e DVD+RW (R significa que pode ser
gravado somente uma vez, RW significa que ele pode ser regravado
alguns milhares de vezes). Eles são padrões muito competitivos.

<p>
Um formato de dvd diferente é o DVD-RAM, que foi desenvolvido como um
drive de dados e tem funções avançadas de gravação de pacotes,
permitindo que ele seja usado como uma espécie de disco rígido óptico.
DVD-RAM não é recomendado para uso com vídeos, já que os vídeos são
gravados nos discos em um formato que não é compatível com reprodutores
normais de DVD.

<p>
Uma coisa importante é você usar mídias que funcionam no seu gravador
de DVD.
Se você espera uma compatibilidade com outros reprodutores de DVD, leia
<a href="http://www.dvddemystified.com/dvdfaq.html#4.3.1">esta seção</a>
da FAQ DVD.

<h4>Velocidade de gravação do DVD</h4>

Pode ser útil apontar que as indicações de velocidade do DVD são
diferentes das especificações de velocidade do CD-ROM.
A tabela a seguir nos dá uma visão geral:

<p>
<table border="1" style="empty-cells: show;">
<tr align="center">
<td>Velocidade de leitura/gravação DVD</td>
<td>Taxa de transferência (MB/s)</td>
<td>Velocidade equivalente de leitura/gravação CD-R(W)</td>
</tr>
<tr align="center">
<td>1x</td>
<td>1.32</td>
<td>9x</td>
</tr>
<tr align="center">
<td>2x</td>
<td>2.64</td>
<td>18x</td>
</tr>
<tr align="center">
<td>4x</td>
<td>5.28</td>
<td>36x</td>
</tr>
<tr align="center">
<td>8x</td>
<td>10.57</td>
<td>72x</td>
</tr>
</table>

<p>
Como você pode ver na tabela, as taxas de transferência são
relativamente altas, e você deve verificar se seu barramento (SCSI,
(E)IDE/ATAPI, USB) está com um bom desempenho para suportá-las.
Em especial, as antigas interfaces USB 1.0 e 1.1 funcionam em taxas
baixas de transferências, com taxas máximas de 1.5 Mbit/s e 12 Mbit/s,
respectivamente.
Isso significa que o USB 1.0 tem uma saída de 178.8 kByte/s e o USB 1.1
tem uma saída máxima de 1.43 MB/s.
O USB 2.0 é muito rápido: 480 Mbit/s ou 57.2 MB/s.
Geralmente, as velocidades dos barramentos SCSI e (E)IDE/ATAPI são
boas.

<h4>Gravação do DVD</h4>

Basicamente, o processo é muito parecido com a gravação de CD-R(W)s.
O software usado, no entanto, é diferente.
No momento, a melhor opção é o <b>growisofs</b> do pacote
<tt>sysutils/dvd+rw-tools</tt>.
Esse utilitário grava uma imagem ISO 9660 em uma mídia de DVD.
Todos os formatos graváveis de DVD são suportados pelo dvd+rw-tools.

<p>
Caso você queira procurar mais informações sobre a mídia que está
no seu gravador de DVD (por exemplo, se você perdeu o texto de
informação da embalagem da mídia ou é apenas desorganizado como eu),
você pode usar o utilitário <b>dvd+rw-mediainfo</b>.

<!--blockquote><pre>
$ <strong>dvd+rw-mediainfo /dev/rcd2c</strong>
INQUIRY:                [LITE-ON ][DVDRW LDW-851S  ][GS0C]
GET [CURRENT] CONFIGURATION:
 Mounted Media:         1Ah, DVD+RW
 Current Write Speed:   4.0x1385=5540KB/s
 Write Speed #0:        4.0x1385=5540KB/s
 Write Speed #1:        2.4x1385=3324KB/s
GET [CURRENT] PERFORMANCE:
 Write Performance:     4.0x1385=5540KB/s@[0 -> 0]
 Speed Descriptor#0:    00/0 R@2.4x1385=3324KB/s W@4.0x1385=5540KB/s
 Speed Descriptor#1:    00/0 R@2.4x1385=3324KB/s W@2.4x1385=3324KB/s
READ DVD STRUCTURE[#0h]:
 Media Book Type:       92h, DVD+RW book [revision 2]
 Media ID:              SONY/S11
 Legacy lead-out at:    2295104*2KB=4700372992
READ DISC INFORMATION:
 Disc status:           blank
 Number of Sessions:    1
 State of Last Session: empty
 Number of Tracks:      1
READ TRACK INFORMATION[#1]:
 Track State:           blank
 Track Start Address:   0*2KB
 Free Blocks:           2295104*2KB
 Track Size:            2295104*2KB
READ CAPACITY:          1*2048=2048
</pre></blockquote-->

Existem duas opções para gravar o DVD:
<ul>
<li>Pré-masterizar uma imagem ISO 9660 dos seus dados, guardando-a no
    seu disco rígido; e então gravar essa imagem no DVD.
<li>Gravar uma imagem ISO 9660 dos seus dados diretamente no DVD.
</ul>

<p>
Eu criei uma imagem ISO 9660 pré-masterizada dos módulos CVS do
OpenBSD (src, XF4, ports e www), encontrados no diretório /cvs
do meu disco.
Eu usei o seguinte comando, que se parece com aquele que eu usei
para criar a imagem de CD-ROM.

<blockquote><pre>
$ <strong>mkisofs -R -o cvs.iso /cvs</strong>
</pre></blockquote>

Se desejado, verifique o sistema de arquivos ISO 9660
<a href="faq14.html#MountImage">montando a imagem</a>.
Para gravar essa imagem (cerca de 2 GB) em um disco vazio, use:

<blockquote><pre>
# <strong>growisofs -dvd-compat -Z /dev/rcd2c=cvs.iso</strong>
Executing 'builtin_dd if=cvs.iso of=/dev/rcd2c obs=32k seek=0'
/dev/rcd2c: pre-formatting blank DVD+RW...
/dev/rcd2c: "Current Write Speed" is 4.1x1385KBps.
  23822336/1545832448 ( 1.5%) @3.9x, remaining 5:19
  42172416/1545832448 ( 2.7%) @3.9x, remaining 5:20
  60522496/1545832448 ( 3.9%) @3.9x, remaining 4:54
...
1504706560/1545832448 (97.3%) @3.9x, remaining 0:07
1523318784/1545832448 (98.5%) @3.9x, remaining 0:04
1541898240/1545832448 (99.7%) @3.9x, remaining 0:00
/dev/rcd2c: flushing cache
/dev/rcd2c: writing lead-out
/dev/rcd2c: reloading tray
</pre></blockquote>

A opção <tt>-Z</tt> diz ao growisofs para gravar uma seção inicial no
dispositivo, que nesse caso é meu gravador de DVD, encontrado em cd2.
A opção <tt>-dvd-compat</tt> fecha o disco, isso significa que nenhuma
outra seção pode ser anexada nele.
Isso deve fornecer uma melhor compatibilidade com reprodutores de DVD de
vídeo e algumas unidades antigas de DVD-ROM.

<p>
Note como o growisofs indica a velocidade de gravação, nesse caso
a velocidade 3.9x, que é o que pode ser esperado da combinação
de mídia e gravador, como indicado pelo dvd+rw-mediainfo.

<p>
Se você tem pouco espaço em disco e não pode armazenar uma imagem
ISO 9660 para o DVD, você pode gravar os dados diretamente no DVD.
Vamos simplesmente fazer uma simulação da criação do sistema de
arquivos.

<blockquote><pre>
# <strong>growisofs -dry-run -Z /dev/rcd2c -R /cvs</strong>
</pre></blockquote>

Se funcionar, remova a opção -dry-run e comece a gravar o DVD.

<blockquote><pre>
# <strong>growisofs -Z /dev/rcd2c -R /cvs</strong>
</pre></blockquote>

<p>
É também possível anexar dados em um DVD existente, usando a opção
-M, que mescla uma nova seção em uma existente:

<blockquote><pre>
# <strong>growisofs -M /dev/rcd2c -R /mydata</strong>
</pre></blockquote>

Para mais informações sobre o growisofs, leia a página de manual.

<p>
Quando você terminar a gravação do DVD, monte-o e veja se tudo que
você espera está realmente lá.

<h4>Por que não estou conseguindo a velocidade de gravação que eu
esperava?</h4>

Em vez da saída de gravação acima, você pode ver algo como:

<blockquote><pre>
   4784128/1545832448 ( 0.3%) @0.7x, remaining 26:50
   7929856/1545832448 ( 0.5%) @0.7x, remaining 29:05
  14123008/1545832448 ( 0.9%) @0.7x, remaining 27:06
...
</pre></blockquote>

que é muito lento.
Isso significa que você não está, de alguma forma, conseguindo a saída
necessária no barramento que seu gravador de DVD está usando.
No exemplo acima, o gravador de DVD USB foi conectado em uma máquina em
que o driver
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ehci&amp;sektion=4">ehci(4)</a>,
usado pelos controladores USB 2.0, não inicializou corretamente.
Como sempre, você é bem-vindo para fornecer correções e resultados
de testes.
O gravador de DVD volta a utilizar a lenta interface USB 1.1,
que causa a saída reduzida.
O USB 1.1 é limitado à velocidade de 12 Mbit/s, que corresponde à
1.43 MB/s ou 1.08x em termos de velocidade do DVD.
O gravador de DVD cai para um ritmo mais baixo que o máximo, para
reduzir o risco de "buffer underruns".


<a name="convert"></a>
<h2>13.10 - Quero meus arquivos multimídia no formato FOO.</h2>

<h3>Conversão entre diferentes formatos de áudio</h3>

Digamos que queremos processar a gravação de áudio da
<a href="#recordaudio">FAQ 13 - Gravação de áudio</a>.
Essa gravação foi armazenada no formato bruto.
Será útil convertê-lo, porque o formato bruto não inclui cabeçalhos,
e os parâmetros de gravação precisam ser especificados em todos os
usos do arquivo.

<p>
Uma ferramenta de conversão de som é o <tt>audio/sox</tt>, disponível
através dos pacotes e portes.
O <b>sox</b> suporta os formatos AIFF, AU, MP3, Ogg Vorbis, RIFF WAV e
bruto ("raw"), como também alguns outros formatos de áudio mais
exóticos.
A seguir, um exemplo para converter a gravação para o formato RIFF WAV.

<blockquote><pre>
$ <strong>sox -U -c 1 -r 8000 -b myvoice.raw myvoice.wav</strong>
</pre></blockquote>

Note que os parâmetros especificados correspondem aos parâmetros de
gravação especificados antes da gravação.
Esse foi somente um exemplo. Outras bibliotecas relacionadas a áudio
podem ser usadas para a conversão de áudio.

<p>
<b>Nota:</b>
A conversão entre diferentes formatos de compressão com perdas não é
recomendada.
Por exemplo, os codecs MP3 e Vorbis removem diferentes partes das ondas
sonoras do áudio original.
Então, ao converter um arquivo MP3 para Ogg Vorbis, o resultado final,
provavelmente, soará de forma ruim em relação ao MP3 original.

<h3>Conversão entre diferentes formatos de vídeo</h3>

É importante fazer uma distinção clara entre
<ul>
<li>o formato de arquivo contêiner - exemplos populares são:
    MP4, OGG, MPEG, MOV, AVI, ASF.
<li>o codec de vídeo - por exemplo:
    codecs do tipo MPEG-1, MPEG-2, MPEG-4 (como Xvid e DivX); FFmpeg;
    WMV; ... - para encontrar outros codecs, leia este
    <a href="http://en.wikipedia.org/wiki/Video_codec">artigo da
    Wikipédia sobre codecs de vídeo</a>.
</ul>

No OpenBSD, o suporte a contêineres MPEG e AVI está mais maduro no
momento.

<p>
Dois utilitários populares são o <tt>multimedia/transcode</tt> e o
<b>mencoder</b> (parte de <tt>x11/mplayer</tt>).
Eles usam ou podem usar a biblioteca <b>libavcodec</b>, parte do
porte <tt>graphics/ffmpeg</tt>, que gera uma saída de boa qualidade.
Você pode, naturalmente, usar o <b>ffmpeg</b> diretamente.
Também deve ser possível usar o codificador XviD, encontrado em
<tt>multimedia/xvidcore</tt>.

<p>
A documentação que vem com esses pacotes, na forma de páginas de manual
ou documentos HTML em <tt>/usr/local/share/doc</tt>, contém muitos
exemplos, então a leitura desses documentos é ALTAMENTE recomendada.


<a name="streaming"></a>
<h2>13.11 - É possível reproduzir fluxo contínuo de dados ("streaming")
no OpenBSD?</h2>

Sim, é possível.
Muitos fluxos de áudio e vídeo funcionam bem, em um número limitado
de plataformas.
Alguns deles não funcionam.

<p>
Esta seção não é planejada para ser completa, nem uma resposta
excessivamente detalhada para executar todos os formatos de
fluxo contínuo de dados em todas as arquiteturas de hardware.
Para começar, você talvez queira aprender mais sobre mídia de
fluxo contínuo de dados.
Um ponto de partida um pouco antigo, mas ainda bom, é este
<a href="http://www.oreilly.com/catalog/sound/chapter/ch05.html">
capítulo sobre mídia de fluxo contínuo de dados</a> do livro
intitulado "Designing Web Audio", da editora O'Reilly.

<p>
A primeira coisa para entender é que existem vários protocolos
diferentes de fluxo contínuo de dados.
O <b>protocolo</b> de fluxo contínuo de dados define como os fluxos
serão enviados pela rede.
Eles foram desenvolvidos para permitir uma transmissão eficiente de
áudio/vídeo em tempo real através da Internet.
Na maioria das vezes, o protocolo de fluxo contínuo de dados é um
protocolo a nível de aplicação (Camada 7), que pode usar os
protocolos de transporte UDP ou TCP.
O procolo de transporte UDP ("User Datagram Protocol") é muito útil
para esse tipo de aplicação, já que ele não faz nenhuma retransmissão
de pacotes ou outro tipo de verificação.
Vários protocolos, porém proprietários, foram desenvolvidos; por
exemplo, o MMS ("Microsoft Media Services", ou Serviços de Mídia da
Microsoft) e o RTSP ("Real Time Streaming Protocol", ou Protocolo de
Transmissão de Fluxos em Tempo Real).
Como nós veremos, o protocolo HTTP (que usa TCP) é usado algumas vezes,
apesar dele não permitir servir fluxos em uma velocidade regular como
UDP, RTSP e MMS.

<p>
Existe um <b>formato</b> de fluxo contínuo de dados, que é como os
dados de áudio/vídeo foram organizados e como podem ser reproduzidos.
Os formatos de fluxo contínuo de dados mais usados são: MP3,
Real Audio (RA, RM) e Windows Media (ASF).
Todas estas são tecnologias proprietárias.
Ocasionalmente, você também encontrará fluxos no formato aberto
Ogg Vorbis.

<p>
Como um exemplo, explicarei em alguns passos como eu fiz para escutar
a <a href="http://www.radio1.be">Radio 1</a>,
uma das estações nacionais de rádio da Bélgica.
Plugins para navegadores não estão disponíveis no OpenBSD, o que
significa que a história não se resume em um
"clicar e escutar".

<ul>
<li>Determine o protocolo de fluxo contínuo de dados e o formato.<br>
    Isso normalmente é indicado no sítio Web onde você acessa o fluxo.
    Nesse caso, eu segui o link "Listen live" do sítio principal, e
    ele está me dizendo que o meu sistema operacional não é suportado.
    Eles estão sendo legais em dizer que eu também posso escutar seus
    fluxos MP3 sem o player Flash embutido.
    Além disso, uma lista de links para as estações de rádio nacionais
    é mostrada, o que me permite ir para o próximo passo.
    Note que eu usei um navegador com JavaScript ativado para obter
    essa informação.
<li>Descubra a URL exata.<br>
    Muitos sítios Web conectam um contêiner metafile ou uma lista de
    reprodução (como M3U, ASX, RAM), que contém a localização real do
    fluxo. Simplesmente salve o arquivo, e leia a URL dele.
    No meu exemplo, ele é

<blockquote><pre>
$ <strong>ftp http://internetradio.vrt.be/dab/hoeluisteren/pc/help/gebruiksvoorwaarden/stream_11.m3U</strong>
$ <strong>cat stream_11.m3U</strong>
http://mp3.streampower.be/radio1-mid.mp3
http://mp3.streampower.be/radio1-low.mp3
http://mp3.streampower.be/radio1-high.mp3
</pre></blockquote>

    Parece que eu posso escolher entre os fluxos de baixa, média ou
    alta qualidade.
    Outros sítios Web podem conter algum código JavaScript para gerar a
    URL.
    Nesse caso, a melhor dica é: baixe o código HTML e procure onde
    o script faz referência.
    Existe uma boa chance de você conseguir reconstruir a URL a partir
    desses dados.

<li>Para reproduzir fluxos, o melhor programa é, provavelmente, o
    <tt>x11/mplayer</tt>, que está disponível através de pacotes e
    portes.
    Ele suporta a maioria dos protocolos e formatos de
    fluxo contínuo de dados, e foi relatado o funcionamento nas
    plataformas amd64, i386, powerpc e sparc64.
    Mas existem alternativas:
    <b>ogg123</b> do <tt>audio/vorbis-tools</tt> (para fluxos Ogg
    Vorbis), <tt>audio/mpg123</tt> e <tt>audio/mpg321</tt> (para
    fluxos MP3), XMMS em <tt>audio/xmms</tt>, e o cliente Videolan em
    <tt>x11/vlc</tt>.
    Continuando o exemplo:

<blockquote><pre>
$ <strong>mplayer http://mp3.streampower.be/radio1-mid.mp3</strong>
</pre></blockquote>

<li>Opcionalmente, você pode facilitar a tarefa incluindo um apelido no
    seu arquivo <tt>.profile</tt>:

<blockquote><pre>
alias radio1='mplayer http://mp3.streampower.be/radio1-mid.mp3'
</pre></blockquote>

</ul>

<!--
check out http://www.cbc.ca/listen/index.html
it has DivX streams over MMS as well as Ogg Vorbis streams over HTTP.
maybe a good example but also nearly an ideal case...
-->

Streams do tipo Windows Media (ASF) funcionam na maioria das vezes,
apesar do fato de que eles podem conter dados em formatos suportados
apenas através do porte <tt>graphics/win32-codecs</tt>, que funciona
apenas na plataforma i386 ('pkg_info win32-codecs' retorna a
lista dos codecs suportados).
Alguns fluxos Real Audio podem funcionar na plataforma i386, usando
o <b>mplayer</b> junto com os portes
<tt>graphics/win32-codecs</tt> e <tt>emulators/fedora/base</tt>
(veja
<a href="http://marc.info/?t=107060510300001&amp;r=1&amp;w=2">esta
thread</a> na lista de discussão do portes).

<a name="javaflash"></a>
<a name="javaplugin"></a>
<h2>13.12 - Posso usar um plugin Java no meu navegador? (somente i386
&amp; amd64)</h2>

O plugin Java é parte do Kit de Ferramentas de Desenvolvimento Java
(JDK, "Java Development Toolkit").
Por razões de licença, o OpenBSD não pode distribuir os pacotes binários
do JDK.
Isso significa que você terá que compilar a partir do portes.
Mais informações sobre a compilação do JDK podem ser encontradas em
<a href="faq8.html#Programming">FAQ 8 - Linguagens de Programação</a>.
Após terminar a compilação do JDK, você pode instalar o pacote JDK
completo ou apenas o Ambiente de Execução Java ("Java Runtime
Environment" - JRE), que está em um subpacote e contém o plugin para
o navegador.

<p>
No final da instalação, são mostradas instruções sobre o uso do plugin
Java no navegador Firefox e no Seamonkey.
Crie a ligação simbólica como explicado, e então você deve ver o plugin
Java ao digitar "about:plugins" na barra de endereço.

<p>
Para o navegador Konqueror do KDE, o binário java precisa estar em seu
PATH, ou seu caminho absoluto pode ser configurado no menu
Settings -&gt; Configure Konqueror -&gt; Java &amp; JavaScript.
Por padrão, o binário java está localizado em
<tt>/usr/local/jre-<i>versão</i>/bin/</tt> ou
<tt>/usr/local/jdk-<i>versão</i>/bin/</tt>, dependendo do lugar que
você instalou o JRE ou o JDK.

<p>
<b>Nota:</b> o plugin Java foi testado somente nos navegadores
Firefox, Seamonkey e Konqueror.
Se ele funciona bem para você em outro navegador, comunique-nos.


<a name="flashplugin"></a>
<h2>13.13 - Posso usar um plugin Flash no meu navegador? (somente i386)
</h2>

O plugin Flash é distribuído pela Adobe somente no formato binário.
A Adobe não fornece um plugin nativo para o OpenBSD, mas existe um
plugin para Linux, que você pode usar com a emulação do Linux.
Esse plugin está disponível somente para a plataforma i386.

<p>
Antes de continuar, é uma boa ideia ler sobre a emulação do Linux na
página de manual
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=compat_linux&amp;sektion=8">compat_linux(8)</a>,
e também em
<a href="faq9.html#Interact">FAQ 9 - Como executar binários do Linux no
OpenBSD</a>.

<p>
Se você entendeu os documentos e ainda não instalou os arquivos
necessários, apenas adicione o pacote fedora.
Assumindo que sua variável de ambiente <tt>PKG_PATH</tt> está definida
(veja a <a href="faq15.html#Easy">FAQ 15</a>),

<blockquote><pre>
# <b>pkg_add -i fedora_base</b>
</pre></blockquote>

Isso define automaticamente <tt>kern.emul.linux=1</tt>, mas não
permanentemente.
Se você precisa que a emulação do Linux seja permanente, você precisa
especificar isso no arquivo <tt>/etc/sysctl.conf</tt>, como explicado em
<a href="faq9.html#Interact">FAQ 9 - Como exeuctar binários do Linux no
OpenBSD</a>.

<p>
Uma outra coisa que você deve saber, é que as bibliotecas compartilhadas
e os módulos do Linux não podem ser usados com os executáveis do
OpenBSD, então você também precisa de um navegador para Linux.

<p>
Um candidato é o navegador <a href="http://www.opera.com/">Opera</a>,
disponível na árvore de portes.
O OpenBSD não distribui pacotes dele, já que a licença do Opera não é
clara a respeito da sua redistribuição.
No entanto, a instalação não demora muito, já que ele é distribuído
no formato binário pela Opera Software.
Depois disso, você pode instalar facilmente o plugin Flash a partir
da árvore de portes.

<blockquote><pre>
# <b>cd /usr/ports/www/opera</b>
# <b>make install</b>
# <b>cd /usr/ports/www/opera-flashplugin</b>
# <b>make install</b>
</pre></blockquote>

<p>
<b>Nota:</b>
Executar somente os últimos passos deve ser o suficiente: o sistema
de portes instala automaticamente as dependências.
Para uma maior clareza, entretanto, na explicação nós dividimos o
processo em alguns passos.

<p>
Se você seguiu o guia, o plugin Flash deve estar listado quando você
digita "about:plugins" na barra de endereço.


<!--
this would be interesting, but lack of hardware at the moment

<a name="camera"></a>
<h2>13.xx - Can I use my digital camera under OpenBSD?</h2>

<a name="scanner"></a>
<h2>13.yy - How do I set up and use my scanner?</h2>
-->

<p>
<font color= "#0000e0">
<a href= "index.html">[Índice da FAQ]</a>
<a href= "faq12.html">[Seção 12 - Questões Específicas de Hardware
e Plataforma]</a>
<a href= "faq14.html">[Seção 14 - Configuração dos Discos]</a>
</font>

<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../../images/back.gif" border= "0" alt="[voltar]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: faq13.html,v 1.130 ]<br>
$Translation: faq13.html,v 1.7 2009/10/13 19:21:11 alan Exp $<br>
-->
$OpenBSD: faq13.html,v 1.5 2009/10/17 15:58:26 ajacoutot Exp $
</small>
</body>
</html>

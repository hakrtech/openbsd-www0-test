<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>5 - Das System aus dem Quelltext erzeugen</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 1998-2013 by OpenBSD.">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
</head>

<body bgcolor= "#ffffff" text= "#000000">
<!-- Passes validator.w3.org.  Please keep it this way -->

<a href="../../de/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif" border="0">
</a>
<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ-Index]</a>
<a href= "faq4.html">[Zum Kapitel 4 - Installationsanleitung]</a>
<a href= "faq6.html">[Zum Kapitel 6 - Vernetzung]</a>
</font>

<h1><font color="#e00000">5 - Das System aus dem Quelltext erzeugen</font></h1>
<hr>

<p>
<h3>Inhaltsverzeichnis</h3>
<ul>
<li><a href="#Flavors"    >5.1 - OpenBSDs Aromata</a>
<li><a href="#WhySrc"     >5.2 -
    Warum muss ich mein System aus dem Quelltext heraus erzeugen?</a>
<li><a href="#Bld"        >5.3 - OpenBSD aus dem Quelltext heraus erzeugen</a>
<ul>
  <li><a href="#BldOverview">5.3.1 - Überblick</a>
  <li><a href="#BldBinary"  >5.3.2 - Die dem Ziel nächstmögliche Binärdatei
    installieren, oder auf sie aktualisieren</a>
  <li><a href="#BldGetSrc"  >5.3.3 - Den passenden Quelltext herunterladen</a>
  <li><a href="#BldKernel"  >5.3.4 - Den Betriebssystemkern erzeugen</a>
  <li><a href="#BldUserland">5.3.5 - Das Userland erzeugen</a>
</ul>
<li><a href="#Release"    >5.4 - Ein Release erstellen</a>
<li><a href="#Xbld"       >5.5 - X erzeugen</a>
<li><a href="#Why"        >5.6 - Warum brauche ich einen angepassten Kern?</a>
<li><a href="#Options"    >5.7 - Einen angepassten Kern erzeugen</a>
<li><a href="#BootConfig" >5.8 - Konfiguration während des Systemstarts</a>
<li><a href="#config"     >5.9 - Mittels config(8) deinen Kern verändern</a>
<li><a href="#VerboseBoot">5.10 -
    Ausführlichere Meldungen während des Systemstarts erhalten</a>
<li><a href="#buildprobs" >5.11 -
    Häufige Probleme, Tipps und Fragen zum Übersetzen und Erzeugen</a>
   <ul>
   <li><a href="#sig11"       >5.11.1 -
        Das Erzeugen bricht mit einem »Signal 11« Fehler ab</a>
   <li><a href="#snake"       >5.11.2 -
        »make build« schlägt mit
        »cannot open output file snake: is a directory« fehl</a>
   <li><a href="#ProbIPv6"    >5.11.3 -
        Mein System läuft nicht ohne IPv6!</a>
   <li><a href="#ProbObj"     >5.11.4 -
        Hoppla! Ich habe vergessen, zuerst das Verzeichnis <tt>/usr/obj</tt>
        zu erstellen!</a>
   <li><a href="#ProbObjPt"   >5.11.5 -
        Lege <tt>/usr/obj</tt> auf seine eigene Partition</a>
   <li><a href="#ProbSKIPDIR" >5.11.6 -
        Wie verhindere ich das Erzeugen bestimmter Teile des Baums?</a>
   <li><a href="#ProbMoreInfo">5.11.7 -
        Wo kann ich mehr über den Prozess des Erzeugens erfahren?</a>
   <li><a href="#NoSnaps"     >5.11.8 -
        Ich sehe keine Schnappschüsse auf den FTP-Seiten.
        Wo sind sie geblieben?</a>
   <li><a href="#NewCompiler" >5.11.9 -
        Wie führe ich die Urladung einer neueren Version des Übersetzers
        (<i>gcc</i>) aus?</a>
   <li><a href="#UpdateEtc"   >5.11.10 -
        Was ist der beste Weg, um <tt>/etc</tt>, <tt>/var</tt>
        und <tt>/dev</tt> zu aktualisieren?</a>
   <li><a href="#Hierarchy"   >5.11.11 -
        Gibt es einen einfachen Weg, um alle nötigen Änderungen an der
        Dateihierarchie durchzuführen?</a>
   <li><a href="#ProbXComp"   >5.11.12 -
        Kann ich querübersetzen? Warum nicht?</a>
   </ul>
</ul>
<hr>
<br>


<a name="Flavors"></a>
<h2>5.1 - OpenBSDs Aromata</h2>
<!-- XXXversion - revise doodle -->
Es gibt drei Aromata von OpenBSD:
<ul>
<li><b>-release:</b> Die Version von OpenBSD, die alle 6 Monate auf CD
    ausgeliefert wird.
<li><b>-stable:</b> Release und zusätzliche Korrekturroutinen, die für
    Sicherheit und Zuverlässigkeit als notwendig erachtet werden.
<li><b>-current:</b> Hier werden die aktuellen Entwicklungsarbeiten
    durchgeführt; letzten Endes wird das nächste Release aus diesem
    Aroma erstellt.
</ul>

Grafisch sieht die Entwicklung dieser Aromata ungefähr so aus:

<blockquote>
<pre>
       ,------o-----------o----X                    5.1 Stable
       |      .           .
       |      .    ,------o---------o----X          5.2 Stable
       |      .    |      .         .
       |      .    |      .    ,----o----------o--&gt; 5.3 Stable
       |      .    |      .    |    .          .
       |      .    |      .    |    .    ,-----o--&gt; 5.4 Stable
       |      .    |      .    |    .    |     .
       |      .    |      .    |    .    |     .
 --&gt;5.1Rel-----&gt;5.2Rel-----&gt;5.3Rel-----&gt;5.4Rel----&gt; Current

          Zeit ---&gt;
</pre>
</blockquote>

<p>
In und an <i>-current</i> findet die aktive Entwicklung statt,
das sich, schließlich, in das nächste <i>-release</i> von OpenBSD verwandelt.
Alle sechs Monate, wenn eine neue Version von OpenBSD veröffentlicht wird,
wird <i>-current</i> etikettiert und somit zu <i>-release</i>:
ein fester Punkt in der Geschichte des Quelltextbaums.
Kein <i>-release</i> wird jemals verändert; es ist das, was auf den
<a href="../../de/orders.html">CDs</a> und
<a href="../../de/ftp.html">FTP-Servern</a> vorliegt.

<p>
<i>-stable</i> basiert auf <i>-release</i> und ist ein Zweig des
Hauptentwicklungspfads von OpenBSD.
Wenn sehr wichtige Korrekturen in <i>-current</i> eingebracht werden,
so werden sie in den Zweig <i>-stable</i> »zurückportiert« (eingefügt).
Das ist der Grund, warum <i>-stable</i> auch als »<i>patch-branch</i>«
bezeichnet wird.
In obiger Illustration sind die vertikalen, gepunkteten Linien
Fehlerkorrekturen, die in die <i>-stable</i>-Zweige eingefügt wurden.
Du wirst auch bemerken, dass der Lebenszyklus des Zweigs <i>5.1-stable</i> im
obigen Beispiel mit Erscheinen des <i>5.3-release</i> und der Zweig
<i>5.2-stable</i> mit Erscheinen von <i>5.4-release</i> beendet war -
alte Versionen werden typischerweise noch zwei Releases lang weiter gepflegt.
Es braucht nun mal Ressourcen und Zeit, ältere Versionen zu pflegen - und
obwohl wir das gerne tun würden, konzentrieren wir uns doch lieber auf neue
Funktionen.
Der Zweig <i>-stable</i> kann vom Design her sehr leicht aus dem Zweig
<i>-release</i> derselben Version erzeugt werden
(z.&nbsp;B. von <i>5.4-release</i> zu <i>5.4-stable</i>).

<p>
Der Zweig <i>-stable</i> ist in der Tat <i>-release</i> inklusive jener
Korrekturroutinen, die auf der <a href="../../de/errata.html">Errataseite</a>
aufgeführt sind.
Die Benutzung von <i>-stable</i> ist identisch der des <i>-release</i>, auf
dem er basiert.
Wenn die <a href="http://www.openbsd.org/cgi-bin/man.cgi">Handbuchseiten</a>
geändert werden müssen, wird es wahrscheinlich nicht in <i>-stable</i>
eingefügt werden.
Mit anderen Worten: Unterstützung für neue Hardware und neue Funktionen werden
NICHT in <i>-stable</i> eingefügt.

<p>
Es lohnt sich, darauf hinzuweisen, dass der Name <i>-stable</i> keineswegs
impliziert, dass <i>-current</i> in einem Produktivsystem unzuverlässig oder
gar weniger stabil ist.
Vielmehr bedeutet es, das sich die APIs (Programmierschnittstellen der
Programme mit dem Betriebssystem) und Eigenschaften von <i>-current</i> ändern
und entwickeln, wohingegen jene von <i>-stable</i> die gleichen sind wie die
des Release, auf dem er basiert, sodass es nicht nötig sein sollte, umlernen-,
oder irgendwelche Konfigurationsdateien ändern zu müssen, und es keine Probleme
geben sollte, zusätzliche Anwendungen zu dem System hinzuzufügen.

<p>
In der Tat ist, da es unsere Hoffnung ist, OpenBSD stetig zu verbessern, das
Ziel, dass <i>-current</i> zuverlässiger und sicherer ist und, natürlich,
großartigere Eigenschaften besitzt als <i>-stable</i>.
Grob gesagt ist <i>-current</i> die »beste« Version von OpenBSD.

<p>
Die meisten Benutzer sollten entweder <i>-stable</i> oder aber
<i>-release</i> benutzen.
Nachdem dies gesagt ist, ist anzumerken, dass viele Leute <i>-current</i> auf
Produktivsystemen einsetzen, und das es wichtig ist, dass es Leute gibt, die
dies tun, damit Fehler gefunden und neue Eigenschaften und Funktionen getestet
werden.
Allerdings, wenn du nicht wissen solltest, wie man Probleme vernünftig
beschreibt, diagnostiziert und mit ihnen umgeht, dann rede bitte dir (oder
jemand anderem) nicht ein, dass du »dem Projekt hilfst«, indem du
<i>-current</i> benutzt.
»Es funktionierte nicht!« ist kein
<a href="../../de/report.html#bugtypes">nützlicher Fehlerbericht</a>.
»The recent changes to the pciide driver broke compatibility with my
Slugchip-based IDE interface, dmesg of working and broken systems
follow...« könnte dagegen durchaus ein sinnvoller und nützlicher
Bericht sein.

<p>
Es mag Zeiten geben, in denen auch ein normaler Benutzer gerne auf
des Messers Schneide leben will und <i>-current</i> benutzt.
Der häufigste Grund dafür ist, dass er ein Gerät hat, das nicht von
<i>-release</i> unterstützt wird (und daher auch nicht von <i>-stable</i>),
oder dass er eine neue Funktion von <i>-current</i> benutzen möchte.
In diesem Fall besteht die Wahl zwischen <i>-current</i> oder dem Nichtbenutzen
des Gerätes, und <i>-current</i> mag das kleinere Übel sein.
Wie auch immer, niemand sollte erwarten, dass die Entwickler Händchen halten.

<h3>Schnappschüsse</h3>
Zwischen den formalen Veröffentlichungen neuer Versionen von OpenBSD
werden <i>Schnappschüsse</i> über die
<a href="../../de/ftp.html">FTP-Seiten</a> verfügbar gemacht.
Wie der Name impliziert, handelt es sich dabei um übersetzte Versionen des
Quelltexts, der sich in dem Moment im Baum vorfand, als der Erzeugungsprozess
sich dort eine Kopie für eine bestimmte Plattform besorgt hat.
Es ist möglich, wenngleich hoffentlich unwahrscheinlich, dass du Fehler in
einem Schnappschuss aufdeckst; dies ist der Grund, warum sie vom Projekt
selbst übersetzt und verteilt werden.
Solltest du einen Fehler in einem Schnappschuss entdecken, stelle sicher, dass
er <a href="../../de/report.html">berichtet</a> wird.

<p>
Wenn es dein Wunsch ist, <i>-current</i> zu benutzen, so ist ein halbwegs
aktueller Schnappschuss oft das Einzige, was du benötigst, und das Upgraden
auf einen Schnappschuss ist eine erforderliche Voraussetzung, bevor man den
Versuch starten kann, <i>-current</i> zu erzeugen.

<p>
Manchmal wird gefragt, ob es einen Weg gibt, genau den Quelltext zu
bekommen, der zur Erzeugung eines Schnappschuss eingesetzt wurde.
Die Antwort ist nein.
Erstens ergibt sich daraus kein besonderer Vorteil.
Zweitens werden Schnappschüsse nach Bedarf erzeugt, wenn die Zeit es erlaubt,
und wenn Ressourcen verfügbar werden.
Auf schnellen Plattformen können mehrere Schnappschüsse an einem Tag
freigegeben werden.
Auf langsameren Plattformen kann es eine Woche oder länger dauern, bis ein
Schnappschuss vollständig erzeugt ist.
Und für jeden Schnappschuss Etiketten oder Markierungen im Quelltextbaum
anzubringen ist nicht wirklich praktikabel.
Drittens, Schnappschüsse enthalten oft experimentellen Kode, der noch nicht in
Baum eingebunden wurde.

<h3>Upgrade oder Update</h3>
Dir werden oft Referenzen zum »Upgraden« und »Updaten« von
OpenBSD-Installationen begegnen.
Obwohl beide Wörter ungefähr die gleiche Bedeutung haben, werden sie in
Verbindung mit OpenBSD unterschiedlich eingesetzt.

<p>
<b>Upgraden</b> bezeichnet den Prozess der Installation einer neueren Version
von OpenBSD, mit neuer Funktionalität.
Zm Beispiel ein Wechsel von v5.3 auf v5.4 oder vom Schnappschuss des 12. Juni
auf den Schnappschuss des 20. Juni.
Wenn du upgradest, so wirst du dich typischerweise an die Anleitungen in
<a href="../current.html">der Entwicklung von -current folgen</a> oder der
<a href="../upgrade54.html">Upgrade-Anleitung</a> (wenn das Release gewechselt
wird) halten, um die Änderungen vorzunehmen, die nötig sind, damit die
upgegradete Version von OpenBSD eingesetzt werden kann.

<br>
<b>Updaten</b> bezeichnet den Prozess des Einspielens von Korrekturroutinen in
ein System, um die Lauffähigkeit zu verbessern, OHNE dass die grundlegenden
Funktionen oder die Binärkompatibilität verändert wird.
Entweder folgst du hierbei den Anweisungen wie man
<a href="faq10.html#Patches">Korrekturroutinen einspielt</a>,
oder wie man <a href="../../de/stable.html">-stable folgt</a>.
Wenn du dein System »updatest«, dann wechselt es von einem
<i>-release</i>-Zweig auf einen <i>-stable</i>-Zweig (oder auf einen
korrigierten <i>-release</i>) der gleichen Version von OpenBSD, zum Beispiel
von 5.4-release auf 5.4-stable.
Du kannst es dann später auf einen neueren <i>-stable</i> derselben
OpenBSD-Version updaten.
Der Updatevorgang ist normalerweise schmerzlos, da keine Datein unter
<tt>/etc</tt> modifiziert oder andere Systemkonfigurationen geändert
werden müssen.

<p>
Du könntest also ein System von CD installieren
(zum Beispiel 5.2-release), dann ein paar Mal auf 5.2-stable updaten,
dann auf 5.3-release per CD upgraden, wieder ein paar Mal updaten
und dann wieder auf OpenBSD 5.4-release upzugraden.

<h3>Die Dinge synchron halten</h3>
Es ist wichtig zu verstehen, dass OpenBSD ein Betriebssystem ist,
und als Ganzes gesehen werden muss, nicht als ein Kern mit einem
Haufen lose angehängter Werkzeuge.
Du musst sicherstellen, dass dein Kern, dein Userland (die unterstützenden
Werkzeuge und Dateien) und dein
<a href="faq15.html#Ports"><tt>Portierungs</tt></a>baum
alle synchron sind, oder es werden unangenehme Dinge passieren.
Oder, anders ausgedrückt (da es immer wieder Leute gibt, die das versuchen),
kannst du keine brandneuen <tt>Portierungen</tt> auf einem System laufen
lassen, das einen Monat alt ist, oder einen Kern aus <i>-current</i> neu
erzeugen und dann erwarten, dass er ordentlich mit einem
<i>release</i>-Userland zusammenarbeitet.
Ja, das heißt, dass du dein System upgraden musst, wenn du ein neues Programm
benutzen möchtest, das heute in den Portierungsbaum eingefügt worden ist.
Entschuldigung, aber noch einmal - OpenBSD verfügt nur über sehr begrenzte
Ressourcen.

<p>
Man sollte ebenfalls verstehen, dass der Upgradevorgang <b>nur in eine Richtung
unterstützt wird: von älter zu neuer</b> und von <i>-stable</i> zu
<i>-current</i>.
Du kannst kein <i>5.4-current</i> (oder einen Schnappschuss) laufen lassen und
dich dann entscheiden, dass dir das zu gefährlich ist, und einfach nach
<i>5.4-stable</i> zurückgehen.
Du bist auf dich allein gestellt, wenn du einen anderen Weg wählst als den
unterstützten der kompletten Neuinstallation, also erwarte bitte keinerlei
Hilfeleistung des OpenBSD-Entwicklerteams.

<p>
Ja, das soll wirklich heißen, dass du darüber nachdenken solltest, bevor du
dich <i>-current</i> verschreibst.

<a name="WhySrc"></a>
<h2>5.2 - Warum muss ich mein System vom Quelltext aus erzeugen?</h2>
An und für sich ist es sehr wahrscheinlich, dass du es gar nicht musst.

<p>
Einige Gründe, NICHT aus dem Quelltext heraus zu erzeugen:
<ul>
<li>Das Übersetzen deines Systems als Weg zum Upgraden zu nutzen, wird
nicht unterstützt.
<li>Du wirst KEINE bessere Systemleistung durch das Übersetzen deines
eigenen Systems erhalten.
<li>Es ist wahrscheinlicher, dass das Ändern von Übersetzeroptionen die
Stabilität deines System vermindert, als das es Verbesserungen bedingt.
</ul>

Einige Gründe, warum du in der Tat den Wunsch verspüren könntest, oder etwa gar
die Notwendigkeit besteht, das System aus dem Quelltext heraus zu erzeugen:
<ul>
<li>Testen oder Entwickeln neuer Funktionen.
<li>Die Übersetzung des Systems bedingt eine hohe Last des Computers, und kann
daher ein Weg sein, sicherzustellen, dass sich das System, das du gerade
zusammengebaut oder erworben hast, in einwandfreiem, betriebsbereitem Zustand
befindet.
<li>Du möchtest dem »<a href="../../de/stable.html">stable-branch</a>« folgen.
<li>Du möchtest eine umfangreich angepasste Version von OpenBSD für einen sehr
speziellen Verwendungszweck erzeugen.
</ul>

<p>
Das OpenBSD-Team stellt für alle Plattformen regelmäßig neue, auf
<i>-current</i> Quelltext basierende Schnappschüsse bereit.
Es ist wahrscheinlich, dass du nichts Anderes benötigst,
um <i>-current</i> zu betreiben.

<p>
Der häufigste Grund, aus dem Quelltext heraus zu erzeugen, ist, dem Zweig
<i>-stable</i> zu folgen, da das Erzeugen aus den Quellen die einzige
unterstützte Option ist.

<p>
Wird <i>-current</i> aus dem Quelltext übersetzt, so ist es SEHR
empfehlenswert, dies nur auf einer Maschine zu machen, auf deren Konsole man
uneingeschränkten Zugriff hat.
Es wird Zeiten im Entwicklungsprozess geben, in denen die Diskrepanz zwischen
deinem neuen Betriebssystemkern und deinem alten Userland dazu führt, dass das
System über das Netzwerk nicht ansprechbar ist.
Dies ist kein Problem mit einem korrekt erzeugten <i>-stable</i>.

<a name="Bld"></a>
<h2>5.3 - OpenBSD aus dem Quelltext erzeugen</h2>

<a name="BldOverview"></a>
<h3>5.3.1 - Überblick über den Erzeugungsprozess</h3>

OpenBSD vom Quelltext aus zu erzeugen beinhaltet einige Schritte:
<ul>
<li><a href="#BldBinary">Zur nächstliegenden Binärdatei aktualisieren.</a>
<li><a href="#BldGetSrc">Den passenden Quelltext herunterladen.</a>
<li><a href="#BldKernel">Den neuen Kern erzeugen und mit diesem neu starten.</a>
<li><a href="#BldUserland">Das »Userland« erzeugen (»make build«).</a>
</ul>

Es gibt ein paar weitere Schritte, die einige Benutzer eventuell
durchführen möchten, abhängig von dem Verwendungszweck des
erzeugten Systems, und ob X installiert ist:
<ul>
<li><a href="#Release">Ein »Release« erzeugen.</a>
<li><a href="#Xbld">X erzeugen.</a>
</ul>



<a name="BldBinary"></a>
<h3>5.3.2 - Zur nächstliegenden Binärdatei aktualisieren oder diese
installieren</h3>

Der erste Schritt beim Erzeugen aus dem Quelltext heraus besteht darin,
sicherzustellen, dass du die dem Ziel nächstliegende verfügbare Binärdatei
installiert hast.

Verwende diese Tabelle, um zu sehen, wo du bist, wo du hingehen
möchtest und mit welcher Binärdatei du starten solltest:

<p>
<table border="1" style="empty-cells: show;">
<tr>
  <td><b>Du bist beim</b></td> <td><b>Ziel</b></td>
  <td><b>Binärdatei-Upgrade auf</b></td> <td><b>dann ...</b></td>
</tr>
<tr>
  <td> alten -release </td> <td> neues Release </td> <td> neuestes Release </td>
  <td> Fertig! </td>
</tr>
<tr>
  <td> -release </td> <td> -stable </td> <td> neuestes Release </td>
  <td>downloade u. erzeuge <i>-stable</i></td>
</tr>
<tr>
  <td> alten -stable</td> <td> -stable </td> <td> neuestes Release </td>
  <td>downloade u. erzeuge <i>-stable</i></td>
</tr>
<tr>
  <td> -release </td> <td> -current </td> <td> aktuellsten Schnappschuss</td>
  <td> (optional) downloade u. erzeuge <i>-current</i></td>
</tr>
<tr>
  <td> alten -current </td> <td> -current </td> <td> aktuellsten Schnappschuss</td>
  <td> (optional) downloade u. erzeuge <i>-current</i></td>
</tr>
</table>

<p>
Es wird empfohlen, dass du die Binärdatei unter Verwendung der Option »Upgrade«
des Installationsmediums installierst.
Wenn das nicht möglich ist, kannst du auch die Binärdatei entpacken, so
wie es <a href="../upgrade54.html">hier</a> beschrieben ist.
Unabhängig davon musst du den gesamten Upgradeprozess durchführen,
einschließlich des Erzeugens möglicher Benutzer oder anderer Änderungen im
Verzeichnis <tt>/etc</tt>.


<a name="BldGetSrc"></a>
<h3>5.3.3 - Den passenden Quelltext herunterladen</h3>
Der Quelltext von OpenBSD wird unter Verwendung des Versionkontrollsystems
<a href="http://ximbiot.com/cvs/cvshome/">CVS</a> verwaltet, und
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1"
>cvs(1)</a> wird genutzt, um eine Kopie der gewünschten Quelle auf deine
lokale Maschine zur Übersetzung herunterzuladen.
Dies kann unter Verwendung eines
<a href="../../de/anoncvs.html">AnonCVS</a>-Servers geschehen (einer
Maschine, die eine öffentlich zugängliche Kopie vom gesamten
CVS-Repositorium hält, das vom OpenBSD-Projekt genutzt wird) oder von
einem lokalen CVS-Repositorium, das du unter Verwendung der Programme
<a href="../../de/cvsync.html">CVSync</a> oder rsync pflegst, welche als
<a href="faq15.html#PkgMgmt">Pakete</a> vorliegen.
Wenn du mehrere Maschinen hast, auf denen du den Quelltextbaum
verwalten willst, kann es für dich durchaus nützlich sein, ein lokales
CVS-Repositorium vorzuhalten, erstellt und gepflegt unter Verwendung von
CVSync oder rsync.

<p>
Nach der Entscheidung, welchen
<a href="../../de/anoncvs.html">AnonCVS-Server</a> du zu verwenden wünschst,
musst du eine »Arbeitskopie« des Quelltextbaums erzeugen, und danach diesen
Baum durch das Ausführen von »Updates« pflegen, um aktualisierte Dateien in
deinen lokalen Baum einzubinden.

<p>
Das Kommando
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1"
>CVS(1)</a> hat viele Optionen, einige von ihnen sind <i><b>notwendig</b></i>,
um eine Arbeitskopie eines nutzbaren Baum zu erzeugen und ihn upzudaten.
Andere Kommandos können dazu führen, dass dein Baum unbrauchbar wird.
Diesen Anweisungen hier zu folgen, und sie zu verstehen, ist wichtig.

<p>
<b><i>-current</i> folgen</b><br>
<blockquote>
In diesem Fall nehmen wir an, dass wir einen öffentlichen
AnonCVS-Server, <b>anoncvs@anoncvs.example.org:/cvs</b>, verwenden.
Wir nehmen des Weiteren an, dass du
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sh&amp;sektion=1"
>sh(1)</a> als deine Kommandoshell verwendest;
solltest du eine andere Shell verwenden,
so musst du einige dieser Kommandos anpassen.

<p>
Um die Arbeitskopie eines <i>-current</i> CVS Quelltextbaums zu erhalten,
kannst du Folgendes nutzen:

<pre>
    # <b>cd /usr</b>
    # <b>export CVSROOT=anoncvs@anoncvs.example.org:/cvs</b>
    # <b>cvs -d$CVSROOT checkout -P src</b>
</pre>

<p>
Sobald du einen Baum hast, kannst du ihn später jederzeit
aktualisieren:
<pre>
    # <b>cd /usr/src</b>
    # <b>export CVSROOT=anoncvs@anoncvs.example.org:/cvs</b>
    # <b>cvs -d$CVSROOT up -Pd</b>
</pre>
</blockquote>

<!-- XXXrelease -->
<b><i>-stable</i> folgen</b><br>
<blockquote>
Wenn du die Arbeitskopie eines alternativen »Zweigs« des Baums,
wie zum Beispiel des Zweigs <i>-stable</i>, haben möchtest,
so musst du die Option <tt>-r</tt> benutzen:
<pre>
    # <b>cd /usr</b>
    # <b>export CVSROOT=anoncvs@anoncvs.example.org:/cvs</b>
    # <b>cvs -d$CVSROOT checkout -rOPENBSD_5_4 -P src</b>
</pre>

Dies wird die Quelltextdateien des Zweigs OPENBSD_5_4 populieren,
welcher ebenfalls als »patch-branch« oder
»<a href="../../de/stable.html">-stable</a>« bekannt ist.
Den Kode würdest du ähnlich aktualisieren:
<pre>
    # <b>cd /usr/src</b>
    # <b>export CVSROOT=anoncvs@anoncvs.example.org:/cvs</b>
    # <b>cvs -d$CVSROOT up -rOPENBSD_5_4 -Pd</b>
</pre>

Tatsächlich ist CVS nett genug, ein Etikett (»tag«) an die
heruntergeladenen Dateien anzuhängen, sodass du dir
<tt>-rOPENBSD_5_4</tt> für die Kommandozeile nicht merken musst.
CVS wird sich immer daran erinnern, bis du dies explizit zurücksetzt
oder eine neue Markierung unter Verwendung der Option <tt>-A</tt> mit
<tt>update</tt> verwendest.
Jedoch ist es vermutlich besser, zu viele Informationen in deine
CVS-Kommandozeilen zu packen als zu wenig.
</blockquote>

<p>
Obwohl bis jetzt nur der Baum »<tt>src</tt>« gezeigt wurde, wirst du die
gleichen Schritte für »<tt>xenocara</tt>« und »<tt>ports</tt>« durchführen.
Da alle Teile von OpenBSD synchron gehalten werden müssen, sollten alle
Bäume, die du verwendest, zur gleichen Zeit als Arbeitskopie erzeugt und
geupdated werden.
Du kannst das Erzeugen der Arbeitskopien in einer Zeile kombinieren
(<i>-stable</i> gezeigt):
<pre>
    # <b>export CVSROOT=anoncvs@anoncvs.example.org:/cvs</b>
    # <b>cd /usr</b>
    # <b>cvs -d$CVSROOT checkout -rOPENBSD_5_4 -P src ports xenocara</b>
</pre>

Updates jedoch müssen Verzeichnis für Verzeichnis durchgeführt werden.

<p>
Zu diesem Zeitpunkt, egal ob du nun <i>-stable</i> oder <i>-current</i>
gefolgt bist, solltest du einen einsetzbaren Quelltextbaum haben.
Sei sehr vorsichtig damit, welchen Baum du beziehst - es ist einfach, zu
versuchen, <i>-current</i> zu übersetzen, obwohl du in Wirklichkeit auf
<i>-stable</i> abziehlst.

<h4>Den Baum vorladen: <tt>src.tar.gz, sys.tar.gz</tt></h4>
Obwohl du den gesamten Quelltextbaum von einem AnonCVS-Server
herunterladen kannst, kannst du oft eine Menge Zeit und Bandbreite sparen,
indem du deinen Quelltextbaum mit den Quelltextdateien von der OpenBSD-CD oder
einem FTP-Server »vorlädst«.
Das ist insbesondere dann der Fall, wenn du
<a href="../../de/stable.html"><i>-stable</i></a> einsetzt, da nur
wenige Dateien zwischen dieser Version und dem <i>-release</i>, auf dem
es basiert, geändert werden.

<p>
Um den Quelltextbaum von der CD unter <i>/usr/src</i> zu entpacken
(und angenommen, dass die CD unter /mnt eingehängt wurde):
<pre>
    # <b>cd /usr/src; tar xzf /mnt/src.tar.gz</b>
    # <b>cd /usr; tar xzf /mnt/xenocara.tar.gz</b>
    # <b>cd /usr; tar xzf /mnt/ports.tar.gz</b>
</pre>

Die zum Download auf den FTP-Servern vorliegenden Quelltextdateien
befinden sich in zwei separaten Dateien, um die Downloadzeit für jene Benutzer
zu minimieren, die nur mit einem Teil des Baum arbeiten wollen.
Die beiden Dateien sind <tt>sys.tar.gz</tt>, das alle zur Erzeugung des
Betriebssystemkerns nötigen Dateien enthält, und <tt>src.tar.gz</tt>, das all
die anderen Werkzeuge des »Userlands« mit Ausnahme des Portierungsbaums und der
X11-Quellen enthält.
Generell gesagt ist es jedoch so, dass du normalerweise beide installieren
möchtest.
Angenommen, dass sich die heruntergeladenen Dateien <tt>src.tar.gz</tt>
und <tt>sys.tar.gz</tt> in <tt>/usr</tt> befinden:

<pre>
    # <b>cd /usr/src</b>
    # <b>tar xzf ../sys.tar.gz</b>
    # <b>tar xzf ../src.tar.gz</b>
    # <b>cd /usr</b>
    # <b>tar xzf xenocara.tar.gz</b>
    # <b>tar xzf ports.tar.gz</b>
</pre>

<p>
Nicht jeder möchte alle Dateisets auspacken, doch da das System synchron
gehalten werden muss, ist es generell nötig, alle Teile des Baums einzurichten.


<a name="CVSTips"></a>
<h4>Allgemeine CVS-Tipps</h4>

Wie zuvor schon beschrieben, sind einige Optionen nachgeradezu notwendig,
um einen gültigen <tt>src</tt>-Baum in OpenBSD zu erhalten.
Die oben gezeigte Option »<tt>-P</tt>« ist eine solche: Sie entfernt (»prunes«)
Verzeichnisse, die leer sind.
Über die Jahre wurden Verzeichnisse im OpenBSD Quelltextbaum erstellt und
gelöscht, und ab und zu werden die Namen von alten Verzeichnissen im Moment als
Dateinamen genutzt.
Ohne Nutzung der Option »<tt>-P</tt>« wird dein gerade erst erstellter Baum
NICHT erfolgreich übersetzt werden.

<p>
Größtenteils gilt das Gleiche für die Option »<tt>-d</tt>« des Kommandos
»update« -- es erstellt neue Verzeichnisse, die eventuell seit der ersten
Erstellung deiner lokalen Arbeitskopie zum Baum hinzugefügt worden sind.
Um ein erfolgreiches Update durchzuführen, musst du die Optionen <tt>-Pd</tt>
verwenden.

<p>
Erfahrene CVS-Anwender wundern sich vielleicht, warum CVSROOT angegeben
und in diesem Beispiel benutzt wurde, obwohl cvs(1) die Adresse des Servers
in der Arbeitskopie des Baums abspeichert.
Das ist korrekt, jedoch gibt es genug Momente, in denen man den
standardmäßigen AnonCVS-Server überschreiben muss, weshalb viele Leute
empfehlen, das Repositorium <i>immer</i> explizit anzugeben.
Es ist an dieser Stelle ebenfalls erwähnenswert, dass, obwohl die
Umgebungsvariable CVSROOT direkt von cvs(1) genutzt werden kann,
sie nur genutzt wird, wenn sie nicht von einer anderen Angabe überschrieben
wird (d.&nbsp;h., wenn cvs(1) ohne sie einen Fehler produzieren würde),
wohingegen ihre Angabe in der cvs(1)-Kommandozeile alle anderen Werte
überschreibt.

<p>
Es ist oft nützlich, eine <tt>.cvsrc</tt> in deinem Heimatverzeichnis
zu verwenden, um Standardwerte für einige dieser Optionen anzugeben.
Ein Beispiel einer solchen <tt>.cvsrc</tt>-Datei:
<pre>
    $ <b>more ~/.cvsrc</b>
    cvs -q -danoncvs@anoncvs.example.org:/cvs
    diff -up
    update -Pd
    checkout -P
</pre>

Diese Datei würde cvs(1) dazu veranlassen, den Server
<tt>anoncvs@anoncvs.example.org:/cvs</tt> zu verwenden,
für alle Operationen normalerweise unnötige Ausgaben zu unterdrücken
(»<tt>-q</tt>« steht für »quiet«, still), dass das Kommando »cvs up«
standardmäßig die Optionen <tt>-Pd</tt> nutzt, ein »cvs diff« aufgrund der
Option »<tt>-u</tt>« standardmäßig »Unified Diffs« erstellt und dass ein
»cvs checkout« die Option »<tt>-P</tt>« verwendet.
Obwohl dies praktisch ist, wirst du Probleme haben, wenn du vergisst, dass
diese Datei existiert, oder du versuchst, Kommandos auf einer Maschine
auszuführen, auf der diese Datei nicht existiert.

<p>
Da der Quelltextbaum aus einer großen Anzahl meist kleiner Dateien besteht,
wird das Aktivieren von »<a href="faq14.html#SoftUpdates">soft updates</a>«
für die Partition, auf der sich der Quelltextbaum befindet, zu einer
deutlich spürbaren Leistungssteigerung führen.


<a name="BldKernel"></a>
<h3>5.3.4 - Einen Kern erzeugen</h3>
Wir nehmen im Weiteren an, dass du einen standardmäßigen
(GENERIC oder GENERIC.MP) Kern erzeugen möchtest.
Normalerweise ist es dies, was du machen möchtest.
Ziehe <i>nicht</i> in Betracht, einen angepassten Kern zu erzeugen,
wenn du den normalen Erzeugungsprozess noch nicht im Griff hast.

<p>
Es ist offensichtlich, dass der Betriebssystemkern eine SEHR hardwareabhängige
Komponente des Systems ist.
Der Quelltext des Kerns findet sich im Verzeichnis <tt>/usr/src/sys</tt>.
Einige Teile des Kodes des OpenBSD-Betriebssystemkerns werden auf allen
Plattformen verwendet, andere sind sehr spezifisch für einen Prozessor oder
eine Architektur.
Wenn du in das Verzeichnis <tt>/usr/src/sys/arch/</tt> schaust, wirst
du eventuell Dinge sehen, die etwas verwirrend wirken - zum Beispiel
gibt es dort die Verzeichnisse <tt>mac68k</tt>, <tt>m68k</tt> und
<tt>mvme68k</tt>.
In diesem Fall verwenden die Systeme mvme68k und mac68k den gleichen Prozessor,
aber die Maschinen, auf denen sie basieren, sind sehr unterschiedlich,
und benötigen daher einen sehr unterschiedlichen Betriebssystemkern
(zu einem Computer-Design gehört mehr als nur der Prozessor!).
Jedoch gibt es auch Teile des Kerns, die diesen Architekturen gemein sind,
und diese Teile werden im Verzeichnis m68k aufbewahrt.
Wenn du einfach nur einen Kern erzeugst, so sind diese, den Basis-Architekturen
gewidmeten Verzeichnisse, wie <tt>m68k</tt>, nichts, worüber du dir Gedanken
machen musst; du wirst exklusiv mit den Verzeichnissen der wahren
»Grundarchitekturen« arbeiten, wie zum Beispiel <tt>mvme68k</tt>.

<p>
Betriebssystemkerne werden basierend auf den
<a href="#Options">Kern-Konfigurationsdateien</a> erzeugt, die sich in dem
Verzeichnis befinden, das dem Namensschema
<tt>/usr/src/sys/arch/&lt;<i>deine Plattform</i>&gt;/conf</tt> folgt.
Das Erzeugen des Kerns besteht aus dem Verwenden des Programms
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8"
>config(8)</a>, dass ein Übersetzungsverzeichnis des Kerns erzeugt und
populiert, und zwar folgend dem Schema
<tt>/usr/src/sys/arch/&lt;<i>deine Plattform</i>&gt;/compile/&lt;<i>KernName</i>&gt;</tt>.
Für dieses Beispiel nehmen wir an, dass du die i386-Plattform verwendest.

<blockquote><pre>
# <b>cd /usr/src/sys/arch/i386/conf</b>
# <b>config GENERIC</b>
# <b>cd ../compile/GENERIC</b>
# <b>make clean && make</b>
    <i>[... jede Menge Ausgabe ...]</i>
# <b>make install</b>
</pre></blockquote>

Ersetze das »<tt>i386</tt>« in der ersten Zeile mit dem Namen deiner Plattform.
Das Kommando
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=machine&amp;sektion=1">machine(1)</a>
kann dir sagen, wie der Name deiner Plattform lautet, sodass eine
offensichtliche Generalisierung die Nutzung des Kommandos
»<tt>cd /usr/src/sys/arch/`machine`/conf</tt>« anstelle der ersten Zeile wäre.

<p>
Starte an diesem Punkt deine Maschine neu, um den neuen Kern zu aktivieren.
Beachte, dass der neue Betriebssystemkern vor dem nächsten Schritt laufen
sollte, obwohl es, solltest du <a href="#BldBinary">obigem</a> Ratschlag
gefolgt sein, auf den am nächsten liegenden Schnappschuss upzugraden, nicht
ganz so wichtig sein muss.
Manchmal jedoch ändern sich die APIs und der alte Kern wird nicht in der Lage
sein, neue Anwendungen auszuführen, der neue Kern aber normalerweise die
alten unterstützen.

<p>
Denke daran, dass du einen Kern ohne root-Zugriff erzeugen kannst,
aber du musst root sein, um den Kern zu installieren.


<a name="BldUserland"></a>
<h3>5.3.5 - Das Userland erzeugen</h3>

Dafür gibt es einen spezifischen, von OpenBSD benutzten Ablauf.
Von anderen Betriebssystemen benutzte Abläufe, mit denen du vertraut bist,
werden vermutlich mit OpenBSD nicht funktionieren, und du wirst ausgelacht
werden, solltest du fragen, warum.

<p>
<ul>
<li>Leere dein <tt>/usr/obj</tt>-Verzeichnis und erstelle die
symbolischen Links neu:
<blockquote><pre>
# <b>rm -rf /usr/obj/*</b>
# <b>cd /usr/src</b>
# <b>make obj</b>
</pre></blockquote>

Beachte, dass die Verwendung des Verzeichnisses <tt>/usr/obj</tt>
vorgeschrieben ist.
Solltest du diesen Schritt versäumen, bevor du den Rest des Baums erzeugst,
so wird sich der Zustand deines <tt>src</tt>-Baums durchaus verschlimmbessern.

<p>
<li>Stelle sicher, dass alle passenden Verzeichnisse erstellt werden.
<blockquote><pre>
# <b>cd /usr/src/etc && env DESTDIR=/ make distrib-dirs</b>
</pre></blockquote>

<p>
<li>Erzeuge das System:
<blockquote><pre>
# <b>cd /usr/src</b>
# <b>make build</b>
</pre></blockquote>
Dies übersetzt und installiert die Werkzeuge des »Userlands« in der passenden
Reihenfolge.
Dieser Schritt nimmt recht viel Zeit in Anspruch - eine sehr schnelle
Maschine kann ihn in unter einer Stunde abschließen, eine sehr langsame
Maschine benötigt vielleicht viele Tage.
Wenn dieser Schritt abgeschlossen ist, hast du neu übersetzte Binärdatei
auf deinem System installiert.

<p>
<li><b>Wenn <i>-current</i> erzeugt wird:</b> Update <tt>/dev</tt> und
<tt>/etc</tt> mit den Änderungen, die in
<a href="../current.html">current.html</a> aufgelistet sind.
Wenn -stable nach einem korrekt durchgeführtem
<a href="../upgrade54.html">Upgradeprozess</a> oder einer Installation
der <a href="#BldBinary">ordentlich startenden Binärdatei</a>
gefolgt wird, ist dieser Schritt weder notwendig noch erwünscht.

</ul>


<a name="Release"></a>
<a name="BldRelease"></a> <!-- old tag -->
<h2>5.4 - Ein Release erstellen</h2>
<h3>Was ist ein »Release«, und warum würde ich eines erstellen wollen?</h3>

Ein Release bezeichnet einen kompletten Satz an Dateien, der verwendet werden
kann, um OpenBSD auf einem anderen Rechner zu installieren.
Wenn du nur einen Computer hast, auf dem OpenBSD läuft, hast du wirklich keinen
Grund, ein Release zu erstellen, da der <a href="#Bld">obige</a>
Erzeugungsprozess alles produziert, was du brauchst.
Eine Beispielanwendung für den Releaseprozess wäre das Erzeugen von
<i>-stable</i> auf einer schnellen Maschine, gefolgt von der Erstellung eines
Release, das dann auf alle deine Maschinen in deinem Büro installiert werden
kann.

<p>
Der Releaseprozess verwendet die Binärdateien, die während des obigen
Erzeugungsprozesses im Verzeichnis <tt>/usr/obj</tt> erstellt wurden,
sodass du diesen Schritt zuerst erfolgreich abschließen musst,
und nichts darf das Verzeichnis <tt>/usr/obj</tt> in Unordnung bringen.
Eine Situation, in der das ein Problem sein könnte, ist, wenn du ein
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mount_mfs&amp;sektion=8"
>speicherbasiertes Laufwerk</a> als <tt>/usr/obj</tt> verwendest, für ein klein
wenig Extraleistung während des Erzeugungsprozesses, in welchem Falle du
sicherlich keinen Systemneustart zwischen »Erzeugung« und »Release« durchführen
möchtest.

<p>
Der Releaseprozess erfordert zwei Arbeitsverzeichnisse, welche wir
DESTDIR und RELEASEDIR nennen werden.
Alle Dateien, die Teil einer »sauberen« OpenBSD-Installation sind,
werden an ihre richtige Stelle im DESTDIR kopiert.
Sie werden dann getar(1)t und im RELEASEDIR platziert.
Am Ende des Prozesses wird RELEASEDIR ein vollständiges Release von OpenBSD
enthalten.
Der Releaseprozess wird ebenfalls den Einhängepunkt <tt>/mnt</tt> verwenden,
sodass dieser Ort für keine anderen Dinge während des Releaseprozesses
genutzt werden sollte.
Zum Zwecke eines Beispiels werden wir nun DESTDIR mit dem Wert
<tt>/usr/dest</tt> und RELEASEDIR mit <tt>/usr/rel</tt> verwenden.


<p>
Der Releaseprozess bezieht ein Werkzeug mit ein,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=crunchgen&amp;sektion=8"
>crunchgen(8)</a>, das benutzt wird, um eine einzige ausführbare Datei aus
vielen einzelnen ausführbaren Binärdateien zu erzeugen.
Der Name, mit dem diese einzelne Binärdatei aufgerufen wird, entscheidet,
welche Binärdatei-Komponente ausgeführt wird.
Dies ist die Art und Weise, wie individuelle Programme in den RAM-Laufwerkskern
gequetscht werden, der auf Systemstartdisketten und anderen Systemstartmedien
vorliegt.

<p>
Du musst root-Privilegien haben, um ein Release zu erstellen.

<p>
<h3>Release-Erstellung</h3>

Definieren der Umgebungsvariablen DESTDIR und RELEASEDIR:
<blockquote><pre>
# <b>export DESTDIR=/usr/dest</b>
# <b>export RELEASEDIR=/usr/rel</b>
</pre></blockquote>

Wir leeren nun das DESTDIR und erstellen die Verzeichnisse, sollte dies nötig
sein:
<blockquote><pre>
# <b>test -d ${DESTDIR} && mv ${DESTDIR} ${DESTDIR}.old && rm -rf ${DESTDIR}.old &</b>
# <b>mkdir -p ${DESTDIR} ${RELEASEDIR}</b>
</pre></blockquote>

RELEASEDIR muss normalerweise vor dem Beginn des Releaseprozesses nicht 
leer sein, jedoch könnten alte Dateien herumliegen bleiben, sollten sich
Änderungen in den Dateien des Release oder ihren Namen ergeben haben.
Du könntest den Wunsch verspüren, dieses Verzeichnis ebenfalls zu löschen,
bevor es losgeht.

<p>
Wir erstellen nun das eigentliche Release:
<blockquote><pre>
# <b>cd /usr/src/etc</b>
# <b>make release</b>
</pre></blockquote>

Nachdem das Release erstellt wurde, ist es eine gute Idee, das Release zu
überprüfen, um sicherzustellen, dass die tar-Dateien mit dem übereinstimmen,
was sich im Verzeichnis DESTDIR befindet.
Die Ausgabe dieses Schritts sollte äußerst minimal sein.

<blockquote><pre>
# <b>cd /usr/src/distrib/sets</b>
# <b>sh checkflist</b>
</pre></blockquote>

Du hast nun vollständige und überprüfte Dateisets innerhalb des RELEASEDIR.
Diese Dateien können nun verwendet werden, um OpenBSD auf anderen Maschinen zu
installieren oder upzugraden.

<p>
Die verbindlichen Anweisungen, wie man ein Release erstellt, finden sich in
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=release&amp;sektion=8"
>release(8)</a>.

<p>
Hinweis: Wenn du die daraus resultierenden Dateien über HTTP für
die Upgrade- und Installationsskripte zur Verfügung stellen willst,
musst du eine index.txt-Datei hinzufügen, in der eine Liste aller
Dateien enthalten ist, die sich in deinem neu erzeugten Release
befinden.
<blockquote><pre>
# <b>/bin/ls -1 >index.txt</b>
</pre></blockquote>

Sobald ein komplettes Release erzeugt wurde, kann man diese Dateien für eine
Standard<a href="faq4.html">installation</a> oder das
<a href="../upgrade54.html">Upgrade</a> einer anderen Maschine nutzen,
oder, wenn man eine Maschine auf einen neuen <i>-stable</i> aktualisiert,
kann man einfach die tar-Dateien im Wurzelverzeichnis der Zielmaschine
<a href="faq4.html#AddFileSet">auspacken</a>.

<a name="Xbld"></a>
<h2>5.5 - X erzeugen (Xenocara)</h2>
Beginnend mit <a href="http://x.org/">X.org v7</a> stellte X auf ein
System zur »modularen Erzeugung« um, was zur Folge hatte, dass der
Quelltext von X.org in über dreihundert mehr oder weniger unabhängige
Pakete zerlegt worden ist.

<p>
Um das Leben der OpenBSD-Anwender zu vereinfachen, wurde eine
»Meta-Erzeuger« mit dem Namen <a href="http://xenocara.org">Xenocara</a>
entwickelt.
Dieses System »konvertiert« X zurück in einen großen Baum, der mit einem
Arbeitsschritt übersetzt wird.
Als zusätzliches Bonbon ist dieser Erzeugungsschritt dem Erzeugungsprozess des
Rests von OpenBSD sehr viel ähnlicher, als es die früheren Versionen waren.

<p>
Die offiziellen Instruktionen für die Erzeugung von X befinden sich auf deinem
System in der Datei <tt>/usr/xenocara/README</tt> und in
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=release&amp;sektion=8"
>release(8)</a>.

<h3>Den Quelltext beziehen</h3>
Der »übliche« Ort für den xenocara-Quelltextbaum ist
<tt>/usr/xenocara</tt> und der Quelltext selbst befindet sich im
CVS-Modul <tt>xenocara</tt>.
Eine Arbeitskopie wird wie folgt erstellt:
<blockquote><pre>
$ <b>cd /usr</b>
$ <b>cvs -qdanoncvs@anoncvs.example.org:/cvs checkout -P xenocara</b>
</pre></blockquote>

<h3>Xenocara erzeugen</h3>
Für die Erzeugung des standardmäßigen Xenocara-Baums, wie er von
OpenBSD unterstützt wird, werden keine weiteren Werkzeuge benötigt.

<blockquote><pre>
# <b>cd /usr/xenocara</b>
# <b>rm -rf /usr/xobj/*</b>
# <b>make bootstrap</b>
# <b>make obj</b>
# <b>make build</b>
</pre></blockquote>

Wenn du tatsächlich Änderungen am Quelltext vornehmen möchtest, dann
wirst du sehr wahrscheinlich einige <a href="faq15.html">Pakete</a>
zusätzlich installieren müssen.
Details hierüber befinden sich in der Datei <tt>/usr/xenocara/README</tt>.

<h3>Ein Release erstellen</h3>
Dies ist dem Releaseprozess des Hauptsystems sehr ähnlich.
Nach dem erfolgreichen Erzeugen von X wirst du DESTDIR und RELEASEDIR
aus dem gleichen Grund erzeugen wie oben erläutert.
RELEASEDIR kann das gleiche Verzeichnis sein wie das RELEASEDIR des
Hauptsystems, aber während dieses Prozesses wird DESTDIR gelöscht und wieder
neu erstellt.
Wenn es vorsichtig angestellt wird, ist dies kein Problem, aber
separate DESTDIRs zu verwenden, kann »sicherer« sein.

<p>
Für dieses Beispiel werden wir DESTDIR und RELEASEDIR mit den respektiven
Werten /usr/dest und /usr/rel nutzen.
Dies muss nach obigem Erzeugungsprozess geschehen.

<blockquote><pre>
# <b>export DESTDIR=/usr/dest</b>
# <b>export RELEASEDIR=/usr/rel</b>
# <b>test -d ${DESTDIR} && mv ${DESTDIR} ${DESTDIR}- && \</b>
  <b>   rm -rf ${DESTDIR}- &</b>
# <b>mkdir -p ${DESTDIR} ${RELEASEDIR}</b>
# <b>make release</b>
</pre></blockquote>

Wenn dieser Prozess abgeschlossen ist, wirst du ein Set der
Releasedateien im $RELEASEDIR haben.

<p>
<a name="Why"></a>
<h2>5.6 - Warum brauche ich einen selbst erstellten Kern?</h2>

<p>
In der Tat brauchst du ihn wahrscheinlich nicht.

<p>
Ein angepasster Kern ist ein Betriebssystemkern, der mit einer anderen
Konfigurationsdatei als der bereitgestellten Konfigurationsdatei
<tt>GENERIC</tt> erstellt wurde.
Ein angepasster Kern kann auf Quelltext der Aromata
<a href="#Flavors"><i>-release-, -stable-</i> oder <i>-current</i></a>
basieren, genauso wie der <tt>GENERIC</tt> es tun kann.
Während das Übersetzen deines eigenen <tt>GENERIC</tt>-Kerns vom OpenBSD-Team
unterstützt wird, so wird es die Übersetzung deines selbst angepassten
Betriebssystemkerns <i>nicht</i>.

<p>
Die standardmäßige OpenBSD-Kernkonfiguration (<tt>GENERIC</tt>)
ist dafür entworfen, für die meisten Leute brauchbar zu sein.
Es gibt mehr Leute, die ihr System bei dem Versuch, den Kern zu optimieren,
ruiniert haben, als solche, die damit ihre Systemfunktion verbessert haben.
Es gibt einige Leute, die glauben, dass du deinen Kern anpassen musst, um
die optimale Leistung zu erhalten, doch das stimmt für OpenBSD nicht.
Nur die fortgeschrittensten und erfahrensten Anwender mit den
anspruchsvollsten Anwendungen müssen sich Gedanken über einen angepassten Kern
oder ein angepasstes System machen.

<p>
Einige Gründe, warum du vielleicht einen angepassten Kern erzeugen
möchtest oder musst:
<ul>
  <li>Du weißt tatsächlich was du tust, und möchtest
      OpenBSD für einen Computer zurechtschustern, der nur über
      sehr wenig RAM verfügt, indem du Gerätetreiber entfernst,
      die du nicht benötigst.
  <li>Du weißt tatsächlich was du tust, und möchtest
      standardmäßig aktivierte Optionen, oder Optionen, die
      (aus gutem Grund) normalerweise nicht aktiviert sind, aktivieren.
  <li>Du weißt tatsächlich was du tust, und möchtest
      experimentelle Optionen aktivieren.
  <li>Du weißt tatsächlich was du tust, und hast eine spezielle Erfordernis zu
      bedienen, die von <tt>GENERIC</tt> nicht befriedigt wird,
      und hast nicht vor zu fragen, warum es nicht klappt, wenn irgendetwas
      schief läuft.
</ul>

<p>
Einige Gründe, warum du keinen eigenen, angepassten Kern erzeugen
solltest:
<ul>
  <li>Du hast keinen Grund dafür, normalerweise.
  <li>Du wirst kein schnelleres System erhalten.
  <li>Du wirst wahrscheinlich ein weniger zuverlässiges System erzeugen.
  <li>Du wirst keinerlei Unterstützung der Entwickler erhalten.
  <li>Es wird von dir erwartet, dass du jegliches Problem mit einem
      <tt>GENERIC</tt>-Kern reproduzieren kannst, bevor Entwickler
      irgendeine Fehlermeldung ernst nehmen.
  <li>Anwender und Entwickler werden dich auslachen, wenn du dein System
      zerschießt.
  <li>Angepasste Übersetzeroptionen sind normalerweise besser dafür geeignet,
      Übersetzerprobleme aufzuzeigen, als die Systemgeschwindigkeit zu erhöhen.

</ul>

<p>
Das Entfernen von Gerätetreibern mag den Systemstart deines Systems
beschleunigen, kann aber die Wiederherstellung erschweren, wenn du ein Problem
mit der Hardware hast, und wird meistens falsch gemacht.
Das Entfernen der Gerätetreiber <i>wird nicht</i> dazu beitragen,
dass dein System spürbar schneller wird, obwohl es einen kleineren
Kern erzeugt.
Das Entfernen von Debuginformationen und Fehlerüberprüfungsroutinen kann das
System spürbar beschleunigen, doch wird es die Untersuchung eines Systems
unmöglich machen, wenn etwas schief geht.


<p>
Es sei an dieser Stelle noch einmal erwähnt, dass Entwickler
normalerweise Fehlerberichte ignorieren, außer wenn sie ebenfalls
mit einem <tt>GENERIC</tt>-Kern hervorgerufen werden können.
Du wurdest gewarnt.

<p>
<a name="Options"></a>
<h2>5.7 - Einen angepassten Kern erzeugen</h2>

Es wird angenommen, dass du das <a href="#Why">Vorherige</a> gelesen
hast und wirklich auf Schmerzen stehst.
Es wird des Weiteren angenommen, dass du ein Ziel hast, das man
weder durch die
<a href="#BootConfig">Konfiguration während des Systemstarts (UKC>)</a>,
noch durch die
<a href="#config">config(8)uration eines GENERIC-Kerns</a> erreicht
werden kann.
Wenn diese Annahmen falsch sind, solltest du weiterhin bei GENERIC verbleiben.

<p>
Die Generierung des OpenBSD-Betriebssystemkerns wird über Konfigurationsdateien
gesteuert, die sich standardmäßig im Verzeichnis
<tt>/usr/src/sys/arch/<i>&lt;arch&gt;</i>/conf/</tt> befinden.
Alle Architekturen haben eine Datei namens <tt>GENERIC</tt>, die verwendet wird,
um den standardmäßigen OpenBSD-Betriebssystemkern für diese Architektur zu
erzeugen.
Dort können sich ebenfalls andere Konfigurationsdateien befinden, die Kerne
erzeugen, die andere Ziele verfolgen, zum Beispiel minimalen Speicherbedarf,
Workstations ohne Laufwerke etc.

<p>
Die Konfigurationsdatei wird von
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8"
>config(8)</a> verarbeitet, das ein für die Übersetzung gedachtes Verzeichnis
in <tt>../compile</tt> erstellt und populiert;
bei einer typischen Installation wäre es in
<tt>/usr/src/sys/arch/<i>&lt;arch&gt;</i>/compile/</tt>.
config(8) erstellt ebenfalls ein
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=make&amp;sektion=1"
>Makefile</a> und weitere Dateien, die für eine erfolgreiche Erzeugung
des Kerns notwendig sind.

<p>
Kern-Konfigurationsoptionen sind Optionen, die du zu deiner Kernkonfiguration
hinzufügst und die bestimmte Eigenschaften oder Funktionen des Kerns
bereitstellen.
Dies erlaubt dir die von dir gewünschte Unterstützung exakt zu definieren
und unnötige Geräte außen vor zu lassen.
Es gibt eine Vielzahl an Möglichkeiten, deinen Kern auf deine Wünsche
abzustimmen.
Hier werden wir nur auf einige der am häufigsten benutzten Möglichkeiten
eingehen.
Lies die Handbuchseite
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=options&amp;sektion=4"
>options(4)</a> für eine komplette Liste der Optionen und, da sich diese
von Zeit zu Zeit ändern, solltest du sicherstellen, dass es die Handbuchseite
für die gleiche Version von OpenBSD ist, die du erzeugst.
Du kannst auch die Beispielkonfigurationsdateien zu Rate ziehen, die für deine
Architektur zur Verfügung stehen.

<p>
<b>Ändere, entferne oder füge niemals Optionen hinzu, wenn du
keinen triftigen Grund dazu hast!
Editiere nicht die Konfigurationsdatei <tt>GENERIC</tt>!!</b>
Die einzige Kernkonfiguration, die vom OpenBSD-Team unterstützt wird,
ist der GENERIC-Kern, der eine Kombination der Optionen in
<tt>/usr/src/sys/arch/&lt;<i>arch</i>&gt;/conf/GENERIC</tt> und
<tt>/usr/src/sys/conf/GENERIC</tt> ist, <i>so, wie sie vom OpenBSD-Team
bereit gestellt worden sind</i> (d.&nbsp;h. NICHT verändert).
Ein Fehlerbericht, der mit einem modifizierten Kern zustande kam,
resultiert meistens darin, dass dir gesagt wird, dass du versuchen sollst, das
Problem mit einem GENERIC-Kern zu reproduzieren.
Nicht alle Optionen sind untereinander kompatibel und viele Optionen sind
notwendig, damit das System läuft.
Es gibt keine Garantie, dass ein Kern läuft, nur weil du ihn übersetzen
konntest.
Es gibt außerdem keine Garantie, dass ein Kern, der »config(8)uriert« werden
konnte, auch erzeugt werden kann.

<p>
Hier kannst du die plattformspezifischen Konfigurationsdateien sehen:
<ul>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/alpha/conf/">alpha Kernkonfgurationsdateien</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/i386/conf/">i386 Kernkonfigurationsdateien</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/macppc/conf/">macppc Kernkonfigurationsdateien</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/sparc/conf/">sparc Kernkonfigurationsdateien</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/sparc64/conf/">sparc64 Kernkonfigurationsdateien</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/vax/conf/">vax Kernkonfigurationsdateien</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/hppa/conf/">hppa Kernkonfigurationsdateien</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/">Andere Architekturen</a>
</ul>

<p>
Wenn du diese Dateien genauer betrachtest, dann wird dir am Anfang
eine Zeile ähnlich dieser auffallen:
<pre>
     include "../../../conf/GENERIC"
</pre>
Das bedeutet, dass ein Verweis auf eine andere Konfigurationsdatei vorhanden
ist, eine, die plattformunabhängige Optionen enthält.
Wenn du also deinen eigenen Kern konfigurieren willst, so stelle sicher, dass
du auch
<a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/conf/GENERIC"
>/sys/conf/GENERIC</a> durchgeschaut hast.
<p>
Betriebsystemkern-Konfigurationsoptionen sollten in deiner
Kernkonfigurationsdatei in folgenden Formaten angeführt werden:
<blockquote>
<tt>option&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt><i>Name</i>
</blockquote>
oder
<blockquote><pre>
<tt>option&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt><i>Name=Wert</i>
</pre></blockquote>

Um beispielsweise die Option »DEBUG« in den Kern einzubringen,
füge eine Zeile wie die folgende ein:
<blockquote><pre>
option      DEBUG
</pre></blockquote>

Die Optionen im OpenBSD-Kern werden in Übersetzer-Präprozessoroptionen
transformiert, weshalb die Angabe einer Option wie DEBUG den Quelltext mit der
Option -DDEBUG übersetzen wird, entsprechend einem <tt>#define DEBUG</tt> im
Kern.

<p>
Manchmal möchtest du vielleicht Optionen deaktivieren, die bereits definiert
sind, typischerweise in der Datei <tt>src/sys/conf/GENERIC</tt>.
Obwohl du eine Kopie dieser Datei verändern könntest, ist das Verwenden der
Angabe <i>rmoption</i> eine bessere Wahl.
Falls du zum Beispiel den im Kern befindlichen Debugger deaktivieren möchtest
(<i>nicht empfohlen!</i>), würdest du eine Zeile wie diese:
<pre>
     rmoption DDB
</pre>
in deine Kernkonfigurationsdatei hinzufügen.
<tt>option DDB</tt> ist in <tt>src/sys/conf/GENERIC</tt> definiert, aber die
oben angegebene Zeile <tt>rmoption</tt> deaktiviert sie wieder.

<p>
Noch einmal, bitte lies
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=options&amp;sektion=4"
>options(4)</a> für weitere Informationen über die Besonderheiten dieser
Optionen.
Beachte auch, dass viele dieser Optionen ihre eigenen Handbuchseiten haben
- lies immer alles, was über eine Option verfügbar ist, bevor du sie zu deinem
Kern hinzufügst oder aus ihm entfernst.

<p>
<h3>Einen angepassten Kern erzeugen</h3>

In diesem Fall werden wir einen Kern erzeugen, der die
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boca&amp;sektion=4"
>boca(4)</a> Serielle-Mehrfachport ISA-Karte unterstützt.
Diese Karte ist aufgrund von Konflikten mit anderen Treibern nicht im
Kern GENERIC vorhanden.
Es gibt zwei typische Wege, einen angepassten Kern zu erzeugen:
kopiere die Konfigurationsdatei GENERIC und editiere sie unter einem anderen
Name, oder erstelle eine »Dateihülse«, die die normale
GENERIC-Kernkonfiguration »einbindet« und des weiteren alle von dir gebrauchten
Optionen enthält.
In folgendem Fall sieht unsere Dateihülse dergestalt aus:
<blockquote><pre>
include "arch/i386/conf/GENERIC"

boca0  at       isa? port 0x100 irq 10     # BOCA 8-port serial cards
com*   at       boca? slave ?
</pre></blockquote>

Die zwei Zeilen bezüglich der boca(4)-Karte wurden von den
auskommentierten Zeilen in <tt>GENERIC</tt> kopiert,
jedoch wurde der IRQ den eigenen Bedürfnissen angepasst.
Der Vorteil der Nutzung einer Hülsendatei ist es, dass Änderungen an GENERIC
automatisch aktualisiert werden, und damit im Einklang mit Änderungen am
übrigen Quelltext bleiben.
Der Nachteil ist, dass man Geräte nicht entfernen kann (obwohl das, generell
gesagt, sowieso eine schlechte Idee ist).

<p>
Der andere Weg, einen angepassten Kern zu generieren, ist, eine
Kopie der standardmäßigen <tt>GENERIC</tt> zu machen, ihr einen
anderen Namen zu geben und dann den eigenen Bedürfnissen anzupassen.
Der Nachteil dabei ist, dass spätere Updates der Konfigurationsdatei GENERIC
manuell in deine Kopie übertragen werden müssen,
oder aber du musst deine Konfigurationsdatei neu erstellen.

<p>
In alle Fällen gilt, dass du, nachdem du deine angepasste
Kernkonfigurationsdatei erstellt hast, config(1) benutzen und dann den
Kern wie <a href="#BldKernel">oben</a> beschrieben erzeugen kannst.

<p>
Vollständige Instruktionen zum Erstellen deines eigenen angepassten
Kerns finden sich auf der Handbuchseite
<a href= "http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8#EXAMPLES+(kernel"
>config(8)</a>.

<a name="BootConfig"></a>
<h2>5.8 - Konfiguration während des Systemstarts</h2>

<p>
Manchmal wird dir, wenn du dein System startest, auffallen, dass der
Betriebssystemkern dein Gerät zwar findet, es aber vielleicht dem falschen
IRQ zugewiesen ist.
Und vielleicht brauchst du dieses Gerät sofort.
Nun, ohne den Kern neu zu bauen kannst du OpenBSDs
Systemstart-Kernkonfiguration benutzen.
Dies wird dein Problem unmittelbar für jetzt lösen.
Startest du neu, so musst du diesen Schritt wiederholen.
Dies ist also nur eine vorübergehende Lösung,
und du solltest das Problem durch Nutzung von <a href="#config">config(8)</a>
korrigieren.
Dafür benötigt dein Kern jedoch die <strong>option BOOT_CONFIG</strong>, die
in GENERIC gesetzt ist.

<p>
Der Großteil dieses Dokumentes kann auf der Handbuchseite
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot_config&amp;sektion=8"
>boot_config(8)</a> gefunden werden.

<p>
Um in die Benutzer-Kern-Konfiguration, kurz UKC (»User Kernel Config«) zu
gelangen, musst du den Systemstart mit der Option -c ausführen.

<blockquote><pre>
boot&gt; <strong>boot hd0a:/bsd -c</strong>
</pre></blockquote>

Oder welchen Kern du auch immer starten möchtest.
Tust du dies, so wird ein UKC-Prompt erscheinen.
Hier kannst du Kommandos direkt an den Kern absetzen, Geräte spezifizieren,
die du ändern, deaktivieren oder sogar aktivieren möchtest.

<p>
Hier eine Liste der gängigen Befehle der UKC.

<ul>
<li><tt>add <strong>device</strong></tt> -
    Füge ein Gerät durch Kopieren eines anderen Geräts hinzu.
<li><tt>change <strong>devno | device </strong></tt> -
    Ändere ein oder mehrere Geräte.
<li><tt>disable <strong>devno | device </strong></tt> -
    Deaktiviere ein oder mehrere Geräte.
<li><tt>enable <strong>devno | device </strong></tt> -
    Aktiviere ein oder mehrere Geräte.
<li><tt>find <strong>devno | device </strong></tt> -
    Suche ein oder mehrere Geräte.
<li><tt>help</tt> - Kurze Zusammenfassung dieser Befehle.
<li><tt>list</tt> - Liste ALLE bekannten Geräte auf.
<li><tt>exit/quit</tt> - Setze das Starten fort.
<li><tt>show <strong>[attr [val]]</strong></tt> -
    Zeige alle Geräte mit Eigenschaft (attr)
    und optional mit einem angegebenen Wert (val).
</ul>

<p>
Wenn du deinen Kern fertig konfiguriert hast, nutze <tt>quit</tt> oder
<tt>exit</tt> und setze den Systemstart fort.
Danach solltest du deine Änderung am Kernabbild permanent machen, indem du die
Schritte ausführst, die in
<a href="#config">Mittels config(8) deinen Kern verändern</a>
beschrieben sind.

<p>
<a name="config"></a>
<h2>5.9 - Mittels config(8) deinen Kern verändern</h2>
<p>
Die Optionen <b>-e</b> und <b>-u</b> von
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8"
>config(8)</a> können äußerst hilfreich sein und wertvolle Zeit sparen,
die du mit dem Übersetzen deines Kerns verschwenden würdest.
Die Option <b>-e</b> erlaubt dir die Benutzer-Kern-Konfiguration, kurz UKC
(»User Kernel Config«), auf einem laufenden System zu nutzen.
Diese Änderungen werden dann beim nächsten Systemstart wirksam.
Die Option <b>-u</b> testet, ob irgendwelche Änderungen am laufenden Kern
während des Systemstarts gemacht wurden, d.&nbsp;h., ob du mittels
<b>boot -c</b> die UKC beim Starten benutzt hast.

<p>
Das folgende Beispiel zeigt das Deaktivieren der ep*-Geräte im Kern.
Zur Sicherheit musst du die Option <b>-o</b> benutzen, die die Änderung in die
angegebene Datei schreibt.
Zum Beispiel: <strong>config -e -o bsd.new /bsd</strong> wird die Änderungen in
bsd.new schreiben.
Das folgende Beispiel verwendet die Option <b>-o</b> nicht, daher werden die
Änderungen einfach ignoriert und nicht zurück in die Kernbinärdatei
geschrieben.
Für weitere Informationen über Fehler- und Warnmeldungen lies die Handbuchseite
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8"
>config(8)</a>.

<!--XXXver -->
<blockquote><pre>
$ <strong>sudo config -e /bsd</strong>
WARNING: no output file specified
OpenBSD 5.4 (GENERIC) #37: Tue Jul 30 12:05:01 MDT 2013
    deraadt@i386.openbsd.org:/usr/src/sys/arch/i386/compile/GENERIC
Enter 'help' for information
ukc&gt; <strong>?</strong>
        help                                Command help list
        add             dev                 Add a device
        base            8|10|16             Base on large numbers
        change          devno|dev           Change device
        disable         attr val|devno|dev  Disable device
        enable          attr val|devno|dev  Enable device
        find            devno|dev           Find device
        list                                List configuration
        lines           count               # of lines per page
        show            [attr [val]]        Show attribute
        exit                                Exit, without saving changes
        quit                                Quit, saving current changes
        timezone        [mins [dst]]        Show/change timezone
        bufcachepercent [number]            Show/change BUFCACHEPERCENT
        nkmempg         [number]            Show/change NKMEMPAGES
ukc&gt; <strong>list</strong>
  0 video* at uvideo* flags 0x0
  1 audio* at uaudio*|sb0|sb*|gus0|pas0|ess*|wss0|wss*|ym*|eap*|envy*|eso*|sv*|n
eo*|cmpci*|clcs*|clct*|auacer*|auglx*|auich*|auixp*|autri*|auvia*|azalia*|fms*|m
aestro*|esa*|yds*|emu* flags 0x0
  2 midi* at umidi*|sb0|sb*|ym*|mpu*|mpu*|autri*|eap*|envy* flags 0x0
  3 drm* at inteldrm*|radeondrm* flags 0x0
  4 inteldrm* at vga0|vga* flags 0x0
  5 radeondrm* at vga0|vga* flags 0x0
  6 radio* at udsbr*|bktr0|fms* flags 0x0
  7 vscsi0 at root flags 0x0
  8 softraid0 at root flags 0x0
  9 nsphy* at url*|udav*|mos*|axe*|aue*|xe*|ef*|hme*|lii*|bce*|ale*|alc*|age*|jm
e*|et*|nfe*|stge*|vge*|bnx*|bge*|lge*|nge*|msk*|sk*|ste*|se*|sis*|wb*|tl*|vte*|v
r*|pcn*|sf*|ti*|gem*|ne0|ne1|ne2|ne*|ne*|ne*|epic*|sm0|sm*|dc*|dc*|re*|re*|rl*|r
l*|mtd*|fxp*|fxp*|xl*|xl*|ep0|ep*|ep*|ep*|ep*|ep* phy -1 flags 0x0
 10 nsphyter* at url*|udav*|mos*|axe*|aue*|xe*|ef*|hme*|lii*|bce*|ale*|alc*|age*
|jme*|et*|nfe*|stge*|vge*|bnx*|bge*|lge*|nge*|msk*|sk*|ste*|se*|sis*|wb*|tl*|vte
*|vr*|pcn*|sf*|ti*|gem*|ne0|ne1|ne2|ne*|ne*|ne*|epic*|sm0|sm*|dc*|dc*|re*|re*|rl
*|rl*|mtd*|fxp*|fxp*|xl*|xl*|ep0|ep*|ep*|ep*|ep*|ep* phy -1 flags 0x0
[...snip...]
ukc&gt; <strong>disable ep</strong>
 95 ep* disabled
 96 ep* disabled
281 ep0 disabled
282 ep* disabled
283 ep* disabled
340 ep* disabled
ukc&gt; <strong>quit</strong>
not forced
</pre></blockquote>

<p>
Im obigen Beispiel werden alle ep* Geräte im Kern deaktiviert und
es wird auch nicht getestet, ob sie überhaupt vorhanden sind.
In einigen Situationen, in denen du die UKC beim Systemstart via <b>boot -c</b>
benutzt hast, wird die Notwendigkeit bestehen, diese Änderungen dauerhaft
einzubringen.
Für diesen Zweck musst du die Option <b>-u</b> benutzen.
Im folgenden Beispiel wurde der Computer in die UKC gestartet und das Gerät
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=wi&amp;sektion=4"
>wi(4)</a> deaktiviert.
Da diese Änderung mit boot -c NICHT dauerhaft ist, müssen die Änderungen erst
geschrieben werden.
Dieses Beispiel schreibt die Änderung von boot -c in eine neue Kernbinärdatei
namens bsd.new.

<blockquote><pre>
$ <strong>sudo config -e -u -o bsd.new /bsd</strong>
OpenBSD 5.4 (GENERIC) #37: Tue Jul 30 12:05:01 MDT 2013
    deraadt@i386.openbsd.org:/usr/src/sys/arch/i386/compile/GENERIC
Processing history...
161 wi* disabled
162 wi* disabled
417 wi* disabled
Enter 'help' for information
ukc&gt; <strong>quit</strong>
</pre></blockquote>


<a name="VerboseBoot"></a>
<h2>5.10 - Ausführlichere Meldungen während des Systemstarts erhalten</h2>

Ausführlichere Meldungen zu erhalten kann sehr hilfreich sein, wenn
man versucht, Probleme während des Systemstarts zu beheben.
Wenn du in einer Problemsituation steckst, in der deine Systemstartdiskette
nicht startet, und du mehr Informationen benötigst, so starte einfach neu.
Am »boot&gt;«-Prompt angelangt, starte mit boot -c.
Dies bringt dich in die UKC&gt;, wo du dann Folgendes eingibst:

<blockquote><pre>
UKC&gt; <strong>verbose</strong>
autoconf verbose enabled
UKC&gt; <strong>quit</strong>
</pre></blockquote>

<p>
Nun wirst du äußerst ausführliche Meldungen während des Systemstarts erhalten.


<p>
<a name="buildprobs"></a>
<h2>5.11 - Häufige Probleme, Tipps und Fragen zum Übersetzen und Erzeugen</h2>

Meistens werden Probleme während des Erzeugungsprozesses dadurch verursacht,
dass den zuvor genannten Anleitungen nicht sorgfältig gefolgt wurde.
Ab und zu gibt es echte Probleme bei der Erzeugung von <i>-current</i> aus dem
allerneuesten Schnappschuss, aber Fehler während der Erzeugung von
<i>-release</i> oder <i>-stable</i> sind fast immer Anwenderfehler.

<p>
Die meisten Probleme treten aus einem der folgenden Gründe auf:
<ul>
<li>Man versäumt, mit einer <a href="#BldBinary">passenden
Binärdatei</a> zu beginnen.
Dazu zählt auch der Versuch des Upgradens vom Quelltext aus,
oder die Annahme, dass ein eine Woche alter Schnappschuss noch »aktuell genug«
ist.
<li>Erzeugung der <a href="#BldGetSrc">Arbeitskopie</a> eines falschen Zweigs
des Baums.
<li>Den <a href="faq5.html">Anweisungen</a> nicht richtig folgen.
<li>Man versucht, das System <a href="#Why">anzupassen</a> oder zu
»optimieren«.
</ul>

Hier sind noch einige weitere Probleme, die auftreten könnten:

<a name="sig11"></a>
<h3>5.11.1 - Das Erzeugen bricht mit einem »Signal 11« Fehler ab</h3>

<p>
OpenBSD und andere Programme aus dem Quelltext heraus zu erzeugen ist eine
Aufgabe, die die Hardware stärker beansprucht als die meisten anderen, da CPU,
Festplatte und Speicher intensiv genutzt werden.
Als Ergebnis ist der wahrscheinlichste Zeitpunkt, an dem sich bei Hardware, die
ein Problem hat, dieses Problem zeigt, während des Übersetzens.
Signal 11 Fehler sind <i>typischerweise</i> durch Hardware-Probleme verursacht,
sehr häufig Speicherprobleme, können aber auch CPU-, Mainboard- oder
Hitzeprobleme sein.
Dein System mag ansonsten sogar sehr stabil sein, sich aber nicht in der Lage
befinden, Programme zu übersetzen.

<p>
Du wirst es vermutlich am besten finden, wenn du die Komponenten, die die
Fehler verursachen, reparierst oder austauschst, da sich Probleme in Zukunft
auch auf andere Weise zeigen könnten.
Falls du Hardware besitzt, bei der du wirklich den Wunsch verspürst, sie zu
nutzen, und die dir keine anderen Probleme bereitet, so installiere einfach
einen Schnappschuss oder ein Release.

<p>
Siehe die <a href="http://www.bitwizard.nl/sig11/">Sig11 FAQ</a> für
sehr viel mehr Informationen.

<a name="snake"></a>
<h3>5.11.2 - »make build« schlägt mit »cannot open output file snake:
is a directory« fehl</h3>

Dies ist das Resultat zweier separater Fehler:
<ul>
<li><b>Du hast deinen CVS-Baum nicht ordentlich heruntergeladen oder
aktualisiert.</b>
Wenn du eine CVS Arbeitskopie erstellst, so musst du die Option »<tt>-P</tt>«
verwenden; wenn du deinen Quelltextbaum mit CVS aktualisierst, so sind die
Optionen »<tt>-Pd</tt>« mit
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1"
>cvs(1)</a> zu verwenden, so wie es <a href="#BldGetSrc">oben</a> beschrieben
ist.
Diese Optionen stellen sicher, dass neue Verzeichnisse im Baum erstellt und
entfernt werden, je nachdem, wie sich OpenBSD entwickelt.

<li><b>Du hast vor dem Build das Verzeichnis <tt>obj</tt> nicht ordnungsgemäß
erstellt.</b>
Den Baum ohne ein <tt>/usr/obj</tt>-Verzeichnis zu erzeugen wird nicht
unterstützt.

</ul>
Es ist wichtig, den Instruktionen sorgfältig zu folgen, wenn du
deinen Baum <a href="#BldGetSrc">herunterlädst</a> und
<a href="#Bld">erzeugst</a>.

<a name="ProbIPv6"></a>
<h3>5.11.3 - Mein System läuft nicht ohne IPv6!</h3>

Stimmt.
Bitte mach keine Modifikationen am Basissystem, von denen du nicht weißt, wie
sie sich auswirken.
Eine »kleine« Änderung im Kern kann große Auswirkungen für den gesamten Rest
des Systems haben.
Bitte lies <a href="#Why">das hier</a> erneut.


<a name="ProbObj"></a>
<h3>5.11.4 - Hoppla! Ich habe vergessen, zuerst das Verzeichnis
<tt>/usr/obj</tt> zu erstellen!</h3>

Durch das Ausführen von »make build« vor einem »make obj« wirst du mit
Objektdateien da stehen, die in deinem <tt>/usr/src</tt>-Verzeichnis
verstreut herumliegen.
Das ist eine schlechte Sache.
Wenn du vermeiden willst, deinen gesamten Quelltextbaum erneut zu
beziehen, kannst du Folgendes versuchen, um die obj-Dateien zu
entfernen:
<pre>
    # <b>cd /usr/src</b>
    # <b>find . -type l -name obj | xargs rm</b>
    # <b>make cleandir</b>
    # <b>rm -rf /usr/obj/*</b>
    # <b>make obj</b>
</pre>

<a name="ProbObjPt"></a>
<h3>5.11.5 - Tipp: Lege <tt>/usr/obj</tt> auf seine eigene
Partition</h3>

Wenn du häufig Erzeugungen anstößt, wirst du es vielleicht als schneller
empfinden, wenn du <tt>/usr/obj</tt> auf seine eigene Partition legst.
Der Nutzen ist einfach, es ist typischerweise schneller:
<pre>
    # <b>umount /usr/obj</b>
    # <b>newfs <i>DeineObjPartition</i></b>
    # <b>mount /usr/obj</b>
</pre>
durchzuführen als »rm -rf /usr/obj/*«.

<a name="ProbSKIPDIR"></a>
<h3>5.11.6 -  Wie verhindere ich das Erzeugen bestimmter Teile des Baums?</h3>

Manchmal möchtest du das Erzeugen von bestimmten Teilen des Baums
verhindern, normalerweise, weil du einen Ersatz für eine mitgelieferte
Anwendung durch Pakete hast, oder weil du, aus welchem Grund auch immer,
ein »kleineres« Release haben willst.
Die Lösung hierfür ist, die Option SKIPDIR von
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mk.conf&amp;sektion=5"
>/etc/mk.conf</a> zu verwenden.

<p>
Hinweis: Es ist möglich, auf diese Weise ein nicht-funktionales System zu
erzeugen.
Resultate des Nutzens dieser Option werden vom OpenBSD-Projekt nicht
unterstützt.

<a name="ProbMoreInfo"></a>
<h3>5.11.7 - Wo kann ich mehr über den Prozess des Erzeugens erfahren?</h3>

Hier sind einige andere Ressourcen:
<ul>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=release&amp;sektion=8"
    >release(8)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8"
    >config(8)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mk.conf&amp;sektion=5"
    >mk.conf(5)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=options&amp;sektion=4"
    >options(4)</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/Makefile"
    ><tt>/usr/src/Makefile</tt></a>
<li>»<a href="../../de/stable.html">patch-branch</a>« (<i>-stable</i>)
<li>(für X) <tt>/usr/X11R6/README</tt> auf deinem installierten System

</ul>

<a name="NoSnaps"></a>
<h3>5.11.8 - Ich sehe keine Schnappschüsse auf den FTP-Seiten.
Wo sind sie geblieben?</h3>

<p>
Schnappschüsse können entfernt werden, wenn sie zu alt werden (oder nicht
länger relevant sind), oder wenn ein neues <i>-release</i> naht.

<a name="NewCompiler"></a>
<h3>5.11.9 - Wie führe ich die Urladung einer neueren Version des Übersetzers
(<i>gcc</i>) aus?</h3>

Du solltest wirklich einfach <a href="#BldBinary">den aktuellsten
Schnappschuss installieren</a>.


<a name="UpdateEtc"></a>
<h3>5.11.10 - Was ist der beste Weg, um <tt>/etc</tt>, <tt>/var</tt> und
<tt>/dev</tt> zu aktualisieren?</h3>

<p>Als Richtlinie modifiziert Software im OpenBSD-Baum keinerlei Dateien
in <tt>/etc</tt> automatisch.
Das bedeutet, dass es <i>immer</i> am Administrator liegt, die
benötigten Modifikationen dort durchzuführen.
Upgrades sind keine Ausnahme.
Um Dateien in diesen Verzeichnissen zu aktualisieren, stelle erst
einmal fest, welche Änderungen an den Basis- (Distributions) Dateien
stattgefunden haben, und führe diese Änderungen erneut durch.

<p>
Um zum Beispiel die Dateien im Baum zu sehen, die sich zuletzt geändert
haben, führe dies aus:

<pre>
    # cd /usr/src/etc
    # ls -lt |more
</pre>

<!-- XXXversion -->
<p>Um alle Änderungen in <tt>/etc</tt> zwischen zwei bestimmten
Versionen von OpenBSD zu sehen, kannst du
<a href="../../de/anoncvs.html">CVS</a> verwenden.
Um zum Beispiel die Änderungen zwischen 5.3 und 5.4 zu sehen, führe dies aus:

<pre>
    # cd /usr/src/etc
    # cvs diff -u -rOPENBSD_5_3 -rOPENBSD_5_4
</pre>

Um die Änderungen zwischen 5.4 und <i>-current</i> (»HEAD«) zu sehen, benutze:
<pre>
    # cd /usr/src/etc
    # cvs diff -u -rOPENBSD_5_4 -rHEAD
</pre>

Das Skript
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=MAKEDEV&amp;sektion=8&amp;arch=i386"
>/dev/MAKEDEV</a> wird nicht automatisch als Teil des »make build« Prozesses aktualisiert,
jedoch wird es als Teil einer <a href="#BldBinary">Binär-Aktualisierung</a> installiert.
Als generelle Regel gilt, dass es eine gute Idee ist, dieses Skript zu kopieren
(falls das notwendig ist) und von deinem Quelltextbaum aus aufzurufen, um ein
Upgrade durchzuführen:

<pre>
    # cd /dev
    # cp /usr/src/etc/etc.`machine`/MAKEDEV ./
    # ./MAKEDEV all
</pre>

<p>
Sobald du die Änderungen ausgemacht hast, füge sie deinem lokalen Baum
erneut zu, jegliche lokale Konfiguration, die du gemacht hast,
bewahrend.

<p>
Typische Änderungen in <tt>/etc</tt>, auf die zwischen zwei Releases
geachtet werden muss, sind unter anderem:

<ul>
<li>Ergänzungen in <tt>/etc/protocols</tt> und <tt>/etc/services</tt>.</li>
<li>Neue sysctls (siehe <tt>/etc/sysctl.conf</tt>).</li>
<li>Änderungen an den standardmäßigen Cronjobs.
    Siehe <tt>/etc/daily</tt>, <tt>/etc/weekly</tt>, <tt>/etc/monthly</tt> und
    <tt>/etc/security.</tt>
<li>Alle rc-Skripte, einschließlich netstart.</li>
<li>Änderungen an Geräten, siehe weiter oben.
<li>Änderungen der Datei-Hierarchie in <tt>/etc/mtree</tt>,
    siehe <a href="#Hierarchy">unten</a>.
<li>Neue Benutzer (<tt>/etc/passwd</tt>) und Gruppen (<tt>/etc/group</tt>).
</ul>

<!-- XXXversion -->
Diese Änderungen werden in
<a href="../upgrade54.html">upgrade54.html</a> (um zum 5.4-Release zu gelangen)
oder <a href="../current.html">current.html</a> (um zu <i>-current</i> zu gelangen)
zusammengefasst.


<a name="Hierarchy"></a>
<h3>5.11.11 - Gibt es einen einfachen Weg, um alle nötigen Änderungen an der
Dateihierarchie durchzuführen?</h3>

<p>
Von Zeit zu Zeit werden Dateien oder Verzeichnisse zu der Datei
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hier&amp;sektion=7"
>hierarchy</a> hinzugefügt oder aus ihr entfernt.
Ebenfalls können sich Besitzer-Informationen für Teile des Dateisystems
ändern.
Ein einfacher Weg, um sicherzustellen, dass deine Dateihierarchie auf dem
neuesten Stand ist, ist das Verwenden des Werkzeugs
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&amp;sektion=8"
>mtree(8)</a>.

<p>
Beziehe zuerst den aktuellsten Quelltext, dann führe Folgendes aus:

<pre>
    # cd /usr/src/etc/mtree
    # install -c -o root -g wheel -m 600 special /etc/mtree
    # install -c -o root -g wheel -m 444 4.4BSD.dist /etc/mtree
    # mtree -qdef /etc/mtree/4.4BSD.dist -p / -u
</pre>

<p>
Deine Dateihierarchie sollte nun auf dem neuesten Stand sein.

<a name="ProbXComp"></a>
<h3>5.11.12 - Kann ich querübersetzen?  Warum nicht?</h3>
Es befinden sich Werkzeuge im System, mit denen man querübersetzen
kann - bereit für Entwickler, die an einer neuen Portierung arbeiten.
Sie sind jedoch nicht für den allgemeinen Einsatz gedacht.

<p>
Wenn ein Entwickler eine neue Plattform unterstützen will, ist einer
der ersten großen Tests eine native Erzeugung des Systems.
Das Erzeugen des Systems aus dem Quelltext setzt das Betriebssystem und die
Maschine unter hohe Last, was wiederum einen guten Test darstellt, wie gut das
System tatsächlich arbeitet.
Aus diesem Grund führt OpenBSD den Erzeugungsprozess auf der Plattform aus, für
die das Resultat gedacht ist, was auch als »native building« bezeichnet wird.
Ohne diese native Übersetzung ist es viel schwerer sicherzustellen, dass die
unterschiedlichen Plattformen verlässlich eingesetzt werden können und nicht
einfach nur starten.

<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ-Index]</a>
<a href= "faq4.html">[Zum Kapitel 4 - Installationsanleitung]</a>
<a href= "faq6.html">[Zum Kapitel 6 - Vernetzung]</a>
</font>

<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../../images/back.gif" border= "0" alt= "[zurück]"></a>
<a href= "mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: faq5.html,v 1.197 ]<br>
$Translation: faq5.html,v 1.142 2013/11/01 17:42:27 steffen Exp $<br>
-->
$OpenBSD: faq5.html,v 1.125 2013/11/01 18:04:04 ajacoutot Exp $
</small>
</body>
</html>

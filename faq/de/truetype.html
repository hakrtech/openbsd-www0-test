<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Kantengeglättete und TrueType-Schriftarten unter OpenBSD</title>
<link rev="made" href="www@OpenBSD.org">
<meta http-equiv="Content-Language" content="de">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="resource-type" content="document">
<meta name="description"   content="Die OpenBSD-FAQ-Seite">
<meta name="keywords"      content="openbsd,faq,kantenglättung,truetype,schriftarten,X.org,XF4">
<meta name="distribution"  content="global">
<meta name="copyright"     content="Dieses Dokument unterliegt dem Copyright von OpenBSD 2001 - 2004.">
</head>

<body bgcolor="#ffffff" text="#000000">
<a href="http://www.openbsd.org/"><img alt="[OpenBSD]" border="0"
  height=30 width=141 src="../../images/smalltitle.gif"></a>

<h1>Kantengeglättete und TrueType-Schriftarten unter OpenBSD</h1>

<h3>Inhaltsverzeichnis</h3>
<ul>
<li><a href="truetype.html#xterm">Screenshot von xterm</a>
<li><a href="truetype.html#konqueror">Screenshot vom Konqueror</a>
<li><a href="truetype.html#how">Wie funktioniert das?</a>
<li><a href="truetype.html#work">Was muss dafür getan werden?</a>
<li><a href="truetype.html#applications">Welche Applikationen können das
    nutzen?</a>
<li><a href="truetype.html#manualfonts">Wie kann ich Schriftarten
    manuell hinzufügen?</a>
</ul>
<hr>

<a name="xterm"></a>
<h2>Screenshot von xterm</h2>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xterm&amp;sektion=1">xterm(1)</a>
mit kantigen und kantengeglätteten Schriftarten nebeneinander:
<div align="center"><img src="../images/xterm_diff.jpg"
  alt="[standardmäßiger und kantengeglätteter xterm]"></div>

<a name="konqueror"></a>
<h2>Screenshot vom Konqueror</h2>
Noch nicht überzeugt?
Dann werfe mal einen Blick hierauf.

<p>
Der <a href="http://konqueror.kde.org/">Konqueror-Webbrowser</a> mit
kantigen und kantengeglätteten Schriftarten nebeneinander:
<div align="center"><img src="../images/konqueror_diff.jpg"
  alt="[Standard- und kantengeglätteter Konqueror]"></div>

<a name="how"></a>
<h2>Wie funktioniert das?</h2>
Die kantenglättenden Berechnungen werden von
<a href="http://www.freetype.org/">FreeType</a> durchgeführt, einer
freien Font-Engine, die Teil von X.org ist. X.org beinhaltet
zusätzlich eine Erweiterung, die
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=Xft&amp;sektion=3">Xft(3)</a>
genannt wird, die X-FreeType-Erweiterung, die mit FreeType
zusammenarbeitet, um das Rendering von Schriftarten durchzuführen.
Xft arbeitet ebenfalls mit einer Erweiterung namens <i>Xrender</i>
zusammen, der X-Render-Erweiterung, die die Berechnung in digitale
Bilder umwandelt.

<a name= "work"></a>
<h2>Was muss dafür getan werden?</h2>
OpenBSD wird mit X.org ausgeliefert, das die X-Render-Erweiterung
bereits aktiviert hat. Um in der Lage zu sein, diese zu benutzen,
muss dein X-Server (Grafikkartentreiber) diese unterstützen. Einige
Treiber wurden bisher noch nicht konvertiert, damit sie den ,fb'-Code
benutzen, um auf die Render-Erweiterungen zugreifen zu können,
was jedoch notwendig ist.

<p>
Du kannst deine Karte mit folgendem Aufruf überprüfen:

<blockquote><pre>
$ <strong>/usr/X11R6/bin/xdpyinfo | grep RENDER</strong>
RENDER
</pre></blockquote>

Wenn dieser nicht ,RENDER' in seiner Erweiterungsliste aufführt,
musst du warten, bis jemand die Erweiterung für diese Karte
implementiert.

<p>
Der nächste Schritt besteht darin, einige TrueType-Schriftarten zu
beziehen und zu installieren. Eine Sammlung beliebter Schriftarten
wurde kompiliert, die über den
<a href="faq8.html#Ports">OpenBSD-Ports-Tree</a> verfügbar ist, und zwar
unter <tt>/usr/ports/x11/msttcorefonts</tt>. Sie kann installiert
werden, indem Folgendes ausgeführt wird:

<blockquote><pre>
# <b>cd /usr/ports/x11/msttcorefonts</b>
# <b>make</b>
# <b>make install</b>
</pre></blockquote>

An diesem Punkt angekommen, kannst du die Anweisungen, wie man neue
Schriftarten unter X registiert, in <a href="#manualfonts">einer
anderen Sektion</a> finden.

<a name= "applications"></a>
<h2>Welche Applikationen können das nutzen?</h2>
Jede Applikation, die auf der Xft-Bibliothek aufbaut, kann
kantengeglättete Schriftarten anzeigen. Dazu gehören auch QT-3.x-
(KDE 3.x) und GTK+2- (Gnome 2.x) -Applikationen. Standardmäßig
mitgelieferte X-Programme, die diese Schnittstelle nutzen können,
sind
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xterm&amp;sektion=1">xterm(1)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xditview&amp;sektion=1">xditview(1)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xfd&amp;sektion=1">xfd(1)</a>
und ein paar andere.

<h3>xterm</h3>
<tt>xterm</tt> kann mit Argumenten aufgerufen werden, die das
Xft-Rendering der Schriftarten aktivieren:

<blockquote><pre>
$ <strong>xterm -fa 'Andale Mono' -fs 14</strong>
</pre></blockquote>

Diese Optionen sind:
<blockquote><pre>
Option   Ressource        Bedeutung
----------------------------------------------
 -fa     XTerm*faceName   Name vom Schriftsatz
 -fs     XTerm*faceSize   Größe der Schriftart
</pre></blockquote>

Daneben könnten auch X-Ressourcen genutzt werden. Standardmäßig werden
sie unter <tt>$HOME/.Xdefaults</tt> abgespeichert und mit dem Programm
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xrdb&amp;sektion=1">xrdb(1)</a>
verwaltet.

<p>
Einige TrueType-Schriftarten (wie zum Beispiel Arial, Georgia und
Verdana) funktionieren nicht sonderlich gut mit <tt>xterm</tt>. Das
liegt daran, dass <tt>xterm</tt> die maximale Breite der Zeichen im
angegebenen Schriftart für die Darstellung nutzt. Bei
Monospace-Schriftarten ist die Breite aller Zeichen gleich und somit
funktioniert auch alles. Mit einem proportionalem Font, wie mit
beispielsweise dem zuvor genannten, legt <tt>xterm</tt> jedes einzelne
Zeichen in eine Zelle, die die maximal mögliche Breite hat, was
unleserlich große Lücken zwischen den Zeichen erstellt.

<h3>QT-3.x-/KDE-3.x-Applikationen</h3>
Applikationen, die QT 3.x verwenden, wie beispielsweise jede
KDE-3.x-Applikation, einschließlich Konqueror, können das Xft-Rendering
benutzen, nachdem der folgende Wert in <tt>$HOME/.qt/qtrc</tt> unter
der Sektion <tt>[General]</tt> eingetragen wurde.

<blockquote><pre>
useXft=true
</pre></blockquote>

Das GUI-Qt-Konfigurationsprogram <tt>qtconfig</tt> (oder
<tt>qtconfig-mt</tt>, falls die ,multi-threaded' Variante von QT
installiert wurde) kann diesen Wert über die
<b>Enable Anti-aliased Font Support</b>-Auswahlbox unter dem
<b>Fonts</b>-Karteireiter setzen.

<h3>GTK+2-Applikationen</h3>
GTK+2-Applikationen setzen voraus, dass die Umgebungsvariable
<tt>GDK_USE_XFT</tt> gesetzt ist. GDK ist das ,backend', das GTK
nutzt, um die Details der Zeichenoperationen zu isolieren, was wiederum
bedeutet, dass das Schriftart-Rendering über Xft gemacht wird, wenn
die Umgebungsvariable gesetzt ist.

<p>
Das Folgende wird das auf GTK+2 basierende ,instant messenging'-Programm
<a href="http://gaim.sourceforge.net/">Gaim</a> starten, das unter
dem Verzeichnis <b>/usr/ports/net/gaim</b> verfügbar ist:

<blockquote><pre>
$ env GDK_USE_XFT=1 gaim
</pre></blockquote>

<a name="manualfonts"></a>
<h2>Wie kann ich Schriftarten manuell hinzufügen?</h2>
Eine TrueType-Schriftart ,zu X' hinzuzufügen, setzt das Registrieren
der Schriftart mit sowohl dem X-Server als auch
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fontconfig&amp;sektion=3">fontconfig(3)</a>
voraus, da beide die Schriftarten separat verwalten. Es ist tatsächlich
so, dass einige Schriftarten nur vom regulären X-Server erkannt werden,
andere hingegen nur mit fontconfig. TrueType-Schriftarten sind die
einzigen Schriftarten, die von beiden erkannt werden.

<h3>Der X-Server</h3>
Die Pfade für die Schriftarten (z.B. die Verzeichnisse, in denen
die Schriftarten liegen) werden entweder direkt über X mit der
Datei <tt>/etc/X11/xorg.conf</tt> oder mit einem separaten Programm
wie zum Beispiel
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xfs&amp;sektion=1">xfs(1)</a>
verwaltet. Um eine Schriftart hinzuzufügen, füge das Verzeichnis
in <tt>/etc/X11/xorg.conf</tt> ein, in dem sich diese Schriftart
befindet:

<blockquote><pre>
Section "Files"
	FontPath	"/usr/X11R6/lib/X11/fonts/TTF/"
	FontPath	"<i>/usr/local/lib/X11/fonts/myfonts/</i>"
	...
EndSection
</pre></blockquote>

Oder, falls du <tt>xfs</tt> verwendest, füge das Verzeichnis in
<tt>/etc/X11/fs/config</tt> ein:

<blockquote><pre>
catalogue = /usr/X11R6/lib/X11/fonts/TTF/,
	    <i>/usr/local/lib/X11/fonts/myfonts/</i>
</pre></blockquote>

Als nächstes müssen die Schriftarten dem X-Server bekanntgegeben
werden, z.B. über die Datei <tt>fonts.dir</tt>. Bisher war es so, dass
alle verfügbaren Größen der Schriftarten im Font-Index aufgelistet
wurden, der über das Kommando
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mkfontdir&amp;sektion=1">mkfontdir(1)</a>
erstellt wurde. Aber da TrueType-Schriftarten auf jede beliebige
Größe skaliert werden können, ist das Auflisten jeder möglichen Größe
nicht mehr erforderlich. Stattdessen werden die skalierbaren
Schriftarten in der Datei <tt>fonts.scale</tt> aufgelistet, die
von <tt>mkfontdir</tt> berücksichtigt wird, wenn die
<tt>fonts.dir</tt>-Indexe erstellt werden.

<p>
Um eine <tt>fonts.scale</tt>-Datei zu erstellen, kann das Programm
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mkfontscale&amp;sektion=1">mkfontscale(1)</a>
genutzt werden:

<blockquote><pre>
# <b>cd <i>/usr/local/lib/X11/fonts/myfonts</i></b>
# <b>/usr/X11R6/bin/mkfontscale</b>
# <b>/usr/X11R6/bin/mkfontdir</b>
</pre></blockquote>

Zum Schluss, damit die Änderungen der aktuellen X-Sitzung
bekanntgegeben werden, muss man nicht X neustarten, sondern kann
folgendes Kommando verwenden, damit die aktuell registierten
Schriftartpfade auf Änderungen hin untersucht werden:

<blockquote><pre>
$ <b>xset fp rehash</b>
</pre></blockquote>

Oder aber, falls ein neuer Schriftartpfad hinzugefügt wurde:

<blockquote><pre>
$ <b>xset +fp <i>/usr/local/lib/X11/fonts/myfonts</i></b>
</pre></blockquote>

Wenn <tt>xfs</tt> genutzt wird, sollte stattdessen Folgendes genutzt
werden:

<blockquote><pre>
# <b>pkill -HUP xfs</b>
</pre></blockquote>

<h3>fontconfig</h3>
Eine andere Komponente von X, der die Existenz einer neuen Schriftart
mitgeteilt werden muss, ist fontconfig, die Xft nutzt, um Schriftarten
zu finden. fontconfig verwendet die Datei <tt>/etc/fonts/fonts.conf</tt>
für die hauptsächliche systemweite Konfiguration, aber da diese Datei
bei X-Upgrades ersetzt wird, sollte <tt>/etc/fonts/local.conf</tt>
verwendet werden, um systemweite Änderungen zu verwalten.

<p>
Füge das Verzeichnis, in dem sich die Schriftarten befinden, in diese
Konfigurationsdatei ein:

<blockquote><pre>
&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;!DOCTYPE fontconfig SYSTEM &quot;/etc/fonts/fonts.dtd&quot;&gt;
&lt;fontconfig&gt;
  &lt;dir&gt;<i>/usr/local/lib/X11/fonts/myfonts</i>&lt;/dir&gt;
&lt;/fontconfig&gt;
</pre></blockquote>

Oder, wenn nur ein Benutzer Schriftarten für seine Sitzungen verwenden
möchte, könnte das obrige in seine <tt>$HOME/.fonts.conf</tt>-Datei
eingetragen werden.

<p>
Beachte, dass fontconfig rekursiv alle Unterverzeichnisse nach
verfügbaren Schriftarten untersuchen wird, während der reguläre X-Server
das nicht macht.

<p>
Nachdem das Verzeichnis hinzugefügt wurde, muss der ,font cache' für
das Verzeichnis neu generiert werden. Das folgende Kommando veranlasst
fontconfig dazu, die ,font caches' für alle angegebenen Verzeichnissen
in seiner Konfiguration neu zu generieren.

<blockquote><pre>
# <b>/usr/X11R6/bin/fc-cache -v</b>
</pre></blockquote>

Diese Änderungen werden Auswirkung auf die aktuelle X-Sitzung haben,
so dass X selbst nicht neugestartet werden muss, laufende Applikationen
jedoch schon.

<hr>
<a href="index.html"><img height="24" width="24" src="../../images/back.gif"
  border="0" alt="[back]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: truetype.html,v 1.17 ]
$Translation: truetype.html,v 1.5 2005/09/14 16:16:38 paldium Exp $
-->
$OpenBSD: truetype.html,v 1.5 2005/09/20 07:30:02 saad Exp $
</small>
</body>
</html>

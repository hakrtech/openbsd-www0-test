<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Following -current</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 2007 by OpenBSD">
</head>

<body bgcolor= "#ffffff" text= "#000000">
<a href="../index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../images/smalltitle.gif" border="0">    
</a>
<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
</font>

<p>

<h1><font color="#e00000">Following <i>-current</i></font></h1>
<hr>

<h3>Table of Contents</h3>
<p>
<ul>
<li><a href="#Intro">Introduction</a>
<!-- Oldest on top... -->
<li><a href="#20070326">2007/03/26 - Xenocara replaces XF4 in <i>-current</i></a>
<li><a href="#20070327">2007/03/27 - updated ahci(4) may cause device
name change for SATA disks</a>
<li><a href="#20070331">2007/03/31 - bgpd filter language change</a>
<li><a href="#20070510">2007/05/10 - ports using the libexpat shipped with xenocara</a></li>
<li><a href="#20070710">2007/07/10 - updated wpi(4) requires new firmware</a></li>
<li><a href="#20070726">2007/07/26 - changes in the way sudo(8) passes environment</a></li>
<!-- New additions go on the bottom, please -->
</ul>
    
<hr>

<a name="Intro"></a>
<!-- XXXversion -->
<h2>Introduction</h2>
This document is for people who wish to follow <i>-current</i>.
It contains information about changes from 4.1-release to <i>-current</i>,
and should NOT be used by anyone upgrading from 4.0 or earlier, or people
wishing to follow <a href="../stable.html"><i>-stable</i></a>.

<p>
If you wish to update to 4.1-release or 4.1-stable from previous
versions, see the <a href="upgrade41.html">upgrade guide</a>.

<p>
Make sure you have read and understood
<a href="faq5.html">FAQ 5 - Building the System from Source</a>
before using -current and the instructions below.

<p>
You should ALWAYS use a snapshot as the starting point for running
<i>-current</i>.
Upgrading by compiling your own source code is not supported.

<p>
If you wish to see upgrade information for earlier versions of OpenBSD,
see <a href= "upgrade-old.html">upgrade-old.html</a>.
This is provided as a historical record -- it should NOT be used as
an upgrade procedure guide.

<p>
<a name="20070326"></a>
<h3>2007/03/26 - Xenocara replaces XF4 in <i>-current</i></h3>
The <a href="http://www.xenocara.org/">xenocara</a> tree is to be used
now instead of the XF4 tree to build X for OpenBSD.
More details can be found on
<a href="http://undeadly.org/cgi?action=article&sid=20070328153001">undeadly.org</a>.
<p>
If you still have <tt>Option "xkbrules" "xfree86"</tt> in your
<tt>/etc/X11/xorg.conf</tt> configuration file, you now need to change
it to <tt>Option "xkbrules" "xorg"</tt>.
<p>
If you really wish to build Xenocara from source (don't, use snapshots!)
<a href="http://www.openbsd.org/cgi-bin/cvsweb.cgi/xenocara/README?rev=HEAD&content-type=text/x-cvsweb-markup"
>xenocara/README</a> and
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=release&amp;sektion=8">release(8)</a>


<a name="20070327"></a>
<h3>2007/03/27 - updated ahci(4) may cause device name change for SATA disks</h3>
<p>
Recent changes to the <tt>ahci(4)</tt> subsystem can cause SATA disks
which were formerly recognized as wd* (e.g <tt>wd0</tt>) devices to turn
up as sd* (e.g <tt>sd0</tt>) devices instead.

<p>
This is a potential problem if you upgrade from an earlier snapshot.
Watch the <tt>dmesg</tt> output at boot.
A drive which turned up earlier as:

<p>
<blockquote><tt>
pciide1 at pci0 dev 31 function 2 "Intel 82801GBM AHCI SATA" rev 0x02: DMA, channel 0 wired to native-PCI, channel 1 wired to native-PCI<br>
pciide1: using apic 2 int 11 (irq 11) for native-PCI interrupt<br>
wd0 at pciide1 channel 0 drive 0: &lt;FUJITSU MHV2080BH&gt;<br>
wd0: 16-sector PIO, LBA48, 76319MB, 156301488 sectors<br>
wd0(pciide1:0:0): using PIO mode 4, Ultra-DMA mode 5
</tt></blockquote>

now instead turns up as

<p>
<blockquote><tt>
ahci0 at pci0 dev 31 function 2 "Intel 82801GBM AHCI SATA" rev 0x02: AHCI 1.1: apic 2 int 16 (irq 11)<br>
scsibus1 at ahci0: 32 targets<br>
sd0 at scsibus1 targ 0 lun 0: &lt;ATA, FUJITSU MHV2080B, 0084&gt; SCSI2 0/direct fixed<br>
sd0: 76319MB, 76319 cyl, 64 head, 32 sec, 512 bytes/sec, 156301488 sec total
</tt></blockquote>

<p>
The recommended workaround is to edit your <tt>/etc/fstab</tt> file,
changing the relevant <tt>/dev/wd</tt> entries to refer to
<tt>/dev/sd</tt> devices and partitions instead.

<p>
The other option is to disable <tt>ahci</tt> using <tt>config(8)</tt> or
<tt>boot -c</tt>.

<p>
Refer to the manpages for
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ahci&amp;sektion=4">ahci(4)</a>
and
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>
for all the details.

<a name="20070331"></a>
<h3>2007/03/31 - bgpd filter language change</h3>
<p>
bgpd filters using only <tt>prefixlen</tt> as filter parameter need to include
now a address family identifier like <tt>inet</tt> or <tt>inet6</tt>:

<p>
<blockquote><tt>
allow from any inet prefixlen 8 - 24<br>
deny from any inet6 prefixlen &gt; 64<br>
</tt></blockquote>

<a name="20070510"></a>
<h3>2007/05/10 - ports are using the libexpat shipped with xenocara</h3>
The textproc/libexpat port has been removed from ports dependencies,
now all ports use the libexpat that's shipped with xenocara.

<p>
This means that for many ports to work you need to have
<tt>xbase42.tgz</tt> installed, even if they don't obviously have a
graphical operation.
Refer to the
<a href="file://localhost/usr/www/faq/faq4.html#AddFileSet">FAQ</a> on
how to add <tt>xbase42.tgz</tt> to a an installed system.

<p>
Ports affected by this include (but is not limited to!) bash, mutt and
all ports with devel/gettext as a dependency.

<p>
This affects package installation as well as ports builds.


<a name="20070710"></a>
<h3>2007/07/10 - updated wpi(4) requires new firmware</h3>
<p>
Recent changes to the <tt>wpi(4)</tt> driver require that the <tt>wpi-firmware</tt> package be updated to revision 2.14.4.

<p>
As usual, you can find a prepackaged version of the firmware at:<br>
<a href="http://damien.bergamini.free.fr/packages/openbsd/wpi-firmware-2.14.4.tgz">http://damien.bergamini.free.fr/packages/openbsd/wpi-firmware-2.14.4.tgz</a>

<a name="20070726"></a>
<h3>2007/07/10 - changes in the way sudo(8) passes environment</h3>

For security reasons,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sudo&amp;sektion=8">sudo(8)</a>
will by default reset the environment to a small default set
with only certain variables preserved from the previous environment.

<p>
In order for many things to continue to work as expected, add the following
line to your <tt>/etc/sudoers</tt> file using
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=visudo&amp;sektion=8">visudo(8)</a>:
<blockquote><pre>
# Defaults specification
Defaults env_keep +="DESTDIR FETCH_CMD FLAVOR FTPMODE MULTI_PACKAGES OKAY_FILES PKG_DBDIR PKG_DESTDIR PKG_CACHE PKG_PATH PKG_TMPDIR RELEASEDIR SUBPACKAGE"
</pre></blockquote>

<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
</font>
<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../images/back.gif" border= "0" alt="[back]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>$OpenBSD: current.html,v 1.68 2007/08/15 19:46:33 nick Exp $</small>

</body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Following -current</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 2005-2010 by OpenBSD">
</head>

<body bgcolor= "#ffffff" text= "#000000">
<a href="../index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../images/smalltitle.gif" border="0">    
</a>
<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
</font>

<p>

<h1><font color="#e00000">Following <i>-current</i></font></h1>
<hr>

<h3>Table of Contents</h3>
<p>
<ul>
<li><a href="#Intro">Introduction</a>
<!-- Oldest on top... -->
<li><a href="#20100323">2010/03/23 - [ports] Major Dovecot upgrade</a>
<li><a href="#20100326">2010/03/26 - softraid(4) metadata changes</a>
<li><a href="#20100403">2010/04/03 - mandoc(1) required now</a>
<li><a href="#20100417">2010/04/17 - ahci(4) no longer attaches to RAID-mode disks</a>
<li><a href="#20100421">2010/04/21 - removal of libevent evdns.h</a>
<li><a href="#20100424">2010/04/24 - new user and group for aucat and midicat</a>
<li><a href="#20100426">2010/04/26 - [ports] samba default user db backend changed</a>
<li><a href="#20100509">2010/05/09 - system Makefile changes</a>
<li><a href="#20100510">2010/05/10 - Intel X driver changes</a>
<li><a href="#20100515">2010/05/15 - X.Org libs updates and removal</a>
<li><a href="#20100525">2010/05/25 - new config(8) for kernel builds</a>
<li><a href="#20100526">2010/05/26 - gcc4 for amd64 and sparc64</a>
<li><a href="#20100526a">2010/05/26 - f77 moved to ports</a>
<li><a href="#20100607">2010/06/07 - new users/groups for iked, ldapd</a>
<li><a href="#20100627">2010/06/27 - bgpd options moved to config</a>
<li><a href="#20100705">2010/07/05 - aucat options order changes</a>
<li><a href="#20100708">2010/07/08 - gcc4 for hppa, i386 and powerpc</a>
<!-- New additions go on the bottom, please -->
</ul>
    
<hr>

<a name="Intro"></a>
<!-- XXXversion -->
<h2>Introduction</h2>
This document is for people who wish to follow <i>-current</i>.
It contains information about changes from 4.7-release to <i>-current</i>,
and should NOT be used by anyone upgrading from 4.6 or earlier, or people
wishing to follow <a href="../stable.html"><i>-stable</i></a>.

<p>
If you wish to update to 4.6-release or 4.6-stable from previous
versions, see the <a href="upgrade46.html">upgrade guide</a>.

<p>
Make sure you have read and understood
<a href="faq5.html">FAQ 5 - Building the System from Source</a>
before using -current and the instructions below.

<p>
You should ALWAYS use a snapshot as the starting point for running
<i>-current</i>.
Upgrading by compiling your own source code is not supported.

<p>
Most of these changes will have to be performed as root.

<p>
If you wish to see upgrade information for earlier versions of OpenBSD,
see <a href= "upgrade-old.html">upgrade-old.html</a>.
This is provided as a historical record -- it should NOT be used as
an upgrade procedure guide.

<a name="20100323"></a>
<h3>2010/03/23 - [Ports] Major Dovecot upgrade</h3>
Dovecot has been updated from 1.1.20 to 1.2.11. The configuration file changed 
and the old cmusieve plugin has been removed in favor of the new Dovecot sieve 
implementation. The 
<a href="http://permalink.gmane.org/gmane.os.openbsd.ports.cvs/42080">commit 
log entry</a> has more details.

<p>
<a name="20100326"></a>
<h3>2010/03/26 - softraid(4) metadata changes</h3>
The
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=softraid&sektion=4">softraid(4)</a>
metadata format has changed and is not compatible with previous versions.
As a result, any softraid volumes created with older kernels will not assemble.
Data on existing volumes should be backed up before upgrading.
The volume should then be recreated and the data restored.

<a name="20100403"></a>
<h3>2010/04/03 - mandoc(1) required now</h3>
mandoc(1) has been added to the build tree, and is now required for
building the system.  If you do not have it, either install a snapshot
or:
<blockquote><pre>
<b>cd /usr/src/usr.bin/mandoc
make obj
NOMAN= make &amp;&amp; NOMAN= make install</b>
</pre></blockquote>

<a name="20100417"></a>
<h3>2010/04/17 - ahci(4) no longer attaches to RAID-mode disks</h3>
To avoid risk of corrupting metadata on certain Intel RAID devices,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ahci&sektion=4">ahci(4)</a>
no longer attaches to the PCI device IDs used by these controllers
when set to RAID mode.
If you lose access to your disks, you'll need to change the
controller type from RAID to AHCI in the BIOS to get them back.

<a name="20100421"></a>
<h3>2010/04/21 - removal of libevent evdns.h</h3>
As part of updating libevent from 1.3 to 1.4, the asynchronous DNS
component was removed. You should delete the headers manually:
<blockquote><pre>
<b>rm /usr/include/evdns.h
rm /usr/libdata/perl5/site_perl/*-openbsd/evdns.ph</b>
</pre></blockquote>

<a name="20100424"></a>
<h3>2010/04/24 - new user and group for aucat(1) and midicat(1)</h3>
The following needs to be run:
<blockquote><pre>
<b>useradd -u 99 -g =uid -c "sndio privsep" -d /var/empty -s /sbin/nologin _sndio</b>
</pre></blockquote>

<a name="20100426"></a>
<h3>2010/04/26 - [ports] samba default user db backend changed</h3>
The default user database backend for the Samba port has changed.
If you currently use smbpasswd, you must either adjust your configuration,
or convert your database. See <a href="http://www.openbsd.org/cgi-bin/cvsweb/ports/net/samba/files/README.OpenBSD?rev=1.12">README.OpenBSD</a>
for more information.

<a name="20100509"></a>
<h3>2010/05/09 - system Makefile changes</h3>
Makefiles now assume the COMPILER_VERSION variable is set.
The following needs to be run before building userland:
<blockquote><pre>
<b>cd /usr/src/share/mk
make install</b>
</pre></blockquote>

<a name="20100510"></a>
<h3>2010/05/10 - Intel X driver changes</h3>

The new Intel X driver now requires a GEM kernel. if X is
out of date the following config fragment is necessary in
the driver section of xorg.conf:
<blockquote><pre>
Option "AccelMethod" "UXA"
</pre></blockquote>
Preferable is to update X at the same time as updating the
kernel.

<a name="20100515"></a>
<h3>2010/05/15 - X.Org libs updates and removal</h3>

Several X libraries have been deprecated recenlty (Xp, Xtrap, Xevie, 
lbxutil) and an other has undergone a major clean-up (Xext).
As a result, several old headers and autotools configuration files have
been removed.
You should remove them manually from your system to
prevent them from interfering with your ports (or other software) builds.
<blockquote><pre>
<b>cd /usr/X11R6/include/X11
rm Xaw/Print.h Xaw/PrintSP.h
rm -r XprintAppUtil XprintUtil
cd extensions
rm Print.h Printstr.h XEVIstr.h Xagstr.h Xcupstr.h Xdbeproto.h Xevie.h \
   Xeviestr.h dpmsstr.h lbxdeltastr.h lbxopts.h lbxstr.h lbxzlib.h \
   mitmiscstr.h multibufst.h securstr.h shapestr.h shmstr.h syncstr.h \
   xteststr.h xtrapbits.h xtrapddmi.h xtrapdi.h xtrapemacros.h \
   xtraplib.h xtraplibp.h xtrapproto.h
cd /usr/X11R6/lib/pkgconfig
rm evieproto.pc lbxutil.pc printproto.pc trapproto.pc xaw8.pc \
   xevie.pc xp.pc xprintapputil.pc xprintutil.pc xtrap.pc
rm /usr/X11R6/share/aclocal/xaw.m4</b>
</pre></blockquote>

<a name="20100525"></a>
<h3>2010/05/25 - Need new config(8) for kernel builds</h3>

A new version of config(8) is needed to build kernels.
Rebuild it using
<blockquote><pre>
<b>cd /usr/src/usr.sbin/config
make obj && make depend && make && make install</b>
</pre></blockquote>

<a name="20100526"></a>
<h3>2010/05/26 - gcc4 for amd64 and sparc64</h3>

amd64 and sparc64 have changed from gcc3 to gcc4.
Updated makefiles, gcc, cpp and libstdc++ must be installed with these four
steps.
<p>
Firstly, gcc4 must be compiled with the existing compiler:
<blockquote><pre>
<b>rm -rf /usr/obj/*
cd /usr/src/share/mk && make install
cd /usr/src/gnu/usr.bin/cc
make obj && make depend && make && make install
</b></pre></blockquote>
Secondly, gcc4 must be rebuilt with itself:
<blockquote><pre>
<b>rm -rf /usr/obj/*
cd /usr/src/usr.bin/cpp
make obj && make && make install
cd /usr/src/gnu/usr.bin/cc
make obj && make depend && make && make install
</b></pre></blockquote>
Thirdly, libstdc++-v3 must be installed after removing the old C++ headers:
<blockquote><pre>
<b>rm -rf /usr/include/g++/*
cd /usr/src/gnu/lib/libstdc++-v3
make obj && make includes && make depend && make && make install
</b></pre></blockquote>
And lastly the entire system rebuilt with the usual procedure documented in
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=release&sektion=8">release(8)</a>.

<p>
For people updating using snapshots, don't forget to:
<blockquote><pre>
<b>rm -rf /usr/include/g++/*
</b></pre></blockquote>
before installing newer snapshot.

<a name="20100526a"></a>
<h3>2010/05/26 - f77 moved to ports</h3>
The Fortran compiler has moved from the base OS to ports.
Remove the following files after updating:
<blockquote><pre><b>rm -f /usr/bin/f77 /usr/bin/g77 /usr/include/f2c.h /usr/include/g2c.h \
   /usr/lib/gcc-lib/*-unknown-openbsd*/3.3.5/f771 /usr/lib/libfrtbegin.a \
   /usr/lib/libfrtbegin_p.a /usr/lib/libfrtbegin_pic.a /usr/lib/libg2c.a \
   /usr/lib/libg2c_p.a /usr/lib/libg2c_pic.a /usr/share/info/g77.info \
   /usr/share/man/cat1/f77.0 /usr/share/man/cat1/g77.0
</b></pre></blockquote>

<a name="20100607"></a>
<h3>2010/06/07 - new users and groups for ldapd(8) and iked(8)</h3>
Newly added daemons
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ldapd&sektion=8">ldapd(8)</a>
and
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=iked&sektion=8">iked(8)</a>
require the following users/groups to be created:
<blockquote><pre>
<b>useradd -u 100 -g =uid -c "LDAP Daemon" -d /var/empty -s /sbin/nologin _ldapd
useradd -u 101 -g =uid -c "IKEv2 Daemon" -d /var/empty -s /sbin/nologin _iked
</b></pre></blockquote>

<a name="20100627"></a>
<h3>2010/06/27 - bgpd(8) options moved to config</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bgpd&sektion=8">bgpd(8)</a>
command-line options -s and -r to set the paths of the control socket
and the restricted control socket have been replaced with settings in the
configuration file.<p>
Replace <tt>-s /path/to/bgpd.sock</tt> with <tt>socket "/path/to/bgpd.sock" in bgpd.conf</tt><br>
Replace <tt>-r /path/to/bgpd.rsock</tt> with <tt>socket "/path/to/bgpd.rsock" restricted in bgpd.conf</tt>

<a name="20100705"></a>
<h3>2010/07/05 - aucat options order changes</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=aucat&sektion=1">aucat(1)</a>
command line options ordering has become more strict in order to support
multiple devices.
Per-stream parameters (-Ccehjmrtvx) must precede stream definitions (-ios)
and per-device parameters (-abz) and stream definitions (-ios) must precede
device definitions (-f).<p>

<a name="20100708"></a>
<h3>2010/07/08 - gcc4 for hppa, i386 and powerpc</h3>

hppa, i386 and the various powerpc architectures (macppc, mvmeppc,
socppc) have moved to gcc4.
If you are building from source rather than installing a snapshot,
please refer to the
<a href="#20100526">amd64 and sparc64 instructions</a>
for the procedure.

<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../images/back.gif" border= "0" alt="[back]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>$OpenBSD: current.html,v 1.228 2010/07/08 21:43:31 sthen Exp $</small>

</body>
</html>

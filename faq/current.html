<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Following -current</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 2005-2011 by OpenBSD">
</head>

<body bgcolor= "#ffffff" text= "#000000">
<a href="../index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../images/smalltitle.gif" border="0">
</a>
<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
</font>

<p>

<h1><font color="#e00000">Following <i>-current</i></font></h1>
<hr>

<h3>Table of Contents</h3>
<p>
<ul>
<li><a href="#Intro">Introduction</a>
<!-- Oldest on top... -->
<li><a href="#20110313">2011/03/13 - -current mklocale required</a>
<li><a href="#20110319">2011/03/19 - [ports] incompatible groff update</a>
<li><a href="#20110414">2011/04/14 - Kernel "make depend" now no-op</a>
<li><a href="#20110417">2011/04/17 - New security(8) script</a>
<li><a href="#20110418">2011/04/18 - vnd removed, svnd renamed to vnd</a>
<li><a href="#20110422">2011/04/22 - [ports] SOGo update</a>
<li><a href="#20110422a">2011/04/22 - [ports] www/opera-flashplugin removed</a>
<li><a href="#20110428">2011/04/28 - ftp-proxy(8) pf.conf change required</a>
<li><a href="#20110505">2011/05/05 - tftp-proxy(8) pf.conf change required</a>
<li><a href="#20110520">2011/05/20 - pf.conf 'set skip' now handles groups</a>
<li><a href="#20110525">2011/05/25 - removed support for legacy audio and MIDI device names</a>
<li><a href="#20110528">2011/05/28 - [ports] Dovecot update</a>
<li><a href="#20110531">2011/05/31 - -current config(8) required to build kernel</a>
<li><a href="#20110602">2011/06/02 - [xenocara] switched to xkeyboard-config</a>
<li><a href="#20110629">2011/06/29 - [xenocara] new input driver configuration code</a>
<li><a href="#20110704">2011/07/04 - pf.conf "set require-order" removed</a>
<li><a href="#20110706">2011/07/06 - [ports] pstoraster moved to its own package<a/>
<li><a href="#20110707">2011/07/07 - rc.conf 'rc_scripts' variable renamed to 'pkg_scripts'<a/>
<li><a href="#20110708">2011/07/08 - OpenBSD/sparc switched to gcc4
<li><a href="#20110710">2011/07/10 - OpenBSD/armish amd OpenBSD/zaurus switched to gcc4
<!-- New additions go on the bottom, please -->
</ul>

<hr>

<a name="Intro"></a>
<!-- XXXversion -->
<h2>Introduction</h2>
This document is for people who wish to follow <i>-current</i>.
It contains information about changes from 4.9-release to <i>-current</i>,
and should NOT be used by anyone upgrading from 4.7 or earlier, or people
wishing to follow <a href="../stable.html"><i>-stable</i></a>.

<p>
If you wish to update to 4.9-release or 4.9-stable from previous
versions, see the <a href="upgrade49.html">upgrade guide</a>.

<p>
Make sure you have read and understood
<a href="faq5.html">FAQ 5 - Building the System from Source</a>
before using -current and the instructions below.

<p>
You should ALWAYS use a snapshot as the starting point for running
<i>-current</i>.
Upgrading by compiling your own source code is not supported.

<p>
Most of these changes will have to be performed as root.

<a name="20110313"></a>
<h3>2011/03/13 - -current mklocale required</h3>
mklocale needs to be built and installed to avoid a
&quot;conflicting map entries&quot; error:
<blockquote><pre><b>cd /usr/src/usr.bin/mklocale
make obj
make depend
make
make install
</b></pre></blockquote>

<a name="20110319"></a>
<h3>2011/03/19 - [ports] incompatible groff update</h3>
In case you are building ports, update src/usr.sbin/pkg_add/OpenBSD
at the same time as upgrading from groff-1.15 to groff-1.21.
New groff and old pkg_create build manuals with ANSI escapes,
old groff and new pkg_create cause ports build failures.

<a name="20110414"></a>
<h3>2011/04/14 - Kernel "make depend" now no-op</h3>
Kernel Makefiles now autogenerate dependencies during compilation,
so the "make depend" target now quietly exits, doing nothing.
Users of most platforms will not have to do anything about this.

<p>
Users of gcc2-based platforms (hp300, mvme68k, mvme88k, sparc, vax)
will have to rebuild gcc before this will work to implement
the required gcc options.

<blockquote><pre><b># gcc2 platforms only!!
rm -r /usr/obj/gnu/egcs/gcc/*
cd /usr/src/gnu/egcs/gcc
make -f Makefile.bsd-wrapper clean
make -f Makefile.bsd-wrapper obj
make -f Makefile.bsd-wrapper depend
make -f Makefile.bsd-wrapper
make -f Makefile.bsd-wrapper install
make -f Makefile.bsd-wrapper clean
make -f Makefile.bsd-wrapper depend
make -f Makefile.bsd-wrapper
make -f Makefile.bsd-wrapper install
</b></pre></blockquote>

But as always, starting from a newer snapshot is a much better idea.

<a name="20110417"></a>
<h3>2011/04/17 - new <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=security&sektion=8">security(8)</a> script</a></h3>
Apply <a href="http://www.openbsd.org/cgi-bin/cvsweb/src/etc/daily.diff?r1=1.69;r2=1.70">revision 1.70</a>
to <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=daily&sektion=8">daily(8)</a>.
In case you have added code to the file <tt>/etc/security</tt>,
move that code to <tt>/etc/daily.local</tt>.
Delete the file <tt>/etc/security</tt>, it has been replaced by the
file <tt>/usr/libexec/security</tt> now contained in the base file set.
Also delete the line containing <tt>/etc/security</tt>
from the file <tt>/etc/changelist</tt>.

<a name="20110418"></a>
<h3>2011/04/18 - vnd removed, svnd renamed to vnd</h3>
The traditional vnd that bypasses the buffer cache has been removed, and svnd
has been renamed to vnd. It is also no longer possible to swap to vnds. Users
running current will notice that the kernel will treat svndX and vndX as the
same device from now, so older svnd device nodes will continue to function.

<a name="20110422"></a>
<h3>2011/04/22 - [ports] SOGo update</h3>
SOGo has been updated to 1.3.6.
The new session handling requires a new configuration default named
OCSSessionsFolderURL.
For more information consult the package README file or the general
SOGo Installation Guide installed with the package.

<a name="20110422a"></a>
<h3>2011/04/22 - [ports] www/opera-flashplugin removed</h3>
www/opera-flashplugin has been removed. You can install GNU Gnash as a
replacement.
<!-- XXX remove FAQ 13.14 for 5.0 -->

<a name="20110428"></a>
<h3>2011/04/28 - ftp-proxy(8) pf.conf change required</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp-proxy&sektion=8">ftp-proxy(8)</a>
has changed to using divert-to instead of rdr-to, avoiding an expensive
state lookup using the DIOCNATLOOK ioctl.
PF rules must be adjusted to compensate - old rules like these:

<blockquote><pre><b>pass in quick proto tcp to port ftp rdr-to 127.0.0.1 port 8021</b></pre></blockquote>

should be replaced with:

<blockquote><pre><b>pass in quick inet proto tcp to port ftp divert-to 127.0.0.1 port 8021</b></pre></blockquote>

Note that with divert-to, the address family (in this example <tt>inet</tt>)
must be specified explicitly.

<a name="20110505"></a>
<h3>2011/05/05 - tftp-proxy(8) pf.conf change required</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tftp-proxy&sektion=8">tftp-proxy(8)</a>
has also changed to using divert-to.
PF rules must be adjusted to compensate - old rules like these:

<blockquote><pre><b>pass in quick on internal proto udp to port tftp rdr-to 127.0.0.1 port 6969</b></pre></blockquote>

should be replaced with:

<blockquote><pre><b>pass in quick on internal inet proto udp to port tftp divert-to 127.0.0.1 port 6969</b></pre></blockquote>

Again note that the address family must be specified explicitly.

<a name="20110520"></a>
<h3>2011/05/20 - pf.conf 'set skip' now handles groups</h3>

In pf.conf, '<tt>set skip on &lt;...&gt;</tt>' now works with interface groups.
Previously if an interface type (without number) was used, e.g. '<tt>set skip
on vlan</tt>' or '<tt>set skip on em</tt>' was used, it would have the
undocumented behaviour of matching any interface of that type.
Now it will only match an interface which is a member of the named group.<p>

This results in changed behaviour for some users:
If you currently use "set skip" with a physical interface type (e.g.
"<tt>set skip on ix</tt>") you will need to add the interface to a group
of that name: '<tt>ifconfig ix0 group ix</tt>' or add '<tt>group ix</tt>'
to hostname.ix0.<p>

Interfaces cloned at runtime (e.g. lo, trunk, vlan, pppoe, carp, gif,
mpe and others) default to being in a group named after the interface type,
so for these interfaces there will be no change in behaviour unless you
have deliberately changed groups, e.g. with '<tt>ifconfig carp456 -group
carp</tt>'.

<p>
<a name="20110525"></a>
<h3>2011/05/25 - removed support for legacy audio and MIDI device names</h3>
Legacy naming won't work any longer so any scripts or configuration
files of applications using
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sndio&amp;sektion=7">sndio(7)</a>
should be updated.
Examples:

<pre>
     /dev/audio0   --&gt;   sun:0
     /dev/audio1   --&gt;   sun:1
     /dev/rmidi2   --&gt;   rmidi:2
     default       --&gt;   aucat:0
     mystuff       --&gt;   aucat:0.mystuff
</pre>

<p>
<a name="20110528"></a>
<h3>2011/05/28 - [ports] Dovecot update</h3>
Dovecot has had a major update, needing some changes in configuration files.
See the <a href="http://wiki2.dovecot.org/Upgrading/2.0">notes on upgrading
from 1.1 to 2.0</a> on Dovecot's wiki for more information about how to handle
this.<p>
The database support has been moved from flavoured versions of Dovecot
(dovecot-1.2.16p5-ldap, -mysql, -postgresql, -sqlite, etc) to plugins
in subpackages (dovecot-ldap-2.0.13, etc).
All older versions will be upgraded to the new main package; if you're
using a flavoured version for database support, you will need to add the
relevant subpackage/s yourself.
Berkeley DB is no longer supported, if you're using this you will need
to switch to a SQL database instead.

<p>
<a name="20110531"></a>
<h3>2011/05/31 - -current config(8) required to build kernel</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&sektion=8">config(8)</a>
needs to be built and installed to avoid "excess elements in
struct initializer" errors in ioconf.o during a kernel build:
<blockquote><pre><b>cd /usr/src/usr.sbin/config
make obj
make depend
make
make install
</b></pre></blockquote>
Afterwards, any existing kernel compilation directories must be
rebuilt by running config again:
<blockquote><pre><b>cd /usr/src/sys/arch/${ARCH}/conf
config ${CONFIG}
</b></pre></blockquote>
Finally, the kernel can be built:
<blockquote><pre><b>cd /usr/src/sys/arch/${ARCH}/compile/${CONFIG}
make
</b></pre></blockquote>

<p>
<a name="20110602"></a>
<h3>2011/06/02 - [Xenocara] switched to xkeyboard-config</h3>
Keyboard definition files from the old xkb-data package in
/etc/X11/xkb have been replaced by files from
<a href="http://www.freedesktop.org/wiki/Software/XKeyboardConfig">xkeyboard-config</a>,
which are now  installed in /usr/X11R6/share/X11/xkb.
The old ones can be removed:
<blockquote><pre><b>rm -rf /etc/X11/xkb
</b></pre></blockquote>
If you have an <pre>/etc/X11/xorg.conf</pre> file that exists mainly
to set keyboard type and nationality that file should be removed,
otherwise you may find yourself without keyboard functionality in X.

<p>
<a name="20110629"></a>
<h3>2011/06/29 - [Xenocara] New input device configuration code</h3>
A new autoconfiguration mechanism for input devices has been implemented
in the X server. It provides even better support for various input
devices: synaptics touchpads (not yet ready) or touchscreens without a
configuration file.
The <b>InputDevice</b> sections can be removed from <tt>xorg.conf</tt>
in most cases.<br>
To override the autoconfiguration with an <b>InputDevice</b> section for
an input device that would normally be auto-configured, the following
needs to be added to <tt>/etc/X11/xorg.conf</tt>:
<blockquote><pre><b>
Section "ServerFlags"
    Option "AutoAddDevices" "False"
EndSection
</b></pre></blockquote>

<p>
<a name="20110704"></a>
<h3>2011/07/04 - pf.conf "set require-order" removed</h3>
The
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&sektion=5">pf.conf(5)</a>
<tt>set require-order</tt> option has been removed; remove it from any
ruleset which uses it.
This option was used to relax requirements on ruleset ordering; these
have not been enforced by default for some time.
</p>

<p>
<a name="20110706"></a>
<h3>2011/07/06 - [ports] pstoraster moved to its own package</h3>
The pstoraster print filter has moved out of ghostscript into the
gstoraster package. If you use a CUPS print filter that requires pstoraster
to run, you need to install the new package manually:
<blockquote><pre><b># pkg_add gstoraster
</b></pre></blockquote>

<p>
<a name="20110707"></a>
<h3>2011/07/07 - rc.conf 'rc_scripts' variable renamed to 'pkg_scripts'</h3>
The
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf&sektion=8">rc.conf(8)</a>
<tt>rc_scripts</tt> variable has been renamed to <tt>pkg_scripts</tt>.
Edit
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf.local&sektion=8">rc.conf.local(8)</a>
accordingly to be able to start package daemons automatically on boot.
<br>
This change was introduced to make it clear that <tt>pkg_scripts</tt> should only be used to store
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=packages&sektion=7">packages(7)</a>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.d&sektion=8">rc.d(8)</a>
scripts names.
</p>

<p>
<a name="20110708"></a>
<h3>2011/07/08 - OpenBSD/sparc switched to gcc4</h3>
OpenBSD/sparc now uses gcc4.
Upgrade from source is non-trivial and time consuming, and will not be
supported.
Upgrade by snapshot dated after July 9 before attempting to build from
source.

<p>
Make sure your boot loader is up to date -- use
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=installboot&arch=sparc">installboot</a>
if you don't use bsd.rd to install the snapshot.

<p>
<a name="20110710">
<h3>2011/07/10 - OpenBSD/armish amd OpenBSD/zaurus switched to gcc4</h3>
The ARM based platforms now use gcc4.
Upgrade from source is non-trivial and time consuming, and will not be
supported.
Upgrade by snapshot dated after July 10 before attempting to build from
source.



<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../images/back.gif" border= "0" alt="[back]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>$OpenBSD: current.html,v 1.278 2011/07/11 12:00:50 ajacoutot Exp $</small>

</body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Following -current</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 2005-2012 by OpenBSD">
</head>

<body bgcolor= "#ffffff" text= "#000000">
<a href="../index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../images/smalltitle.gif" border="0">
</a>
<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
</font>

<p>

<h1><font color="#e00000">Following <i>-current</i></font></h1>
<hr>

<h3>Table of Contents</h3>
<p>
<ul>
<li><a href="#Intro">Introduction</a>
<!-- Oldest on top... -->
<li><a href="#20120304">2012/03/04 - xf86-video-ati update is back</a>
<li><a href="#20120406">2012/04/06 - RAIDframe removed</a>
<li><a href="#20120412">2012/04/12 - [landisk] gcc4 for landisk</a>
<li><a href="#20120428">2012/04/28 - [ports] Subversion gnome-keyring is now a subpackage</a>
<li><a href="#20120606">2012/06/06 - [ports] xpdf-utils replaced with poppler-utils</a>
<li><a href="#20120607">2012/06/07 - [ports] ser removed</a>
<li><a href="#20120607a">2012/06/07 - [ports] scrotwm renamed to spectrwm</a>
<li><a href="#20120607b">2012/06/07 - [ports] xxxterm renamed to xombrero</a>
<li><a href="#20120608">2012/06/08 - [ports] dovecot update</a>
<li><a href="#20120623">2012/06/23 - nginx.conf default SSL file locations changed</a>
<li><a href="#20120708">2012/07/08 - smtpd.conf syntax change</a>
<li><a href="#20120709">2012/07/09 - smtpd queue layout changed</a>
<li><a href="#20120709a">2012/07/09 - HID usage table changed</a>
<!-- 5.2 -->
<li><a href="#20120808">2012/08/08 - xf86-video-ati 6.14.6 is now selected by default</a>
<li><a href="#20120821">2012/08/21 - IPv6 SLAAC defaults to privacy addresses</a>
<li><a href="#20120823">2012/08/23 - New toolchain behavior</a>
<li><a href="#20120830">2012/08/30 - pmdb(1) removed</a>
<li><a href="#20120831">2012/08/31 - gcc(1) now uses __guard_local instead of __guard on ELF/GCC4 architectures</a>
<li><a href="#201208XX">2012/08/31 - amd64, sgi, loongson and sparc64 are now PIE</a>

<!-- New additions go on the bottom, please -->
</ul>

<hr>

<a name="Intro"></a>
<!-- XXXversion -->
<h2>Introduction</h2>
This document is for people who wish to follow <i>-current</i>.
It contains information about changes from 5.1-release to <i>-current</i>,
and should NOT be used by anyone upgrading from 5.0 or earlier, or people
wishing to follow <a href="../stable.html"><i>-stable</i></a>.

<p>
If you wish to update to 5.1-release or 5.1-stable from previous
versions, see the <a href="upgrade51.html">upgrade guide</a>.

<p>
Make sure you have read and understood
<a href="faq5.html">FAQ 5 - Building the System from Source</a>
before using -current and the instructions below.

<p>
You should ALWAYS use a snapshot as the starting point for running
<i>-current</i>.
Upgrading by compiling your own source code is not supported.

<p>
Most of these changes will have to be performed as root.

<p>
<a name="20120304"></a>
<h3>2012/03/04 - return of the xf86-video-ati update</h3>

The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=radeon">radeon(4)</a>
driver has been re-updated to version 6.14.3, but it's not selected by
auto-configuration code.
The
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=radeonold">radeonold(4)</a>
driver is providing a frozen version of the last working driver, until
all issues in the new driver are fixed.<br>
Users with cards needing the new driver should create an
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xorg.conf">xorg.conf(5)</a> file containing just
<pre>
Section "Device"
    Identifier "RadeonCard"
    Driver "radeon"
EndSection
</pre>
Or merge this section in their existing <tt>/etc/X11/xorg.conf</tt> file.<br>
The <b>radeonhd</b> driver is now deprecated.
Users of this this driver should update their <tt>/etc/X11/xorg.conf</tt> file
by replacing
<pre>
      Driver "radeonhd"
</pre>
with
<pre>
      Driver "radeon"
</pre>

<p>
<a name="20120406"></a>
<h3>2012/04/06 - RAIDframe removed</h3>
The RAIDframe disk driver and configuration utility have been removed.
After upgrading, the following files can be removed:
<blockquote><pre>
<b>rm /sbin/raidctl
rm /usr/share/man/man4/raid.4
rm /usr/share/man/man8/raidctl.8
</b></pre></blockquote>
Users of RAIDframe will need to consider alternatives such as
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=softraid">softraid(4)</a>.

<p>
<a name="20120412"></a>
<h3>2012/04/12 - [landisk] gcc4 for landisk</h3>

landisk has changed from gcc3 to gcc4.  It is strongly recommended
to use snapshots instead of the following method.
Updated makefiles, gcc, cpp and libstdc++ must be installed with these
steps.
<p>
Firstly, gcc4 and csu must be compiled with the existing compiler:
<blockquote><pre>
<b>rm -rf /usr/obj/*
cd /usr/src/share/mk && make install
cd /usr/src/gnu/usr.bin/cc
make obj && make depend && make
cd /usr/src/lib/csu
make obj && make depend && make && make install
cd /usr/src/gnu/usr.bin/cc
make install
</b></pre></blockquote>
Secondly, gcc4 must be rebuilt with itself:
<blockquote><pre>
<b>rm -rf /usr/obj/*
cd /usr/src/usr.bin/cpp
make obj && make && make install
cd /usr/src/gnu/usr.bin/cc
make obj && make depend && make && make install
</b></pre></blockquote>
Thirdly, libstdc++-v3 must be installed after removing the old C++ headers:
<blockquote><pre>
<b>rm -rf /usr/include/g++/*
cd /usr/src/gnu/lib/libstdc++-v3
make obj && make includes && make depend && make && make install
</b></pre></blockquote>
And lastly the entire system rebuilt with the usual procedure documented in
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=release&sektion=8">release(8)</a>.

<p>
For people updating using snapshots, don't forget to:
<blockquote><pre>
<b>rm -rf /usr/include/g++/*
</b></pre></blockquote>
before installing newer snapshot.

<p>
<a name="20120428"></a>
<h3>2012/04/28 - [ports] Subversion gnome-keyring is now a subpackage</h3>
gnome-keyring support in Subversion was previously a FLAVOR of the port,
as it required the main program to link with libpthread causing some
side-effects with the previous uthread library (notably, strange
behaviour with "svn diff | more" due to how I/O on file descriptors
was handled).<p>

As this is no longer an issue with rthreads, the FLAVOR has been removed.
To continue using gnome-keyring with Subversion, after updating packages you
will need to "pkg_add gnome-keyring-subversion".

<p>
<a name="20120606"></a>
<h3>2012/06/06 - [ports] xpdf-utils replaced with poppler-utils</h3>
The PDF-related tools from xpdf-utils (pdffonts, pdfimages, pdfinfo,
pdftotext) have been replaced with equivalents in poppler-utils.
Note that these no longer read xpdfrc files and are now only configured
using command-line options.

<p>
<a name="20120607"></a>
<h3>2012/06/07 - [ports] ser removed</h3>
The ser port has been removed. Users of ser are advised to migrate
to kamailio for now.

<p>
<a name="20120607a"></a>
<h3>2012/06/07 - [ports] scrotwm renamed to spectrwm</h3>
scrotwm has changed its name to spectrwm.
The package update will be handled automatically but you will need to
rename your configuration file/s:
<tt>mv /etc/scrotwm.conf /etc/spectrwm.conf</tt> for the system
configuration file, and any ".scrotwm.conf" files in user home directories
will need to be renamed to ".spectrwm.conf".
You will also need to adapt any entries in .xsession, etc., to start the
window manager.

<p>
<a name="20120607b"></a>
<h3>2012/06/07 - [ports] xxxterm renamed to xombrero</h3>
xxxterm has changed its name to Xombrero.
The package update will be handled automatically but you will need to
rename your configuration file/s and directories.
There is no system configuration file, but any ".xxxterm.conf" files in
user home directories will need to be renamed to ".xombrero.conf".

<p>
<a name="20120608"></a>
<h3>2012/06/08 - [ports] dovecot update</h3>
Dovecot was updated to 2.1 which may require minor changes to configuration.
See the <a href="http://wiki2.dovecot.org/Upgrading/2.1">upgrade notes</a>
for information.

<p>
<a name="20120623"></a>
<h3>2012/06/23 - nginx.conf default SSL file locations changed</h3>
The <tt>ssl_certificate</tt> and <tt>ssl_certificate_key</tt> values in the
default <tt>/etc/nginx/nginx.conf</tt> file have been changed to
<tt>/etc/ssl/server.crt</tt> and <tt>/etc/ssl/private/server.key</tt>
respectively to match the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssl&sektion=8">ssl(8)</a>
man page.

<p>
<a name="20120708"></a>
<h3>2012/07/08 - smtpd.conf syntax change</h3>
<tt>relay via</tt> rules should now be expressed with a relay URL:
<pre>	accept [...] relay via "mx1.example.org" smtps port 465</pre>
becomes
<pre>	accept [...] relay via "smtps://mx1.example.org"</pre>
The new relay URL syntax is documented in
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=smtpd.conf&sektion=5">smtpd.conf(5)</a>

<p>
<a name="20120709"></a>
<h3>2012/07/09 - smtpd queue layout changed</h3>
A change to the queue layout was introduced, you will want to empty your
queue before updating.

<p>
<a name="20120709a"></a>
<h3>2012/07/09 - HID usage table changed</h3>
The HID usage table (as used by
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=uhid&sektion=4">uhid(4)</a>)
has been updated and certain entry names have been changed. If you are
using <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=usbhidaction&sektion=1">usbhidaction(1)</a>
you may need to adjust your config with the new entry names. These can be
obtained with:
<blockquote><pre>usbhidctl -l</pre></blockquote>

<!-- 5.2 -->
<p>
<a name="20120808"></a>
<h3>2012/08/08 - xf86-video-ati 6.14.6 is now selected by default</h3>
The
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=radeon&sektion=4">radeon(4)</a>
X.Org driver has been updated to version 6.14.6 and is now selected by
default when running without an <tt>xorg.conf</tt> file.<br>
To force the use of the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=radeonold&sektion=4">radeonold(4)</a>
driver, add the following to <tt>/etc/X11/xorg.conf</tt>:
<pre>
Section "Device"
    Identifier "Old Radeon Card"
    Driver "radeonold"
EndSection
</pre>

<p>
<a name="20120821"></a>
<h3>2012/08/21 - IPv6 SLAAC defaults to privacy addresses</h3>
IPv6 stateless automatic address configuration (as used when you
configure an interface's address using "rtsol") now defaults to using
RFC4941 privacy addresses.<p>
This means that when making outgoing connections, predictable addresses
based on the MAC address are no longer used as a source address, instead
temporary addresses are generated periodically and used (see
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&sektion=8">ifconfig(8)</a>'s
description of "autoconfprivacy" for more information).<p>
Incoming connections aren't affected by this; the IPv6 address based on
the MAC address is still configured on the interface and can be used for
incoming connections.
However if connections to other machines are restricted based on source
IPv6 addresses or reverse DNS lookups, you may need to make configuration
changes and either disable privacy addresses (e.g. <tt>echo
"up -autoconfprivacy" &gt;&gt; /etc/hostname.em0</tt>) or configure
addresses manually instead.

<p>
<a name="20120823"></a>
<h3>2012/08/23 - New toolchain behavior</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ld&sektion=1">ld(1)</a>'s
linker scripts now recognizes .openbsd.randomdata sections, which libc has
also been updated to make use of.  Normally ld(1) is not built until after libc,
so to explicitly build it first use:
<blockquote><pre>
<b>cd /usr/src/gnu/usr.bin/binutils
make -f Makefile.bsd-wrapper obj
make -f Makefile.bsd-wrapper
make -f Makefile.bsd-wrapper install
</b></pre></blockquote>
You can verify that ld(1) is up to date by checking the output from
ld --verbose:
<blockquote><pre>
$ <b>ld --verbose | grep randomdata</b>
  .openbsd.randomdata     :
    PROVIDE_HIDDEN (__openbsd_randomdata_start = .);
    *(.openbsd.randomdata .openbsd.randomdata.*)
    PROVIDE_HIDDEN (__openbsd_randomdata_end = .);
</pre></blockquote>

<p>
<a name="20120830"></a>
<h3>2012/08/30 - pmdb(1) removed</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pmdb&sektion=1">pmdb(1)</a>
was removed from base. The binary and it's manual page can be removed:
<blockquote><pre>
rm /usr/bin/pmdb /usr/share/man/man1/pmdb.1
</pre></blockquote>

<p>
<a name="20120831"></a>
<h3>2012/08/31 - gcc(1) now uses __guard_local instead of __guard on ELF/GCC4 architectures</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gcc&sektion=1">gcc(1)</a>
now emits stack-smashing protection code that references __guard_local instead
__guard on ELF/GCC4 architectures.  Because GCC is built at the end of a normal
"make build", it's necessary to either do two full builds, or you can short-cut
the first build by updating just the C runtime files and compiler:
<blockquote><pre>
cd /usr/src/lib/csu
make depend && make && make install
cd /usr/src/gnu/usr.bin/cc
make depend && make && make install
</pre></blockquote>
You can then proceed with a normal "make build" as per
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=release&sektion=8">release(8)</a>.

<p>
<a name="20120831"></a>
<h3>2012/08/31 - amd64, sgi, loongson and sparc64 are now PIE</h3>
The amd64, sgi, loongson and sparc64 platforms have been switched to
PIE (position-independent executables) by default.
Everyone is encouraged to update via snapshots (dated after 2012/08/31); if you
want to upgrade via sources, follow these instructions:
<p>
First, install the new system Makefiles with the change to PIE_ARCH in
bsd.own.mk:
<blockquote><pre>
<b>cd /usr/src/share/mk && sudo make install
</b></pre></blockquote>
Then, recompile and install gcc and binutils.
<blockquote><pre>
<b>cd /usr/src/gnu/usr.bin/binutils
make -f Makefile.bsd-wrapper clean && make -f Makefile.bsd-wrapper obj && \
	make -f Makefile.bsd-wrapper depend && make -f Makefile.bsd-wrapper
cd /usr/src/gnu/usr.bin/cc
make clean && make obj && make depend && make && sudo make install
cd /usr/src/gnu/usr.bin/binutils && sudo make install
</b></pre></blockquote>
Finally, recompile your system by following the procedure outlined in
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=release&sektion=8">release(8)</a>.

<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../images/back.gif" border= "0" alt="[back]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>$OpenBSD: current.html,v 1.339 2012/08/31 17:21:52 pascal Exp $</small>

</body>
</html>

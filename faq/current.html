<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Following -current</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 2005-2014 by OpenBSD">
</head>

<body bgcolor= "#ffffff" text= "#000000">
<a href="../index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../images/smalltitle.gif" border="0">
</a>
<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
</font>

<p>

<h1><font color="#e00000">Following <i>-current</i></font></h1>
<hr>

<h3>Table of Contents</h3>
<p>
<ul>
<li><a href="#Intro">Introduction</a>
<!-- Oldest on top... -->
<li><a href="#20130806">2013/08/06 - vax port switches to gcc 3</a>
<li><a href="#20130812">2013/08/12 - kernel modesetting in radeondrm(4)</a>
<li><a href="#20130813">2013/08/13 - system ABI break: time_t and others changed</a>
<li><a href="#20130813b">2013/08/13 - new identd(8) implementation</a>
<li><a href="#20130816">2013/08/16 - vlan(4) and pppoe(4) ABI breaks</a>
<li><a href="#20130823">2013/08/23 - [ports] php 5.4</a>
<li><a href="#20130914">2013/09/14 - [ports] dspam 3.10.2</a>
<li><a href="#20130919">2013/09/19 - [ports] wordpress 3.6.1</a>
<li><a href="#20131010">2013/10/10 - [ports] Apache Subversion 1.8.3</a>
<li><a href="#20131012">2013/10/12 - pf queue changes</a>
<li><a href="#20131014">2013/10/14 - [ports] PostgreSQL 9.3.0</a>
<li><a href="#20131019">2013/10/17 - [ports] Lout 3.40</a>
<li><a href="#20131031">2013/10/31 - new routing message version</a>
<li><a href="#20131103">2013/11/03 - [ports] ngircd 21</a>
<li><a href="#20131105">2013/11/05 - [ports] RRDtool 1.4.8</a>
<li><a href="#20131106">2013/11/06 - smtpd.conf changes</a>
<li><a href="#20131119">2013/11/19 - [ports] Icinga 1.10</a>
<li><a href="#20131126">2013/11/26 - NSD 4.0.0</a>
<li><a href="#20131204">2013/12/04 - libcompat removed</a>
<li><a href="#20131204">2013/12/08 - libcompat removal, updated</a>
<li><a href="#20131215">2013/12/15 - popa3d removed</a>
<li><a href="#20131216">2013/12/16 - cwm(1) default keybinding change</a>
<li><a href="#20131228">2013/12/28 - i386 is now PIE</a>
<li><a href="#20131228b">2013/12/28 - atexit(3) moved</h3>
<li><a href="#20131126">2014/01/07 - NSD 4.0.0, updated</a>
<li><a href="#20140112">2014/01/12 - freetype 2.5.2</a>
<li><a href="#20140120">2014/01/20 - amd64/i386 installboot</a>
<li><a href="#20140210">2014/02/10 - [ports] No Java on i386</a>
<li><a href="#20140214">2014/02/14 - amd64/i386 serial consoles need current bootloader</a>
<!-- 5.5 entries start below here -->
<!-- New additions go on the bottom, please -->
<li><a href="#20140312">2014/03/12 - rmail removed</a>
<li><a href="#20140312b">2014/03/12 - smtpd becomes default MTA</a>
<li><a href="#20140312c">2014/03/12 - spray removed</a>
<li><a href="#20140313">2014/03/13 - _smtpq user added</a>
<li><a href="#20140313b">2014/03/13 - httpd(8) removed</a>
<li><a href="#20140316">2014/03/16 - [ports] unbound(8) moved to base</a>
<li><a href="#20140317">2014/03/17 - ftpd(8) disallows uid &lt; 1000 by default</a>
<li><a href="#20140317b">2014/03/17 - userland agp(4) interfaces removed</a>
<li><a href="#20140317c">2014/03/17 - userland ppp(8) and pppoe(8) implementations removed</a>
<li><a href="#20140317d">2014/03/17 - uucpd(8) removed</a>
<li><a href="#20140319">2014/03/19 - rcp(1) removed</a>
</ul>

<hr>

<a name="Intro"></a>
<!-- XXXversion -->
<h2>Introduction</h2>
This document is for people who wish to follow <i>-current</i>.
It contains information about changes from 5.4-release to <i>-current</i>,
and should NOT be used by anyone upgrading from 5.3 or earlier, or people
wishing to follow <a href="../stable.html"><i>-stable</i></a>.

<p>
If you wish to update to 5.4-release or 5.4-stable from previous
versions, see the <a href="upgrade54.html">upgrade guide</a>.

<p>
Make sure you have read and understood
<a href="faq5.html">FAQ 5 - Building the System from Source</a>
before using -current and the instructions below.

<p>
You should ALWAYS use a snapshot as the starting point for running
<i>-current</i>.
Upgrading by compiling your own source code is not supported.

<p>
Most of these changes will have to be performed as root.

<p>
<a name="20130806"></a>
<h3>2013/08/06 - vax port switches to gcc 3</h3>
The vax port now uses gcc 3.3.6 as its system compiler. Upgrading with a recent
snapshot is recommended; however, for reference, the manual upgrade steps are:
<br>
<ul>
<li>Build the new C compiler with the existing compiler:
<pre>
   cd /usr/src/gnu/usr.bin/gcc
   make -f Makefile.bsd-wrapper clean
   make -f Makefile.bsd-wrapper obj
   make -f Makefile.bsd-wrapper -DBOOTSTRAP depend
   make -f Makefile.bsd-wrapper -DBOOTSTRAP
   make -f Makefile.bsd-wrapper -DBOOTSTRAP includes
   make -f Makefile.bsd-wrapper -DBOOTSTRAP install
</pre>
<li>Let the rest of the system know the platform now runs gcc 3:
<pre>
   cd /usr/src/share/mk
   make install
</pre>
<li>Build and install an up-to-date preprocessor:
<pre>
   cd /usr/src/usr.bin/cpp
   make clean
   make obj
   make depend
   make
   make install
</pre>
<li>Build and install the C runtime startup files:
<pre>
   cd /usr/src/lib/csu
   make clean
   make depend
   make
   make install
</pre>
<li>Now rebuild the compiler set again:
<pre>
   cd /usr/src/gnu/usr.bin/gcc
   make -f Makefile.bsd-wrapper clean
   make -f Makefile.bsd-wrapper obj
   make -f Makefile.bsd-wrapper depend
   make -f Makefile.bsd-wrapper
   make -f Makefile.bsd-wrapper install
</pre>
<li>The system is now ready to be rebuild with gcc3:
<pre>
   cd /usr/src
   rm -fR /usr/include/g++
   make obj
   make build
</pre>
</ul>

<p>
<a name="20130812"></a>
<h3>2013/08/12 - kernel modesetting in radeondrm(4)</h3>
radeondrm(4) now uses kernel modesetting, either install the firmware and wait
for a snapshot or follow the steps below:
<ul>
<li>Install the Radeon firmware:
<pre>
    pkg_add http://firmware.openbsd.org/firmware/snapshots/radeondrm-firmware-20131002p0.tgz
</pre>
<li>Build xenocara as usual
<li>Build and install a kernel as usual
<li>Reboot
</ul>

<p>
<a name="20130813"></a>
<h3>2013/08/13 - system ABI break: time_t and others changed</h3>
The system ABI has been changed to expand time_t, ino_t, and
clock_t and the <i>ident</i> and <i>data</i> members of struct
kevent to 64bit types.  A GENERIC kernel with this change will not
run old binaries and the /etc/{pwd,spwd}.db files must be regenerated
after updating the system binaries.  Rolling back to stock
5.4 will require reinstalling.
<br>
To update across this change you must now use a snapshot.
The recommended steps for updating are:
<ol>
<li>Save a record of what packages you had installed, manually and
automatically:
<pre>
    pkg_info -mq >/root/pkg_list_manual
    pkg_info -q >/root/pkg_list_full
</pre>
</li>
<li>Review the "package notes" below for information about known problems with
packages during the changeover. Some will need additional steps taking before the
update.
</li>
<li>While their uninstall programs can still execute, remove all packages
(except firmware packages):
<pre>
    pkg_delete -X /var/db/pkg/*-firmware-[0-9]*
</pre>
</li>
<li>Install/upgrade to the new snapshot.
If you upgrade instead of doing a fresh install,
then <b>BEFORE</b> rebooting, run
<pre>
    /mnt/usr/sbin/pwd_mkdb -d /mnt/etc /mnt/etc/master.passwd
    cp /dev/null /mnt/var/log/lastlog
    cp /dev/null /mnt/var/log/wtmp
</pre>
</li>
<li>Now that the base and X are updated, install new packages:
<pre>
    pkg_add -z -l /root/pkg_list_manual
    pkg_add -za -l /root/pkg_list_full
</pre>
</li>
</ol>

<h3>Package notes</h3>

<ul>
<li>Reminder: if you rely on anything from packages for management
access to the system (for example: shells, VPN software, routing daemons,
etc), arrange alternative access before removing packages.
<li>Various packages use non-portable data formats in cache files etc.
If you run into problems it may be necessary to remove these.
<li>If using the <b>rrdtool</b> package, note that the binary RRD database file
format on 32-bit architectures will not be compatible.
Export any RRD files to XML format before updating:
<pre>
    # Single file:
    rrdtool dump filename.rrd filename.xml

    # To convert a batch:
    for i in *.rrd; do rrdtool dump $i ${i%.rrd}.xml; done
</pre>
After updating, restore them as follows:
<pre>
    # Single file:
    rrdtool restore filename.xml filename.rrd

    # To convert a batch:
    for i in *.xml; do rrdtool restore $i ${i%.xml}.rrd; done
</pre>
This is not necessary on 64-bit architectures (amd64, sparc64, etc).
<li>If using the <b>postgresql</b> package, this has had a major version update
which requires the usual dump+restore cycle as described in the update notes
(see /usr/local/share/doc/pkg-readmes/postgresql*).
<b>The old database must be dumped *before* upgrading OpenBSD.</b>
Also note that because all old packages are removed, the normal warning
from pkg_add at update time is not triggered.
</ul>

<p>
<a name="20130813b"></a>
<h3>2013/08/13 - new identd(8) implementation</h3>
/usr/libexec/identd has been replaced by a new libevent-based daemon,
/usr/sbin/identd.
You should remove the old version:
<pre>
   rm -f /usr/libexec/identd
</pre>
If you are currently using
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=identd&sektion=8">identd(8)</a>
as a standalone daemon (identd_flags is set in /etc/rc.conf.local),
check the manual to confirm that the flags are still valid.<p>
If you are currently using it from
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=inetd&sektion=8">inetd(8)</a>,
remove the "ident" entries from /etc/inetd.conf, set identd_flags instead,
reload inetd and start identd:
<pre>
   $EDITOR /etc/inetd.conf
   $EDITOR /etc/rc.conf.local
   /etc/rc.d/inetd reload
   /etc/rc.d/identd start
</pre>
Note that if you have not yet run sysmerge, "/etc/rc.d/identd start" will
report a failure.

<p>
<a name="20130816"></a>
<h3>2013/08/16 - vlan(4) and pppoe(4) ABI breaks</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vlan&sektion=4">vlan(4)</a> and <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pppoe&sektion=4">pppoe(4)</a>
now use their own set of dedicated ioctls. So make sure to compile and install
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&sektion=8">ifconfig(8)</a> against the new headers if you are building your kernel from source.
<p>
This specially applies to people relying on these interfaces and willing to cross
the <a href="#20130813">time_t ABI break</a> by updating with source.

<p>
<a name="20130823"></a>
<h3>2013/08/23 - [ports] php 5.4</h3>
The primary PHP version used in ports has switched to 5.4.
This change means that if you run PHP applications packaged in ports,
you will need to switch your webserver config to use the newer version
of PHP.
Check /etc/php-5.3.ini for changes from the default configuration:
<pre>   diff /usr/local/share/examples/php-5.3/php.ini-production /etc/php-5.4.ini</pre>
and carry them across to /etc/php-5.4.ini.
You will also need to check for links to any active PHP extension modules
in /etc/php-5.3 and re-create them in /etc/php-5.4, e.g.
<pre>   cd /etc/php-5.4
   ls -l ../php-5.4.sample
   ln -s ../php-5.4.sample/pdo_mysql.ini .
   # (etc)
</pre>
If you are currently using PHP with Apache in base, you will also need to
adjust your Apache configuration:
<pre>   cd /var/www/conf/modules
   ln -fs /var/www/conf/modules.sample/php-5.4.conf /var/www/conf/modules/php.conf</pre>

<p>
<a name="20130914"></a>
<h3>2013/09/14 - [ports] dspam 3.10.2</h3>
If you were using one of the mysql or pgsql FLAVORS of the <b>dspam</b> package
you will have to manually install the corresponding driver subpackage after the
update to the 3.10.2 version.
If you were using dspam with the PostgreSQL driver:
<pre>
   pkg_add dspam-pgsql
</pre>
If you were using dspam with the MySQL driver:
<pre>
   pkg_add dspam-mysql
</pre>

<p>
<a name="20130919"></a>
<h3>2013/09/19 - [ports] wordpress 3.6.1</h3>
The twentyeleven theme from wordpress 3.5.x is no longer included with
wordpress 3.6.x. If you are using this theme, back it up before updating:
<pre>
   cd /var/www/wordpress/wp-content/themes &&
   cp -Rp twentyeleven twentyeleven.bak
</pre>
and restore it after wordpress update:
<pre>
   cd /var/www/wordpress/wp-content/themes &&
   mv twentyeleven.bak twentyeleven
</pre>

<p>
<a name="20131010"></a>
<h3>2013/10/10 - [ports] Apache Subversion 1.8.3</h3>
Apache Subversion has been upgraded to version 1.8.3.
This release of Subversion updates the working copy format (client-side).
Existing working copies need to be upgraded using <tt>svn upgrade</tt>
because Subversion 1.8 cannot operate with older working copy formats.
See the <a href="http://subversion.apache.org/docs/release-notes/1.8.html#wc-upgrade"
>section about working copy upgrades</a> in Subversion's release notes for details.
The server is fully backwards compatible and will serve existing repositories just fine.
However, to take advantage of new FSFS repository features a repository upgrade is necessary.
See the <a href="http://subversion.apache.org/docs/release-notes/1.8.html#fsfs-enhancements"
>section about FSFS enhancements</a> for details.

<p>
<a name="20131012"></a>
<h3>2013/10/12 - pf queue changes</h3>
PF has a new implementation of packet queueing - the configuration syntax
is different to that used by altq.
During a transition period, the old mechanism is still available by
replacing "queue" keywords in /etc/pf.conf with "oldqueue".
If instead you wish to switch to the new implementation, review the
documentation in
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&sektion=5">pf.conf(5)</a>.

<p>
<a name="20131014"></a>
<h3>2013/10/14 - [ports] PostgreSQL 9.3.0</h3>
Major update to 9.3.0. A dump/restore is required.

<p>
<a name="20131019"></a>
<h3>2013/10/17 - [ports] Lout 3.40</h3>
<!-- XXX 5.4->5.5 upgrade notes do not need to mention this as we are
         telling people to remove/reinstall all packages  -->
Lout packages were merged and require removal before upgrade: 
<pre>
    pkg_delete lout lout-doc
    pkg_add lout
</pre>

<p>
<a name="20131031"></a>
<h3>2013/10/31 - new routing message version</h3>
To convert the route expire time to 64 bit, it was necessary to
change the routing message structure.
Make sure that you boot a new kernel before replacing the user land
programs.
<br>
A small compatibility layer allows to configure addresses with old
ifconfig and new kernel.
Old route get also works in this setup.
Old dhclient with new kernel assigns the address but hangs.
Make sure to reboot your machine sucessfully during transition.

<p>
<a name="20131103"></a>
<h3>2013/11/03 - [ports] ngircd 21</h3>
ngircd's configuration directory has changed; if updating from a previous
version, you will need to move your old configuration file into place:
<pre>
   mv /etc/ngircd.conf /etc/ngircd/ngircd.conf
</pre>
Additional steps may be needed if you have configured it to use a motd file,
ssl or chroot.

<p>
<a name="20131105"></a>
<h3>2013/11/05 - [ports] RRDtool 1.4.8</h3>
RRDtool has changed to using Cairo/Pango for graph and text generation.
If using it in a chroot jail (for cgi/php scripts, etc), you will need to
take additional steps to install the relevant files.
A script is provided to copy the relevant libraries and support files;
see <a href="http://www.openbsd.org/cgi-bin/cvsweb/~checkout~/ports/net/rrdtool/pkg/README-main">/usr/local/share/doc/pkg-readmes/rrdtool-1.4.8</a>
for more details.

<p>
<a name="20131106"></a>
<h3>2013/11/06 - smtpd.conf changes</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=smtpd&sektion=8">smtpd(8)</a>
configuration file parser was updated.
Some changes might require existing setups to be adapted.
<p>
SSL certificates must be explicitely defined,
and the "certificate" keyword becomes "pki" in listen and relay rules.
<pre>
  pki mail.example.com certificate "/etc/ssl/mail.example.com.crt" \
                       key "/etc/ssl/private/mail.example.com.key"
  listen on egress tls pki mail.example.com auth
</pre>
<p>
The "ssl" keyword in relay urls becomes "secure".
<pre>
  table secrets file:/etc/mail/secrets
  accept for any relay via secure+auth://label@some.mx auth &lt;secrets&gt;
</pre>
<p>
Rules matching on source address must use "from source" rather than just "from".
<pre>
  accept from source "192.168.0.0/16" for any relay
</pre>
<p>
The "helo" keyword in relay rules becomes "hostnames".
<pre>
  accept for any relay source &lt;source&gt; hostnames &lt;htable&gt;
</pre>
<p>
See <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=smtpd.conf&sektion=5">smtpd.conf(5)</a>
for more details.

<p>
<a name="20131119"></a>
<h3>2013/11/19 - [ports] Icinga 1.10</h3>
Note that the deprecated (and ignored) "log_external_commands_user" option
has been removed from Icinga.
If this is present in your configuration, Icinga will fail to start until
you remove it.
This is in addition to the database schema upgrades that are needed as
usual for Icinga-web/NDOUtils users (see the pkg-readme for more
information).

<p>
<a name="20131126"></a>
<h3>2013/11/26 - NSD 4.0.0 (updated 2014/01/07 with info about zonec)</h3>
NSD has had a major update to 4.0.0 which requires some changes.

<pre>
  mv /etc/nsd.conf /var/nsd/etc/nsd.conf
  cd /usr/sbin &amp;&amp; rm nsd-notify nsd-patch nsd-xfer nsd-zonec nsdc
  cd /usr/share/man/man8 &amp;&amp; rm nsd-notify.8 nsd-patch.8 nsd-xfer.8 \
    nsd-zonec.8 nsdc.8
  chown _nsd /var/nsd/db/nsd.db
  printf '\nremote-control:\n\tcontrol-enable: yes\n' &gt;&gt; /var/nsd/etc/nsd.conf
</pre>

<ul>
<li>If you use "include" lines in nsd.conf, move the files into the chroot
path (/var/nsd) and change the include lines to specify the full path
(include: "/var/nsd/etc/nsd.local").
NSD strips the chroot prefix as needed.</li>

<li>Remove any old cronjobs that run "nsdc patch", this is no longer needed.
If you wish to write slaved zones to the readable data files, you may like
to change this for a 'nsdc-control write' job.</li>

<li>Check nsd_flags in /etc/rc.conf.local; NSD is now started by
nsd-control(8) so nsd(8) flags are no longer available.</li>

<li>It is no longer necessary to compile zone files manually with zonec.
This is now handled automatically by the main program.</li>
</ul>

<p>
<a name="20131204"></a>
<h3>2013/12/04 - libcompat removed (updated 2013/12/08)</h3>
libcompat has been removed from base:
<pre>
   rm -f /usr/lib/libcompat.a /usr/lib/libcompat_p.a
   rm -f /usr/include/{re_comp,regexp,sgtty,sys/timeb}.h
   rm -f /usr/share/man/man3/{re_comp,re_exec,rexec,regexp}.3
   rm -f /usr/share/man/man3/{cuserid,ftime,gtty,setrgid,setruid,stty}.3
</pre>

<p>
<a name="20131215"></a>
<h3>2013/12/15 - popa3d removed</h3>
popa3d has been removed from base:
<pre>
   rm -f /etc/rc.d/popa3d
   rm -f /usr/sbin/popa3d
   rm -f /usr/share/man/man8/popa3d.8
</pre>

<p>
<a name="20131216"></a>
<h3>2013/12/16 - cwm(1) default keybinding change</h3>
Default keybinding changed for 'maximize' from CM-f to CM-m.  CM-f is now
bound to the new 'fullscreen' mode.  See
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cwmrc&sektion=5">cwmrc(5)</a> for re-mapping details.

<a name="20131228"></a>
<h3>2013/12/28 - i386 is now PIE</h3>
The i386 platform has been switched to
PIE (position-independent executables) by default.
Everyone is encouraged to update via snapshots (dated after 2013/12/28); if you
want to upgrade via sources, follow these instructions:
<p>
First, install the new system Makefiles with the change to PIE_ARCH in
bsd.own.mk:
<blockquote><pre>
<b>cd /usr/src/share/mk && sudo make install
</b></pre></blockquote>
Then, recompile and install gcc and binutils.
<blockquote><pre>
<b>cd /usr/src/gnu/usr.bin/binutils
make -f Makefile.bsd-wrapper clean && make -f Makefile.bsd-wrapper obj && \
       make -f Makefile.bsd-wrapper depend && make -f Makefile.bsd-wrapper
cd /usr/src/gnu/usr.bin/cc
make clean && make obj && make depend && make && sudo make install
cd /usr/src/gnu/usr.bin/binutils && sudo make -f Makefile.bsd-wrapper install
</b></pre></blockquote>
Finally, recompile your system by following the procedure outlined in
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=release&sektion=8">release(8)</a>.

<a name="20131228b"></a>
<h3>2013/12/28 - atexit(3) moved</h3>
To support the use of atexit(3) in dynamically loaded shared objects,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=atexit&sektion=3">atexit(3)</a>
is now provided by the C runtime startup files.
If you want to upgrade via source you will need to build and install
new C runtime startup files first:
<pre>
    cd /usr/src/lib/csu
    make clean
    make obj
    make depend
    make
    make install
</pre>
Now you can follow the standard procedure outlined in
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=release&sektion=8">release(8)</a>.

<a name="20140112"></a>
<h3>2014/01/12 - freetype updated</h3>
Freetype in Xenocara was updated to 2.5.2. This update moves the
headers files around. Old headers need to be manually removed:
<pre>
    rm -rf /usr/X11R6/include/freetype2/freetype
    rm -f /usr/X11R6/include/ft2build.h
</pre>

<a name="20140120"></a>
<h3>2014/01/20 - amd64/i386 installboot</h3>
The amd64 and i386 architectures have switched to the new
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=installboot&sektion=8">installboot(8)</a>.
As a result, the old binary and manual should be removed:
<pre>
    rm -f /usr/mdec/installboot
    rm -f /usr/share/man/man8/{amd64,i386}/installboot.8
</pre>

<a name="20140210"></a>
<h3>2014/02/10 - [ports] No Java on i386</h3>
Be aware that Java is currently broken on i386 so packages are not available.
If you rely on Java on OpenBSD, you will either need to make a new installation
with the amd64 architecture (which supports 64-bit Intel CPUs as well as AMD
CPUs), or stay with an older version of OpenBSD.

<a name="20140214"></a>
<h3>2014/02/14 - amd64/i386 serial consoles need current bootloader</h3>
This is a reminder of a change which
<a href="http://permalink.gmane.org/gmane.os.openbsd.cvs/124092">took place
earlier</a>: backward compatibility for learning about a serial console device
from old boot loaders was removed.
This only affects those who will be doing a <b>remote</b> upgrade <b>via serial
console</b> on <b>amd64/i386</b> who do not already have "BOOT 3.20" (amd64)
or "BOOT 3.18" (i386).<p>
The boot loader is updated as part of the normal upgrade procedure
via the install media, but users who have previously upgraded from
OpenBSD 5.2 or earlier using the "without install kernel" method on a
running system may have missed this step.
If this is the case, you can either do a ramdisk-based update to
OpenBSD 5.4 first (even if you are already running 5.4), or manually
use
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=installboot&manpath=OpenBSD+5%2e4&arch=i386">installboot(8)</a>
<!-- XXX do not update 5.4 link above to 5.5, this needs to show the old
installboot syntax which has now changed -->
to update to boot blocks from OpenBSD 5.3 or 5.4, before attempting to
boot a 5.5 kernel or installer.

<!-- 5.5 entries start below here -->

<a name="20140312"></a>
<h3>2014/03/12 - rmail removed</h3>
/bin/rmail has been removed.
<pre>
    rm -f /bin/rmail
    rm -f /usr/share/man/man8/rmail.8
</pre>

<a name="20140312b"></a>
<h3>2014/03/12 - smtpd becomes default MTA</h3>
The default system MTA is now smtpd. If you are running sendmail with anything
other than the default configuration, please exercise caution and care
when upgrading. The sendmail cronjob should be disabled, /etc/mailer.conf
and /etc/rc.conf{,local} should be checked to verify one and only one MTA is
enabled, and newaliases run.
<pre>
    crontab -e
    vi /etc/mailer.conf
    vi /etc/rc.conf
    vi /etc/rc.conf.local
    newaliases
</pre>

<a name="20140312c"></a>
<h3>2014/03/12 - spray removed</h3>
/usr/sbin/spray and the associated rpc daemon have been removed.
<pre>
    rm -f /usr/sbin/spray
    rm -f /usr/libexec/rpc.sprayd
    rm -f /usr/share/man/man8/{,rpc.}spray{,d}.8
    vi /etc/inetd.conf
</pre>

<a name="20140313"></a>
<h3>2014/03/13 - _smtpq user added</h3>
A new <em>_smtpq</em> user and group have been added to support privilege
separation in smtpd. Add the following passwd line using vipw.
<pre>
_smtpq:*:103:103::0:0:SMTP Daemon:/var/empty:/sbin/nologin
</pre>
Add the following line to /etc/group.
<pre>
_smtpq:*:103:
</pre>
If you have previously started smtpd, you will need to change the owner of
the queue subdirectories.
<pre>
    cd /var/spool/smtpd
    chown -R _smtpq corrupt incoming purge queue temporary
</pre>

<a name="20140313b"></a>
<h3>2014/03/13 - httpd(8) removed</h3>
/usr/sbin/httpd and the associated tools and files have been removed.
Consider using
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=nginx&sektion=8">nginx(8)</a>
for your http serving needs, but note that nginx is not a drop-in replacement.
If you need the old httpd(8) or tools (e.g. logresolve, htdigest,
etc) and cannot switch at this time, see the port www/apache-httpd-openbsd.
Packages are not yet available due to release engineering, but will follow.
All users need to remove the following files and directories:
<pre>
    rm -r /usr/lib/apache
    rm -r /usr/share/doc/html/httpd
    rm /usr/bin/{dbmmanage,htdigest}
    rm /usr/sbin/{apachectl,apxs,httpd,logresolve,rotatelogs,suexec}
    rm /usr/share/man/man1/{dbmmanage.1,htdigest.1}
    rm /usr/share/man/man8/{apachectl.8,apxs.8,httpd.8,logresolve.8}
    rm /usr/share/man/man8/{rotatelogs.8,suexec.8}
    rm /etc/rc.d/httpd
</pre>

The following files are associated with httpd(8) and can be deleted in some
cases, but may have been replaced with user content or configuration.
<b>Warning: On systems which currently or have previously used any http daemon,
care must be taken and files analyzed case by case to avoid accidental deletion
of user content or important configuration files.</b>
In particular, users moving to apache-httpd-openbsd will want to keep many
of these files.
<pre>
    rm -r /var/www/icons
    rmdir /var/www/conf/{modules,modules.sample}
    rmdir /var/www/users
    rm /var/www/cgi-bin/{printenv,test-cgi}
    rm /var/www/conf/{httpd.conf,magic,mime.types}
    rm /var/www/htdocs/{apache_pb.gif,blowfish.jpg,bsd_small.gif,index.html}
    rm /var/www/htdocs/{lock.gif,logo23.jpg,logo24.jpg,mod_ssl_sb.gif}
    rm /var/www/htdocs/{openbsd_pb.gif,openbsdpower.gif,openssl_ics.gif}
    rm /var/www/htdocs/smalltitle.gif
</pre>
Many PHP applications will work under nginx with few or minimal changes;
in most cases php-fpm is the preferred method of running PHP under nginx.

<a name="20140316"></a>
<h3>2014/03/16 - [ports] unbound(8) moved to base</h3>
Unbound has moved to the base OS; if the package is installed,
remove it before upgrading to avoid a conflict in /etc/rc.d/unbound:

<pre>
    pkg_delete unbound
</pre>

<a name="20140317"></a>
<h3>2014/03/17 - ftpd(8) disallows uid &lt; 1000 by default</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&sektion=8">ftpd(8)</a>
now defaults to denying access to user accounts with uid below 1000.
See the -m option if you need to change this.

<a name="20140317b"></a>
<h3>2014/03/17 - userland agp(4) interfaces removed</h3>
With the introduction of KMS, userland access to
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=agp&sektion=4">agp(4)</a>
is no longer needed.  Since these interfaces provided low-level access
to the hardware, they have been removed.  You should remove the associated header file:
<pre>
    rm -f /usr/include/sys/agpio.h
</pre>

<a name="20140317c"></a>
<h3>2014/03/17 - userland ppp(8) and pppoe(8) implementations removed</h3>
The userland <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ppp&sektion=8&manpath=OpenBSD+5.4">ppp(8)</a>
daemon and its associated PPPoE helper,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pppoe&sektion=8&manpath=OpenBSD+5.4">pppoe(8)</a>,
have been removed.
As a result, the old binaries and manual pages should be removed:
<pre>
    rm -f /etc/ppp/ppp.{conf,linkdown,linkup,secret}.sample
    rm -f /usr/sbin/ppp /usr/share/man/man8/ppp.8
    rm -f /usr/sbin/pppctl /usr/share/man/man8/pppctl.8
    rm -f /usr/sbin/pppoe /usr/share/man/man8/pppoe.8
</pre> 
Many users will be able to migrate to the kernel implementations:
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pppoe&sektion=4">pppoe(4)</a>
(for PPPoE),
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ppp&sektion=4">ppp(4)</a>
and its associated control program
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pppd&sektion=8">pppd(8)</a>
(for modems, mobile data, and some use with userland programs via a pipe).<p>
Another option for some users is
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=npppd&sektion=8">npppd(8)</a>
which supports L2TP, PPTP and PPPoE (currently server-side, IPv4 only).

<a name="20140317d"></a>
<h3>2014/03/17 - uucpd(8) removed</h3>
uucpd(8) has been removed.
As a result, the old binaries and manual pages should be removed:
<pre>
    rm -f /usr/libexec/uucpd
    rm -f /usr/share/man/man8/uucpd.8
</pre>

<a name="20140319"></a>
<h3>2014/03/19 - rcp(1) removed</h3>
rcp(1) has been removed.
As a result, the binary and manual page should be removed:
<pre>
    rm -f /bin/rcp /usr/share/man/man1/rcp.1
</pre>


<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../images/back.gif" border= "0" alt="[back]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>$OpenBSD: current.html,v 1.476 2014/03/21 03:11:16 lteo Exp $</small>

</body>
</html>

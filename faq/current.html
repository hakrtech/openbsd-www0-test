<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Following -current</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 2005-2009 by OpenBSD">
</head>

<body bgcolor= "#ffffff" text= "#000000">
<a href="../index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../images/smalltitle.gif" border="0">    
</a>
<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
</font>

<p>

<h1><font color="#e00000">Following <i>-current</i></font></h1>
<hr>

<h3>Table of Contents</h3>
<p>
<ul>
<li><a href="#Intro">Introduction</a>
<!-- Oldest on top... -->
<li><a href="#20090304">2009/03/04 - new user and group for smtpd</a>
<li><a href="#20090316">2009/03/16 - makemap(8) now run through mailwrapper(8)</a>
<li><a href="#20090324">2009/03/24 - "redistribute default" behaviour change in ospfd(8) and ripd(8)</a>
<li><a href="#20090406">2009/04/06 - incompatible changes to pf(4)</a>
<li><a href="#20090407">2009/04/07 - fragment reassembly on by default</a>
<li><a href="#20090426">2009/04/26 - require-order off by default in pfctl(8)</a>
<li><a href="#20090520">2009/05/20 - new user and group for rpc.rwalld</a>
<li><a href="#20090525">2009/05/25 - update of daily(8), weekly, monthly,
                                     security(8)</a>
<li><a href="#20090531">2009/05/31 - pf enabled by default</a>
<li><a href="#20090602">2009/06/02 - tmux(1) moved from ports to base</a>
<li><a href="#20090603">2009/06/03 - httpd ABI change</a>
<li><a href="#20090626">2009/06/26 - updated lynx(1)</a>
<li><a href="#20090703">2009/07/03 - updated bnx(4) driver</a>
<li><a href="#20090721">2009/07/01 - [ports] New postgresql release</a>
<li><a href="#20090724">2009/07/24 - thread model posix enabled for gcc 3</a>
<!-- New additions go on the bottom, please -->
</ul>
    
<hr>

<a name="Intro"></a>
<!-- XXXversion -->
<h2>Introduction</h2>
This document is for people who wish to follow <i>-current</i>.
It contains information about changes from 4.5-release to <i>-current</i>,
and should NOT be used by anyone upgrading from 4.4 or earlier, or people
wishing to follow <a href="../stable.html"><i>-stable</i></a>.

<p>
If you wish to update to 4.5-release or 4.5-stable from previous
versions, see the <a href="upgrade45.html">upgrade guide</a>.

<p>
Make sure you have read and understood
<a href="faq5.html">FAQ 5 - Building the System from Source</a>
before using -current and the instructions below.

<p>
You should ALWAYS use a snapshot as the starting point for running
<i>-current</i>.
Upgrading by compiling your own source code is not supported.

<p>
If you wish to see upgrade information for earlier versions of OpenBSD,
see <a href= "upgrade-old.html">upgrade-old.html</a>.
This is provided as a historical record -- it should NOT be used as
an upgrade procedure guide.


<p>
<a name="20090304"></a>
<h3>2009/03/04 - new user and group for smtpd</h3>
The following needs to be run:
<pre>
useradd -u 95 -g =uid -c "SMTP Daemon" -d /var/empty -s /sbin/nologin _smtpd
</pre>

<p>
<a name="20090316"></a>
<h3>2009/03/16 - makemap(8) now run through mailwrapper(8)</h3>
Since the connection of smtpd(8) to the build, makemap(8) is run through
mailwrapper(8) to avoid conflict between sendmail and smtpd version of
the binary. For this to work, one has to manually add the following line to
/etc/mailer.conf:
<pre>
makemap		/usr/libexec/sendmail/makemap
</pre>

<p>
<a name="20090324"></a>
<h3>2009/03/24 - "redistribute default" behaviour change in ospfd(8) and ripd(8)</h3>
"redistribute default", set in ospfd.conf(5) and ripd.conf(5) configuration
files, require now the presence of a default route in the kernel routing
table otherwise no route will be announced by ospfd(8) and ripd(8).

<p>
<a name="20090406"></a>
<h3>2009/04/06 - incompatible changes to pf(4)</h3>
Packet normalization ("scrubbing") has been integrated with the
main ruleset. This is now specified by adding the "scrub (options)"
parameter to rules. For example:

<pre>
        scrub in all no-df max-mss 1440
</pre>

can be replaced with a rule using the new "match" action:

<pre>
        match in all scrub (no-df max-mss 1440)
</pre>

Since ruleset ordering is enforced by default, this will either
have to be moved to the main ruleset (before "pass quick" rules),
or ruleset order checking must be disabled:

<pre>
        set require-order no
</pre>

Packet reassembly has been simplified. "Crop" and "drop-ovl" have
been removed; only full reassembly remains. It's enabled like this:

<pre>
        set reassemble yes|no [no-df]
</pre>

If "no-df" is given, fragments (and only fragments!) with the df bit
set have it cleared before entering the fragment cache, and thus the
reassembled packet doesn't have df set either. Non-fragmented packets
are unaffected by no-df.

<p>
<a name="20090407"></a>
<h3>2009/04/07 - fragment reassembly on by default in pf(4)</h3>
Since there is little to no reason not to use fragment reassembly,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&sektion=4">pf(4)</a>
was changed so that it is now enabled by default.

<p>
<a name="20090426"></a>
<h3>2009/04/26 - require-order off by default in pfctl(8)</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&sektion=8">pfctl(8)</a>
was changed so that "set require-order" is now disabled by default.
This is advisory only, no configuration change is necessary.

<p>
<a name="20090520"></a>
<h3>2009/05/20 - new user and group for rpc.rwalld</h3>
The following needs to be run:
<pre>
useradd -u 96 -g =uid -c "rpc.rwalld" -d /var/empty -s /sbin/nologin _rwalld
</pre>

<p>
<a name="20090525"></a>
<h3>2009/05/25 - update of daily(8), weekly, monthly, security(8)</h3>
When updating your periodic maintenance scripts to the latest versions,
pay attention to the following changes:
<ul>
<li>The scripts daily, weekly, and monthly now all use the PATH variable
from the root crontab(5), which is /bin:/sbin:/usr/bin:/usr/sbin by default.
The daily(8) PATH no longer includes /usr/local/bin, the weekly(8) PATH no
longer includes /usr/libexec.  In daily.local, weekly.local and monthly.local,
you can still add additional directories to the PATH.
<li>All four scripts now suppress section headers when there is no content
to follow.  When a script produces no output whatsoever, it does not send
mail to root any more.  This may require adjustment of your parser scripts.
<li>The security(8) script now uses some shell functions from daily(8),
so it cannot run stand-alone.  Use "sudo /bin/sh /etc/daily" in case you
need to run it manually.
</ul>

<p>
<a name="20090531"></a>
<h3>2009/05/31 - pf enabled by default</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&sektion=4">pf(4)</a>
is now enabled by default in rc.conf.

<p>
<a name="20090602"></a>
<h3>2009/06/02 - tmux(1) moved from ports to base</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tmux&amp;sektion=1">tmux(1)</a>
has moved from ports to base. If you installed it from ports,
please remove it with pkg_delete.

<p>
<a name="20090603"></a>
<h3>2009/06/03 - httpd ABI change</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&amp;sektion=8">httpd(8)</a>
was fixed to report correct size of big files, this introduced a change
to its ABI. Because of this some third party modules will have to be rebuilt
or packages updated.

<p>
<a name="20090626"></a>
<h3>2009/06/26 - lynx(1) update</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=lynx&amp;sektion=1">lynx(1)</a>
has been updated to 2.8.6rel.5.  Some directives of configuration
file /etc/lynx.cfg have changed therefore you have to update it:
<blockquote><pre>
# cd /tmp
# ftp ftp://mirror/path/to/snapshots/arch/etc46.tgz
# tar xzpf etc46.tgz ./etc/lynx.cfg
# mv etc/lynx.cfg /etc
</pre></blockquote>
Merge your local changes afterwards.

<p>
<a name="20090703"></a>
<h3>2009/07/03 - updated bnx(4) driver</h3>
<!-- this shouldn't be needed in the 4.6 notes -->
The
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bnx&amp;sektion=4">bnx(4)</a>
driver has been updated to support new controllers.
This includes a change in the way firmware handling is done.
Users with bnx must create the new firmware files before booting a new kernel:
<blockquote><pre>
# cd /sys/dev/microcode/bnx 
# make obj clean
# make 
# make install 
</pre></blockquote>
Alternatively, if upgrading from a binary snapshot on a running system (rather
than via the installer), be sure to extract base46.tgz before rebooting onto the
new kernel.

<p>
<a name="20090721"></a>
<h3>2009/07/21 - [ports] New postgresql version</h3>
The new version of postgresql requires that your databases be dumped
before upgrade and reloaded after.

<p>
<a name="20090724"></a>
<h3>2009/07/24 - thread model posix enabled for gcc 3</h3>
Thread model posix has been enabled for gcc 3 which makes dwarf2 exception
handling thread safe and enables thread safety for libstdc++.
To upgrade follow these steps:
<ul>
<li>Build and install gcc:
<pre>
     # cd /usr/src/gnu/usr.bin/gcc
     # make -f Makefile.bsd-wrapper obj
     # make -f Makefile.bsd-wrapper depend
     # make -f Makefile.bsd-wrapper
     # make -f Makefile.bsd-wrapper install
     # make -f Makefile.bsd-wrapper clean
</pre>
<li><a href="faq5.html#BldUserland">Build and install userland</a>
</ul>

<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../images/back.gif" border= "0" alt="[back]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>$OpenBSD: current.html,v 1.161 2009/07/25 02:06:00 kurt Exp $</small>

</body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>5 - Building the System from Source</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 1998-2005 by OpenBSD.">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
</head>

<body bgcolor= "#ffffff" text= "#000000">
<!-- Passes validator.w3.org.  Please keep it this way -->

<a href="../index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../images/smalltitle.gif" border="0">    
</a>
<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
<a href= "faq4.html">[To Section 4 - Installation Guide]</a>
<a href= "faq6.html">[To Section 6 - Networking]</a>
</font>

<h1><font color="#e00000">5 - Building the System from Source</font></h1>
<hr>

<p>
<h3>Table of Contents</h3>
<ul>
<li><a href= "#Flavors">5.1 - OpenBSD's Flavors</a>
<li><a href= "#Why">5.2 - Why do I need a custom kernel?</a>
<li><a href= "#Options">5.3 - Kernel configuration files</a>
<li><a href= "#Building">5.4 - Building your own kernel</a>
<li><a href= "#BootConfig">5.5 - Boot-time configuration</a>
<li><a href= "#VerboseBoot">5.6 - Getting more verbose output during
  boot</a>
<li><a href= "#config">5.7 - Using config(8) to change your kernel</a>
<li><a href="#buildprobs">5.8 - Common Problems when
  Compiling and Building</a>
   <ul>
   <li><a href="#sig11">5.8.1 - The build stopped with a "Signal 11" error</a>
   <li><a href="#snake">5.8.2 - "make build" fails with "cannot open output
      file snake: is a directory"</a>
   </ul>
<li><a href="#BldRelease">5.9 - How do I build an OpenBSD release?</a>
</ul>
<hr>
<br>


<a name="Flavors"></a>
<h2>5.1 - OpenBSD's Flavors</h2>
<!-- XXXversion - revise doodle -->
There are three "flavors" of OpenBSD:
<ul>
<li><b>-release:</b> The version of OpenBSD shipped every six months on CD.
<li><b>-stable:</b>  Release, plus patches considered critical to security
    and reliability.
<li><b>-current:</b> The to-the-moment version of OpenBSD, which will 
    turn into the next release.
</ul>

Graphically, the development of these flavors looks something like
this:

<blockquote>
<pre>
       ,------o-----------o----X                    3.3 Stable
       |      .           .
       |      .    ,------o---------o----X          3.4 Stable
       |      .    |      .         .
       |      .    |      .    ,----o----------o--&gt; 3.5 Stable
       |      .    |      .    |    .          .
       |      .    |      .    |    .    ,-----o--&gt; 3.6 Stable
       |      .    |      .    |    .    |     .
       |      .    |      .    |    .    |     .
 --&gt;3.3Rel-----&gt;3.4Rel-----&gt;3.5Rel-----&gt;3.6Rel----&gt; Current 

          Time ---&gt;
</pre>
</blockquote>

<p>
The code tree is branched between <i>-current</i>, <i>-release</i> and
<i>-stable</i> every six months -- <i>-release</i> becomes a frozen point
(a &quot;Tag&quot;) in the history of the source tree - it is never
changed, and is what is on the <a href="../orders.html">CDs</a> and 
<a href="../ftp.html">FTP
servers</a>.  <i>-Current</i> is where active work is done, and turns
into the next <i>-release</i> of OpenBSD.

<p>
The <i>-stable</i> (also known as the "Patch branch") is based on
<i>-release</i>, and as one can see, it is a "branch" from the
development path of OpenBSD.  As important fixes are made to
<i>-current</i>, they are "back ported" into the <i>-stable</i>
branches.  In the above illustration, the vertical dotted lines are bug
fixes being incorporated into the <i>-stable</i> branches.  You will
also note that in the above example, the <i>3.3-stable</i> branch came
to an end with <i>3.5-release</i>, and the <i>3.4-stable</i> branch came
to an end with <i>3.6-release</i> -- old releases are typically supported
up to two
releases back.  It takes resources and time to support older versions,
while we might like to provide ongoing support for old releases, we
would rather focus on new features.  The <i>-stable</i> branch is, by
design, very easy to build from <i>-release</i> of the same version
(i.e., going from <i>3.6-release</i> to <i>3.6-stable</i>).

<p>
The <i>-stable</i> branch is <i>-release</i> plus patches found on the
<a href="../errata.html">errata page</a>, and some simple fixes that do
not merit an errata entry.  Usually, the operation of <i>-stable</i> is
the same as the <i>-release</i> it is based on.  If the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi">man pages</a> have to
change, it probably won't go into <i>-stable</i>.  In other words, new
device support will NOT be added to <i>-stable</i>, and new feature
support will rarely be added unless it is considered very important. 

<p>
It is worth pointing out that the name "<i>-stable</i>" is not intended
to imply that <i>-current</i> is unreliable.
Rather, <i>-current</i> is changing and evolving, whereas the operation
of <i>-stable</i> is not going to change, so you won't have to relearn
your system.
In fact, as our hope is to continually improve OpenBSD, you may well 
find the reliability of <i>-current</i> is greater than that of 
<i>-stable</i>.

<p>
Warning: <i>-current</i> is a moving target.  It changes minute by
minute,
and may well change several times in the time it takes to retrieve the
source code.  As indicated earlier, there is no promise that the system
compiles or that it works (of course, the hope is it does).  It is
entirely possible and not uncommon to get the <i>-current</i> source and
have it fail to compile, whereas five minutes later, it may work just
fine.  <b>If you are not prepared to deal with this, stay away from
<i>-current</i>.</b>

<p>
Most users should be running either <i>-stable</i> or <i>-release</i>.
That being said, many people do run <i>-current</i> on production
systems, and it is important that some people do so to identify bugs and
test new features.  However, if you don't know how to properly describe,
diagnose and deal with a problem, don't tell yourself (or anyone else)
that you are "helping the project" by running <i>-current</i>.  "It
didn't work!" is not a <a href="../report.html#bugtypes">useful bug
report</a>.  "The recent changes to the pciide driver broke
compatibility with my Slugchip-based IDE interface, dmesg of working and
broken systems follow..." might be a useful report.

<p>
There are times where "normal" users may wish to live on the cutting
edge and run <i>-current</i>. The most common reason is that the user 
has a device
which is not supported by <i>-release</i> (and thus, not <i>-stable</i>),
or wishes to use a new feature of the <i>-current</i>.  In this case, the
choice may be either <i>-current</i> or not using the device, and
<i>-current</i> may be the lesser evil.  However, one should not expect
hand-holding from the developers.

<h3>Snapshots</h3>
Between formal releases of OpenBSD, <i>snapshots</i> are made available
through the <a href="../ftp.html">FTP sites</a>.  As the name implies,
these are builds of whatever code is in the tree at the instant the
builder grabbed a copy of the code for that particular platform.
Remember, on some platforms, it may be DAYS before the snapshot build
is completed and put out for distribution.  There is no promise that the
snapshots are completely functional, or even install.  Often, a change
that needs to be tested may trigger snapshot creation.  Some
platforms have snapshots built on an almost daily basis, others will be
much less frequent.  If you desire to run <i>-current</i>, a recent
snapshot is often all you need, and upgrading to a snapshot is a
required starting point before attempting to build <i>-current</i>
from source.

<p>
It is sometimes asked if there is any way to get a copy of exactly the
code used to build a snapshot.  The answer is no.  First, there is no
significant benefit to this.  Second, the snapshots are built as
desired, as time permits, and as resources become available.  On fast
platforms, several snapshots may be released in one day.  On
slower platforms, it may take a week or more to build a snapshot.
Providing tags or markers in the source tree for each snapshot would be
quite impractical.

<h3>Keeping Things in Sync</h3>
It is important to understand that OpenBSD is an Operating System, 
intended to be taken as a whole, not a kernel with a bunch of utilities
stuck on.  You must make sure your kernel, "userland" (the supporting
utilities and files) and <a href="../ports.html"><tt>ports</tt></a> tree
are all in sync, or unpleasant things will happen.  Said another way
(because people just keep making the error), you can not run brand new
<tt>ports</tt> on a month old system, or rebuild a kernel from <i>-current</i>
source and expect it to work with a <i>-release</i> userland.  Yes,
this does mean you need to update your system if you want to run a new 
program which was added to the ports tree today.  Sorry,
but again, OpenBSD has limited resources available.

<p>
One should also understand that when 
<a href="upgrade-minifaq.html">upgrading by source</a>, the update
process is supported in <b>only one direction: from older to newer</b>,
and from <i>-stable</i> to <i>-current</i>.  You can not run
<i>3.6-current</i> (or a snapshot), then decide you are living too
dangerously, and step back to <i>3.6-stable</i>.  You are on your own if
you choose any path other than the supported option of reloading your
system from scratch, do not expect assistance from the OpenBSD
development team.

<p>
Yes, this does mean you should think long and hard before committing
yourself to using <i>-current</i>.


<p>
<a name="Why"></a>
<h2>5.2 - Why do I need a custom kernel?</h2>

<p>
Actually, you probably don't.

<p>
A custom kernel is a kernel built with a configuration file other than 
the provided <tt>GENERIC</tt> configuration file.
A custom kernel can be based on <a href="#Flavors"><i>-release,
-stable</i> or <i>-current</i></a> code, just as a <tt>GENERIC</tt>
kernel can be.
While compiling your own <tt>GENERIC</tt> kernel is supported by the
OpenBSD team, compiling your own custom kernel is <i>not</i>.

<p>
The standard OpenBSD kernel configuration (<tt>GENERIC</tt>) is designed
to be suitable for most people.
More people have broken their system by trying to tweak their
kernel than have improved system operation.
There are some people that believe that you must customize your kernel
and system for optimum performance, but this is not true for OpenBSD.
Only the most advanced and knowledgeable users with the most demanding 
applications need to worry about a customized kernel or system.

<p>
Some reasons you might want or need to build a custom kernel:
<ul>
  <li>You really know what you are doing, and want to shoe-horn
      OpenBSD onto a computer with a small amount of RAM
      by removing device drivers you don't need.
  <li>You really know what you are doing, and wish to remove default
      options or add options which may not have been enabled by default
      (and have good reason to do so).
  <li>You really know what you are doing, and wish to enable experimental
      options.
  <li>You really know what you are doing, and have a special need that is
      not met by <tt>GENERIC</tt>, and
      aren't going to ask why it doesn't work if something goes wrong.
</ul>

<p>
Some reasons why you should not build a custom kernel:
<ul>
  <li>You do not need to, normally.
  <li>You will not get a faster system.
  <li>You are likely to make a less reliable machine.
  <li>You will not get any support from developers.
  <li>You will be expected to reproduce any problem with a <tt>GENERIC</tt>
      kernel before developers take any problem report seriously.
  <li>Users and developers will laugh at you when you break your system.
  <li>Custom compiler options usually do a better job of exposing
      compiler problems than improving system performance.

</ul>

<p>
Removing device drivers may speed the boot process on your system, but
can complicate recovery should you have a hardware problem, and is
very often done wrong.  
Removing device drivers <i>will not</i> make your system run faster by
any noticeable amount, though can produce a smaller kernel.
Removing debugging and error checking can result in a measurable
performance gain, but will make it impossible to troubleshoot a system
if something goes wrong.


<p>
Again, developers will
usually ignore bug reports dealing with custom kernels, unless the
problem can be reproduced in a <tt>GENERIC</tt> kernel as well.
You have been warned.

<p>
<a name="Options"></a>
<h2>5.3 - Kernel configuration files</h2>
OpenBSD kernel generation is controlled by configuration files, 
which are located in the <tt>/usr/src/sys/arch/<i>&lt;arch&gt;</i>/conf/</tt>
directory by default.  All architectures have a file, <tt>GENERIC</tt>,
which is used to generate the standard OpenBSD kernel for that platform.
There may also be other configuration files which are used to create 
kernels with different focuses, for example, for minimal RAM, diskless
workstations, etc.  

<p>
The configuration file is processed by 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>,
which creates and populates a compilation directory in <tt>../compile</tt>,
on a typical installation, that would be in
<tt>/usr/src/sys/arch/<i>&lt;arch&gt;</i>/compile/</tt>.  config(8) also creates
a <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=make&amp;sektion=1">Makefile</a>,
and other files required to successfully build the kernel.

<p>
Kernel Configuration Options are options that you add to your kernel
configuration that place certain features into your kernel. This allows
you to have exactly the support you want, without having support for
unneeded devices. There are a multitude of options that allow you to
customize your kernel. Here we will go over only some of them, those that
are most commonly used. Check the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=options&amp;sektion=4">options(4)</a>
man page for a complete list of options, and as these change from time
to time, you should make sure you use a man page for the same version of
OpenBSD you are building. You can also check the example configuration
files that are available for your architecture.

<p>
<b>Do not add, remove, or change options in your kernel unless you
actually have a reason to do so!</b>  The only kernel configuration
which is supported by the OpenBSD team is the GENERIC kernel, the
combination of the options in
<tt>/usr/src/sys/arch/&lt;<i>arch</i>&gt;/conf/GENERIC</tt>
and <tt>/usr/src/sys/conf/GENERIC</tt> <i>as shipped by the OpenBSD
team</i> (i.e., NOT edited).  Reporting a problem on a customized kernel
will almost always result in you being told to try to reproduce the
problem with a GENERIC kernel.  Not all options are compatible with
each other, and many options are required for the system to work.  There
is no guarantee that just because you manage to get a custom kernel
compiled that it will actually run.

<p>
You can see the platform-specific configuration files here:
<ul>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/alpha/conf/">alpha Kernel Configuration Files </a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/i386/conf/">i386 Kernel Configuration files</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/macppc/conf/">macppc Kernel Configuration files</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/sparc/conf/">sparc Kernel Configuration Files</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/sparc64/conf/">sparc64 Kernel Configuration Files</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/vax/conf/">vax Kernel Configuration Files</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/hppa/conf/">hppa Kernel Configuration Files</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/">Other Arch's</a>
</ul>

<p>
Look closely at these files and you will notice a line near the top
similar to:
<pre>
     include "../../../conf/GENERIC"
</pre>
This means that it is referencing another configuration file, one
that stores platform-independent options.  When creating your Kernel
Config, be sure to look through 
<a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/conf/GENERIC">sys/conf/GENERIC</a>. 
<p>
Kernel configuration options should be placed in your kernel
configuration file in the format of:
<blockquote>
<tt>option&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt><i>name</i>
</blockquote>
For example, to place option "DEBUG" in the kernel, add a line like this:
<pre>
     option      DEBUG
</pre>
Options in the OpenBSD kernel are translated into compiler preprocessor
options, therefore an option like DEBUG would have the source compiled
with option -DDEBUG, which is equivalent to doing a <tt>#define DEBUG</tt>
throughout the kernel.

<p>
Sometimes, you may wish to disable an option that is already defined,
typically in the "<tt>src/sys/conf/GENERIC</tt>" file.  While you could
modify a copy of that file, a better choice would be to use the
<i>rmoption</i> statement.  For example, if you really wanted to 
disable the in-kernel debugger (<i>not recommended!</i>), you would add
a line such as:
<pre>
     rmoption DDB
</pre>
in your kernel configuration file.  <tt>option DDB</tt> is defined in
<tt>src/sys/conf/GENERIC</tt>, but the above <tt>rmoption</tt> line
deactivates it.

<p>
Once again, please see 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=options&amp;sektion=4">options(4)</a>
for more information about the specifics of these options.  Also note
that many of the options also have their own manual pages -- always read
everything available about an option before adding or removing it from
your kernel.




<p> 
<a name="Building"></a>
<h2>5.4 - Building your own kernel</h2>

<p>
Full instructions for creating your own custom kernel are in the
<a href= "http://www.openbsd.org/cgi-bin/man.cgi?query=afterboot&amp;sektion=8">
afterboot(8)</a> man page.

<p>
To compile your kernel from the CD-ROM you need to first have the source
code available.  The source is available on both the 
<a href="../orders.html">official CD</a> (disk 3) and on the 
<a href="../ftp.html">FTP sites</a>.  The following example assumes
that CD3 is mounted on /mnt:

<blockquote>
<pre>
# <strong>cd /usr/src</strong>
# <strong>tar xvzf /mnt/src.tar.gz</strong>
</pre>
</blockquote>

<b>Note:</b> If you are downloading from the FTP servers, you will find
TWO files, <i>src.tar.gz</i> and <i>sys.tar.gz</i>.  The first is the
"userland" -- everything but the kernel, the second is the kernel
source.  Download and extract both of them as above, as for most uses,
you will want both.  On the CD-ROM, they are combined into one file.

<p>
Now to create your custom kernel it is easiest to start with the GENERIC
kernel. This is located at <tt>/usr/src/sys/arch/$ARCH/conf/GENERIC</tt>,
where $ARCH is your architecture. There are other sample configurations
available in that directory as well. Here are two examples for compiling
your kernel. The first example is compiling your kernel on a read-only
source tree. The second on a writable source tree.

<blockquote> 
<pre>
# <strong>cd /somewhere</strong>
# <strong>cp /usr/src/sys/arch/$ARCH/conf/SOMEFILE .</strong>
# <strong>vi SOMEFILE</strong>   <i>(to make the changes you want)</i>
# <strong>config -s /usr/src/sys -b . SOMEFILE</strong>
</pre>
followed by either:

<pre>
    # <strong>make depend</strong>
         <b><i>- OR -</i></b>
    # <strong>make clean && make depend</strong>
# <strong>make</strong>
</pre>
</blockquote>

You should run '<tt>make depend</tt>' when you have made any changes
(including updates and patches) to your source tree (in other words,
almost always).
If config tells you to also run '<tt>make clean</tt>', do so before 
running the '<tt>make depend</tt>'


<p>
If you have made changes to your kernel configuration options, and/or
made major changes to your source tree, you should use '<tt>make
clean</tt>' instead of the above '<tt>made depend</tt>'.  Note that it
is always safe to do a 'make clean', though it may result in longer
compile times, as more will be rebuilt.

<p>
To compile a kernel inside a writable source tree do the following:

<blockquote>
<tt>
# <strong>cd sys/arch/$ARCH/conf</strong><br>
# <strong>vi SOMEFILE</strong><i> (to make any changes you want)</i><br>
# <strong>config SOMEFILE</strong><i> (read more about it here: 
<a href= "http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>)</i><br>
# <strong>cd ../compile/SOMEFILE</strong><br>
# <strong>make</strong> <br>
</tt>
</blockquote>

<p>
Where $ARCH is the architecture you are using (e.g. i386). You can also do
a <strong>make depend</strong> to make the dependencies for the next time
you compile your kernel.

<p>
To move your kernel into place:

<blockquote>
<pre>
# <strong>cp /bsd /bsd.old</strong>
# <strong>cp /sys/arch/$ARCH/compile/SOMEFILE/bsd /bsd</strong>
</pre>
</blockquote>

To revert to your old kernel at boot you just need to

<blockquote>
<pre>
boot&gt; <strong>bsd.old</strong>
</pre>
</blockquote>

and your old kernel will be loaded instead of /bsd.

<p>
Sometimes when you build a new kernel you will be required to install
new bootblocks. To do so, read <a href="faq14.html#InstBoot">FAQ 14,
Installing Bootblocks</a>, which will give you an overview on using
OpenBSD's Bootloader.

<p>
<a name="BootConfig"></a>
<h2>5.5 - Boot-Time Configuration</h2>

<p>
Sometimes when booting your system you might notice that the kernel finds
your device but maybe at the wrong IRQ. And maybe you need to use this
device right away. Well, without rebuilding the kernel you can use
OpenBSD's boot time kernel configuration. This will only correct your
problem for one time. If you reboot, you will have to repeat this
procedure. So, this is only meant as a temporary fix, and you should
correct the problem by fixing and recompiling your kernel. Your kernel
does however need <strong>option BOOT_CONFIG</strong> in the kernel, which 
GENERIC does have.

<p>
Most of this document can be found in the man page
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot_config&amp;sektion=8">boot_config(8)</a>.

<p>
To boot into the User Kernel Config, or UKC, use the -c option at boot time.

<blockquote><pre>
boot&gt; <strong>boot hd0a:/bsd -c</strong>
</pre></blockquote>

Or whichever kernel it is you want to boot. Doing this will bring up a
UKC prompt. From here you can issue commands directly to the kernel
specifying devices you want to change or disable or even enable.

<p>
Here is a list of common commands in the UKC.

<ul>
<li><tt>add <strong>device</strong></tt> - Add a device through copying another
<li><tt>change <strong>devno | device </strong></tt> - Modify one or more devices
<li><tt>disable <strong>devno | device </strong></tt> - Disable one or more devices 
<li><tt>enable <strong>devno | device </strong></tt> - Enable one or more devices 
<li><tt>find <strong>devno | device </strong></tt> - Find one or more devices
<li><tt>help</tt> - Short summary of these commands
<li><tt>list</tt> - List ALL known devices
<li><tt>exit/quit</tt> - Continue Booting
<li><tt>show <strong>[attr [val]]</strong></tt> - Show devices with an attribute and
  optional with a specified value
</ul>

<p>
Once you have your kernel configured, use <tt>quit</tt> or <tt>exit</tt>
and continue booting.
After doing so, you should make the change permanent in your
kernel image, as described in <a href="faq5.html#config">Using config(8)
to change your kernel</a>.

<p>
<a name="VerboseBoot"></a>
<h2>5.6 - Getting more verbose output during boot</h2>

Getting more verbose output can be very helpful when trying to debug
problems when booting.  If you have a problem wherein your boot floppy
won't boot and need to get more information, simply reboot. When you get
to the &quot;boot&gt;&quot; prompt, boot with boot -c. This will bring you
into the UKC&gt;, then do:

<blockquote><pre>
UKC&gt; <strong>verbose</strong>
autoconf verbose enabled
UKC&gt; <strong>quit</strong>
</pre></blockquote>

<p>
Now you will be given extremely verbose output upon boot.

<p>
<a name="config"></a>
<h2>5.7 - Using config(8) to change your kernel</h2>
<p>
The <b>-e</b> and <b>-u</b> options with
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>
can be extremely helpful and save wasted time compiling your kernel. The
<b>-e</b> flag allows you to enter the UKC or User Kernel Config on a
running system. These changes will then take place on your next reboot.
The <b>-u</b> flag tests to see if any changes were made to the running
kernel during boot, meaning you used <b>boot -c</b> to enter the UKC
while booting your system.

<p>
The following example shows the disabling of the ep* devices in the
kernel. For safety's sake you must use the <b>-o</b> option which writes
the changes out to the file specified. For example : <strong>config -e
-o bsd.new /bsd</strong> will write the changes to bsd.new. The example
doesn't use the <b>-o</b> option, therefore changes are just ignored,
and not written back to the kernel binary. For more information
pertaining to error and warning messages read the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>
man page.

<blockquote><pre>
$ <strong>sudo config -e /bsd</strong>
OpenBSD 3.6 (GENERIC) #59: Fri Sep 17 12:32:57 MDT 2004
    deraadt@i386.openbsd.org:/usr/src/sys/arch/i386/compile/GENERIC
warning: no output file specified
Enter 'help' for information
ukc&gt; ?
        help                            Command help list
        add         dev                 Add a device
        base        8|10|16             Base on large numbers
        change      devno|dev           Change device
        disable     attr val|devno|dev  Disable device
        enable      attr val|devno|dev  Enable device
        find        devno|dev           Find device
        list                            List configuration
        lines       count               # of lines per page
        show        [attr [val]]        Show attribute
        exit                            Exit, without saving changes
        quit                            Quit, saving current changes
        timezone    [mins [dst]]        Show/change timezone
        nmbclust    [number]            Show/change NMBCLUSTERS
        cachepct    [number]            Show/change BUFCACHEPERCENT
        nkmempg     [number]            Show/change NKMEMPAGES
        shmseg      [number]            Show/change SHMSEG
        shmmaxpgs   [number]            Show/change SHMMAXPGS
ukc&gt; <strong>list</strong>
  0 audio* at sb0|sb*|gus0|pas0|sp0|ess*|wss0|wss*|ym*|eap*|eso*|sv*|neo*|cmpci*
|clcs*|clct*|auich*|autri*|auvia*|fms*|uaudio*|maestro*|esa*|yds*|emu* flags 0x0
  1 midi* at sb0|sb*|opl*|opl*|opl*|opl*|ym*|mpu*|autri* flags 0x0
  2 nsphy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*
|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|e
p*|ep* phy -1 flags 0x0
  3 nsphyter* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|
vr*|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep
*|ep*|ep* phy -1 flags 0x0
  4 qsphy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*
|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|e
p*|ep* phy -1 flags 0x0
  5 inphy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*
|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|e
p*|ep* phy -1 flags 0x0
  6 iophy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*
|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|e
p*|ep* phy -1 flags 0x0
  7 eephy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*
|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|e
p*|ep* phy -1 flags 0x0
  8 exphy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*
|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|e
p*|ep* phy -1 flags 0x0
[...snip...]
ukc&gt; <strong>disable ep</strong>
 67 ep0 disabled
 68 ep* disabled
 69 ep* disabled
155 ep0 disabled
156 ep0 disabled
157 ep* disabled
158 ep* disabled
210 ep* disabled
ukc&gt; <strong>quit</strong>
not forced
</pre></blockquote>

<p>
In the above example, all ep* devices are disabled in the kernel and will
not be probed. In some situations where you have used the UKC during boot,
via <b>boot -c</b>, you will need these changes to be written out
permanently. To do this you need to use the <b>-u</b> option.
In the following example, the computer was booted into the UKC and the
wi(4) device was disabled. Since changes made with boot -c are NOT
permanent, these changes must be written out. This example writes the
changes made from boot -c into a new kernel binary bsd.new.

<blockquote><pre>
$ <strong>sudo config -e -u -o bsd.new /bsd</strong>
OpenBSD 3.6 (GENERIC) #59: Fri Sep 17 12:32:57 MDT 2004
    deraadt@i386.openbsd.org:/usr/src/sys/arch/i386/compile/GENERIC
Processing history...
105 wi* disabled
106 wi* disabled
Enter 'help' for information
ukc&gt; <strong>quit</strong>
</pre></blockquote>

<p>
<a name="buildprobs"></a>
<h2>5.8 - Common Problems when Compiling and Building</h2>

<a name="sig11"></a>
<h3>5.8.1 - The build stopped with a "Signal 11" error</h3>

<p>
Building OpenBSD and other programs from source is a task which pushes
hardware harder than most others, making intensive use of CPU, disk and
memory. As a result, if you have hardware which has a problem, the most
likely time for that problem to appear is during a build.  Signal 11
failures are <i>typically</i> caused by hardware problems, very often
memory problems, but can also be CPU, main board, or heat issues.  Your
system may actually be very stable otherwise, but unable to compile
programs.

<p>
You will probably find it best to repair or replace the components that
are causing trouble, as problems may show themselves in other ways in
the future.  If you have hardware which you really wish to use and
causes you no other problem, simply install a snapshot or a release.

<p>
For much more information, see the
<a href="http://www.bitwizard.nl/sig11/">Sig11 FAQ</a>.

<a name="snake"></a>
<h3>5.8.2 - "make build" fails with "cannot open output file snake: is
a directory"</h3>

This is the result of two separate errors: 
<ul>
<li><b>You did not fetch or update your CVS tree properly.</b>  When 
doing a CVS checkout operation, you must use the "<tt>-P</tt>" option,
when you update your source tree with CVS, you must use "<tt>-Pd</tt>"
options to
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1"
>cvs(1)</a>,
as documented in the <a href="../anoncvs.html">anoncvs guide</a>, the
<a href="upgrade-minifaq.html">upgrade-minifaq</a> and the
<a href="faq8.html#CVS">FAQ</a>.  These options make sure new 
directories are added and removed from the tree as OpenBSD evolves.

<li><b>You did not properly create the <tt>obj</tt> directory before
your build.</b>  Building the tree without a <tt>/usr/obj</tt> directory
is not supported.

</ul>
It is important to carefully follow the instructions when 
<a href="../anoncvs.html">getting and updating</a> your source code
and <a href="upgrade-minifaq.html">building</a> your tree.

<a name="BldRelease"></a>
<h2>5.9 - How do I build an OpenBSD release?</h2>
After building your system in place, you can create the OpenBSD 
<a href="faq4.html#FilesNeeded">file sets</a> that can be used to 
install your system on another computer.

<p>
This is detailed in 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=release&amp;sektion=8">release(8)</a>


<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
<a href= "faq4.html">[To Section 4 - Installation Guide]</a>
<a href= "faq6.html">[To Section 6 - Networking]</a>
</font>

<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../images/back.gif" border= "0" alt= "[back]"></a>
<a href= "mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>$OpenBSD: faq5.html,v 1.100 2005/02/06 18:33:09 nick Exp $</small>
</body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>5.0 - Kernel configuration</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 1998-2002 by OpenBSD.">
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
</head>

<body bgcolor= "#ffffff" text= "#000000">
<!-- Passes validator.w3.org.  Please keep it this way -->

<img alt="[OpenBSD]" height=30 width=141 src="../images/smalltitle.gif">
<p>
<h2><font color="#e00000">5.0 - Kernel configuration</font></h2>
<hr>

<p>
<h3>Table of Contents</h3>
<ul>
<li><a href= "#Why">5.1 - Why do I need a custom kernel?</a>
<li><a href= "#Options">5.2 - Kernel configuration Options</a>
<li><a href= "#Building">5.3 - Building your own kernel</a>
<li><a href= "#BootConfig">5.4 - Boot-time configuration</a>
<li><a href= "#VerboseBoot">5.5 - Getting more verbose output during
  boot</a>
<li><a href= "#config">5.6 - Using config(8) to change your kernel
  binary</a>
</ul>
<hr>
<br>

<p>
<a name= "Why"></a>
<a name= "5.1"></a>
<h2>5.1 - Why would I want to create my own custom kernel?</h2>

<p>
Several reasons, although this practice is generally geared towards
knowledgeable users who have a good overall understanding of the system.

<ul>
  <li>Your computer has a very small amount of RAM and you want to preserve 
      as much as possible by removing device drivers you don't use
  <li>Remove default options or add options which may not have been enabled
      by default
  <li>Enable experimental options
    
</ul>

<p>
Under most circumstances you will NOT need to compile your own kernel.
The GENERIC kernel will usually be all that you need.  In fact, there
are several reasons why you do not want to create your own kernel.  The
main reason is that it is very easy to make changes to the kernel
configuration which look logical, but do not work.  This is your danger
sign.  If something does not appear to work properly, please try the
GENERIC kernel before sending in a bug report.

<p>
<a name= "Options"></a>
<a name= "5.2"></a>
<h2>5.2 - Kernel Configuration Options</h2>

<p>
Kernel Configuration Options are options that you add to your kernel
configuration that place certain features into your kernel. This allows
you to have exactly the support you want, without having support for
unneeded devices. There are multitudes of options that allow you to
customize your kernel. Here we will go over only some of them, those that
are most commonly used. Check the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=options&amp;sektion=4">options(4)</a>
man page for a more complete list of options. You can also check the
example configuration files that are available for your architecture.

<p>
Not all kernel options have been tested for compatibility with
all other options.  Don't put an option in your kernel unless you
actually have a reason to do so!  The one kernel configuration which
gets the most testing is the GENERIC kernel.  This is usually a
combination of the options in /usr/src/sys/arch/&lt;your arch&gt;/conf/GENERIC
and /usr/src/sys/conf/GENERIC. 

<p>
<ul>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/alpha/conf/">Alpha Kernel Conf Files </a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/i386/conf/">i386 Kernel Configuration files</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/macppc/conf/">macppc Kernel Configuration files</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/sparc/conf/">sparc Kernel Configuration Files</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/sparc64/conf/">sparc64 Kernel Configuration Files</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/vax/conf/">vax Kernel Configuration Files</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/">Other Arch's</a>
</ul>

<p>
Look closely at these files and you will notice a line like:<br>
<strong>include "../../../conf/GENERIC"</strong><br>
This means that it is referencing yet another configuration file. This
file stores non arch-dependent options. So when creating your Kernel
Config be sure to look through 
<a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/conf/GENERIC">/sys/conf/GENERIC</a> 
and see what you want. There ARE options in there that are NEEDED.

<p>
All of the options listed below should be placed in your kernel
configuration file in the format of:<br>
<strong>option      OPTION</strong><br>
for example. To place option debug in the kernel, add a line like this:<br>
<strong>option	    DEBUG</strong><br>
Options in the OpenBSD kernel are translated into compiler preprocessor
options, therefore an option like DEBUG would have the source compiled
with option -DDEBUG. Which is equivalent to doing a #define DEBUG
throughout the kernel.

<p>
OpenBSD has a great many compatibility options which allow you to use
binaries from other OS's.  Not all are availably on every architecture,
so be sure to read the man pages for each option to see if your arch is
supported.

<p>
<ul>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=compat_svr4&amp;sektion=8">COMPAT_SVR4(8)</a> 
  - Compatibility with SVR4 binaries.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=compat_bsdos&amp;sektion=8">COMPAT_BSDOS(8)</a> 
  - Compatibility with BSD/OS binaries.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=compat_linux&amp;sektion=8">COMPAT_LINUX(8)</a> 
  - Compatibility with Linux binaries.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=compat_sunos&amp;sektion=8">COMPAT_SUNOS(8)</a> 
  - Compatibility with SunOS binaries.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=compat_ultrix&amp;sektion=8">COMPAT_ULTRIX(8)</a> 
  - Compatibility with Ultrix binaries.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=compat_freebsd&amp;sektion=8">COMPAT_FREEBSD(8)</a> 
  - Compatibility with FreeBSD binaries.
<li>COMPAT_HPUX 
  - Compatibility with HP-UX binaries. Only available on some m68k
  arch's.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=compat_ibcs2&amp;sektion=8">COMPAT_IBCS2(8)</a> 
  - Compatibility to run ibcs2 binaries.
<li>COMPAT_OSF1 
  - Run Digital Unix binaries. Available only on Alpha platform.
<li>COMPAT_43 
  - Compatibility with 4.3BSD. Use of this is certainly discouraged, but
  it is needed for our Navigator port
<li>COMPAT_11 
  - Compatibility with NetBSD 1.1
<li>COMPAT_NOMID 
 - Compatibility with a.out executables that lack a machine id.
</ul>

<p>
It is always helpful to be able to debug problems with the kernel. But
many choose not to put these options in their kernel because these
options add considerable size to the kernel. They are however extremely
helpful in a case where a bug might be present. This well help the
developers discover the source of your problems much quicker. Here is a
list of popular debugging options that can be added to your kernel.

<p>
<ul>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ddb&amp;sektion=4">DDB</a>
  - This compiles in the in-kernel debugger. This isn't available on all
  platforms. So be sure to read before adding it.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gdb&amp;sektion=1">KGDB</a>
  - Compiles a remote kernel debugger using gdb's `remote target`
  feature.
<li>makeoptions  DEBUG="-g" - Makes bsd.gdb along with bsd. This is
  useful for debugging crash dumps with gdb.
<li>DEBUG - Used to put various debugging options in the kernel, where
  the source has defined them.
<li>KTRACE - Adds hooks for the system call tracing facility. Which
  allows users to use 
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ktrace&amp;sektion=1">ktrace(1)</a>.
<li>DIAGNOSTIC - Adds code to the kernel that does internal consistency
  checks.
<li>GPROF - adds code to the kernel for kernel profiling with 
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=kgmon&amp;sektion=8">kgmon(8)</a>.
<li>makeoptions PROF="-pg" - The -pg flag causes the kernel to be
  compiled with support for profiling. Option GPROF is required to use
  this option.
</ul>

<p>
<strong>Filesystem Options.</strong>
<ul>
<li>FFS - Berkeley Fast Filesystem <strong>NOTE:</strong> This option is
  required.
<li>EXT2FS - Second Extended File System, This is needed for those of
  you who want to read Linux partitions.
<li>MFS - Memory File System that stores files in swappable memory.
<li>NFS - Network File System, This is needed if you will be using
  NFS.
<li>CD9660 - This is iso9660 + rockridge filesystem. This is required to
  read from CDs.
<li>MSDOSFS - Needed to read MS-DOS FAT filesystems. Also has support
  for Windows 95 long name + mixed case extensions.
<li>FDESC - Includes code for a file system which can be mounted on
  /dev/fd.
<li>KERNFS - Includes code that permits the mounting of a special file
  system (normally mounted on /kern) in which files representing various
  kernel variables and parameters may be found.
<li>NULLFS - Code to have a loopback filesystem. 
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mount_null&amp;sektion=8">mount_null(8)</a>
  has more information.
<li>PROCFS - Includes code for a special file system (conventionally
  mounted on /proc).
<li>PORTAL - Includes the (experimental) portal filesystem.  This
  permits interesting tricks like opening TCP sockets by opening files
  in the file system.
<li>UMAPFS - Includes a loopback file system in which user and group ids
  may be remapped -- this can be useful when mounting alien file systems
  with different uids and gids than the local system (eg, remote NFS).
<li>UNION - Includes code for the union file system, which permits
  directories to be mounted on top of each other in such a way that both
  file systems remain visible. This code isn't quite stable yet.
<li>XFS - Add hooks for using a filesystem that is compatible with the
  AFS filesystem. Currently used by the Arla/AFS code.
<li>FFS_SOFTUPDATES - Allows for the use of softupdates. To read up on
  softupdates more read the <a href="faq14.html#SoftUpdates">Softupdates
  FAQ</a> section.
<li>NFSSERVER - Allow for the server-side NFS code to be included in the
  kernel.
<li>NFSCLIENT - Allow for the client-side NFS code to be included in the
  kernel.
<li>FIFO - Support for FIFOs.. RECOMMENDED.
<li>NVNODE=integer - Where integer is the size of the cache used by the
  name-to-inode translation routines, (a.k.a. the namei() cache, though
  called by many other names in the kernel source).
<li>EXT2FS_SYSTEM_FLAG - This option changes the behavior of the APPEND
  and IMMUTABLE flags for a file on an EXT2FS filesystem. Read 
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=options&amp;sektion=4">options(4)</a>
  for more details.
<li>QUOTA - Support for Filesystem Quota's. To read up on using quotas
  read <a href="faq10.html#Quotas">FAQ 10, Quotas</a>
</ul>


<strong>Misc. Options</strong>
<ul>
<li>PCIVERBOSE - Make the boot process more verbose for PCI
  peripherals.
<li>EISAVERBOSE - Make the boot process more verbose for EISA
  peripherals.
<li>PCMCIAVERBOSE - Make the boot process more verbose for PCMCIA
  peripherals.
<li>APERTURE - Provide in-kernel support for VGA framebuffer mapping by
  user processes. Needed to run X.
<li>LKM - Support for Loadable Kernel Modules. Not available on all
  arch's. Read 
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=lkm&amp;sektion=4">lkm(4)</a>
  for more information.
<li>INSECURE - Hardwires the kernel security level to -1. Read 
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=init&amp;sektion=8">init(8)</a>
  for more information on kernel security levels.
<li>RAM_DISK_HOOKS - Allows for machine dependent functions to be called
  when the ramdisk driver is configured.
<li>RAM_DISK_IS_ROOT - Forces the ramdisk to be root.
<li>CCDNBUF=integer - Set number of component buffers used by CCD(4).
  Default is 8. For more on CCD read the 
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ccd&amp;sektion=4">CCD(4)</a>
  man page, or the <a href="faq11.html#ccd">Performance Tuning FAQ
  section.</a>
<li>KMEMSTATS - This makes malloc(9), the kernel memory allocator keep
  statistics on its use. If option DEBUG is used, this option is
  automatically turned on by config. 
<li>BOOT_CONFIG - Adds support of the -c boot option.
</ul>

<strong>Networking Options</strong><br>
Also check the <a href="faq6.html">Networking FAQ</a> or the 
<a href="faq11.html#Network">Networking Performance Tuning FAQ</a>.
<ul>
<li>GATEWAY - Enables IPFORWARDING and (on most ports) increases the
  size of NMBCLUSTERS.
<li>NMBCLUSTERS=integer - Controls the size mbuf cluster map. 
<li>IPFORWARDING - Enables IP routing behavior.  With this option
  enabled, the machine will forward IP datagrams between its interfaces
  that are destined for other machines.
<li>MROUTING - Includes support for IP multicast routers.
<li>INET - Includes support for the TCP/IP protocol stack. This option
  is REQUIRED
<li>MCLSHIFT=value - This option is the base-2 logarithm of the size of
  mbuf clusters. Read
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=options&amp;sektion=4">options(4)</a>
  for more information on this option.
<li>NS - Include support for the Xerox XNS protocol stack.  See 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ns&amp;sektion=4">ns(4)</a>
<li>ISO,TPIP - Include support for the ubiquitous OSI protocol stack.
  See 
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=iso&amp;sektion=4">iso(4)</a>
  for more information.
<li>EON - Include support for OSI tunneling over IP.
<li>CCITT,LLC,HDLC - Include support for the X.25 protocol stack.
<li>IPX, IPXIP - Include support for Internetwork Packet Exchange
  protocol commonly in use by Novell NetWare.
<li>NETATALK - Include kernel support for the AppleTalk family of
  protocols.
<li>TCP_COMPAT_42 - Use of this option is extremely discouraged, so it
  should not be enabled. TCP bug compatibility with 4.2BSD. In 4.2BSD, TCP
  sequence numbers were 32-bit signed values.  Modern implementations of
  TCP use unsigned values.
<li>TCP_NEWRENO - Turns on NewReno fast recovery phase, which allows one
  lost segment to be recovered per round trip time.
<li>TCP_SACK - Turns on selective acknowledgements.
<li>TCP_FACK - Turns on forward acknowledgements allowing a more precise
  estimate of outstanding data during the fast recovery phase by using
  SACK information. This option can be used together with TCP_SACK.
<li>PPP_FILTER - This option turns on 
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pcap&amp;sektion=3">pcap(3)</a>
  based filtering for ppp connections.
<li>PPP_BSDCOMP - PPP BSD compression.
<li>PPP_DEFLATE - Used in conjunction with PPP_BSDCOMP.
<li>IPSEC - This option enables IP security protocol support. See 
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsec&amp;sektion=4">ipsec(4)</a>
  for more details. This now implies option KEY, which gives support for
  PFKEYv2.
<li>ENCDEBUG - This option enables debugging information to be
  conditionally logged in case IPSEC encounters errors.
</ul>

<strong>SCSI Subsystem Options</strong>
<ul>
<li>SCSITERSE - Terser SCSI error messages.  This omits the table for
  decoding ASC/ASCQ info, saving about 8 bytes or so.
<li>SCSIDEBUG - Prints extra debugging info for the SCSI subsystem to
  the console.
</ul>


<p> 
<a name= "Building"></a>
<a name= "5.3"></a>
<h2>5.3 - Building your own kernel</h2>

<p>
Full instructions for creating your own custom kernel are in the
<a href= "http://www.openbsd.org/cgi-bin/man.cgi?query=afterboot&amp;sektion=8">
afterboot(8)</a> man page.

<p>
To compile your kernel from the cdrom you need to first have the source
code available.  The source is available on both the 
<a href="../orders.html">official CD</a> (disk 3) and on the 
<a href="../ftp.html">FTP sites</a>.  The following example assumes
assumes that CD3 is mounted on /mnt:

<blockquote>
<pre>
# <strong>cd /usr/src</strong>
# <strong>tar xvzf /mnt/src.tar.gz</strong>
</pre>
</blockquote>

<p>
Now to create your custom kernel it is easiest to start with the GENERIC
kernel. This is located at <i>/usr/src/sys/arch/${arch}/conf/GENERIC</i>,
where ${arch} is your architecture. There are other sample configurations
available in that directory as well. Here are two examples for compiling
your kernel. The first example is compiling your kernel on a read-only
source tree. The second on a writable source tree.

<blockquote> 
<pre>
# <strong>cd /somewhere</strong>
# <strong>cp /usr/src/sys/arch/$ARCH/conf/SOMEFILE .</strong>
# <strong>vi SOMEFILE</strong>   <i>(to make the changes you want)</i>
# <strong>config -s /usr/src/sys -b . SOMEFILE</strong>
</pre>
followed by either:

<pre>
    # <strong>make depend</strong>
         <b><i>- OR -</i></b>
    # <strong>make clean</strong>
# <strong>make</strong>
</pre>
</blockquote>

You must run '<tt>make depend</tt>' when you have made any changes 
(including updates and patches) to your source tree (in other words,
almost always, unless you need to run '<tt>make clean</tt>').

<p>
If you have made changes to your kernel configuration options, and/or
made major changes to your source tree, you should use '<tt>make
clean</tt>' instead of the above '<tt>made depend</tt>'.  Note that it
is always safe to do a 'make clean', though it may result in longer
compile times, as more will be rebuilt.

<p>
To compile a kernel inside a writable source tree do the following:

<blockquote>
<tt>
# <strong>cd /sys/arch/$ARCH/conf</strong><br>
# <strong>vi SOMEFILE</strong><i> (to make any changes you want)</i><br>
# <strong>config SOMEFILE</strong><i> (read more about it here: 
<a href= "http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>)</i><br>
# <strong>cd ../compile/SOMEFILE</strong><br>
# <strong>make</strong> <br>
</tt>
</blockquote>

<p>
Where $ARCH is the architecture you are using (e.g. i386). You can also do
a <strong>make depend</strong> to make the dependencies for the next time
you compile your kernel.

<p>
To move your kernel into place.

<blockquote>
<pre>
# <strong>cp /bsd /bsd.old</strong>
# <strong>cp /sys/arch/$ARCH/compile/SOMEFILE/bsd /bsd</strong>
</pre>
</blockquote>

To revert to your old kernel at boot you need to just

<blockquote>
<pre>
boot&gt; <strong>bsd.old</strong>
</pre>
</blockquote>

and your old kernel will be loaded instead of /bsd.

<p>
Sometimes when you build a new kernel you will be required to install
new bootblocks. To do so, read <a href="faq14.html#InstBoot">FAQ 14,
Installing Bootblocks</a>. Which will give you an overview on using
OpenBSD's Bootloader

<p>
<a name= "BootConfig"></a>
<a name="5.4"></a> 
<h2>5.4 - Boot Time Configuration </h2>

<p>
Sometimes when booting your system you might notice that the kernel finds
your device but maybe at the wrong IRQ. And maybe you need to use this
device right away. Well, without rebuilding the kernel you can use
OpenBSD's boot time kernel configuration. This will only correct your
problem for one time. If you reboot, you will have to repeat this
procedure. So, this is only meant as a temporary fix, and you should
correct the problem by fixing and recompiling your kernel. Your kernel
does however need <strong>option BOOT_CONFIG</strong> in the kernel, which 
GENERIC does have.

<p>
Most of this document can be found in the man page
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot_config&amp;sektion=8">boot_config(8)</a>

<p>
To boot into the User Kernel Config, or UKC, at boot time us the -c
option.

<blockquote><pre>
boot&gt; <strong>boot wd0a:/bsd -c</strong>
</pre></blockquote>

Or whichever kernel it is you want to boot. Doing this will bring up a
UKC prompt. From here you can issue commands directly to the kernel
specifying devices you want to change or disable or even enable.

<p>
Here is a list of common commands in the UKC.

<ul>
<li><tt>add <strong>device</strong></tt> - Add a device through copying another
<li><tt>change <strong>devno | device </strong></tt> - Modify one or more devices
<li><tt>disable <strong>devno | device </strong></tt> - Disable one or more devices 
<li><tt>enable <strong>devno | device </strong></tt> - Enable one or more devices 
<li><tt>find <strong>devno | device </strong></tt> - Find one or more devices
<li><tt>help</tt> - Short summary of these commands
<li><tt>list</tt> - List ALL known devices
<li><tt>exit/quit</tt> - Continue Booting
<li><tt>show <strong>[attr [val]]</strong></tt> - Show devices with an attribute and
  optional with a specified value
</ul>

<p>
Once you get your device configured, use quit or exit and continue
booting. After doing so you should correct your Kernel configuration and
Compile a new kernel. Refer to <a href="faq5.html#Building">Building
your own kernel</a> for help.

<p>
<a name= "VerboseBoot"></a>
<a name="5.5"></a>
<h2>5.5 - Getting more verbose output during boot</h2>

Getting more verbose output can be very helpful when trying to debug
problems when booting.  If you have a problem wherein your boot floppy
won't boot and need to get more information, simply reboot. When you get
to the &quot;boot&gt;&quot; prompt, boot with boot -c. This will bring you
into the UKC&gt;, then do:

<blockquote><pre>
UKC&gt; <strong>verbose</strong>
autoconf verbose enabled
UKC&gt; <strong>quit</strong>
</pre></blockquote>

<p>
Now you will be given extremely verbose output upon boot.

<p>
<a name= "config"></a>
<a name="5.6"></a>
<h2>5.6 - Using config(8) to change your kernel</h2>
<p>
The <b>-e</b> and <b>-u</b> options with
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>
can be extremely helpful and save wasted time compiling your kernel. The
<b>-e</b> flag allows you to enter the UKC or User Kernel Config on a
running system. These changes will then take place on your next reboot.
The <b>-u</b> flag tests to see if any changes were made to the running
kernel during boot, meaning you used <b>boot -c</b> to enter the UKC
while booting your system.

<p>
The following example shows the disabling of the ep* devices in the
kernel. For safety's sake you must use the <b>-o</b> option which writes
the changes out to the file specified. For example : <strong>config -e
-o bsd.new /bsd</strong> will write the changes to bsd.new. The example
doesn't use the <b>-o</b> option, therefore changes are just ignored,
and not written back to the kernel binary. For more information
pertaining to error and warning messages read the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>
man page.

<blockquote><pre>
$ <strong>sudo config -e /bsd</strong>
OpenBSD 3.1 (GENERIC) #2: Sat Apr 20 21:44:54 EDT 2002
    root@build:/usr/src/sys/arch/i386/compile/GENERIC
warning: no output file specified
Enter 'help' for information
ukc&gt; ?
        help                            Command help list
        add         dev                 Add a device
        base        8|10|16             Base on large numbers
        change      devno|dev           Change device
        disable     attr val|devno|dev  Disable device
        enable      attr val|devno|dev  Enable device
        find        devno|dev           Find device
        list                            List configuration
        lines       count               # of lines per page
        show        [attr [val]]        Show attribute
        exit                            Exit, without saving changes
        quit                            Quit, saving current changes
        timezone    [mins [dst]]        Show/change timezone
        nmbclust    [number]            Show/change NMBCLUSTERS
        cachepct    [number]            Show/change BUFCACHEPERCENT
        nkmempg     [number]            Show/change NKMEMPAGES
        shmseg      [number]            Show/change SHMSEG
        shmmaxpgs   [number]            Show/change SHMMAXPGS
ukc&gt; <strong>list</strong>
  0 audio* at sb0|sb*|gus0|pas0|sp0|ess*|wss0|wss*|ym*|eap*|eso*|sv*|neo*|cmpci*
|clcs*|clct*|auich*|autri*|auvia*|fms*|uaudio*|maestro*|esa*|yds*|emu* flags 0x0
  1 midi* at sb0|sb*|opl*|opl*|opl*|opl*|ym*|mpu*|autri* flags 0x0
  2 nsphy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*
|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|e
p*|ep* phy -1 flags 0x0
  3 nsphyter* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|
vr*|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep
*|ep*|ep* phy -1 flags 0x0
  4 qsphy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*
|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|e
p*|ep* phy -1 flags 0x0
  5 inphy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*
|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|e
p*|ep* phy -1 flags 0x0
  6 iophy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*
|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|e
p*|ep* phy -1 flags 0x0
  7 eephy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*
|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|e
p*|ep* phy -1 flags 0x0
  8 exphy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*
|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|e
p*|ep* phy -1 flags 0x0
[...snip...]
ukc&gt; <strong>disable ep</strong>
 65 ep0 disabled
 66 ep* disabled
 67 ep* disabled
149 ep0 disabled
150 ep0 disabled
151 ep* disabled
152 ep* disabled
202 ep* disabled
ukc&gt; <strong>quit</strong>
not forced
</pre></blockquote>

<p>
In the above example, all ep* devices are disabled in the kernel and will
not be probed. In some situations where you have used the UKC during boot,
via <b>boot -c</b>, you will need these changes to be written out
permanently. To do this you need to use the <b>-u</b> option.
In the following example, the computer was booted into the UKC and the
wi(4) device was disabled. Since changes made with boot -c are NOT
permanent, these changes must be written out. This example writes the
changes made from boot -c into a new kernel binary bsd.new.

<blockquote><pre>
$ <strong>sudo config -e -u -o bsd.new /bsd</strong>
OpenBSD 3.1 (GENERIC) #2: Sat Apr 20 21:44:54 EDT 2002
    root@build:/usr/src/sys/arch/i386/compile/GENERIC
Processing history...
105 wi* disabled
106 wi* disabled
Enter 'help' for information
ukc&gt; <strong>quit</strong>
</pre></blockquote>


<p>
<font color= "#0000e0">
<a href= "index.html">[Back to Main Index]</a>
<a href= "faq4.html">[To Section 4.0 - Installation Guide]</a>
<a href= "faq6.html">[To Section 6.0 - Networking]</a>
</font>

<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../images/back.gif" border= "0" alt= "[back]"></a>
<a href= "mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>$OpenBSD: faq5.html,v 1.67 2002/07/21 23:15:31 nick Exp $</small>
</body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>4 - Guide d'Installation d'OpenBSD 3.9</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 1998-2005 by OpenBSD.">
</head>

<!-- Passes validator.w3.org.  Please keep it this way -->

<body bgcolor= "#ffffff" text= "#000000">

<a href="../../fr/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif" border="0">
</a>
<p>

<font color= "#0000e0">
<a href= "index.html">[Retour à l'Index principal]</a>
<a href= "faq3.html">[Section 3 - Obtenir OpenBSD]</a>
<a href= "faq5.html">[Section 5 - Construire le Système à partir des Sources]</a>
</font>

<h1><font color="#e00000">4 - Guide d'Installation d'OpenBSD 3.9</font></h1>
<!-- UNCOMMENT ONLY WHEN THE FILE IS OUT OF SYNC

<hr>
<p>
<b><font color="#e00000">Remarque Importante :</font></b> Le contenu de
   ce fichier est obsolète. Consultez la version anglaise 
   <a href="../faq4.html">ici</a> pour des informations à jour.

<p>
Si vous souhaitez contribuez à l'effort de traduction,
prière de consulter
<a href="../../fr/translation.html">la page de traduction</a>.

-->
<hr>

<p>
<h3>Table des Matières</h3>
<ul>
<li><a href= "#Overview"    >4.1 - Présentation de la procédure d'installation
                                     d'OpenBSD</a>
<li><a href= "#Checklist"   >4.2 - Vérifications avant l'installation</a>

<li><a href="#MkInsMedia"   >4.3 - Créer un média d'installation OpenBSD amorçable</a>
    <ul>
    <li><a href="#UnixFlop" >4.3.1 - Créer des disquettes de démarrage sur Unix</a>
    <li><a href="#DosFlop"  >4.3.2 - Créer des disquettes de démarrage sur Windows ou DOS</a>
    <li><a href="#MkCD-ROM" >4.3.3 - Créer un CD-ROM amorçable</a>
    </ul>
<li><a href="#Boot"         >4.4 - Démarrer le média d'installation OpenBSD</a>
<li><a href="#Install"      >4.5 - Installer OpenBSD</a>
  <ul>
  <li><a href="#Start"      >4.5.1 - Commencer l'installation</a>
  <li><a href="#Disks"      >4.5.2 - Configurer les disques</a>
  <li><a href="#Hostname"   >4.5.3 - Configurer le nom d'hôte du système ("hostname")</a>
  <li><a href="#Network"    >4.5.4 - Configurer le réseau</a>
  <li><a href="#InstMedia"  >4.5.5 - Choisir le média d'installation</a>
  <li><a href="#Filesets"   >4.5.6 - Choisir les sets de fichiers</a>
  <li><a href="#Finish"     >4.5.7 - Terminer l'installation</a>
  </ul>

<li><a href= "#FilesNeeded"  >4.6 - Quels sont les fichiers nécessaires à l'installation ?</a>
<li><a href= "#Partitioning" >4.7 - De combien d'espace disque ai-je besoin pour une installation
                                   OpenBSD ?</a>
<li><a href= "#Multibooting">4.8 - Multiboot OpenBSD/i386</a>
<li><a href= "#SendDmesg"   >4.9 - Envoyer votre dmesg à dmesg@openbsd.org après l'installation</a>
<li><a href= "#AddFileSet"  >4.10 - Ajouter un paquetage après l'installation</a>
<li><a href= "#bsd.rd"      >4.11 - Qu'est ce que 'bsd.rd' ?</a>
<li><a href= "#InstProb"    >4.12 - Problèmes d'installation courants</a>
  <ul>
  <li><a href="#cpq16m"     >4.12.1 - Mon Compaq ne reconnaît que 16M de RAM</a>
  <li><a href="#noboot"     >4.12.2 - Mon i386 ne démarre pas après l'installation</a>
  <li><a href="#sshhang"    >4.12.3 - Ma machine a démarré, mais bloque pendant la procédure
                                      ssh-keygen</a>
  <li><a href="#noftplist"  >4.12.4 - J'ai le message "Failed to change directory" pendant
                                      l'installation</a>
  <li><a href="#blankfdisk" >4.12.5 - Ma table de partition fdisk est corrompue ou vide !</a>
  </ul>
<li><a href= "#site"        >4.13 - Personnaliser la procédure d'installation</a>
<li><a href= "#Multiple"    >4.14 - Comment puis-je installer plusieurs systèmes identiques ?</a>
<li><a href="#getdmesg"     >4.15 - Comment puis-je obtenir un dmesg(8) pour rapporter un
                                    problème d'installation ?</a>
</ul>
<hr>

<p>
<a name= "Overview"></a>
<h2>4.1 - Présentation de la procédure d'installation OpenBSD</h2>

<p>
OpenBSD a une procédure d'installation robuste, adaptable et peut
être installé depuis une simple disquette.
La plupart des architectures suivent une procédure d'installation
similaire ; cependant quelques détails diffèrent.
Dans tous les cas, il vous est vivement conseillé de lire le document
INSTALL spécifique à votre architecture se trouvant dans le dossier
<i>"platform"</i> sur le CD-ROM ou les sites FTP (par exemple,
<tt>i386/INSTALL.i386</tt>, <tt>mac68k/INSTALL.mac68k</tt> ou
<tt>sparc/INSTALL.sparc</tt>).

<p>
Sur la plupart des architectures, l'installation OpenBSD utilise un
noyau spécial avec un certain nombre d'utilitaires et de scripts
d'installation inclus dans un disque RAM préchargé.
Après le démarrage de ce noyau, le système d'exploitation est extrait
depuis plusieurs fichiers
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tar&amp;sektion=1">tar(1)</a>
(<tt>.tgz</tt>) compressés.
Il existe de nombreux moyens de démarrer ce noyau d'installation :

<ul>
<li><b>Disquette :</b>
Des images de disquettes utilisables pour
créer une disquette d'installation depuis un autre système
<a href="#UnixFlop">Compatible Unix</a> ou sur un système
<a href="#DosFlop">DOS/Windows</a> sont fournies.
Les noms de fichiers typiques sont <tt>floppy39.fs</tt>, bien que
plusieurs architectures possèdent de multiples images de disquettes.

<li><b>CD-ROM :</b> Sur plusieurs architectures une image CD-ROM
(<tt>cd39.iso</tt>) est fournie, autorisant la création d'un CD-ROM amorçable.
Il contient simplement le noyau d'installation - les fichiers d'installation doivent
toujours être téléchargés via FTP ou une autre source.
Vous pouvez, bien sûr, créer votre propre CD-ROM avec les fichiers et
outils que vous désirez.

<li><b><a href="#bsd.rd">bsd.rd</a> :</b> Le noyau RAM,
créé pour le démarrage depuis une partition OpenBSD existante ou à
travers le réseau.

<li><b>Réseau:</b> Quelques architectures supportent le démarrage à
travers un réseau (en utilisant par exemple <a
href="faq6.html#PXE">PXE</a> ou d'autres méthodes de 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=diskless&amp;sektion=8">démarrage réseau</a>).

<li><b>Ecrire une image de système de fichiers sur disque :</b> Une
image de système de fichiers qui peut être écrite depuis une partition
existante, et qui sera ensuite amorçable.

<li><b>Cassettes amorçable :</b> Certaines architectures supportent
l'amorçage depuis des cassettes.

Ces cassettes peuvent être créées en suivant les instructions du fichier
INSTALL.<i>platform</i>.
</ul>

Toutes les <a href="../../fr/plat.html">architectures</a> ne supportent
pas chacune des options de démarrage :

<ul>
<li><a href="../../fr/alpha.html"><b>alpha :</b></a> Disquette, CD-ROM,
    Ecriture d'une image de disquette sur le disque dur.

<li><a href="../../fr/amd64.html"><b>amd64 :</b></a> Disquette, CD-ROM,
    <a href="faq6.html#PXE">Réseau</a>.

<li><a href="../../fr/cats.html"><b>cats :</b></a> CD-ROM.

<li><a href="../../fr/hp300.html"><b>hp300 :</b></a> CD-ROM, Réseau.

<li><a href="../../fr/hppa.html"><b>hppa :</b></a> Réseau.

<li><a href="../../fr/i386.html"><b>i386 :</b></a> Disquette, CD,
    <a href="faq6.html#PXE">Réseau</a>.

<li><a href="../../fr/mac68k.html"><b>mac68k :</b></a> Booté en utilisant
    des outils lancés sur Mac OS. Voir
    <a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.9/mac68k/INSTALL.mac68k">INSTALL.mac68k</a>
    pour plus de détails.

<li><a href="../../fr/macppc.html"><b>macppc :</b></a> CD-ROM, Réseau.

<li><a href="../../fr/mvme68k.html"><b>mvme68k :</b></a> Réseau,
    Cassette amorçable.

<li><a href="../../fr/mvme88k.html"><b>mvme88k :</b></a> Réseau,
    Cassette amorçable.

<li><a href="../../fr/sparc.html"><b>sparc :</b></a> Disquette, CD-ROM,
    Réseau, Ecriture d'une image sur une partition swap existante,
    Cassette amorçable.

<li><a href="../../fr/sparc64.html"><b>sparc64 :</b></a> Disquette
    (U1/U2 uniquement), CD-ROM, Réseau, Ecriture d'une image sur une
    partition existante.

<li><a href="../../fr/vax.html"><b>vax :</b></a> Disquette, Réseau.

</ul>

Toutes les installations autres que mac68k peuvent aussi utiliser un
noyau <a href="#bsd.rd">bsd.rd</a> lors d'une mise à jour ou d'une
réinstallation.

<p>
Une fois le noyau démarré, vous avez plusieurs options pour obtenir les
<a href="#FilesNeeded">paquetages d'installation</a>.
Une fois de plus, toutes les architectures ne supportent pas toutes ces
options.

<ul>
<li><b>CD-ROM :</b> Bien sûr, nous préférons que vous utilisiez les
<a href="../../orders.html">CD-ROMS Officiels</a>, mais pour des besoins
spéciaux, vous pouvez aussi créer les vôtres.

<li><b>FTP :</b>
L'un des différents
<a href="../../ftp.html">sites miroirs FTP</a>
OpenBSD ou votre serveur FTP local contenant les paquetages.

<li><b>HTTP :</b>
L'un des différents
<a href="../../ftp.html#http">sites miroirs HTTP</a>
OpenBSD ou votre serveur web local contenant les paquetages.

<li><b>Partition de disque local :</b>
Dans la plupart des cas, vous pouvez installer les paquetages depuis une
autre partition de votre disque dur local.
Par exemple, sur <a href="../../fr/i386.html">i386</a>,
vous pouvez installer à partir d'une partition FAT ou d'un CD-ROM
formaté au format ISO9660, Rock Ridge ou Joliet.
Dans certains cas, vous devrez manuellement monter le système de
fichiers avant de l'utiliser.

<li><b>NFS :</b>
Quelques architectures supportent les montages NFS de paquetages.

<li><b>Cassette :</b>
Les paquetages peuvent aussi être lus depuis une cassette formatée.
</ul>

<a name="Checklist"></a>
<h2>4.2 - Vérifications avant l'installation</h2>

<p>
Avant de commencer votre installation, vous devriez avoir une
idée de ce que vous allez devoir faire.

Vous devriez connaître ces différents éléments au minimum :
<ul>
<li>Nom de la machine.
<li>Matériel installé et disponible.
  <ul>
  <li>La compatibilité de votre architecture grâce à la page de compatibilité.
  <li>Dans les cas d'utilisation de matériel ISA, vous devrez aussi
      connaître les paramètres matériels et confirmer qu'ils sont tels
      qu'OpenBSD les requiert.
  </ul>
<li>La méthode d'installation qui sera utilisée (CD-ROM, FTP, etc.)
<li>Comment le système sera-t-il mis à jour et corrigé ?
  <ul>
  <li>Si cela est fait localement, vous devrez bénéficier de suffisamment
      <a href="#Partitioning">d'espace libre</a> pour stocker l'arbre des
      sources et le construire.
  <li>Autrement, vous aurez besoin d'accéder à une autre machine pour y
      construire une <a href="faq5.html#Release">release</a> patchée.
  </ul>
<li>Partitionnement de disque désiré.
  <ul>
  <li>Y-a-t-il des données à sauvegarder quelque part ?
  <li>OpenBSD coexistera-t-il sur ce système avec d'autres OS ?
      Si oui, comment seront-il démarrés ?
      Aurez vous besoin d'installer un gestionnaire de démarrage ?
  <li>La totalité du disque sera-t-elle utilisée par OpenBSD ou
      voulez-vous conserver une partition ou un OS (ou de la place pour
      un autre) ?
  <li>Comment souhaitez vous partitionner la partie réservée à OpenBSD
      de votre disque ?
  </ul>
<li>Paramètres Réseau, si vous n'utilisez pas DHCP :
  <ul>
  <li>Nom de domaine.
  <li>Adresse des Serveurs de Nom de Domaine (DNS).
  <li>Adresse IP et masque de sous-réseau pour chaque NIC.
  <li>Adresse de la passerelle.
  </ul>
<li>Lancerez vous le système de fenêtres X ?
</ul>


<a name="MkInsMedia"></a>
<h2>4.3 - Créer un média d'installation OpenBSD amorçable</h2>

<p>
Comme exemples, nous allons regarder les images d'installation
disponibles pour les architectures
<a href="../../fr/i386.html">i386</a> et
<a href="../../fr/sparc.html">sparc</a>.

<p>
L'architecture <a href="../../fr/i386.html">i386</a> dispose de six
images de disques séparées parmi lesquelles choisir :

<ul>
<li><b><tt>floppy39.fs</tt></b> (PC de bureau) supporte la plupart
    des cartes PCI et ISA, des adaptateurs IDE et des adaptateurs
    SCSI simples ainsi que quelques matériels PCMCIA. La plupart
    des utilisateurs utiliseront cette image.
<li><b><tt>floppyB39.fs</tt></b> (Serveurs) supporte plusieurs
    contrôleurs RAID et quelques adaptateurs SCSI courants. Toutefois le
    support pour certains adaptateurs SCSI et plusieurs NICs EISA et ISA
    a été retiré.
<li><b><tt>floppyC39.fs</tt></b> (Portables) supporte les matériels
    CardBus et PCMCIA trouvés sur la plupart des portables.
<li><b><tt>cdrom39.fs</tt></b> est, en effet, la combinaison des trois
    disques de démarrage. Il peut être utilisé pour créer des disquettes
    amorçables de 2.88M, ou plus couramment, comme une image d'amorce de
    CD inscriptibles personnalisés.
<li><b><tt>cd39.iso</tt></b> est une image ISO9660 qui peut être
    utilisée pour créer un CD amorçable à l'aide de la plupart des
    logiciels de création de CD-ROM sur la plupart des architectures.
<li><b><tt>cdemu39.iso</tt></b> est une image ISO9660 se servant de
    l'émulation de disquette pour démarrer. Elle utilise pour cela
    l'image <tt>cdrom39.fs</tt> de 2.88M. Il faut espérer que peu de
    personnes auront à utiliser cette image -- la plupart utiliseront
    <tt>cd39.iso</tt>, n'utilisez <tt>cdemu39.iso</tt> que si
    <tt>cd39.iso</tt> ne fonctionne pas pour vous.
</ul>

Oui, il peut y avoir des situations dans lesquelles un disque
d'installation est requis pour supporter votre adaptateur SCSI et un
autre disque pour votre adaptateur réseau.
Heureusement, ce cas est rare, et peut être généralement contourné.

<p>
L'architecture
<a href="../../fr/sparc.html">sparc</a> dispose de trois images disques
d'installation parmi lesquelles choisir :

<ul>
<li><b><tt>floppy39.fs:</tt></b> Supporte les systèmes équipés d'un
    lecteur de disquettes.
<li><b><tt>cd39.iso</tt></b> Une image ISO utilisable pour créer votre
    propre CD afin d'amorcer les systèmes SPARC à l'aide un CD-ROM.
<li><b><tt>miniroot39.fs</tt></b> peut être écrite sur une partition
    swap et démarrée.
</ul>

<a name="MkFlop"></a>
<a name="UnixFlop"></a>
<h3>4.3.1 - Créer des disquettes de démarrage sur Unix</h3>

<p>
Pour créer une disquette formatée, utilisez la commande
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdformat&amp;sektion=1&amp;arch=i386">fdformat(1)</a>
pour chacun des formats et recherchez les secteurs défectueux..

<p>
<table border=0 width="90%"> <tr> <td nowrap bgcolor="#EEEEEE"><pre>
  # <b>fdformat /dev/rfd0c</b>
  Format 1440K floppy `/dev/rfd0c'? (y/n): y
  Processing VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV done.
</pre></td></tr> </table>

<p>
Si votre sortie est identique à celle ci-dessus, votre disque est correct.
Cependant, si vous ne voyez pas tous les "V" alors votre disque est
probablement endommagé et vous devriez en essayer un autre.

<p>
Notez que certains systèmes compatibles UNIX possèdent des commandes
différentes pour le formatage des disquettes.
Référez-vous à votre documentation système pour connaître la procédure
exacte.

<p>
Une fois que vous avez une disquette propre et formatée, il est
temps d'écrire l'image d'installation sur celle-ci.
Pour cela, vous pouvez recourir à l'utilitaire
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&amp;sektion=0">dd(1)</a>.
Un exemple d'utilisation de <tt>dd(1)</tt> est fourni ci-dessous :

<p>
<table border=0 width="90%"> <tr> <td nowrap bgcolor="#EEEEEE"><pre>
  # <b>dd if=floppy39.fs of=/dev/rfd0c bs=32k</b>
</pre></td></tr></table>

<p>
Une fois l'image écrite, vérifiez qu'elle a été correctement copiée et
qu'elle est identique à l'image d'origine avec la commande
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cmp&amp;sektion=1">cmp(1)</a>.
Si la disquette est identique à l'image, vous ne verrez apparaître
qu'une nouvelle invite de commande.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  # <b>cmp /dev/rfd0c floppy39.fs</b>
</pre></td> </tr> </table>

<a name="DosFlop"></a>
<h3>4.3.2 - Créer des disquettes de démarrage sur Windows ou DOS</h3>

<p>
Cette section décrit comment écrire des images d'installation sur une
disquette à partir de Windows ou DOS.
Vous pouvez obtenir les utilitaires mentionnés ci-dessous depuis le
dossier
<a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.9/tools/">tools</a>
de n'importe quel miroir FTP, ou depuis le dossier <tt>3.9/tools</tt>
du CD1 du lot de CD-ROMS OpenBSD.

<p>
Pour préparer la disquette sous MS-DOS ou Windows, utilisez tout
d'abord les utilitaires natifs pour formater le disque.

<p>
Pour écrire l'image d'installation sur la disquette préparée vous
pouvez utiliser
<i>rawrite</i>, <i>fdimage</i>, ou <i>ntrw</i>.
<i>rawrite</i> ne fonctionnera pas sur Windows NT, 2000 ou XP.

<p>
Notez que <tt>FDIMAGE.EXE</tt> et <tt>RAWRITE.EXE</tt> sont toutes deux
des applications MS-DOS, et sont donc limitées à la convention de
nommage de fichiers MS-DOS "8.3".
Comme <tt>floppyB39.fs</tt> et <tt>floppyC39.fs</tt> ont des noms de
fichiers longs, vous devrez trouver comment votre système a sauvegardé
ces derniers dans le format "8.3" avant d'utiliser <tt>FDIMAGE.EXE</tt>
ou <tt>RAWRITE.EXE</tt> pour créer les images de disquettes de
démarrage.

<p>
Exemple d'utilisation de <i>rawrite</i> :
<table border=0 width="90%"> <tr> <td nowrap bgcolor="#EEEEEE"><pre>
  C:\> <b>rawrite</b>
  RaWrite 1.2 - Write disk file to raw floppy diskette

  Enter source file name: <b>floppy39.fs</b>
  Enter destination drive: <b>a</b>
  Please insert a formatted diskette into drive A: and press -ENTER- : <i><b>Enter</b></i>
</pre> </td> </tr> </table>

<p>
Exemple d'utilisation de <i>fdimage</i> :
<table border=0 width="90%"> <tr> <td nowrap bgcolor="#EEEEEE"><pre>
  C:\> <strong>fdimage -q floppy39.fs a:</strong>
</pre></td></tr></table>

<p>
Exemple d'utilisation de <i>ntrw</i> :
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  C:\> <strong>ntrw floppy39.fs a:</strong>
  3.5", 1.44MB, 512 bytes/sector
  bufsize is 9216
  1474560 bytes written
</pre></td></tr></table>

<a name="MkCD-ROM"></a>
<h3>4.3.3 - Créer un CD-ROM amorçable</h3>

<p>
Vous pouvez créer un CD-ROM soit en utilisant le fichier
<tt>cd39.iso</tt>, ou dans le cas des architectures i386 et amd64, vous
pouvez aussi utiliser <tt>cdrom39.fs</tt> comme image de disquette
amorçable pour démarrer un système i386 depuis le CD-ROM. On laissera
ici au lecteur le soin de déterminer lui-même les détails en fonction
des outils mis à sa disposition.

<p>
Voici quelques-uns des outils présents dans OpenBSD :
<ul>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mkhybrid&amp;sektion=8">mkhybrid(8)</a>
<li><a href="http://cdrecord.berlios.de/old/private/cdrecord.html">cdrecord</a>,
    qui est une partie de la collection cdrtools dans le
    <a href="../faq15.html">Système de Ports et de Paquetages OpenBSD</a>.
</ul>

<a name="Boot"></a>
<h2>4.4 - Démarrer le média d'installation OpenBSD</h2>

<h3>Démarrer sur i386/amd64</h3>

Démarrer une image d'installation sur les architectures PC i386 et amd64 n'est
pas nouveau pour la plupart des gens.
Si vous utilisez une disquette, insérez-la simplement dans le lecteur
et démarrez le système.
L'image d'installation va se charger si le démarrage depuis la disquette
est activé dans votre BIOS.
Si vous souhaitez démarrer depuis un CD-ROM, vous devrez aller dans
votre BIOS système et autoriser le démarrage depuis celui-ci.
Quelques anciens BIOS ne supportent pas cette option, et vous devrez
utiliser une disquette pour démarrer votre image d'installation. Ne vous
inquiétez pas ; bien que vous démarriez depuis la disquette, vous
pourrez installer depuis le CD.
<p>
Vous pouvez aussi démarrer <a href="#bsd.rd">bsd.rd</a> depuis une
partition OpenBSD existante, ou depuis le réseau en utilisant la
<a href="faq6.html#PXE">procédure de démarrage PXE</a>.

<h3>Démarrer sur sparc/sparc64</h3>

<b>NOTE :</b>
Sur l'architecture <a href="../../fr/sparc64.html">sparc64</a>, seules
les machines SBus (Ultra 1, Ultra 2) sont amorçables depuis une
disquette.

<p>
Pour démarrer depuis une disquette, placez la disquette contenant
l'image d'installation OpenBSD dans le lecteur.
Utilisez ensuite la commande suivante pour démarrer :

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  ok <b>boot floppy</b>
</pre></td></tr></table>

<p>
Pour démarrer depuis un CD-ROM, placez le CD-ROM OpenBSD dans le
lecteur.
Si votre Sun n'a qu'un lecteur de CD-ROM, alors allez simplement à
l'invite de démarrage et tapez <tt>boot cdrom</tt> :

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  ok <b>boot cdrom</b>
</pre></td></tr></table>

<p>
Bien sûr, cela ne fonctionnera que dans le nouveau mode de commande. Si
vous possédez l'ancien mode de commande (une flèche droite), tapez 'n'
pour le nouveau mode de commande.
(Si vous utilisez un ancien sparc qui est antérieur à sun4c, vous
n'avez probablement pas de nouveau mode de commande.
Dans ce cas, vous allez devoir expérimenter.)

Si vous avez de multiples lecteurs CD-ROM, vous devez démarrer depuis le
bon.
Essayez <tt>probe-scsi</tt> depuis le nouveau mode de commande.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  ok <b>probe-scsi</b>

  Target 0
    Unit 0   Disk     QUANTUM LIGHTNING 365S
  Target 1
    Unit 0   Removable Disk     QUANTUM EMPIRE_1080S
  Target 3
    Unit 0   Removable Disk     Joe's CD-ROM
</pre></td></tr></table>

<p>
Regardez depuis lequel vous souhaitez démarrer. Notez le numéro
de cible ("Target").

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  ok <b>boot /sbus/esp/sd@X,0</b>
</pre></td></tr></table>

<a name="Install"></a>
<h2>4.5 - Installer OpenBSD</h2>
<a name="Start"></a>
<h3>4.5.1 - Commencer l'installation</h3>
<!-- XXXrelease -->
Quelle que soit votre méthode de démarrage, il est temps de l'utiliser.
Pendant la procédure de démarrage, le noyau et tous les programmes
utilisés pour installer OpenBSD sont chargés en mémoire. Le problème le
plus courant au démarrage est une disquette endommagée ou un problème
d'alignement de lecteur. La disquette de démarrage est très compactée --
un seul mauvais bloc causera des problèmes.

<p>
A presque tout moment de la procédure d'installation OpenBSD, vous
pouvez arrêter la procédure en frappant CTRL-C et pourrez la relancer
sans avoir à redémarrer en lançant <tt>install</tt> à l'invite shell.

<p>
Si votre démarrage réussi, vous verrez beaucoup de messages défiler.
Ces textes, dans beaucoup d'architectures en blanc sur bleu, représentent le
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dmesg&amp;sektion=8">dmesg</a>,
du noyau qui cite les matériels trouvés et leur emplacement. Ne vous
souciez pas de retenir ce message, une copie est conservée dans
<tt>/var/run/dmesg.boot</tt>.

<p>
Ensuite, vous verrez ce qui suit :

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  rootdev=0x1100 rrootdev=0x2f00 rawdev=0x2f02
  erase ^?, werase ^W, kill ^U, intr ^C, status ^T
  (I)nstall, (U)pgrade or (S)hell? <b>i</b>
</pre></td></tr></table>

<p>
Avec cela, nous atteignons notre première question. Dans la plupart des
cas, vous avez ces trois options :
<ul>
<li><b>Install :</b> Charge OpenBSD dans le système, remplaçant un
    éventuel autre système se trouvant là. Notez qu'il est possible
    de laisser certaines partitions intactes dans cette procédure, comme
    <tt>/home</tt>, mais dans les autres cas, considérez que tout le
    reste sera écrasé.
<li><b>Upgrade :</b> Installer un nouveau paquetage de <a
    href="#FilesNeeded">fichiers d'installation</a>
    sur cette machine, mais ne remplacer aucune information
    de configuration, donnée utilisateur ou programme additionnel. Aucun
    formatage de disque n'est réalisé, ni le dossier /etc ni /var ne
    sont remplacés.
    Quelques remarques importantes :
    <ul>
    <li> Vous n'aurez pas la possibilité d'installer le paquetage
    <tt>etc39.tgz</tt>.
    Après l'installation, vous devrez
    <a href="upgrade39.html#etcUpdates">>manuellement greffer</a>
    <tt>etc39.tgz</tt> sur votre système avant qu'il puisse être complètement
    fonctionnel.
    C'est une étape importante qui doit être réalisée, car dans le cas
    contraire certains services clés (tel que
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4">pf(4)</a>)
    ne démarreront pas.

<li>
La procédure de mise à jour n'est pas faite pour sauter des "releases" !
Bien que ce saut fonctionnera souvent, il n'est pas supporté.
Pour OpenBSD 3.9, mettre à jour de la version 3.8 à la version 3.9 est la
seule mise à jour supportée.
Si vous mettez à jour depuis une version plus vieille, une 
réinstallation complète est recommandée.<br>

</ul>
<!-- XXXversion -->
Plus d'informations concernant la mise à jour d'une version à une autre
se trouvent <a href="upgrade39.html">ici</a>.

<li><b>Shell :</b> Parfois, vous devez réaliser des réparations ou de
la maintenance sur un système qui ne pourra pas (ou ne devra pas) démarrer
un noyau normal.
Cette option vous permettra cette maintenance sur le système.
Un certain nombre d'utilitaires importants sont présents sur le media de
démarrage.
</ul>

Parfois, vous ne verrez pas l'option "Upgrade" listée. Après un <i>"jour
drapeau"</i>, il n'est pas possible de mettre à jour directement ; l'on
doit recréer le système depuis le début.

<p>
Dans cet exemple, nous allons faire une installation mais la procédure
de mise à jour est similaire.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Welcome to the OpenBSD/i386 3.9 install program.

  This program will help you install OpenBSD in a simple and rational way. At
  any prompt except password prompts you can run a shell command by typing
  '!foo', or escape to a shell by typing '!'. Default answers are shown in []'s
  and are selected by pressing RETURN. At any time you can exit this program by
  pressing Control-C and then RETURN, but quitting during an install can leave
  your system in an inconsistent state.

  Specify terminal type: [vt220] <b><i>Entrée</i></b>
  kbd(8) mapping? ('L' for list) [none] <b><i>Entrée</i></b>
</pre></td></tr></table>

<p>
Dans la plupart des cas, le type de terminal par défaut est approprié ;
cependant si vous utilisez une <a href="faq7.html#SerCon">console
série</a> pour l'installation, ne prenez pas l'option par défaut,
répondez de manière appropriée.

<p>
Si vous ne choisissez pas une table d'encodage, une disposition de
clavier US est choisie.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  IS YOUR DATA BACKED UP? As with anything that modifies disk contents, this
  program can cause SIGNIFICANT data loss.

  It is often helpful to have the installation notes handy. For complex disk
  configurations, relevant disk hardware manuals and a calculator are useful.

  Proceed with install? [no] <b>y</b>
</pre></td></tr></table>

<p>
Si vous sélectionnez l'option par défaut ici, le processus
d'installation va se terminer et vous envoyer sur une invite de commande
shell.

<p>
Les notes d'installation auxquelles nous nous référons ici sont
présentes sur les CDs d'installation ainsi que les serveurs FTP dans le
fichier <tt>INSTALL.<i>&lt;plat&gt;</i></tt>, où <i>&lt;plat&gt;</i> est
votre <a href="../../fr/plat.html">plate-forme</a>, par exemple pour
<tt>i386</tt>.

<a name="Disks"></a>
<h3>4.5.2 - Configurer les disques</h3>

<p>
Configurer les disques sur OpenBSD varie un peu en fonction des
architectures. Pour <a href="../../fr/i386.html">i386</a>, <a
href="../../fr/amd64.html">amd64</a>, <a
href="../../fr/macppc.html">macppc</a>, <a
href="../../fr/zaurus.html">zaurus</a> et <a
href="../../fr/cats.html">cats</a>, la configuration est faite en deux
étapes. D'abord, la partition OpenBSD du disque dur est définie avec
fdisk(8), ensuite cette partition est divisée en partitions OpenBSD avec
disklabel(8).

<p>
Quelques utilisateurs peuvent être désorientés par la terminologie
utilisée ici. Nous utiliserons le mot "partition" dans deux sens
différents. Il y a deux niveaux de partitionnement sous OpenBSD pour les
architectures citées précédemment, la première, peut être considérée
comme le partitionnement des Systèmes d'Exploitation, qui permet à de
multiples systèmes d'exploitation de définir leur espace sur le disque,
et la seconde définie comment la partition OpenBSD est subdivisée en
plusieurs systèmes de fichiers individuels. La première couche est
visible comme une partition de disque pour DOS, Windows ou tout autre
système d'exploitation supportant cette disposition. La seconde couche
de partitionnement est visible seulement par OpenBSD et les systèmes
d'exploitation pouvant lire directement un système de fichiers OpenBSD.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Cool!  Let's get to it...

  You will now initialize the disk(s) that OpenBSD will use. To enable all
  available security features you should configure the disk(s) to allow the
  creation of separate filesystems for /, /tmp, /var, /usr, and /home.

  Available disks are: wd0.
  Which one is the root disk? (or done) [wd0] <b><i>Entrée</i></b>
</pre></td></tr></table>

<p>
Le disque "root" est le disque depuis lequel le système démarrera et
normalement sur lequel l'espace "swap" réside.
Les disques IDE vont être désignés comme <tt>wd0</tt>, <tt>wd1</tt>, etc., tandis
que les disques SCSI et les matériels RAID apparaîtront comme <tt>sd0</tt>,
<tt>sd1</tt>, et ainsi de suite.
Les disques que OpenBSD peut utiliser sont listés ici -- si vous avez
des lecteurs qui ne sont pas montrés, votre matériel est soit non
supporté, soit mal configuré.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Do you want to use *all* of wd0 for OpenBSD? [no] <b><i>Entrée</i></b>
</pre></td></tr></table>

<p>
Si vous répondez "yes" à cette question, l'intégralité du disque sera
allouée à OpenBSD. Le résultat sera un "Master Boot Record" valide et
une table de partition écrite sur le disque -- une partition, de la
taille du disque entier, configurée avec le type de partition OpenBSD,
et indiquée comme partition amorçable. Ce sera un choix courant pour la
plupart des utilisations en production d'OpenBSD ; cependant, il y a
quelques systèmes sur lesquels cela ne doit pas être fait.
La plupart des systèmes Compaq, certains ordinateurs portables, quelques
DELL et d'autres systèmes utilisant une partition "maintenance" ou
"Suspend to Disk", qui devrait être gardée intacte.
Si votre système a d'autres partitions, quels que soient leurs types, que vous
ne voulez pas effacer, ne répondez pas "yes" à la question précédente.
En revanche, si votre système possède un disque tout neuf qui n'a jamais
été utilisé, vous devrez probablement répondre "yes" (ou utiliser
l'option "update" de fdisk) afin d'inscrire un enregistrement et une
signature de boot valide.

<p>
Dans le cas de cet exemple, nous considérerons que le disque doit
être partagé entre OpenBSD et une partition Windows 2000 existante,
donc nous répondrons l'option par défaut "no", qui nous enverra dans
le programme
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&amp;sektion=8&amp;arch=i386">fdisk(8)</a>.
Vous pouvez obtenir plus d'informations sur fdisk(8)
<a href="faq14.html#fdisk">ici</a>.

<p>
<b>Note importante :</b>
Les utilisateurs avec un disque de grande capacité (plus grande que la
capacité généralement disponible lorsque votre machine a été fabriquée)
voudront sûrement consulter <a href="faq14.html#LargeDrive">cette
section</a> avant d'aller plus loin.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  You will now create a single MBR partition to contain your OpenBSD data. This
  partition must have an id of 'A6'; must *NOT* overlap other partitions; and
  must be marked as the only active partition.

  The 'manual' command describes all the fdisk commands in detail.

  Disk: wd0       geometry: 2586/240/63 [39100320 Sectors]
  Offset: 0       Signature: 0xAA55
           Starting       Ending       LBA Info:
   #: id    C   H  S -    C   H  S [       start:      size   ]
  ------------------------------------------------------------------------
  *0: 06    0   1  1 -  202 239 63 [          63:     3069297 ] DOS > 32MB
  *0: 0B    0   1  1 -  202 239 63 [          63:     3069297 ] Win95 FAT-32
   1: 00    0   0  0 -    0   0  0 [           0:           0 ] unused
   2: 00    0   0  0 -    0   0  0 [           0:           0 ] unused
   3: 00    0   0  0 -    0   0  0 [           0:           0 ] unused
  Enter 'help' for information
  fdisk: 1> <b>help</b>
          help            Command help list
          manual          Show entire OpenBSD man page for fdisk
          reinit          Re-initialize loaded MBR (to defaults)
          setpid          Set the identifier of a given table entry
          disk            Edit current drive stats
          edit            Edit given table entry
          flag            Flag given table entry as bootable
          update          Update machine code in loaded MBR
          select          Select extended partition table entry MBR
          swap            Swap two partition entries
          print           Print loaded MBR partition table
          write           Write loaded MBR to disk
          exit            Exit edit of current MBR, without saving changes
          quit            Quit edit of current MBR, saving current changes
          abort           Abort program without saving current changes
  fdisk: 1>
</pre></td></tr></table>

<p>
Quelques commandes doivent être expliquées :
<ul>
<li><b><tt>r</tt></b> ou <b><tt>reinit :</tt></b> Efface la table
des partitions existante, crée une grande partition OpenBSD,
la définit active et installe le code MBR OpenBSD.
Cela équivaut à répondre "yes" à la question
"<tt>use *all* of ...</tt>" précédente.
<li><b><tt>p</tt></b> ou <b><tt>print :</tt></b> Montre la table des
partitions courante en secteurs. "<tt>p m</tt>" montrera la
table en méga-octets, "<tt>p g</tt>" la montrera en
giga-octets.
<li><b><tt>e</tt></b> ou <b><tt>edit :</tt></b> Editer ou modifier
une entrée de la table.
<li><b><tt>f</tt></b> ou <b><tt>flag :</tt></b> Marquer une partition
comme active, ce sera celle depuis laquelle le système démarrera.
<li><b><tt>u</tt></b> or <b><tt>update :</tt></b> Met à jour le MBR avec
le code de boot d'OpenBSD, similaire à "<tt>reinit</tt>", si ce n'est que
cela ne modifie pas la table des partitions existante.
<li><b><tt>exit</tt></b> et <b><tt>quit :</tt></b> Soyez prudents, car
certains utilisateurs ont l'habitude d'utiliser "exit" et "quit" qui
ont des sens opposés.
</ul>

Il est nécessaire de le rappeler, une erreur à ce stade entraînera
de lourdes pertes de données. Si vous comptez faire cette manipulation
sur un disque avec des données importantes, il serait plus judicieux
de vous exercer sur un disque plus "disponible", en plus d'avoir une
bonne sauvegarde.

<p>
Notre disque ici a une partition de 1.5Go pour Windows 2000
(utilisant le système de fichiers FAT). En regardant les informations
ci-dessous, nous pouvons voir que la partition Windows occupe le
lecteur jusqu'au cylindre 202. Nous allons donc allouer le reste du
disque à OpenBSD en commençant au cylindre 203. Vous pouvez aussi
calculer que le secteur de début d'OpenBSD est 3069360 en additionnant
le secteur de début de la partition existante (63) et sa taille (3069297).

<p>
Vous pouvez éditer la disposition du disque en utilisant soit la notation
Cylindre/Tête/Secteur, soit la notation en secteurs bruts. Ce qui est
le plus simple dépend de ce que l'on fait ; dans notre cas, travailler
autour d'une partition existante, utiliser le format CHS sera
probablement plus simple.
Si vous créez la première partition sur le disque, utiliser les
secteurs bruts sera probablement plus aisé.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  fdisk: 1> <b>e 1</b>
           Starting       Ending       LBA Info:
   #: id    C   H  S -    C   H  S [       start:      size   ]
  ------------------------------------------------------------------------
   1: 00    0   0  0 -    0   0  0 [           0:           0 ] unused
  Partition id ('0' to disable)  [0 - FF]: [0] (? for help) <b>a6</b>
  Do you wish to edit in CHS mode? [n] <b>y</b>
  BIOS Starting cylinder [0 - 2585]: [0] <b>203</b>
  BIOS Starting head [0 - 239]: [0] <b><i>Entrée</i></b>
  BIOS Starting sector [1 - 63]: [0] <b>1</b>
  BIOS Ending cylinder [0 - 2585]: [0] <b>2585</b>
  BIOS Ending head [0 - 239]: [0] <b>239</b>
  BIOS Ending sector [1 - 63]: [0] <b>63</b>
  fdisk:*1> <b>p</b>
  Disk: wd0       geometry: 2586/240/63 [39100320 Sectors]
  Offset: 0       Signature: 0xAA55
            Starting       Ending       LBA Info:
    #: id    C   H  S -    C   H  S [       start:      size   ]
   ------------------------------------------------------------------------
    0: 06    0   1  1 -  202 239 63 [          63:     3069297 ] DOS > 32MB
   *0: 0B    0   1  1 -  202 239 63 [          63:        1499M] Win95 FAT-32
   *1: A6  203   0  1 - 2585 239 63 [     3069360:    36030960 ] OpenBSD
    2: 00    0   0  0 -    0   0  0 [           0:           0 ] unused
    3: 00    0   0  0 -    0   0  0 [           0:           0 ] unused
  fdisk:*1> <b>p m</b>
  Disk: wd0       geometry: 2586/240/63 [19092 Megabytes]
  Offset: 0       Signature: 0xAA55
           Starting       Ending       LBA Info:
   #: id    C   H  S -    C   H  S [       start:      size   ]
  ------------------------------------------------------------------------
  *0: 06    0   1  1 -  202 239 63 [          63:        1499M] DOS > 32MB
   0: 0B    0   1  1 -  202 239 63 [          63:     3069297 ] Win95 FAT-32
   1: A6  203   0  1 - 2585 239 63 [     3069360:       17593M] OpenBSD
   2: 00    0   0  0 -    0   0  0 [           0:           0M] unused
   3: 00    0   0  0 -    0   0  0 [           0:           0M] unused
  fdisk:*1>
</pre></td></tr></table>

<a name="trackoffset"></a>
<p>
Il est important que la première partition saute la première piste
du disque, <i>dans notre cas</i>, qu'elle commence au secteur <tt>63</tt>.
Ceci varie d'une machine à une autre et d'un disque à un autre.
Si une partition OpenBSD est crée en ayant pour origine le secteur
<tt>0</tt>, la table de partition finira écrasée par le
<a href="faq14.html#Boot386">"Partition Boot Record"</a> de la
partition OpenBSD.
Le système sera toujours amorçable, mais il sera très difficile à
maintenir, et ce type de configuration n'est <i>ni recommandé ni
supporté</i>.

<p>
Notez que l'invite a changée pour inclure un astérisque ('<tt>*</tt>')
indiquant que nous avons des changements non enregistrés. Comme nous
pouvons le voir à partir de la sortie <tt>p&nbsp;m</tt> nous n'avons
pas altéré notre partition Windows, nous avons correctement alloué
le reste du disque à OpenBSD et les partitions ne se chevauchent pas. Nous
avons terminé. Presque.

<p>
Ce que nous n'avons pas fait est de définir la partition active pour que
la machine l'amorce lors du prochain redémarrage :

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  fdisk:*1> <b>f 1</b>
  Partition 1 marked active.
  fdisk:*1> <b>p</b>
  Disk: wd0       geometry: 2586/240/63 [39100320 Sectors]
  Offset: 0       Signature: 0xAA55
           Starting       Ending       LBA Info:
   #: id    C   H  S -    C   H  S [       start:      size   ]
  ------------------------------------------------------------------------
   0: 06    0   1  1 -  202 239 63 [          63:     3069297 ] DOS > 32MB
  *1: A6  203   0  1 - 2585 239 63 [     3069360:    36030960 ] OpenBSD
   2: 00    0   0  0 -    0   0  0 [           0:           0 ] unused
   3: 00    0   0  0 -    0   0  0 [           0:           0 ] unused
  fdisk:*1>
</pre></td></tr></table>

<p>
Maintenant, nous sommes prêts à enregistrer nos changements :

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  fdisk:*1> <b>w</b>
  Writing MBR at offset 0.
  wd0: no disk label
  fdisk: 1> <b>q</b>
</pre></td></tr></table>

<p>

<a name="disklabel"></a>
<h3>Créer le "disklabel"</h3>
La prochaine étape est d'utiliser
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=disklabel&amp;sektion=8">disklabel(8)</a>
pour diviser la partition OpenBSD. Plus de détails concernant disklabel(8)
peuvent être trouvés sur la
<a href="faq14.html#disklabel">FAQ 14, disklabel</a>.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Here is the partition information you chose:

  Disk: wd0       geometry: 2586/240/63 [39100320 Sectors]
  Offset: 0       Signature: 0xAA55
           Starting       Ending       LBA Info:
   #: id    C   H  S -    C   H  S [       start:      size   ]
  ------------------------------------------------------------------------
  *0: 06    0   1  1 -  202 239 63 [          63:     3069297 ] DOS > 32MB
   1: A6  203   0  1 - 2585 239 63 [     3069360:    36030960 ] OpenBSD
   2: 00    0   0  0 -    0   0  0 [           0:           0 ] unused
   3: 00    0   0  0 -    0   0  0 [           0:           0 ] unused

  You will now create an OpenBSD disklabel inside the OpenBSD MBR
  partition. The disklabel defines how OpenBSD splits up the MBR partition
  into OpenBSD partitions in which filesystems and swap space are created.

  The offsets used in the disklabel are ABSOLUTE, i.e. relative to the
  start of the disk, NOT the start of the OpenBSD MBR partition.

  disklabel: no disk label
  WARNING: Disk wd0 has no label. You will be creating a new one.
  
  # using MBR partition 1: type A6 off 3069360 (0x2ed5b0) size 36030960 (0x225c9f0)

  Treating sectors 3069360-39100320 as the OpenBSD portion of the disk.
  You can use the 'b' command to change this.

  Initial label editor (enter '?' for help at any prompt)
  > <b>?</b>
   Available commands:
           ? [cmnd]  - this message or command specific help.
           a [part]  - add new partition.
           b         - set OpenBSD disk boundaries.
           c [part]  - change partition size.
           D         - set label to default.
           d [part]  - delete partition.
           e         - edit drive parameters.
           g [b|d|u] - use [b]ios, [d]isk or [u]ser geometry.
           M         - show entire OpenBSD man page for disklabel.
           m [part]  - modify existing partition.
           n [part]  - set the mount point for a partition.
           p [unit]  - print label.
           q         - quit and save changes.
           r         - recalculate free space.
           s [path]  - save label to file.
           u         - undo last change.
           w         - write label to disk.
           X         - toggle expert mode.
           x         - exit without saving changes.
           z         - zero out partition table.

  Numeric parameters may use suffixes to indicate units:
          'b' for bytes, 'c' for cylinders, 'k' for kilobytes, 'm' for megabytes,
          'g' for gigabytes or no suffix for sectors (usually 512 bytes).
          '%' for percent of total disk size, '&' for percent of free space.
          Non-sector units will be rounded to the nearest cylinder.
  Entering '?' at most prompts will give you (simple) context sensitive help.
  >
</pre></td></tr></table>

<p>
Une fois de plus, certaines commandes doivent être expliquées :
<ul>
<li><b><tt>p</tt></b> - Montre le partitionnement courant à l'écran, vous pouvez
utiliser les arguments <tt>k, m</tt> ou <tt>g</tt> pour obtenir des
kilo-octets, méga-octets ou giga-octets.

<li><b><tt>D</tt></b> - Efface tout partitionnement existant au préalable, crée
un nouveau partitionnement par défaut qui recouvre juste la partition OpenBSD
courante. Ceci peut être utile si le disque contenait préalablement un
partitionnement, et que la partition OpenBSD avait été recréée avec une taille
différente -- l'ancien partitionnement n'aurais pas été supprimé, et aurait
pu être déroutant.

<li><b><tt>m</tt></b> - Modifie une entrée existante dans un partitionnement.
Ne surestimez pas ce que cette option pourra vous permettre. Alors que vous
pourrez modifier la taille d'une partition "disklabel", cela ne changera
PAS le système de fichiers sur le disque. Utiliser cette option et
vouloir redimensionner une partition existante est une bonne solution pour
perdre de grandes quantités de données.

</ul>

<p>
Diviser votre disque proprement est important. La réponse à la question,
"Comment dois-je partitionner mon système ?" est "Exactement comme vous
en avez besoin". Cela variera d'applications en applications. Il n'y a
pas de réponse universelle. Si vous n'êtes pas sûr de la façon dont vous
voulez partitionner votre système, regardez
<a href="#Partitioning">cette discussion</a>.

<p>
Sur ce système, nous avons près de 17Go disponibles pour OpenBSD. Cela
représente beaucoup d'espace, et nous n'aurons probablement pas besoin
d'autant. Nous n'utiliserons donc pas les tailles minimales absolues.
Nous préférerons disposer de quelques centaines de mega-octets en trop
plutôt que d'un kilo-octets en moins.

<p>
Sur le disque "root", deux partitions 'a' et 'b' <b>doivent</b> être créées.
La procédure d'installation ne démarrera pas tant que ces deux partitions
ne seront pas disponibles. 'a' sera utilisée comme racine du système de
fichiers (/) et 'b' sera utilisée comme zone de "swap".

<p>
Après quelques réflexions, nous décidons de créer juste assez de partitions
pour autoriser la création des systèmes de fichiers séparés qui est
recommandée (<tt>/, /tmp, /var, /usr, /home</tt>) et une partition
de "swap" :
<ul>
<li><i><b>wd0a: /</b></i> (root) - 150Mo.  Devrait être plus que suffisant.
<li><i><b>wd0b: </b></i>(swap) - 300Mo.
<li><i><b>wd0d: /tmp</b></i> - 120Mo.  <tt>/tmp</tt> est utilisé pour construire
  certains logiciels, 120Mo sera probablement suffisant pour la plupart des
  cas de figure.
<li><i><b>wd0e: /var</b></i> - 80Mo. Si ce fût un serveur web ou de mail,
  nous aurions fait une partition plus large, mais, ce n'est pas ce que
  nous souhaitons réaliser.
<li><i><b>wd0g: /usr</b></i> - 4Go. Nous voulons que cette partition soit
  assez grande pour charger quelques applications utilisateurs, et en
  plus être capable de mettre à jour et reconstruire le système si
  nécessaire. La <a href="../faq15.html#Ports">Racine des "Ports"</a>
  sera très bien ici, occupant approximativement 160Mo avant la construction des
  "ports". Si vous prévoyez la compilation de nombreuses applications à
  partir des sources, en vous servant des <a
  href="../faq15.html#Ports">ports</a> plutôt que des <a
  href="../faq15.html#PkgMgmt">paquetages</a> pré-compilés vous aurez
  sûrement besoin de plus de place ici.
<li><i><b>wd0h: /home</b></i> - 4Go. Cela permettra de stocker beaucoup de
  fichiers utilisateurs.
</ul>

Maintenant, si vous additionnez tout cela, vous verrez que plus de 9Go d'espace
est inutilisé ! De l'espace inutilisé ne dérange en rien, et donne la
flexibilité d'agrandir une de nos partitions dans le futur si le besoin
se fait sentir. Vous voulez plus de <i>/tmp</i> ?

créez une nouvelle partition dans l'espace inutilisé, formatez la avec
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=newfs&amp;sektion=8"
>newfs(8)</a>, et changez
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fstab&amp;sektion=5"
><i>/etc/fstab</i></a> pour monter la partition dans <i>/tmp</i>.
Problème réglé.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  > <b>p m</b>
  device: /dev/rwd0c
  type: ESDI
  disk: ESDI/IDE disk
  label: ST320011A
  bytes/sector: 512
  sectors/track: 63
  tracks/cylinder: 16
  sectors/cylinder: 1008
  cylinders: 16383
  total sectors: 39102336
  free sectors: 36030960
  rpm: 3600

  16 partitions:
  #             size        offset  fstype [fsize bsize  cpg]
    a:      17593.2M       1498.7M  unused      0     0      
    c:      19092.9M          0.0M  unused      0     0      
    i:       1498.7M          0.0M  MSDOS                 
  > <b>d a</b>
  > <b>a a</b>
  offset: [3069360] <b><i>Entrée</i></b>
  size: [36030960] <b>150m</b>
  Rounding to nearest cylinder: 307440
  FS type: [4.2BSD] <b><i>Entrée</i></b>
  mount point: [none] <b>/</b>
  > <b>a b</b>
  8ffset: [3376800] <b><i>Entrée</i></b>
  size: [35723520] <b>300m</b>
  Rounding to nearest cylinder: 614880
  FS type: [swap] <b><i>Entrée</i></b>
  > <b>a d</b>
  offset: [3991680] <b><i>Entrée</i></b>
  size: [35108640] <b>120m</b>
  Rounding to nearest cylinder: 245952
  FS type: [4.2BSD] <b><i>Entrée</i></b>
  mount point: [none] <b>/tmp</b>
  > <b>a e</b>
  offset: [4237632] <b><i>Entrée</i></b>
  size: [34862688] <b>80m</b>
  Rounding to nearest cylinder: 164304
  FS type: [4.2BSD] <b><i>Entrée</i></b>
  mount point: [none] <b>/var</b>
  > <b>a g</b>
  offset: [4401936] <b><i>Entrée</i></b>
  size: [34698384] <b>4g</b>
  Rounding to nearest cylinder: 8388576
  FS type: [4.2BSD] <b><i>Entrée</i></b>
  mount point: [none] <b>/usr</b>
  > <b>a h</b>
  offset: [12790512] <b><i>Entrée</i></b>
  size: [26309808] <b>4g</b>
  Rounding to nearest cylinder: 8388576
  FS type: [4.2BSD] <b><i>Entrée</i></b>
  mount point: [none] <b>/home</b>
  > <b>p m</b>
  device: /dev/rwd0c
  type: ESDI
  disk: ESDI/IDE disk
  label: ST320011A
  bytes/sector: 512
  sectors/track: 63
  tracks/cylinder: 16
  sectors/cylinder: 1008
  cylinders: 16383
  total sectors: 39102336
  free sectors: 22115520
  rpm: 3600

  16 partitions:
  #             size        offset  fstype [fsize bsize  cpg]
    a:        150.1M       1498.7M  4.2BSD   2048 16384   16 # /
    b:        300.2M       1648.8M    swap                   
    c:      19092.9M          0.0M  unused      0     0      
    d:        120.1M       1949.1M  4.2BSD   2048 16384   16 # /tmp
    e:         80.2M       2069.2M  4.2BSD   2048 16384   16 # /var
    g:       4096.0M       2149.4M  4.2BSD   2048 16384   16 # /usr
    h:       4096.0M       6245.4M  4.2BSD   2048 16384   16 # /home
    i:       1498.7M          0.0M   MSDOS  
  > <b>q</b>
  Write new label?: [y] <b><i>Entrée</i></b>
</pre></td></tr></table>

<p>
Vous noterez qu'il y a une partition <i>c</i> que nous avons vraisemblablement
ignorée. Cette partition représente votre disque entier ; n'essayez pas de la
modifier. Vous noterez aussi que la partition <i>i</i> n'as pas été définie par
nous ; elle est la partition existante Windows 2000. Les partitions n'ont pas de
lettre prédéfinie particulière -- à l'exception de <i>a</i> (racine),
<i>b</i> (swap) et <i>c</i> (disque entier), le reste des partitions (jusqu'a
la lettre <i>p</i>) est disponible pour l'utilisation que vous désirez en faire.

<p>
Si vous regardez de près à la sortie de disklabel, vous verrez que le valeur
de "RPM" est probablement faux. Ceci est historique ; la vitesse du disque
n'est utilisée nulle part dans le système. Ne vous inquiétez pas de cela.

<h3>Configurez vos points de montage et formatez vos systèmes de fichiers</h3>

Maintenant vient la configuration finale de vos points de montage. Si vous les
avez configurés à travers
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=disklabel&amp;sektion=8">disklabel(8)</a>,
cette étape consiste juste en la vérification de vos sélections ; autrement,
vous pouvez les spécifier maintenant.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Mount point for wd0d (size=122976k)? (or 'none' or 'done') [/tmp] <b><i>Entrée</i></b>
  Mount point for wd0e (size=82152k)? (or 'none' or 'done') [/var] <b><i>Entrée</i></b>
  Mount point for wd0g (size=4194288k)? (or 'none' or 'done') [/usr] <b><i>Entrée</i></b>
  Mount point for wd0h (size=4194288k)? (or 'none' or 'done') [/home] <b><i>Entrée</i></b>
  Mount point for wd0d (size=122976k)? (or 'none' or 'done') [/tmp] <b>done</b>
  No more disks to initialize.

  OpenBSD filesystems:
  wd0a /
  wd0d /tmp
  wd0e /var
  wd0g /usr
  wd0h /home

  The next step *DESTROYS* all existing data on these partitions!
  Are you really sure that you're ready to proceed? [no] <b>y</b>
  /dev/rwd0a:     307440 sectors in 305 cylinders of 16 tracks, 63 sectors
          150.1MB in 1 cyl groups (306 c/g, 150.61MB/g, 19328 i/g)
  /dev/rwd0d:     245952 sectors in 244 cylinders of 16 tracks, 63 sectors
          120.1MB in 1 cyl groups (244 c/g, 120.09MB/g, 15360 i/g)
  /dev/rwd0e:     164304 sectors in 163 cylinders of 16 tracks, 63 sectors
          80.2MB in 1 cyl groups (164 c/g, 80.72MB/g, 10368 i/g)
  /dev/rwd0g:     6291936 sectors in 6242 cylinders of 16 tracks, 63 sectors
          3072.2MB in 20 cyl groups (328 c/g, 161.44MB/g, 20608 i/g)
  /dev/rwd0h:     8388576 sectors in 8322 cylinders of 16 tracks, 63 sectors
          4096.0MB in 26 cyl groups (328 c/g, 161.44MB/g, 20608 i/g)
  /dev/wd0a on /mnt type ffs (rw, asynchronous, local, ctime=Thu Mar 30 00:03:14 2
  006)
  /dev/wd0h on /mnt/home type ffs (rw, asynchronous, local, nodev, nosuid, ctime=T
  hu Mar 30 20 00:03:14 2006)
  /dev/wd0d on /mnt/tmp type ffs (rw, asynchronous, local, nodev, nosuid, ctime=Th
  u Mar 30 00:03:15 2006)
  /dev/wd0g on /mnt/usr type ffs (rw, asynchronous, local, nodev, ctime=Thu Mar 20
   00:03:15 2006)
  /dev/wd0e on /mnt/var type ffs (rw, asynchronous, local, nodev, nosuid, ctime=Th
  u Mar 30 00:03:15 2006)

 </pre></td></tr></table>

<p>
Vous devez vous demander pourquoi la procédure d'installation vous
demande encore vos points de montage. Cela permet d'éviter des erreurs
ou des omissions sur les points de montage spécifiés pendant la création
du partitionnement. Par exemple, la procédure d'installation va
automatiquement supprimer les points de montage identiques que vous
avez entrés lors du partitionnement. Le programme "disklabel" vous
autorisera de telles erreurs, ces points de montage doivent donc être
vérifiés après l'exécution du programme "disklabel". Ceux qui sont en
doubles et qui ont été supprimés deviendront des partitions sans point
de montage, auxquelles vous devez assigner de nouveaux points de montage
si vous souhaitez utiliser l'espace.

<p>
Notez que la question "Are you really sure that you are ready to
proceed?" a pour réponse par défaut "no", vous devrez donc délibérément
lui indiquer de démarrer la procédure de formatage de vos partitions. Si
vous choisissez "no", vous serez simplement renvoyé vers une invite de
commande shell et pourrez relancer l'installation en tapant la commande
"install", ou en redémarrant simplement depuis votre média d'amorçage.  
<p>
Durant cette étape tous les systèmes de fichiers sont formatés. Cela
peut prendre un certain temps, en fonction de la taille des partitions
et de la vitesse du disque.

<a name="Hostname"></a>
<h3>4.5.3 - Configurer le nom d'hôte du système ("hostname")</h3>
<p>
Vous devez maintenant configurer le nom d'hôte du système ("hostname").

Cette valeur, avec le nom de domaine DNS (spécifié
<a href="#Network">ci-dessous</a>), sera sauvée dans le fichier
<tt>/etc/myname</tt>, qui est utilisé pendant le démarrage normal pour
configurer le nom d'hôte du système.
Si vous ne configurez pas le nom de domaine du système, la valeur par
défaut 'my.domain' sera utilisée.

<p>
Il est important de configurer ce nom maintenant, car il sera utilisé
lorsque les clés cryptographiques nécessaires au système seront générées
lors du premier démarrage suivant l'installation. Cette génération
intervient que le réseau soit configuré ou pas.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Enter system hostname (short form, e.g. 'foo'): <b>puffy</b>
</pre></td></tr></table>

<a name="Network"></a>
<h3>4.5.4 - Configurer le réseau</h3>

<p>
Maintenant il est temps de passer à la configuration de votre réseau.
Le réseau doit être configuré si vous voulez procéder à une installation
par FTP ou NFS car celle-ci sera basée sur les informations que vous aller entrer.
Voici un aperçu de la section de configuration réseau de la
procédure d'installation.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Configure the network? [yes] <b><i>Entrée</i></b>
  Available interfaces are: fxp0.
  Which one do you wish to initialize? (or 'done') [fxp0] <b><i>Entrée</i></b>
  Symbolic (host) name for fxp0? [puffy] <b><i>Entrée</i></b>
  The default media for fxp0 is
          media: Ethernet autoselect (100baseTX full-duplex)
  Do you want to change the default media? [no] <b><i>Entrée</i></b>
  IPv4 address for fxp0? (or 'dhcp') <b>199.185.137.55</b>
  Netmask? [255.255.255.0] <b><i>Entrée</i></b>
  IPv6 address for fxp0? (or 'rtsol' or 'none') [none] 
  No more interfaces to initialize.
  DNS domain name? (e.g. 'bar.com') [my.domain] <b>example.com</b>
  DNS nameserver? (IP address or 'none') [none] <b>199.185.137.1</b>
  Use the nameserver now? [yes] <b><i>Entrée</i></b>
  Default route? (IP address, 'dhcp' or 'none') <b>199.185.137.128</b>
  add net default: gateway 199.185.137.128
  Edit hosts with ed? [no] <b><i>Entrée</i></b>
  Do you want to do any manual network configuration? [no] <b><i>Entrée</i></b>
</pre></td></tr></table>

<p>
Dans l'exemple précédent nous utilisons une adresse IP statique. Comme
indiqué, il est possible d'utiliser le "<tt>dhcp</tt>" à la place sur la
plupart des architectures (sauf <a
href="../../fr/alpha.html">Alpha</a>), si votre environnement le
supporte. Dans le cas du DHCP, la plupart des informations seront
obtenues depuis le serveur distant DHCP ; vous aurez la possibilité de
les confirmer. Voici un exemple de configuration réseau, cette fois cela
est réalisé en utilisant DHCP :

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Configure the network? [yes] <b><i>Entrée</i></b>
  Available interfaces are: fxp0.
  Which one do you wish to initialize? (or 'done') [fxp0] <b><i>Entrée</i></b>
  Symbolic (host) name for fxp0? [puffy] <b><i>Entrée</i></b>
  The default media for fxp0 is
          media: Ethernet autoselect (100baseTX full-duplex)
  Do you want to change the default media? [no] <b><i>Entrée</i></b>
  IPv4 address for fxp0? (or 'dhcp') <b>dhcp</b>
  Issuing hostname-associated DHCP request for fxp0.
  Sending on   Socket/fallback/fallback-net
  DHCPDISCOVER on fxp0 to 255.255.255.255 port 67 interval 1
  DHCPOFFER from 199.185.137.128
  DHCPREQUEST on fxp0 to 255.255.255.255 port 67
  DHCPACK from 199.185.137.128 
  bound to 199.185.137.55 -- renewal in 43200 seconds.
  IPv6 address for fxp0? (or 'rtsol' or 'none') [none] <b><i>Entrée</i></b>
  Done - no available interfaces found.
  DNS domain name? (e.g. 'bar.com') [example.org] <b><i>Entrée</i></b>
  DNS nameserver? (IP address or 'none') [199.185.137.1] <b><i>Entrée</i></b>
  Use the nameserver now? [yes] <b><i>Entrée</i></b>
  Default route? (IP address, 'dhcp' or 'none') [dhcp] <b><i>Entrée</i></b>
  Edit hosts with ed? [no] <b><i>Entrée</i></b>
  Do you want to do any manual network configuration? [no] <b><i>Entrée</i></b>
</pre></td></tr></table>
<p>
<b>NOTE : </b><b>Une</b> seule interface peut être facilement
configurée en utilisant DHCP pendant l'installation. Si vous essayez
de configurer plus d'une interface en utilisant DHCP vous allez au devant
d'erreurs. Vous devrez configurer manuellement les autres interfaces après
l'installation.

<p>
Maintenant, configurez le mot de passe pour le compte root :
<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
Password for root account? (will not echo) <b><i>pAssWOrd</i></b>
Password for root account? (again) <b><i>pAssWOrd</i></b>
</pre></td></tr></table>
<p>
Utilisez un mot de passe sécurisé pour le compte root. Vous créerez
d'autres comptes utilisateurs après le démarrage du système.
Extrait de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=passwd&amp;sektion=1">passwd(1)</a>:
<pre>
    The new password should be at least six characters long and not purely
    alphabetic.  Its total length must be less than _PASSWORD_LEN (currently
    128 characters).  A mixture of both lower and uppercase letters, numbers,
    and meta-characters is encouraged.
</pre>

<a name="InstMedia"></a>
<h3>4.5.5 - Choisir le média d'installation</h3>

<p>
Une fois votre réseau configuré, le script d'installation vous
donne la possibilité de faire des ajustements manuels à la configuration.

<p>
Enfin, vous aurez la possibilité de choisir le média d'installation.
Les options sont listées ci-dessous.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Let's install the sets!
  Location of sets? (cd disk ftp http or 'done') [cd] <b><i>Entrée</i></b>
  Available CD-ROMs are: cd0.
</pre></td></tr></table>

<p>
Dans cet exemple nous installons depuis le CD-ROM. Une liste des
matériels sur notre machine identifiés comme lecteurs de CD-ROM nous
sera proposée. La plupart des gens n'en auront qu'un. Si vous en avez
besoin, soyez sûr d'indiquer le bon matériel que vous souhaitez utiliser
pour installer OpenBSD.

<p>
<b>REMARQUE : </b>Les options d'installation ne sont pas toutes
disponibles sur toutes les plates-formes. Dans le cas présenté, la
plate-forme OpenBSD/i386 ne supporte pas les installations via NFS c'est
pour cela que cette option n'est pas affichée dans la liste d'options
d'installation.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Available CD-ROMs are: cd0.
  Which one contains the install media? (or 'done') [cd0] <b><i>Entrée</i></b>
  Pathname to the sets?  (or 'done') [3.9/i386] <b><i>Entrée</i></b>
</pre></td></tr></table>

<p>
Ici, on vous demande dans quel dossier se trouvent les fichiers
d'installation, celui-ci est <tt>3.9/i386/</tt> sur les CD-ROM officiels.

<a name="Filesets"></a>
<h3>4.5.6 - Choisir les sets de fichiers</h3>

<p>
Il est maintenant temps de choisir quels sets de fichiers vous aller
installer.
Vous pouvez avoir une description de ces sets dans
<a href="#FilesNeeded">la section suivante</a>. Les fichiers que le 
programme d'installation détecte sont montrés à l'écran.
Votre travail consiste simplement à spécifier ceux que vous souhaitez
installer. Par défaut toutes les archives ne concernant pas X sont 
sélectionnées; certains utilisateurs expérimentés peuvent préférer se
limiter au strict minimum requis pour démarrer OpenBSD, qui devrait se
résumer à <tt>base39.tgz</tt>, <tt>etc39.tgz</tt> et <tt>bsd</tt>.
La plupart des utilisateurs voudront installer toutes les archives.
L'exemple suivant illustre une installation complète.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Select sets by entering a set name, a file name pattern or 'all'. De-select
  sets by prepending a '-' to the set name, file name pattern or 'all'. Selected
  sets are labeled '[x]'.

          [X] bsd
          [X] bsd.rd
          [ ] bsd.mp
          [X] base39.tgz
          [X] etc39.tgz
          [X] misc39.tgz
          [X] comp39.tgz
          [X] man39.tgz
          [X] game39.tgz
          [ ] xbase39.tgz
          [ ] xetc39.tgz
          [ ] xshare39.tgz
          [ ] xfont39.tgz
          [ ] xserv39.tgz
  Set name? (or 'done') [bsd.mp] <b>all</b>

          [X] bsd
          [X] bsd.rd
          [X] bsd.mp
          [X] base39.tgz
          [X] etc39.tgz
          [X] misc39.tgz
          [X] comp39.tgz
          [X] man39.tgz
          [X] game39.tgz
          [X] xbase39.tgz
          [X] xetc39.tgz
          [X] xshare39.tgz
          [X] xfont39.tgz
          [X] xserv39.tgz
</pre></td></tr></table>

<p>
Vous pouvez faire toutes sortes de combinaisons ici -- "<tt>-x*</tt>"
désélectionnera tous les composants X. Dans notre cas, nous allons
installer tous les paquetages. Bien que le système se lancera avec un
minimum de paquetages, la sélection par défaut ou une installation
complète sont recommandées.
De plus amples détails sur la sélection des paquetages sont disponibles
<a href="#FilesNeeded">ici</a>.

<p>
Une fois que vous avez choisi les paquetages que vous désirez, il vous
sera demandé si vous êtes d'accord pour décompresser puis
installer ces derniers. Une barre de progression sera affichée
pour vous informer du temps nécessaire. Les temps varient
énormément en fonction du système sur lequel vous installez OpenBSD,
les paquetages que vous avez sélectionnés et la vitesse du média source.
Cela va de quelques minutes à plusieurs heures.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Set name? (or 'done') [done] <b><i>Entrée</i></b>
  Ready to install sets? [yes] <b><i>Entrée</i></b>
  Getting bsd ...
  100% |**************************************************|  5332 KB    00:07    
  Getting bsd.rd ...
  100% |**************************************************|  4622 KB    00:03    
  Getting bsd.mp ...
  100% |**************************************************|  5374 KB    00:04    
  Getting base39.tgz ...
  100% |**************************************************| 39523 KB    00:32    
  Getting etc39.tgz ...
  100% |**************************************************|  1126 KB    00:01    
  Getting misc39.tgz ...
  100% |**************************************************|  2222 KB    00:02  
  Getting comp39.tgz ...
  100% |**************************************************| 73524 KB    01:03    
  Getting man39.tgz ...
  100% |**************************************************|  7258 KB    00:06    
  Getting game39.tgz ...
  100% |**************************************************|  2538 KB    00:02    
  Getting xbase39.tgz ...
  100% |**************************************************| 10313 KB    00:09    
  Getting xetc39.tgz ...
  100% |**************************************************| 90387       00:00    
  Getting xshare39.tgz ...
  100% |**************************************************|  2028 KB    00:02    
  Getting xfont39.tgz ...
  100% |**************************************************| 32457 KB    00:28    
  Getting xserv39.tgz ...
  100% |**************************************************| 19410 KB    00:26
  Location of sets? (cd disk ftp http or 'done') [done] <b><i>Entrée</i></b>
</pre></td></tr></table>

<p>
A ce point, vous pouvez spécifier des fichiers additionnels venant
d'autres sources (incluant <a href="#site">les paquetages personnalisés</a>)
si vous le souhaitez, ou taper '<tt>done</tt>' si vous avez installé
tous les paquetages dont vous avez besoin.

<a name="Finish"></a>
<h3>4.5.7 - Terminer l'installation</h3>

Ensuite, plusieurs questions vous seront posées concernant les paramètres
de votre système une fois installé.
La première est si
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&amp;sektion=8">sshd(8)</a>
doit être lancé au démarrage.
Dans la plupart des cas, vous souhaiterez que sshd(8) soit lancé, mais
dans de rares cas non. Si votre configuration n'a aucune nécessité de
sshd(8), il y a un petit avantage de sécurité théorique à ne pas le lancer.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
        Start sshd(8) by default? [yes] <b>y</b>
</pre></td></tr></table>

<p>
(Si vous changez d'avis plus tard, modifiez <a href="faq10.html"
><tt>/etc/rc.conf.local</tt></a> ou <tt>/etc/rc.conf</tt>.)

<p>
Vous avez à présent la possibilité de lancer
<a href="faq6.html#OpenNTPD">OpenNTPD</a> au boot.
OpenNTPD est un moyen peu coûteux permettant de garder une horloge
système synchronisée, et la configuration par défaut est suffisante dans
la plupart des cas.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
        Start ntpd(8) by default? [no] <b>y</b>
</pre></td></tr></table>

<p>
(Si vous changez d'avis plus tard, modifiez <a href="faq10.html"
><tt>/etc/rc.conf.local</tt></a> ou <tt>/etc/rc.conf</tt>.)

<p>
Sur certaines plates-formes, on vous demande maintenant si vous souhaitez
lancer X sur votre système. Si vous répondez 'Y',
<tt>/etc/sysctl.conf</tt> sera modifié pour inclure la ligne
<tt>machdep.allowaperture=1</tt> ou <tt>machdep.allowaperture=2</tt>, en
fonction de votre architecture. Sous certaines architectures cette
question ne sera pas posée du tout. Si vous ne comptez pas utiliser X
sur ce système ou si vous n'êtes pas sûr, répondez 'N' vu que vous
pouvez facilement changer la valeur ultérieurement en éditant
<tt>/etc/sysctl.conf</tt> au besoin. Il existe un avantage potentiel à
laissé le pilote d'aperture
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xf86&amp;sektion=4">xf86(4)</a>
désactivé car le moteur graphique d'une carte vidéo moderne pourrait
être utilisé pour altérer la mémoire, passant outre le contrôle du
processeur.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Do you expect to run the X Window System? [yes] <b>y</b>
</pre></td></tr></table>

<p>
Ensuite, on vous demande si vous souhaitez vous servir d'une
<a href="faq7.html#SerCons">console série</a>, plutôt que d'un clavier
et un écran standards, sur cet ordinateur.
Si vous choisissez "<tt>yes</tt>" et répondez à deux autres questions,
<tt><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot.conf&amp;sektion=8">/etc/boot.conf</a></tt>
et
<tt><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ttys&amp;sektion=5">/etc/ttys</a></tt>
seront édités de manière appropriée pour vous.
La plupart des utilisateurs choisiront la réponse par défaut, c'est à dire 
<b><tt>no</tt></b>.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Change the default console to com0? [no] <b><i>Entrée</i></b>
</pre></td></tr></table>

<p>
Votre dernière tâche est de paramétrer votre fuseau horaire ("timezone").
Selon l'endroit où votre machine réside, il peut y avoir plusieurs
réponses équivalentes à la question. Dans l'exemple suivant,
nous utilisons <tt>US/Eastern</tt>, mais l'on pourrait aussi utiliser
<tt>EST5EDT</tt> ou <tt>US/Michigan</tt> et obtenir le même résultat.
Appuyer sur <tt>?</tt> à l'invite vous aidera dans vos choix.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Saving configuration files......done.
  Generating initial host.random file ......done.
  What timezone are you in? ('?' for list) [Canada/Mountain] <b>?</b>
  Africa/      Chile/       GB-Eire      Israel       NZ-CHAT      UCT
  America/     Cuba         GMT          Jamaica      Navajo       US/
  Antarctica/  EET          GMT+0        Japan        PRC          UTC
  Arctic/      EST          GMT-0        Kwajalein    PST8PDT      Universal
  Asia/        EST5EDT      GMT0         Libya        Pacific/     W-SU
  Atlantic/    Egypt        Greenwich    MET          Poland       WET
  Australia/   Eire         HST          MST          Portugal     Zulu
  Brazil/      Etc/         Hongkong     MST7MDT      ROC          posix/
  CET          Europe/      Iceland      Mexico/      ROK          posixrules
  CST6CDT      Factory      Indian/      Mideast/     Singapore    right/
  Canada/      GB           Iran         NZ           Turkey       zone.tab
  What timezone are you in? ('?' for list) [Canada/Mountain] <b>US</b>
  What sub-timezone of 'US' are you in? ('?' for list) <b>?</b>
  Alaska          Central         Hawaii          Mountain        Samoa
  Aleutian        East-Indiana    Indiana-Starke  Pacific
  Arizona         Eastern         Michigan        Pacific-New
  Select a sub-timezone of 'US' ('?' for list): <b>Eastern</b>
  Setting local timezone to 'US/Eastern'...done.
</pre></td></tr></table>

<p>
Si vous êtes intéressé par un horodatage vraiment précis, vous devriez
lire <a href="faq8.html#NTPerror">ceci</a>.

<p>
Les dernières étapes sont pour le système de créer le répertoire <tt>/dev</tt>
(ce qui pourrait prendre un peu de temps sur certains systèmes, surtout
si vous avez peu de RAM), et d'installer les "boot blocks".

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Making all device nodes...done.
  Installing boot block...
  boot: /mnt/boot
  proto: /usr/mdec/biosboot
  device: /dev/rwd0c
  /usr/mdec/biosboot: entry point 0
  proto bootblock size 512
  /mnt/boot is 3 blocks x 16384 bytes
  fs block shift 2; part offset 3069360; inode block 152, offset 4136
  using MBR partition 1: type 166 (0xa6) offset 3069360 (0x2ed5b0)
  ...done.

  CONGRATULATIONS! Your OpenBSD install has been successfully completed!
  To boot the new system, enter halt at the command prompt. Once the
  system has halted, reset the machine and boot from the disk.
  # <b>halt</b>
  syncing disks... done

  The operating system has halted.
  Please press any key to reboot.
</pre></td></tr></table>

<p>
OpenBSD est maintenant installé sur votre système et prêt pour son
premier démarrage, mais avant cela...

<p>

<h4>Avant de redémarrer</h4>
A ce point, votre système est installé et prêt à être redémarré et
configuré pour votre service. Avant de faire cela, cependant, il serait
sage de consulter la <a href="../../fr/errata.html">page d'Errata</a> pour voir
s'il existe des bugs qui pourraient vous concerner.

<p>
Une astuce pouvant être utilisée pour une configuration "d'avant le premier
démarrage" consiste à lancer :
<pre>
    # <b>/mnt/usr/sbin/chroot /mnt</b>
</pre>
au prompt du shell.
Ceci règlera vos points de montage comme ils le seraient après un
redémarrage normal du système fraîchement installé.
Vous pouvez à présent réaliser des tâches de configuration basique du système,
comme l'ajout d'utilisateurs, le changement des points de montage, etc.

<h4>Après avoir redémarré</h4>

<p>
Une des premières choses que vous devrez lire après avoir installé votre
système est
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=afterboot&amp;sektion=8">afterboot(8)</a>.

<p>
Vous devriez aussi trouver ces différents liens utiles :
<ul>
<li><a href="faq10.html#AddDelUser">Ajouter des utilisateurs sur OpenBSD</a>
<li><a href="faq6.html#Setup">Configuration initiale du réseau</a>
<li><a href="faq2.html#ManPages">Page des manuels de commandes populaires/utiles</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi">Page de manuel OpenBSD sur le web</a>
<li><a href="../faq15.html">Le système de Ports et de Paquetages OpenBSD pour installer des logiciels</a>.
</ul>

<h4>Une dernière chose...</h4>
Les développeurs OpenBSD vous demandent de leur
<a href="#SendDmesg">Envoyer une copie de votre "dmesg"</a>. Celui-ci leur est
vraiment utile, et bénéficie au final, à tous les utilisateurs.

<p>
<a name= "FilesNeeded"></a>
<h2>4.6 - Quels sont les fichiers nécessaires à l'installation ?</h2>
<!-- XXXrelease -->

<p>
L'installation complète d'OpenBSD est divisée en plusieurs <i>paquetages
de fichiers</i> séparés. Toutes les utilisations ne requièrent pas
tous les paquetages. Voici une vue d'ensemble de chacun :
<p>
<ul>
  <li><b><i>bsd</i></b>          - Ceci est le noyau. <b>Requis</b>
  <li><b><i>bsd.mp</i></b>          - Noyau pour les systèmes multiprocesseurs
  (SMP) (seulement sur certaines plates-formes)
  <li><b><i>bsd.rd</i></b> - <a href="#bsd.rd">Kernel de disque RAM</a>
  <li><b><i>base39.tgz</i></b>   - Contient le système de base OpenBSD
    <b>Requis</b>
  <li><b><i>etc39.tgz</i></b>    - Contient tous les fichiers de /etc
    <b>Requis</b>
  <li><b><i>comp39.tgz</i></b>    - Contient le compilateur et ses
    outils, en-têtes et bibliothèques <b>Recommandé</b>
  <li><b><i>man39.tgz</i></b>    - Contient les pages de manuels <b>Recommandé</b>
  <li><b><i>misc39.tgz</i></b>   - Contient différentes informations et documentations
    de configuration
  <li><b><i>game39.tgz</i></b>   - Contient les jeux pour OpenBSD
  <li><b><i>xbase39.tgz</i></b>  - Contient les fichiers de base pour X11
  <li><b><i>xetc39.tgz</i></b>   - Contient les fichiers de configuration /etc/X11 et /etc/fonts
  <li><b><i>xfont39.tgz</i></b>  - Contient le serveur de fontes X11 et les fontes
  <li><b><i>xserv39.tgz</i></b>  - Contient les serveurs X de X11
  <li><b><i>xshare39.tgz</i></b> - Contient les pages de manuels, les options de localisations,
    les inclusions, etc. pour X
</ul>

Les paquetages <b>etc39.tgz</b> et <b>xetc39.tgz</b> ne sont pas installés lors
d'une mise à niveau mais uniquement lors d'une installation complète, de ce fait,
toute configuration que vous ferez sera conservée.
Vous devrez mettre à jour vos dossiers <tt>/etc</tt>, <tt>/dev</tt> et
<tt>/var</tt> manuellement.

<p>
Même si vous n'avez pas l'intention de faire tourner X, certains
<a href="../faq15.html">paquetages</a> nécessitent que les bibliothèques
graphiques présentes dans <b>xbase39.tgz</b> soient installées sur votre
système. Cette dépendance peut facilement être résolue en installant
<b>xbase39.tgz</b>, le reste de X n'étant pas nécessaire.


<p>
<a name="Partitioning"></a>
<a name= "SpaceNeeded"></a>  <!-- XXXobsolete tag -->
<h2>4.7 - De combien d'espace disque ai-je besoin pour une installation
        OpenBSD ?</h2>
<!-- XXXrelease -->

<p>
Evidemment, la réponse à cette question dépend de l'utilisation que vous
voulez faire du système.
Cependant, ces nombres peuvent être utilisés comme un point de
<i>départ</i> :

<blockquote><pre>
(root)             60MB
/usr               420MB (no X) ou 550MB (avec X)
/var               25MB
/tmp               50MB
swap               32MB
</pre></blockquote>

Ce sont les tailles de systèmes de fichiers pour une installation
complète. Ces nombres incluent un peu d'espace supplémentaire, et
correspondent à une installation typique d'une machine connectée à
Internet et à usage personnel.

<p>
Gardez les choses suivantes à l'esprit :
<ul>
<li>Ces valeurs sont les valeurs minimales. L'espace disque est
relativement bon marché aujourd'hui et essayer de réduire votre système
afin de le faire tenir sur le plus petit disque possible ne vaut
généralement pas la peine. Pour les applications spécifiques les valeurs
précédentes peuvent être rabaissées mais vous aurez besoin
d'expérimentation.
<li>Ces valeurs n'incluent PAS l'arbre des ports
<li>Si vous voulez installer un certain nombre de logiciels tiers,
faites-vous une grosse partition <tt>/usr</tt> ! Sa taille dépend des
applications que vous comptez installer.
<li>Pour un système qui devra garder un nombre de mails et de pages web
conséquent (enregistrés respectivement, dans <tt>/var/mail</tt> et
<tt>/var/www</tt>) vous aurez besoin d'une grande partition <tt>/var</tt>
, ou de les stocker dans des partitions différentes.
<li>Pour un système multi-utilisateurs qui pourrait générer beaucoup
de journaux, vous devrez avoir une partition <tt>/var</tt> de taille
confortable (<tt>/var/log</tt>).
<li>Si vous pensez reconstruire le <a href="faq5.html">noyau</a> ou le
système depuis les sources, vous devrez avoir une partition
<tt>/usr</tt> volumineuse. 4G est une taille correcte.
<li>La compilation de <a href="../faq15.html#Ports">ports</a> depuis les
sources pourrait nécessiter beaucoup d'espace sur les partitions
<tt>/usr</tt> et <tt>/tmp</tt>. C'est une des raisons pour lesquelles
nous conseillons d'utiliser des <a href="../faq15.html#PkgMgmt">paquetages
pré-compilés</a>.
<li>La partition <tt>/tmp</tt> est entre autres utilisée lors de la
compilation de ports, et la taille à lui donner dépend de l'utilisation
que vous voulez en faire.
50Mo devraient être suffisants pour la plupart des gens, mais quelques
grosses applications peuvent nécessiter 100Mo ou plus d'espace dans
<tt>/tmp</tt>.

<li>La partition 'b' que vous configurez
devient automatiquement votre partition swap système -- nous recommandons
un minimum de 32Mo mais si vous avez un peu de place disponible, réservez
au minimum 64Mo. Si vous avez beaucoup de place disponible, faite une
partition de 256Mo, ou même 512Mo.
D'un autre côté, si vous utilisez un périphérique de stockage flash,
vous souhaiterez probablement ne pas avoir de partition swap du tout.
Beaucoup de personnes suivent une vieille règle stipulant que la
partition de swap doit être d'une taille double à celle de la quantité
de RAM.
Cette règle n'a aucun sens.
Sur un système moderne, il y a beaucoup de swap, la plupart des gens ne
veulent pas que leur système swap.
Utilisez ce qui correspond à vos besoins.
<li>Les espaces swap et <tt>/var</tt> sont utilisés pour stocker les
"core dumps" du système lors d'un
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=crash&amp;sektion=8">crash(8)</a>.
Si cela entre en ligne de considération pour vous, votre zone de swap
devra être au moins égale à la taille de mémoire vive dont vous pourrez
disposer dans le système.
Lors du redémarrage,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=savecore&amp;sektion=8">savecore(8)</a>
essaiera de sauvegarder le contenu de la partition swap dans un fichier
stocké dans <tt>/var/crash</tt> donc une fois de plus, si cela est une
priorité pour vous, votre partition <tt>/var</tt> devra avoir suffisamment
d'<i>espace disponible</i> pour enregistrer ces fichiers de copie mémoire.
Soyez réaliste -- peu de développeurs voudront jeter un oeil à votre
fichier de dump de 1GB, et il est peu probable que le dump
serve à quiconque si vous ne prévoyez pas de le faire vous-même.
</ul>

<p>
Il y a plusieurs bonnes raisons pour utiliser des systèmes de fichiers
séparés plutôt que de n'en utiliser qu'un ou deux pour tout stocker :

<ul>
<li><b>Sécurité</b> : Vous pouvez marquer certains systèmes de fichiers
  d'un 'nosuid', 'nodev', 'noexec', 'readonly', etc. Cela est fait par
  la procédure d'installation, si vous utilisez les partitions décrites
  ci-dessus.
<li><b>Stabilité</b> : Un utilisateur, ou un programme se conduisant mal,
  peut remplir votre système de fichiers s'il a les droits d'écriture
  pour le faire. Vos programmes critiques, qui bien sûr sont lancés sur
  un système de fichier à part, ne seront pas interrompus.
<li><b>Vitesse</b> : Un système de fichiers sur lequel on écrit souvent
  peut devenir quelque peu fragmenté.
  (Par chance, le système de fichiers ffs utilisé par OpenBSD n'est pas
  enclin à être très fragmenté.)
<li><b>Intégrité</b> : Si un système de fichiers est corrompu pour
  quelque raison que ce soit, les autres restent en bon état.
<li><b>Taille</b> : Beaucoup de machines ont une limite sur la
  taille de la zone d'un disque d'où la ROM de démarrage peut charger le
  noyau. Dans certains cas, cette limite peut être vraiment basse (504Mo
  pour un ancien 486), dans d'autre cas, elle peut être plus grande (par
  exemple, 2Go, 8Go ou 128Go sur les systèmes i386). Comme le système
  peut être installé n'importe où sur la partition racine, la totalité
  de la partition racine devrait être comprise dans cette zone. Pour
  plus de détails, regardez <a href="faq14.html#LargeDrive">cette
  section</a>. Une bonne ligne de conduite peut être de conserver votre
  partition / inférieure à 2Go, dans le cas où vous ne savez pas si
  votre architecture (et votre machine) peuvent en supporter plus (ou
  moins).
</ul>

<p>
Quelques remarques sur le partitionnement :
<ul>
 <li>Pour votre première tentative sur un système d'expérimentation, une
   grosse partition <tt>/</tt> et une zone "swap" devraient être plus
   simples jusqu'à ce que vous sachiez combien de place vous est
   nécessaire.
   En faisant cela vous sacrifierez certaines fonctions de sécurité
   d'OpenBSD qui requièrent des systèmes de fichiers séparés pour
   <tt>/, /tmp, /var, /usr</tt> et <tt>/home</tt>.
   Cependant, vous ne devriez probablement pas mettre votre première
   installation OpenBSD en production.
 <li>Un système exposé à l'Internet ou à d'autres forces hostiles devrait
   avoir une partition <tt>/var</tt> séparée (et peut être même une
   partition <tt>/var/log</tt> séparée) pour la journalisation.
 <li>Une partition <tt>/home</tt> peut être intéressante. Nouvelle version
   de l'OS ? Supprimez et rechargez tout le reste, conservez votre
   partition <tt>/home</tt> intacte. Rappelez vous de garder une copie
   de vos fichiers de configuration tout de même.
 <li>Une partition séparée pour tout ce qui risque d'accumuler une grosse
   quantité de fichiers qui devront être supprimés peut être plus rapide
   à reformater puis re-créér que de supprimer les fichiers. Regardez la
   <a href="faq5.html#ProbObjPt">FAQ de la compilation du code source</a>
   pour un exemple (<tt>/usr/obj</tt>).
 <li>Si vous souhaitez reconstruire votre système depuis les sources pour
   quelque raison que ce soit, les sources seront dans <tt>/usr/src</tt>. Si vous
   ne faites pas une partition séparée pour <tt>/usr/src</tt>, soyez sûr
   que <tt>/usr</tt> est suffisamment grand.
 <li>Un fait souvent oublié : vous n'avez <b>pas</b> besoin d'allouer toute
   la place sur un disque quand vous configurez un système ! Etant donné
   qu'il est maintenant compliqué de trouver un disque dur plus petit que 20Go, il
   devient sensé de laisser une certaine portion du disque non allouée.
   Si vous dépassez la taille d'une partition, vous pouvez allouer une
   nouvelle partition dans l'espace non utilisé,
   <a href="faq10.html#DupFS">dupliquer</a> votre partition existante sur
   la nouvelle, changer
   <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fstab&amp;sektion=5">/etc/fstab</a>
   pour pointer vers votre nouvelle partition, la remonter, vous disposez maintenant
   de plus d'espace.
 <li>Si vous créez vos partitions avec une taille trop proche de la taille
   minimum requise, vous allez probablement le regretter plus tard lorsqu'il
   sera temps de mettre à jour votre système.
 <li>Si vous créez des partitions très larges, il est à signaler que la
   vérification des systèmes de fichiers à l'aide de 
   <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fsck&amp;sektion=8">fsck(8)</a>
   nécessite approximativement 1M de RAM par gigaoctet, et peut être
   très consommatrice en temps voire infaisable sur des systèmes anciens et
   lents (merci de consulter <a href="faq14.html#LargeDrive">cette section</a>.
 <li>Si vous autorisez les utilisateurs à écrire dans <tt>/var/www</tt> (ex., pages
   web personnelles), vous devriez le placer dans une partition séparée, vous pouvez
   par exemple utiliser les <a href="faq10.html#Quotas">quotas</a> pour restreindre
   la place qu'ils utiliseront, de manière à ce que s'ils remplissent la partition,
   les autres parties du système ne seront pas affectées.
</ul>

<p>
<a name= "Multibooting"></a>
<h2>4.8 - Multiboot OpenBSD/i386</h2>

Le "Multibooting" est le fait d'avoir plusieurs systèmes d'exploitation
sur le même ordinateur, et de pouvoir choisir depuis lequel vous
souhaitez démarrer.
Ce n'est <i>pas</i> une tâche triviale ! Si vous ne comprenez pas ce que
vous êtes en train de faire, vous finirez par perdre une somme
conséquente de données sur votre ordinateur. Les nouveaux utilisateurs OpenBSD
sont <i>vivement</i> encouragés a démarrer avec un disque dur vierge et sur une
machine dédiée, afin d'essayer la configuration désirée sur un
système qui n'est pas en production avant d'installer une configuration
"multiboot" sur une machine de production. <a href="faq14.html">La FAQ 14</a>
donne plus d'informations sur la procédure d'amorçage OpenBSD.

<p>
Voici plusieurs options pour le "multiboot" :

<h3>Configurer la partition active</h3>

C'est probablement la solution la plus négligée, et parfois la plus
intéressante pour le "multiboot".
Configurez simplement comme partition active, la partition d'OS depuis
laquelle vous souhaitez démarrer par défaut au prochain démarrage.
Chaque OS offre un programme pour faire ceci ; celui
d'OpenBSD est <a href="faq14.html#fdisk">fdisk(8)</a>, des programmes
portant des noms similaires sont disponibles sous Windows 9x et DOS,
et la plupart des autres systèmes d'exploitation. Ceci peut être très
utile pour les OS ou systèmes long à arrêter et redémarrer -- vous
pouvez le configurer et lancer la procédure de redémarrage,  ensuite
aller faire un tour, prendre une tasse de café, et revenir devant le
système démarré comme vous le souhaitiez -- pas d'attente du Moment
Magique pour choisir le système d'exploitation désiré.

<h3>Disquette d'amorçage</h3>
Si vous avez un système qui utilise OpenBSD peu fréquemment (ou que vous
ne voulez pas que les autres utilisateurs de l'ordinateur notent que quoi
que ce soit ai changé), vous pouvez utiliser une disquette d'amorçage.
Utilisez simplement l'une des <a href="#MkFlop">disquettes d'installation
standard d'OpenBSD</a>, et créez un fichier <tt>/etc/boot.conf</tt>
(oui, vous devrez aussi créer un dossier <tt>/etc</tt> sur la disquette)
ayant le contenu suivant :

<pre>
     boot hd0a:/bsd
</pre>

pour que le système démarre sur le disque dur 0, la partition OpenBSD
'a' et le fichier de noyau <tt>/bsd</tt>. Notez que vous pouvez aussi
démarrer d'autres disques avec une ligne comme :
"<tt>boot hd2a:/bsd</tt>" pour lancer le troisième disque dur de votre
système. Pour lancer OpenBSD, insérez la disquette dans le lecteur et
redémarrez. Pour lancer un autre système d'exploitation, éjectez la
disquette et redémarrez.

<p>
Dans ce cas, le programme
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot&amp;sektion=8&amp;arch=i386">boot(8)</a>
chargé depuis la disquette, cherche et lit
<tt>/etc/boot.conf</tt>. L'instruction "<tt>boot hd0a:/bsd</tt>" indique
à boot(8) depuis quel endroit charger le noyau -- dans ce cas, le premier
disque dur que le BIOS voit. Gardez à l'esprit que seulement un petit
fichier (<tt>/boot</tt>) est chargé depuis la disquette -- le système
charge le noyau entier depuis le disque dur, cela ne ralentit que de
quelques secondes la procédure de démarrage.

<h3>Windows NT/2000/XP NTLDR</h3>

Pour un "multiboot" entre OpenBSD et Windows NT/2000/XP, vous pouvez
utiliser NTLDR, le chargeur de démarrage que NT utilise. Pour "multi-booter"
avec NT, vous aurez besoin d'une copie de votre "Partition Boot Record" (PBR)
OpenBSD. Après avoir lancé "installboot" vous pouvez en obtenir une copie dans un
fichier en utilisant
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&amp;sektion=1">dd(1)</a>,
en suivant une procédure similaire à la procédure suivante :

<pre>
        # <strong>dd if=/dev/rsd0a of=openbsd.pbr bs=512 count=1</strong>
</pre>

Remarque : ceci est une excellente occasion pour vous rappeler que
saisir bêtement des commandes auxquelles vous ne comprenez rien est
vraiment une mauvaise idée. La commande ci-dessus ne fonctionnera pas
directement sur la plupart des machines. Au lecteur de l'adapter à son
équipement.

<p>
Maintenant démarrez sous NT et mettez <tt>openbsd.pbr</tt> dans C:. Ajoutez
une ligne comme celle-ci à la fin du fichier <tt>C:\BOOT.INI</tt> :

<pre>
        c:\openbsd.pbr="OpenBSD"
</pre>

<p>
Quand vous redémarrerez, vous devriez être en mesure de choisir OpenBSD
dans le menu de chargement NT. D'autres informations sur le NTLDR sont
disponibles dans le
<a href="http://www.tburke.net/info/ntldr/ntldr_hacking_guide.htm">"NTLDR
Hacking Guide"</a>.

<p>
Sur Windows XP vous pouvez aussi éditer les informations en utilisant la
"GUI" ; consultez le
<a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;289022">XP
Boot.ini HOWTO</a>.
 

<p>
Des programmes faisant la plupart de ce travail sont à votre disposition,
par exemple
<a href="http://www.winimage.com/bootpart.htm">BootPart</a>.
Ce programme peut être lancé depuis Windows NT/2000/XP, et ira chercher
le PBR OpenBSD, le mettra dans votre partition NT/2000/XP partition, et
le rajoutera dans <tt>C:\BOOT.INI</tt>.

<p>
Note : Le chargeur de démarrage Windows NT/2000/XP est seulement capable
de démarrer des systèmes depuis le premier disque dur.
Vous ne pouvez pas l'utiliser pour charger OpenBSD depuis le second
disque sur un système.

<p>
<h3>Autres chargeurs de démarrage</h3>

<p>
D'autres utilisateurs de chargeurs de démarrage OpenBSD ont inclus avec
succès
<a href="http://gag.sourceforge.net/">GAG</a>,
OS-BS,
<a href="http://www.ranish.com/part/">The Ranish Partition Manager</a>
et <a href="http://www.gnu.org/software/grub/">GRUB</a>.

<p>
<h3>OpenBSD et Linux (i386)</h3>
<!-- XXXversion -->

<p>
Veuillez vous référer au
<a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.9/i386/INSTALL.linux">INSTALL.linux</a>,
qui donne les instructions en profondeur pour faire fonctionner OpenBSD avec Linux.

<a name= "SendDmesg"></a>
<h2>4.9 - Envoyer votre dmesg à dmesg@openbsd.org après l'installation</h2>

<p>
Rappelez vous, il est important pour les développeurs OpenBSD de garder une
trace de quels matériels fonctionnent, et de quels matériels ne fonctionnent pas parfaitement.

<p>
Un commentaire de /usr/src/etc/root/root.mail
<pre>
If you wish to ensure that OpenBSD runs better on your machines, please do us
a favor (after you have your mail system configured!) and type something like:
 # dmesg | mail -s "Sony VAIO 505R laptop, apm works OK" dmesg@openbsd.org
so that we can see what kinds of configurations people are running.  As shown,
including a bit of information about your machine in the subject or the body
can help us even further.  We will use this information to improve device driver
support in future releases.  (Please do this using the supplied GENERIC kernel,
not for a custom compiled kernel, unless you're unable to boot the GENERIC
kernel).  The device driver information we get from this helps us fix existing
drivers. Thank you!
</pre>

<p>
Soyez sûr d'envoyer le mail depuis un compte sous lequel pour serez habilité
à recevoir pour que les développeurs puissent vous contacter s'il ont quelque
chose qu'il voudraient que vous testiez ou changiez afin que votre
configuration fonctionne. Il n'est pas important d'envoyer le mail depuis
la même machine que celle sur laquelle tourne OpenBSD, donc si cette
dernière n'est pas en mesure de recevoir des mails, faites simplement :

<pre>
$ dmesg | mail your-account@yourmail.dom
</pre>
et transférez le message à
<pre>
 dmesg@openbsd.org
</pre>
Où <tt>your-account@yourmail.dom</tt> est votre compte de messagerie
régulier.
(ou transférez votre sortie dmesg en utilisant
FTP/scp/disquette/pigeon-porteur/...)

<p>
<strong>NOTE</strong> - N'envoyez que des dmesg concernant les noyaux
GENERIC. Les noyaux personnalisés qui ont des drivers de matériels en moins
ne sont pas utiles.

<p>
Notez aussi que les dmesgs sont reçus sur un ordinateur utilisant le
système de filtrage de spam
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=spamd&amp;sektion=8">spamd</a>.
Cela peut causer le rejet temporaire de votre dmesg par les serveurs de mails.
Soyez patient, après une demi-heure voire une heure, il sera reçu.

<a name="AddFileSet"></a>
<h2>4.10 - Ajouter un paquetage après l'installation</h2>
<!-- XXXversion -->
"Oh non ! J'ai oublié de rajouter un paquetage quand j'ai fait l'installation !"
<p>
Parfois, vous réalisez que vous AURIEZ vraiment eu besoin de
<tt>comp39.tgz</tt> (ou de n'importe quel composant système) après tout,
mais vous ne l'avez pas réalisé quand vous avez installé votre système.
Bonne nouvelle : Il y a deux voies relativement simples pour rajouter un
paquetage après l'installation initiale :

<h3>En utilisant la procédure de mise à jour</h3>
Démarrez simplement votre média d'installation (CD-ROM ou disquette), et
choisissez "Upgrade" (plutôt que "Install"). Quand vous aurez la liste
des paquetages, sélectionnez simplement celui que vous avez oublié
d'installer la première fois, choisissez la source, et laissez-le
l'installer pour vous.

<h3>En utilisant tar(1)</h3>
Les paquetages d'installation sont de simples fichiers compressés tar, et
vous pouvez les décompresser vous même manuellement depuis la racine
du système de fichiers.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  # cd /
  # tar xzvpf comp39.tgz
</pre></td></tr></table>

<p>
N'oubliez PAS l'option <tt>'p'</tt> ci-dessus qui restaurera correctement
les permissions sur les fichiers !
<p>
Une méprise courante est de croire qu'il est possible d'utiliser
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_add&amp;sektion=1">pkg_add(1)</a>
pour rajouter des sets d'installation manquants. Cela ne fonctionne pas.
pkg_add(1) est l'<a href="../faq15.html#PkgMgmt">outil de gestion des
paquetages</a> pour installer des applications tierces.
Cet outil prend en compte les fichiers paquetages et non des archives tar
génériques telles que les ensembles d'installation.

<a name="bsd.rd"></a>
<h2>4.11 - Qu'est ce que 'bsd.rd' ?</h2>

<b><tt>bsd.rd</tt></b> est un noyau "RAM Disk". Ce fichier peut
être vraiment intéressant ; beaucoup de développeurs prudents
en conservent un tout le temps à la racine de leur système.

<p>
Le noyau "RAM Disk" définit la racine du système de fichiers
du noyau -- plutôt qu'être stockés sur un disque physique, les utilitaires
disponibles après l'amorçage de <tt>bsd.rd</tt> sont enregistrés
dans le kernel, et lancés depuis un système de fichiers basé en
mémoire RAM.
<tt>bsd.rd</tt> comporte aussi une floppée d'utilitaires 
vous permettant de faire de la maintenance système et de lancer une
installation.
<p>
Sur certaines architectures, <tt>bsd.rd</tt> est actuellement la
méthode d'installation privilégiée -- vous placez ce noyau sur un
système de fichiers, vous le démarrez, et lancez l'installation
depuis ce dernier. Sur la plupart des architectures, si vous
utilisez une ancienne version d'OpenBSD, vous pouvez obtenir
une nouvelle version de <tt>bsd.rd</tt>  par FTP, redémarrer
à partir de lui, et installer la nouvelle version d'OpenBSD
sans avoir besoin de quelque média amovible que ce soit.

<p>
Voici un exemple d'amorçage de <tt>bsd.rd</tt> sur un système
i386 :

<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Using Drive: 0 Partition: 3
  reading boot.....
  probing: pc0 com0 com1 apm mem[639k 255M a20=on]
  disk: fd0 hd0+
  &gt;&gt; OpenBSD/i386 BOOT 2.10
  boot&gt; <b>boot hd0a:/bsd.rd</b>
<i>. . . normal boot to install . . .</i>
</pre></td></tr></table>

Comme indiqué, vous allez être amené au programme d'installation,
mais vous pouvez aussi aller à une invite de shell pour faire de
la maintenance sur votre système.
<p>
La règle générale en lançant <tt>bsd.rd</tt> est de changer votre
noyau d'amorçage de <tt>/bsd</tt> à <tt>bsd.rd</tt> quelle que soit
la méthode pour votre architecture.


<a name="InstProb"></a>
<h2>4.12 - Problèmes d'installation courants</h2>

<a name="cpq16m"></a>
<h3>4.12.1 - Mon Compaq ne reconnaît que 16Mo de RAM</h3>
<i>Certains</i> systèmes Compaq rencontrent un problème où la mémoire
RAM n'est pas complètement détectée par le
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot&amp;sektion=8&amp;arch=i386">Chargeur d'amorçage de second niveau OpenBSD</a>
et seulement 16Mo seront détectés et utilisés par OpenBSD.
Ceci peut être corrigé en créant/éditant le fichier
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot.conf&amp;sektion=8&amp;arch=i386"><tt>/etc/boot.conf</tt></a>,
ou en entrant des commandes à l'invite "<tt>boot></tt>" avant
qu'OpenBSD ne se charge. Si vous avez une machine avec 64Mo
de RAM, mais qu'OpenBSD n'en a détecté que 16Mo, la commande
devrait être :

<pre>
     machine mem +0x3000000@0x1000000
</pre>

pour ajouter 48Mo (<tt>0x3000000</tt>) après les premiers 16Mo
(<tt>0x1000000</tt>). Typiquement, si vous avez une machine avec
ce problème, vous devriez entrer la commande précédente d'abord
dans l'invite <tt>boot></tt> du CD-ROM ou de la Disquette, charger
la disquette, redémarrer et créer un fichier <tt>/etc/boot.conf</tt>
avec la ligne précédente pour que dans les démarrages suivants
OpenBSD reconnaisse toute la mémoire disponible.

<p>
Une mise à jour ROM règlera ce problème sur
<i>certains</i> systèmes.

<a name="noboot"></a>
<h3>4.12.2 - Mon i386 ne démarre pas après l'installation</h3>
Votre installation a eu l'air de bien se dérouler, mais lors
de votre premier démarrage, vous ne voyez aucun signe montrant
qu'OpenBSD essaye de démarrer. Plusieurs problèmes courants
peuvent expliquer ce phénomène :

<ul>
<li><b>Aucune partition n'a été définie active dans fdisk(8).</b>
Pour corriger cela, relancez la machine en utilisant une disquette
de démarrage ou tout autre média, et marquez une partition comme active.
Regardez
<a href="faq14.html#fdisk">ici</a> et
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&amp;sektion=8&amp;arch=i386">ici</a>.

<li><b>Aucun chargeur de démarrage valide n'a été installé sur le disque.</b>
Si vous avez répondu "Y" à la question "Use entire disk for OpenBSD?" pendant
l'installation, ou utilisé l'option "<tt>reinit</tt>"
de fdisk(8), l'amorce OpenBSD a été installée sur le "Master Boot Record"
du disque ; autrement, le programme d'amorce est conservé intact.
Ce sera un problème si aucun autre programme d'amorce n'existe.
Une solution est de démarrer le média d'installation une nouvelle fois,
basculer dans le shell et invoquer la commande
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&amp;sektion=8&amp;arch=i386">fdisk(8)</a> pour mettre à jour le MBR depuis la ligne de commande :
<pre>
  # fdisk -u wd0
</pre>
Note : l'option "update" du mode ("-e") interactif de fdisk n'écrira pas les
bits de signature requis pour rendre le disque amorçable.

<li><b>Dans quelques rares cas, quelque chose s'est mal déroulé dans
l'installation du chargeur de démarrage de stage 2.</b> La
réinstallation du chargeur de démarrage de stage 2
est vue <a href="faq14.html#InstBoot">ici</a>.

</ul>

<a name="sshhang"></a>
<h3>4.12.3 - Ma (vieille et lente) machine a démarré, mais bloque pendant
la procédure ssh-keygen</h3>
Il semble que votre machine fonctionne correctement, mais prend juste
beaucoup de temps pendant la procédure de génération de clés ssh.
Une SPARCStation2 ou un Macintosh Quadra peut prendre <i>plusieurs
heures</i> ou plus pour terminer les trois étapes
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-keygen&amp;sektion=1">ssh-keygen(1)</a>,
Laissez le simplement terminer ; cela n'est réalisé qu'une fois par
installation.

<p>
La taille de la clé par défaut a été augmentée pour OpenBSD 3.8, en
conséquence de quoi les temps de génération de clés sont beaucoup plus
élevés que ce qu'ils furent.
Les utilisateurs possédant des machines très lentes souhaiteront
peut-être générer leurs clés sur une autre machine, les placer dans
l'archive <a href="#site">site39.tgz</a>, et les installer avec le reste
des "file sets".


<a name="noftplist"></a>
<h3>4.12.4 - J'ai le message "Failed to change directory" pendant
     l'installation</h3>

Quand vous faites l'installation d'un
<a href="faq5.html#Flavors">snapshot</a> durant la
phase <i>-beta</i> du cycle de développement OpenBSD, vous devriez voir
ceci :

<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>

  Do you want to see a list of potential FTP servers?  [yes] <b><i>Entrée</i></b>
  Getting the list from 192.128.5.191 (ftp.openbsd.org)... FAILED
  Failed to change directory.
  Server IP address or hostname? 
</pre></td></tr></table>

Cela est normal et souhaité pendant la version précédant la sortie officielle
dans le cycle. Le programme d'installation cherche la liste FTP sur le
premier serveur FTP dans un dossier qui ne sera pas disponible avant
<a href="faq1.html#Next">la date de "release"</a>, vous obtiendrez
donc les messages précédents.

<p>
Utilisez simplement la
<a href="../../ftp.html">liste de miroirs FTP</a> pour trouver votre
site miroir FTP favori, et entrez manuellement son nom lorsque
cela vous est demandé.

<p>
<b>Note : Vous ne devriez pas voir cela si vous installez une version
<i>"-release"</i> ou depuis un CD-ROM.</b>

<a name="blankfdisk"></a>
<h3>4.12.5 - Ma table de partition fdisk est corrompue ou vide !</h3>
Occasionnellement, un utilisateur trouvera un système fonctionnant, mais
en faisant un <tt>fdisk wd0</tt>, il trouvera une table de partitions
vide (ou polluée).
Cela est usuellement du à la création d'une partition dans
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&amp;sektion=8&amp;arch=i386">fdisk(8)</a>
ayant un offset de zero secteurs, au lieu de <a href="#trackoffset">l'offset
d'une piste</a> qu'elle est sensée avoir.
(note : cela ne concerne que les plates-formes
<a href="../../fr/i386.html">i386</a> et <a
href="../../fr/amd64.html">amd64</a>.
Les autres plates-formes requièrent des offsets différents, certaines n'en
requièrent pas).
Le système <a href="faq14.html#Boot386">démarre</a> ensuite en utilisant
le PBR, pas le MBR.

<p>
Bien que cette configuration peut fonctionner, cela peut causer des
problèmes de maintenance et devrait être corrigé. Pour corriger ce
problème, le système de fichiers doit généralement être recréé depuis
le début (si vous savez VRAIMENT ce que vous faites, vous devriez être
en mesure de recréer juste le disklabel et le MBR et ne perdre que la
première partition OpenBSD du disque).

<a name="site"></a>
<h2>4.13 - Personnaliser la procédure d'installation</h2>
<!-- XXXversion -->

<h3>Fichier <tt>siteXX.tgz</tt></h3>
Les scripts d'installation/mise à jour d'OpenBSD autorisent la création
d'un set utilisateur nommé "<tt>siteXX.tgz</tt>", où XX représente la
version (ex. 39). Le fichier <tt>siteXX.tgz</tt> est, comme les autres
<a href="#FilesNeeded">paquetages</a>, une compression
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gzip&amp;sektion=1">gzip(1)</a>
d'archive
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tar&amp;sektion=1">tar(1)</a>
dont la racine est '/' et est décompressé comme les autres avec les
options <tt>xzpf</tt>. Ce paquetage sera installé en dernier, après tous
les autres paquetages.

<p>
Ce paquetage vous permet d'ajouter et/ou écraser des fichiers installés
dans les paquetages 'normaux' et donc de personnaliser l'installation ou
la mise à jour.

<p>
Quelques exemples d'utilisation de fichier <tt>siteXX.tgz</tt> :
<ul>
<li>Créer un fichier siteXX.tgz qui contient tous les changements
que vous avez fait depuis la première installation de OpenBSD. Ensuite,
si vous avez à récréer le système, sélectionnez simplement siteXX.tgz
pendant la procédure de réinstallation et toutes les modifications que
vous avez faites seront répliquées sur le nouveau système.

<li>Créer une série de dossiers spécifiques machine qui
contiennent chacun un fichier siteXX.tgz dans lequel se trouvent les
fichiers spécifiques à la machine.
L'installation de machines (ex. machines avec des cartes graphiques
différentes) d'une catégorie particulière peut être faite en choisissant
le fichier siteXX.tgz approprié.

<li>Mettez les fichiers que vous paramétrez constamment dans un fichier
siteXX.tgz similaire -- fichiers
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&amp;sektion=8"
><tt>/etc/skel</tt></a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5"
><tt>/etc/pf.conf</tt></a>, 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&amp;sektion=8"
><tt>/var/www/conf/httpd.conf</tt></a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf.local&amp;sektion=8"
><tt>/etc/rc.conf.local</tt></a>,
etc.
</ul>

<h3>Scripts <tt>install.site</tt>/<tt>upgrade.site</tt>.</h3>
A la dernière étape de la procédure d'installation/mise à jour, le
script cherche dans la racine un <tt>install.site</tt> ou un
<tt>upgrade.site</tt> d'un nouveau système ou d'une nouvelle mise à
jour, selon la procédure en cours, et lance le script dans un
environnement
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chroot&amp;sektion=8">chroot</a>é
de la racine système de l'installation/de la mise à jour.
Rappelez-vous, la mise à jour est faite depuis un système de fichiers
démarré donc votre système de fichiers cible est actuellement monté dans
<tt>/mnt</tt>.
Cependant, votre script peut être écrit tel quel à cause du chroot,
comme s'il était écrit dans la racine normale de votre système de
fichiers. Comme ce script est lancé après que tous les fichiers aient
été installés, vous avez un système totalement fonctionnel (bien que
lancé en mode mono-utilisateur) quand votre script est invoqué.

<p>
Notez que le script <tt>install.site</tt> devra être placé dans un
fichier <tt>siteXX.tgz</tt>, tandis que le script <tt>upgrade.site</tt>
pourra être placé à la racine du système de fichiers avant la mise à jour
ou bien être placé lui aussi dans fichier <tt>siteXX.tgz</tt>.

<p>
Ce script peut être utilisé pour faire de nombreuses choses.
<ul>
<li> Supprimer des fichiers qui sont installés/mis à jour et que vous ne
souhaitez pas présents dans votre système.
<li> Supprimer/mettre à jour/installer les
<a href="../faq15.html#PkgMgmt">paquetages</a> que vous souhaitez sur le système
installé.
<li> Faire une <a href="faq14.html#Backup">sauvegarde/archive immédiate</a>
de votre nouveau système avant de l'exposer au reste du monde.
<li>Utilisez
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rdate&amp;sektion=8">rdate(8)</a>
pour paramètrer l'horloge du système.
</ul>

<p>
La combinaison de <tt>siteXX.tgz</tt> et de
<tt>install.site/upgrade.site</tt> a pour but de donner de larges
capacités de personnalisation sans avoir à créer ses propres paquetages
d'installation.

<a name="Multiple"></a>
<h2>4.14 - Comment puis-je installer plusieurs systèmes identiques ?</h2>
Voici quelques utilitaires que vous pouvez utiliser lorsque vous avez
plusieurs systèmes OpenBSD identiques à déployer.

<h3>Les fichiers <tt>siteXX.tgz</tt> et <tt>install/upgrade.site</tt></h3>
Voir l'article <a href="#site">précédent</a>.

<h3>Restauration depuis dump(8)</h3>
Sur la plupart des architectures, le média de démarrage inclut le programme
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=restore&amp;sektion=8">restore(8)</a>
qui peut être utilisé pour restaurer une sauvegarde faite par
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dump&amp;sektion=8">dump(8)</a>.
Ainsi, vous pouvez démarrer depuis
<a href="#MkFlop">disquettes</a>,
<a href="../../orders.html">CD</a>, ou
fichier <a href="#bsd.rd">bsd.rd</a>, ensuite
<a href="faq14.html#fdisk">fdisk</a>,
<a href="faq14.html#disklabel">disklabel</a>, et
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=restore&amp;sektion=8">restore</a>
pour restaurer la configuration désirée depuis une bande ou autre média, et installer les
<a href="faq14.html#InstBoot">blocs de d'amorce</a>. Plus de détails
<a href="faq14.html#Backup">ici</a>.

<h3>Image de disque</h3>
Malheureusement, il n'existe pas de paquetage d'image de disque reconnaissant
le FFS, et qui pourrait faire une image contenant simplement l'espace de
disque utilisé. La plupart des solutions d'image de disque traiteront
la partition OpenBSD comme une partition "générique", et pourront
simplement faire l'image de l'intégralité du disque. Cela rejoint
souvent notre but, mais souvent avec d'énormes quantités d'espace
perdu -- une partition <tt>/home</tt> de 10Go vide demandera 10Go
d'espace dans l'image, même s'il n'y a aucun fichier à l'intérieur.
Tandis que vous pouvez typiquement installer une image de disque sur un
disque plus grand, vous ne pourrez pas l'installer sur un disque de plus
petite taille.

<p>
Si cela est pour vous acceptable, vous devriez trouver dans la
commande
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&amp;sektion=1">dd</a>
tout ce dont vous avez besoin, autorisant la copie d'un disque vers un
autre, secteur-par-secteur. Celui-ci vous fournira souvent les mêmes fonctionnalités que
les programmes commerciaux, sans le prix.

<a name="getdmesg"></a>
<h2>4.15 - Comment puis-je obtenir un dmesg(8) pour rapporter un
  problème d'installation ?</h2>
Lorsque vous <a href="../../report.html">rapportez un problème</a>, il est
important d'inclure le
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dmesg&amp;sektion=8">dmesg(8)</a>
complet du système.
Souvent cependant, vous en avez besoin parce que le système ne fonctionne pas
correctement ou ne s'installe pas, donc vous n'aurez pas de disque, pas de réseau
ou manquerez d'une autre ressource vous permettant d'envoyer votre dmesg à la 
<a href="../../fr/mail.html">mailing liste</a> appropriée.
Il y a d'autres façons de faire cela, cependant :

<ul>
<li><b>Disquette :</b> Les disques d'amorçage et les CD-ROM ont assez d'outils
pour permettre d'enregistrer votre dmesg sur une disquette MSDOS afin de
le lire sur une autre machine. Mettez une disquette MSDOS formatée dans
votre lecteur de disquette et tapez les commandes suivantes :

<pre>
     mount -t msdos /dev/fd0a /mnt
     dmesg >/mnt/dmesg.txt
     umount /mnt
</pre>
Si vous avez un autre système OpenBSD, vous pouvez aussi écrire sur une
disquette compatible OpenBSD -- souvent, la disquette d'amorce a encore
assez d'espace libre pour contenir le dmesg. Dans ce cas, retirez le
"<tt>-t msdos</tt>" ci-dessus.

<p>
<li><b>Console série :</b>
Utiliser une console série et capturer la sortie sur un autre ordinateur
est souvent la meilleure solution pour obtenir des informations de
diagnostic - particulièrement si l'ordinateur "panic" immédiatement
après le démarrage.
Aussi bien qu'un second ordinateur, vous aurez besoin d'un câble série
(souvent un câble null-modem), et d'un émulateur de terminal pouvant
capturer la sortie de l'écran dans un fichier.

<p>
Des informations sur la configuration d'une console série sont données
<a href="faq7.html#SerCon">ailleurs dans la FAQ</a>; dans le but de
capturer le log de l'installation, les commandes suivantes sont souvent
suffisantes.

<p><b>i386</b>

<p>
A l'invite de démarrage tapez :
<p>
<blockquote>
<pre>
boot> <b>set tty com0</b>
</pre>
</blockquote>

<p>
Cela indiquera à OpenBSD d'utiliser le premier port série (souvent
appelé COM1 ou COMA dans la documentation du PC) en tant que console série.
La bande passante par défaut est 9600 bauds.

<p><b>Sparc/Sparc64</b>

<p>
Ces machines utiliseront automatiquement une console série si elles sont
lancées sans clavier.
Si vous avez un clavier et un écran attachés, vous pouvez toujours
forcer le système à utiliser une console série avec l'invocation
suivante à l'invite <tt>ok</tt>.

<p>
<blockquote>
<pre>
ok <b>setenv input-device ttya</b>
ok <b>setenv out-device ttya</b>
ok <b>reset</b>
</pre>
</blockquote>

<p>
<li><b>FTP :</b> Dans certaines circonstances, et sous réserve de
paramétrage correct de votre réseau, vous aurez la possibilité d'utiliser
le client
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp&amp;sektion=1">ftp(1)</a>
sur le disque d'amorce ou le CD-ROM pour envoyer le dmesg sur un serveur
FTP local, où vous pourrez le récupérer ensuite.
</ul>

<p>

<font color= "#0000e0">
<a href= "index.html">[Retour à l'Index principal]</a>
<a href= "faq3.html">[Section 3 - Obtenir OpenBSD]</a>
<a href= "faq5.html">[Section 5 - Construire le Système à partir des Sources]</a>
</font>

<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../../images/back.gif" border= "0" alt= "[back]"></a> 
<a href= "mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: faq4.html,v 1.228 ]<br>
$Translation: faq4.html,v 1.67 2006/10/13 16:08:14 saad Exp $<br>
-->
$OpenBSD: faq4.html,v 1.54 2006/10/13 19:33:48 saad Exp $
</small>
</body>
</html>

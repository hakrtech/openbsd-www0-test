<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Suivre la version de développement "-current"</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 2006 by OpenBSD">
</head>

<body bgcolor= "#ffffff" text= "#000000">
<a href="../../fr/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif" border="0">    
</a>
<p>
<font color= "#0000e0">
<a href= "index.html">[Index de la FAQ]</a>
</font>

<p>

<h1><font color="#e00000">Suivre la version de développement "<i>-current</i>"</font></h1>
<hr>

<h3>Table des matières</h3>
<p>
<ul>
<li><a href="#Intro">Introduction</a>
<!-- Les entrées les plus vieilles en haut... -->
<li><a href="#20050927">2005/09/27 - De nouvelles fonctionnalités de xargs sont
nécessaires à la compilation du système</a>
<li><a href="#20051006">2005/10/06 - Changements apportés à MAKEDEV(8) et ksh(1)</a>
<li><a href="#20051116">2005/11/16 - Nouvelle version de ftp-proxy(8)</a>
<li><a href="#20051216">2005/12/16 - Suppression de libresolv</a>
<li><a href="#20060104">2006/01/04 - mac68k passe à wscons(4)</a>
<!-- Les nouvelles additions se mettent en bas, merci -->
</ul>
    
<hr>

<a name="Intro"></a>
<XXXversion>
<h2>Introduction</h2>
Ce document est pour les personnes souhaitant suivre la version de
développement d'OpenBSD; celle-ci sera nommée <i>-current</i> dans la
suite de ce texte. Il contient des informations sur les changements
apportés entre la version 3.8-release et <i>-current</i>, et ne devrait
PAS être utilisé par quiconque voulant faire une mise à jour à partir
des versions 3.7 ou précédantes ou même par les personnes souhaitant
suivre <a href="../../fr/stable.html"><i>-stable</i></a>.

<p>
Si vous voulez passer vers la version 3.8-release ou bien vers sa
branche stable à partir de versions antérieures, consulter le
<a href="upgrade38.html">guide de mise à niveau</a>.

<p>
Soyez certain d'avoir lu et compris la
<a href="faq5.html">FAQ 5 - Construire le Système à partir des Sources</a>
avant d'utiliser -current et les instructions qui suivent.

<p>
Vous devriez TOUJOURS partir d'un "snapshot" pour suivre
<i>-current</i>. Une mise à jour via la compilation des sources n'est
pas supportée.
   
<p>
Si vous souhaitez avoir des informations pour mettre à jour en partant de
versions plus anciennes, consultez le document
<a href="../upgrade-old.html">upgrade-old.html</a>.
Celui-çi est fourni en tant que document historique -- il ne DOIT PAS
servir de procédure de mise à jour.

<p>
<a name="20050927"></a>
<h3>2005/09/27 - De nouvelles fonctionnalités de xargs sont nécessaires
à la compilation du système</h3>

Compilez puis installez xargs(1)
<pre>
     # cd /usr/src/usr.bin/xargs && make obj && make && make install
</pre>
Avant de passer à la compilation du système (make build).

<p>
<a name="20051006"></a>
<h3>2005/10/06 - Changements apportés à MAKEDEV(8) et ksh(1)</h3>

Des modifications ont été apportées à MAKEDEV(8) pour augmenter significativement
sa vitesse d'exécution.
Ces modifications dépendent d'autres changements précédemment apportés à ksh(1). 
Ainsi donc, les médias d'installation antérieurs à cette date ne peuvent pas
servir.
<br>

<p>
<a name="20051116"></a>
<h3>2005/11/16 - Nouvelle version de ftp-proxy(8)</h3>

ftp-proxy a été remplacé par ce qui était précédemment appelé pftpx.
Le nouveau ftp-proxy tourne seul et non plus via inetd.conf comme
auparvant.
<p>
Les instructions de mise à jour suivent:
<p>
Arréter l'ancien ftp-proxy en installant un nouveau /etc/inetd.conf ou bien en
commentant manuellement son entrée dans /etc/inetd.conf.

<pre>
cp /usr/src/etc/inetd.conf /etc/inetd.conf
</pre>

Puis lancé via kill un signal HUP à inetd:
<p>
<pre>
kill -HUP `cat /var/run/inetd.pid`
</pre>

Démarré le nouveau ftp-proxy en installant un
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc&amp;sektion=8"><i>/etc/rc</i></a>
neuf ainsi qu'un
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf&amp;sektion=8"><i>/etc/rc.conf</i></a>
et positionné ftpproxy_flags="" dans /etc/rc.conf.local.

<pre>
cp /usr/src/etc/{rc,rc.conf} /etc
echo 'ftpproxy_flags=""' >> /etc/rc.conf.local
</pre>

Sinon, il peut simplement être démarré en exécutant
/usr/sbin/ftp-proxy from /etc/rc.local
<p>

Le nouveau proxy se sert <a href="pf/anchors.html"><i>d'ancres</i></a> pour
autoriser des connections ce qui signifie que
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5"><i>/etc/pf.conf</i></a>
doit être adapté. Dans la section NAT vous devez mettre:
<p>

<pre>
nat-anchor "ftp-proxy/*"
rdr-anchor "ftp-proxy/*"
</pre>

Ces lignes sont obligatoires, même si vous ne vous servez pas du NAT.
La règle suivante, qui est probablement déja présente pour l'ancien ftp-proxy,
doit rester:
<pre>
rdr pass on $int_if proto tcp from $lan to any port 21 -> \
    127.0.0.1 port 8021
</pre>

Dans la section des règles de filtrage, la ligne suivante est nécessaire:

<pre>
anchor "ftp-proxy/*"
</pre>

Les règles qui permettent au proxy de créer des connections de controle FTP
(port destination 21/tcp) doivent rester.
Les règles qui autorisent des connections de données FTP ne sont plus utiles.
Ces règles peuvent contenir "user proxy" ou bien "to port > 49151".

Des précautions ont été prises pour garder des options de ligne de commande
similaires, mais certaines peuvent diffèrer.
Consulter la page de manuel de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp-proxy&amp;sektion=8">ftp-proxy</a>
.
<p>

Un cas mérite une mention spéciale: si vous avez des clients anciens se servant
de connections de données en mode actif et qui utilisent le port 20/tcp comme port
source, vous avez besoin de l'option '-r'. (Pour cela vous deviez faire tourner
l'ancien proxy avec "-u root").
<p>
Exécuter ftp-proxy avec "-d -D7" si vous avez des problèmes et si vous souhaitez
diagnostiquer ce qui se passe.

<p>
<a name="20051216"></a>
<h3>2005/12/16 - Suppression de libresolv</h3>

Vous devez supprimer libresolv de votre machine car celui-çi n'est
plus installé.
<pre>
     # rm /usr/lib/libresolv*
</pre>

<p>
<a name="20060104"></a>
<h3>2006/01/04 - mac68k passe à wscons(4)</h3>
Avant de redémarrer avec le nouveau noyau, il faut mettre à jour des fichiers
systèmes pour <a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=wscons&amp;sektion=4">wscons(4)</a>.
</p>

<pre>
# cp /usr/src/etc/etc.mac68k/MAKEDEV /dev
# cd /dev &amp;&amp; sh ./MAKEDEV wscons
</pre>

<p>
Dans <tt>/etc/ttys</tt>,
changer la ligne getty on <em>ttye0</em> to <em>ttyC0</em>
puis redémarrer avec le nouveau noyau.
</p>


<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
</font>
<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../../images/back.gif" border= "0" alt="[back]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: current.html,v 1.26 ]<br>
$Translation: current.html,v 1.20 2006/01/09 21:26:05 borte Exp $<br>
-->
$OpenBSD: current.html,v 1.16 2006/01/10 06:01:41 saad Exp $
</small>

</body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Suivre la version de développement "-current"</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 2006 by OpenBSD">
</head>

<body bgcolor= "#ffffff" text= "#000000">
<a href="../../fr/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif" border="0">    
</a>
<p>
<font color= "#0000e0">
<a href= "index.html">[Index de la FAQ]</a>
</font>

<p>

<h1><font color="#e00000">Suivre la version de développement "<i>-current</i>"</font></h1>
<hr>

<h3>Table des matières</h3>
<p>
<ul>
<li><a href="#Intro">Introduction</a>
<!-- Les entrées les plus vieilles en haut... -->
<li><a href="#20060926">26/09/2006 - Passage à gcc3 (alpha)</a>
<li><a href="#20061006">06/10/2006 - 'flags S/SA keep state' devient
    implicite dans pf.conf(5)</a>
<li><a href="#20061011">11/10/2006 - pas de disklabel dans les
    partitions FreeBSD ou NetBSD</a>
<li><a href="#20061012">12/10/2006 - Ne pas démarrer à partir de
    partitions NetBSD</a>
<li><a href="#20061029">29/10/2006 - nouvel utilisateur pour ripd(8)</a>
<li><a href="#20061227">27/12/2006 - "Flag day" pour ARM (zaurus/armish)
    </a>
<li><a href="#20070131">31/01/2007 - nouvel utilisateur pour
    hoststated(8)</a>
<li><a href="#20070202">02/02/2007 - nouvelle façon d'activer
    l'accounting au démarrage</a>
<li><a href="#20070226">26/02/2007 - spamd: greylisting activé
    par défaut; les fichiers de configuration sont déplacés sous
    /etc/mail</a>
<li><a href="#20070326">26/03/2007 - Xenocara remplace XF4 dans <i>-current</i></a>
<li><a href="#20070327">27/03/2007 - le nouveau pilote ahci(4) peut
    entraîner un renommage des disques SATA</a>
<li><a href="#20070331">31/03/2007 - changement dans le langage de filtrage
    de bgpd</a>
<!-- Les nouvelles additions se mettent en bas, merci -->
</ul>
    
<hr>

<a name="Intro"></a>
<!-- XXXversion -->
<h2>Introduction</h2>
Ce document est pour les personnes souhaitant suivre la version de
développement d'OpenBSD; celle-ci sera nommée <i>-current</i> dans la
suite de ce texte. Il contient des informations sur les changements
apportés entre la version 4.0-release et <i>-current</i>, et ne devrait
PAS être utilisé par quiconque voulant faire une mise à jour à partir
des versions 3.9 ou précédentes ou même par les personnes souhaitant
suivre <a href="../../fr/stable.html"><i>-stable</i></a>.

<p>
Si vous voulez passer vers la version 4.0-release ou 4.0-stable à partir
de versions antérieures, consulter le <a href="upgrade40.html">guide de
mise à niveau</a>.

<p>
Soyez certain d'avoir lu et compris la
<a href="faq5.html">FAQ 5 - Construire le Système à partir des Sources</a>
avant d'utiliser -current et les instructions qui suivent.

<p>
Vous devriez TOUJOURS partir d'un "snapshot" pour suivre
<i>-current</i>. Une mise à jour via la compilation des sources n'est
pas supportée.
   
<p>
Si vous souhaitez avoir des informations pour mettre à jour en partant de
versions plus anciennes, consultez le document
<a href="../upgrade-old.html">upgrade-old.html</a>.
Celui-çi est fourni en tant que document historique -- il ne DOIT PAS
servir de procédure de mise à jour.

<p>

<a name="20060926"></a>
<h3>26/09/2006 - Passage à gcc3 (alpha)</h3>
OpenBSD/alpha est passé à gcc3.
Pour mettre à jour,
<pre>
 # rm -rf /usr/include/g++
 # cp /usr/src/share/mk/bsd.own.mk /usr/share/mk/
</pre>
A présent, <a href="faq5.html#NewCompiler">compilez gcc3</a> (en
utilisant le répertoire gcc3) puis compilez un nouvel ld.so :

<pre>
 cd /usr/src/libexec/ld.so
 make clean
 make obj
 make depend
 make
 make install
</pre>

Ensuite, compilez le noyau et le système comme à
<a href="faq5.html#Bld">l'accoutumée</a>.
<p>

<a name="20061006"></a>
<h3>06/10/2006 - 'flags S/SA keep state' devient implicite dans
        pf.conf(5)</h3>
<i>flags S/SA keep state</i> est à présent le mode par défaut pour les
règles "pass" de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5">pf.conf(5)</a>,
et les options <i>no state</i> et <i>flags any</i> ont été ajoutées afin
de changer le fonctionnement par défaut. Les jeux de règles actuels
continueront de se charger, mais leurs comportements pourraient changer
quelque peu, ces nouvelles options par défaut étant plus restrictives.
Les jeux de règles avec un filtrage sans état (<i>no state</i>) ou qui
doivent créer des états sur les paquets intermédiaires (<i>flags
any</i>) doivent être mis à jour explicitement afin d'obtenir le
comportement souhaité.
<p>
Une attention toute particulière devra être prise avec l'interface
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=enc&amp;sektion=4">enc0</a>,
étant donné que des états flottants constituent un problème potentiel
pour le filtrage du trafic IPsec : les états doivent être liés à une
interface afin d'éviter l'autorisation de trafic non chiffré dans le cas
où
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=isakmpd&amp;sektion=8">isakmpd(8)</a>
serait amené à s'arrêter. Toutes les règles liées à l'interface enc0
devraient donc contenir <i>keep state (if-bound)</i>.
<p>

<a name="20061011"></a>
<h3>11/10/2006 - pas de disklabel dans les partitions FreeBSD ou
          NetBSD</h3>
<i>Les partitions DOS de FreeBSD et NetBSD au niveau du MBR</i> ne sont
plus utilisées pour stocker des disklabels et pour chercher un
disklabel. Ainsi, les partitions DOS de FreeBSD et NetBSD au niveau du
MBR ne contiendront plus une partition 'a' créée par le disklabel
usurpé. Le disklabel de tels disques sera stocké et chargé à partir du
secteur 1. Mais cette opération pourrait trouver un vieux disklabel de
manière accidentelle. Utilisez fdisk(8) pour changer le type de
partition en OpenBSD ('A6') pour utiliser le disklabel existant.
<p>
 
<a name="20061012"></a>
<h3>12/10/2006 - ne pas démarrer à partir de partitions NetBSD</h3>
<i>amd64, i386, macppc et mvmeppc</i> n'essaient plus désormais de
démarrer à partir de la première partition NetBSD lorsqu'aucune
partition OpenBSD n'a été trouvée.
<p>

<a name="20061029"></a>
<h3>29/10/2006 - nouvel utilisateur pour ripd(8)</h3>
<i>Un nouveau service RIP a été importé</i> et afin de l'utiliser, un
nouveau couple utilisateur et groupe est nécessaire.

En tant que <i>root</i>, ajoutez l'utilisateur et le groupe en question
en utilisant
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8">useradd(8)</a> :

<blockquote><pre>
# useradd -u88 -g=uid -c"RIP Daemon" -d/var/empty -s/sbin/nologin _ripd
</pre></blockquote>

Cette commande ajoutera l'utilisateur et le groupe correspondant. Selon
votre environnement, vous pouvez tout simplement la copier/coller.
<p>

<a name="20061227"></a>
<h3>27/12/2006 - "Flag day" pour ARM (zaurus/armish)</h3>
<i>Le mécanisme d'appel système pour arm a changé</i> ce qui aura pour
conséquence d'empêcher les binaires et bibliothèques partagées
antérieurs au 7 novembre de fonctionner. Il est nécessaire de mettre à
jour à partir d'un snapshot afin de se conformer à ce changement d'ABI.
<p>

<a name="20070131"></a>
<h3>31/01/2007 - nouvel utilisateur pour hoststated(8)</h3>
<i>Un service "HostState" a été importé</i> et afin de l'utiliser, un
nouveau couple utilisateur et groupe est nécessaire.

En tant que <i>root</i>, ajoutez l'utilisateur et le groupe en question
en utilisant
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8">useradd(8)</a> :

<blockquote><pre>
# useradd -u89 -g=uid -c"HostState Daemon" -d/var/empty -s/sbin/nologin _hoststated
</pre></blockquote>

Cette commande ajoutera l'utilisateur et le groupe correspondant. Selon
votre environnement, vous pouvez tout simplement la copier/coller.
<p>

<a name="20070202"></a>
<h3>02/02/2007 - nouvelle façon d'activer l'accounting au démarrage</h3>
Afin d'activer l'accounting lors du démarrage de la machine vous devez à
présent renseigner la variable rc.conf "accounting=YES". La seule
présence du fichier /var/account/acct ne suffit plus à l'activer
automatiquement.
<p>

<a name="20070226"></a>
<h3>2007/02/26 - spamd: "greylisting" activé par défaut; les fichiers de
    configuration sont déplacés sous /etc/mail</h3>
<p>
Le "greylisting" est maintenant le mode de fonctionennemt par défaut de
spamd(8); l'argument <tt>-g</tt> est devenu obsoléte.
Pour désactiver le "greylisting" et fonctionner en mode "blacklist-only",
utiliser l'argument <tt>-b</tt>.
Afin de contrôler sur quelle adresse spamd va se lier, utiliser le nouvel
argument <tt>-l</tt>.

<p>
Il est aussi possible de mettre spamd-setup(8) en mode "blacklist-only" en
lui passant le nouvel argument <tt>-b</tt>.

<p>
Le fichier spamd.conf(5) a été déplacé de <tt>/etc</tt> vers <tt>/etc/mail</tt>.

<p>
Référez-vous aux pages de manuel de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=spamd&amp;sektion=8">spamd(8)</a>
et de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=spamd-setup&amp;sektion=8">spamd-setup(8)</a>
pour les détails.

<a name="20070326"></a>
<h3>26/03/2007 - Xenocara remplace XF4 dans <i>-current</i></h3>
L'arbre <a href="http://www.xenocara.org/">xenocara</a> doit à présent
être utilisé au lieu de XF4 afin de compiler X pour OpenBSD.
Plus de détails sont disponibles sur
<a href="http://undeadly.org/cgi?action=article&sid=20070328153001">undeadly.org</a>.

<p>
Si vous avez toujours <tt>Option "xkbrules" "xfree86"</tt> dans votre
fichier de configuration <tt>/etc/X11/xorg.conf</tt>, vous devez le
modifier en <tt>Option "xkbrules" "xorg"</tt>.
<p>
Si vous souhaitez vraiment compiler Xenocara à partir des sources (ne le
faites pas, utilisez plutôt les snapshots !), référez-vous au fichier
<a href="http://www.openbsd.org/cgi-bin/cvsweb.cgi/xenocara/README?rev=HEAD&content-type=text/x-cvsweb-markup"
>xenocara/README</a> ainsi qu'à
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=release&amp;sektion=8">release(8)</a>

<a name="20070327"></a>
<h3>27/03/2007 - le nouveau pilote ahci(4) peut entraîner un renommage
des disques SATA</h3>
<p>
De récents changements dans le sous-système <tt>ahci(4)</tt> peuvent
renommer les disques SATA anciennement reconnus en wd* (ex.
<tt>wd0</tt>) vers sd* (ex. <tt>sd0</tt>).

<p>
Il s'agir d'un problème si vous mettez votre machine à jour à partir
d'un snapshot plus ancien.
Vérifiez le <tt>dmesg</tt> au démarrage.
Un disque reconnu précédemment comme :

<p>
<blockquote><tt>
pciide1 at pci0 dev 31 function 2 "Intel 82801GBM AHCI SATA" rev 0x02: DMA,
channel 0 wired to native-PCI, channel 1 wired to native-PCI<br>
pciide1: using apic 2 int 11 (irq 11) for native-PCI interrupt<br>
wd0 at pciide1 channel 0 drive 0: <FUJITSU MHV2080BH>&gt;<br>
wd0: 16-sector PIO, LBA48, 76319MB, 156301488 sectors<br>
wd0(pciide1:0:0): using PIO mode 4, Ultra-DMA mode 5
</tt></blockquote>

apparait désormais comme :

<p>
<blockquote><tt>
ahci0 at pci0 dev 31 function 2 "Intel 82801GBM AHCI SATA" rev 0x02: AHCI 1.1: apic 2 int 16 (irq 11)<br>
scsibus1 at ahci0: 32 targets<br>
sd0 at scsibus1 targ 0 lun 0: &lt;ATA, FUJITSU MHV2080B, 0084&gt; SCSI2 0/direct fixed<br>
sd0: 76319MB, 76319 cyl, 64 head, 32 sec, 512 bytes/sec, 156301488 sec total
</tt></blockquote>

<p>
La solution recommandée est de modifier votre fichier
<tt>/etc/fstab</tt> afin de changer les disques et partitions
<tt>/dev/wd</tt> en cause vers <tt>/dev/sd</tt>.

<p>
Une autre solution serait de désactiver <tt>ahci</tt> en utilisant
<tt>config(8)</tt> ou <tt>boot -c</tt>.

<p>
Référez-vous aux pages de manuel d'
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ahci&amp;sektion=4">ahci(4)</a>
et de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>
pour de plus amples détails.

<a name="20070331"></a>
<h3>31/03/2007 - changement dans le langage de filtrage de bgpd</h3>
<p>
Les filtres bgpd n'utilisant que <tt>prefixlen</tt> comme paramètre de
filtrage doivent à présent inclure un identifiant représentant la
famille d'adresse en question, tel que <tt>inet</tt> ou <tt>inet6</tt> :

<p>
<blockquote><tt>
allow from any inet prefixlen 8 - 24<br>
deny from any inet6 prefixlen &gt; 64<br>
</tt></blockquote>

<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
</font>
<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../../images/back.gif" border= "0" alt="[back]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: current.html,v 1.65 ]<br>
$Translation: current.html,v 1.55 2007/04/11 07:03:22 saad Exp $<br>
-->
$OpenBSD: current.html,v 1.44 2007/04/11 07:24:30 saad Exp $
</small>

</body>
</html>

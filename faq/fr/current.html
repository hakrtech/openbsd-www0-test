<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Suivre la version de développement "-current"</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 2005-2012 by OpenBSD">
</head>

<body bgcolor= "#ffffff" text= "#000000">
<a href="../../fr/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif" border="0">
</a>
<p>
<font color= "#0000e0">
<a href= "index.html">[Index de la FAQ]</a>
</font>

<p>

<h1><font color="#e00000">Suivre la version de développement "<i>-current</i>"</font></h1>
<hr>

<h3>Table des matières</h3>
<p>
<ul>
<li><a href="#Intro">Introduction</a>
<!-- Les entrées les plus vieilles en haut... -->
<li><a href="#20120808">2012/08/08 - xf86-video-ati 6.14.6 est maintenant sélectionné par défaut</a>
<li><a href="#20120821">2012/08/21 - SLAAC IPv6 à des adresse privées par défaut</a>
<li><a href="#20120823">2012/08/23 - Nouveau comportement du toolchain</a>
<li><a href="#20120830">2012/08/30 - pmdb(1) supprimé</a>
<li><a href="#20120831">2012/08/31 - gcc(1) utilise maintenant __guard_local au lieu de __guard sur les architectures ELF/GCC4</a>
<li><a href="#20120831a">2012/08/31 - amd64, sgi, loongson et sparc64 sont désormais PIE</a>
<li><a href="#20120901">2012/09/01 - alpha est désormais PIE</a>
<li><a href="#20120902">2012/09/02 - hppa est désormais PIE</a>
<li><a href="#20120912">2012/09/12 - landisk est désormais PIE</a>
<li><a href="#20120920">2012/09/20 - pf impose la limite 'frags'</a>
<li><a href="#20120923">2012/09/23 - imake déplacé dans les ports</a>
<li><a href="#20120924">2012/09/24 - [ports] Mise à jour majeure de PostgreSQL</a>
<li><a href="#20121011">2012/10/11 - Changement de syntaxe pour smtpd.conf</a>
<li><a href="#20121123">2012/11/23 - Changement des options sndiod(1)</a>
<li><a href="#20121201">2012/12/01 - Les ports m88k passent à gcc 3</a>

<!-- Les nouvelles entrées se mettent en bas, merci -->
</ul>

<hr>

<a name="Intro"></a>
<!-- XXXversion -->
<h2>Introduction</h2>
Ce document est pour les personnes souhaitant suivre la version de
développement d'OpenBSD; celle-ci sera nommée <i>-current</i> dans la
suite de ce texte. Il contient des informations sur les changements
apportés entre la version 5.2-release et <i>-current</i>, et ne devrait
PAS être utilisé par quiconque voulant faire une mise à jour à partir
des versions 5.1 ou précédentes ou même par les personnes souhaitant
suivre <a href="../../fr/stable.html"><i>-stable</i></a>.

<p>
Si vous voulez passer vers la version 5.2-release ou 5.2-stable à partir
de versions antérieures, consulter le <a href="../upgrade52.html">guide de
mise à niveau</a>.

<p>
Soyez certain d'avoir lu et compris la
<a href="faq5.html">FAQ 5 - Construire le Système à partir des Sources</a>
avant d'utiliser -current et les instructions qui suivent.

<p>
Vous devriez TOUJOURS partir d'un "snapshot" pour suivre
<i>-current</i>. Une mise à jour via la compilation des sources n'est
pas supportée.

<p>
La plupart de ces changements doivent être réalisés comme root.

<p>
<a name="20120808"></a>
<h3>2012/08/08 - xf86-video-ati 6.14.6 est maintenant sélectionné par défaut</h3>
Le pilote X.Org
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=radeon&sektion=4">radeon(4)</a>
a été mis à jour à la version 6.14.6 et est à présent sélectionné par
défaut lors d'utilisations sans le fichier <tt>xorg.conf</tt>.<br>
Pour forcer l'utilisation du pilote
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=radeonold&sektion=4">radeonold(4)</a>,
ajoutez les lignes suivantes à <tt>/etc/X11/xorg.conf</tt>:
<pre>
Section "Device"
    Identifier "Old Radeon Card"
    Driver "radeonold"
EndSection
</pre>

<p>
<a name="20120821"></a>
<h3>2012/08/21 - SLAAC IPv6 à des adresses privées par défaut</h3>
L'auto-configuration sans état d'IPv6 (comme quand vous configurez
une interface en utilisant "rtsol") utilise désormais des adresses
privées RFC4941.<p>
Cela signifie que lorsque vous mettez en place une connexion sortante,
les adresses prévisibles basées sur l'adresse MAC ne sont plus utilisées
en tant qu'adresses sources; à la place, des adresses temporaires sont
générées périodiquement et utilisées (voir la description de "autoconfprivacy"
d'<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&sektion=8">ifconfig(8)</a>
pour plus d'informations).<p>
Les connexions entrantes ne sont pas affectées par ceci; l'adresse
IPv6 basée sur l'adresse MAC est toujours configurée sur l'interface
et peut être utilisée pour les connexions entrantes.
Cependant, si les connexions vers d'autres machines sont filtrées selon
les adresses IPv6 ou le reverse DNS, vous pourriez avoir besoin soit de
modifier votre configuration, soit de désactiver les adresses privées
(e.g. <tt>echo "up -autoconfprivacy" &gt;&gt; /etc/hostname.em0</tt>),
soit de configurer les adresses manuellement.

<p>
<a name="20120823"></a>
<h3>2012/08/23 - Nouveau comportement du toolchain</h3>
Le script de link
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ld&sektion=1">ld(1)</a>
reconnaît désormais les sections .openbsd.randomdata, dont libc a aussi été mis
à jour pour s'en servir. Normalement, ld(1) n'est construit qu'après libc,
donc pour le construire utilisez en premier:
<blockquote><pre>
<b>cd /usr/src/gnu/usr.bin/binutils
make -f Makefile.bsd-wrapper obj
make -f Makefile.bsd-wrapper
make -f Makefile.bsd-wrapper install
</b></pre></blockquote>
Vous pouvez vérifier que ld(1) est mis à jour en vérifiant la sortie
de ld --verbose:
<blockquote><pre>
$ <b>ld --verbose | grep randomdata</b>
  .openbsd.randomdata     :
    PROVIDE_HIDDEN (__openbsd_randomdata_start = .);
    *(.openbsd.randomdata .openbsd.randomdata.*)
    PROVIDE_HIDDEN (__openbsd_randomdata_end = .);
</pre></blockquote>

<p>
<a name="20120830"></a>
<h3>2012/08/30 - pmdb(1) supprimé</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pmdb&sektion=1">pmdb(1)</a>
a été supprimé. Le fichier binaire et sa page de manuel peuvent être supprimés:
<blockquote><pre>
<b>rm /usr/bin/pmdb /usr/share/man/man1/pmdb.1
</b></pre></blockquote>

<p>
<a name="20120831"></a>
<h3>2012/08/31 - gcc(1) utilise maintenant __guard_local au lieu de __guard sur les architectures ELF/GCC4</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gcc&sektion=1">gcc(1)</a>
émet désormais du code de protection stack-smashing qui référence 
__guard_local à la place de __guard sur les architectures ELF/GCC4.
À cause du fait que GCC est construit à la fin d'un "make build" normal,
il est nécessaire soit de faire deux constructions complètes, soit de raccourcir
la première construction en mettant juste à jour les fichiers d'exécution C et
le compilateur:
<blockquote><pre>
<b>cd /usr/src/lib/csu
make depend && make && sudo make install
cd /usr/src/gnu/usr.bin/cc
make depend && make && sudo make install
</b></pre></blockquote>
Vous pouvez ensuite procéder à un "make build" normal comme pour
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=release&sektion=8">release(8)</a>.

<p>
<a name="20120831a"></a>
<h3>2012/08/31 - amd64, sgi, loongson et sparc64 sont désormais PIE</h3>
Les plates-formes amd64, sgi, loongson et sparc 64 ont été passés à
PIE ("position-independent executables") par défaut. Tout le monde est
encouragé à mettre à jour son système via les snapshots (datés après le
31/08/2012); si vous voulez mettre à jour via les sources, suivez ces
instructions:
<p>
Premièrement, installez les nouveaux Makefiles système avec le changement
vers PIE_ARCH dans bsd.own.mk:
<blockquote><pre>
<b>cd /usr/src/share/mk && sudo make install
</b></pre></blockquote>
Ensuite, recompilez et installez gcc et binutils.
<blockquote><pre>
<b>cd /usr/src/gnu/usr.bin/binutils
make -f Makefile.bsd-wrapper clean && make -f Makefile.bsd-wrapper obj && \
	make -f Makefile.bsd-wrapper depend && make -f Makefile.bsd-wrapper
cd /usr/src/gnu/usr.bin/cc
make clean && make obj && make depend && make && sudo make install
cd /usr/src/gnu/usr.bin/binutils && sudo make -f Makefile.bsd-wrapper install
</b></pre></blockquote>
Pour finir, recompilez votre système en suivant la procédure décrite dans
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=release&sektion=8">release(8)</a>.

<p>
<a name="20120901"></a>
<h3>2012/08/31 - alpha est désormais PIE</h3>
La plate-forme alpha a été passée à PIE ("position-independent executables")
par défaut. Tout le monde est encouragé à mettre à jour son système via les
snapshots (datés après le 01/09/2012). Pour effectuer cette conversion
vous-même, référez-vous aux
<a href="#20120831a">instructions pour la conversion PIE</a> pour les autres
architectures.

<p>
<a name="20120902"></a>
<h3>2012/09/02 - hppa est désormais PIE</h3>
La plate-forme hppa a été passée à PIE ("position-independent executables")
par défaut. Tout le monde est encouragé à mettre à jour son système via les
snapshots (datés après le 02/09/2012). Pour effectuer cette conversion
vous-même, référez-vous aux
<a href="#20120831a">instructions pour la conversion PIE</a> pour les autres
architectures.

<p>
<a name="20120912"></a>
<h3>2012/09/12 - landisk est désormais PIE</h3>
La plate-forme landisk a été passée à PIE ("position-independent executables")
par défaut. Tout le monde est encouragé à mettre à jour son système via les
snapshots (datés après le 12/09/2012). Pour effectuer cette conversion
vous-même, référez-vous aux
<a href="#20120831a">instructions pour la conversion PIE</a> pour les autres
architectures.

<p>
<a name="20120920"></a>
<h3>2012/09/20 - pf impose la limite 'frags'</h3>
pfctl va avorter si la limite 'frags' dans pf.conf est plus élevée
que kern.maxclusters. Ceci a pour but d'empêcher qu'un système exécute plus
que les clusters mbuf. Si cette valeur n'est pas spécifiée, elle sera
par défaut celle de 25% de kern.maxclusters.

<p>
<a name="20120923"></a>
<h3>2012/09/23 - imake déplacé dans les ports</h3>
Imake, le vieux système de construction de X, a été déplacé dans les ports, étant
donné qu'aucun des packages de xenocara ne l'utilise. La version installée dans
<tt>/usr/X11R6</tt> doit être supprimée manuellement:
<blockquote><pre><b>
sudo rm -rf /usr/X11R6/lib/X11/config
sudo rm -f /usr/X11R6/bin/{ccmakedep,cleanlinks,imake,makeg,mergelib,mkdirhier,mkhtmlindex,revpath,xmkmf}
sudo rm -f /usr/X11R6/man/man1/{ccmakedep,cleanlinks,imake,makeg,mergelib,mkdirhier,mkhtmlindex,revpath,xmkmf}.1
</b></pre></blockquote>

<p>
<a name="20120924"></a>
<h3>2012/09/24 - [ports] Mise à jour majeure de PostgreSQL</h3>
Mise à jour majeure vers la version 9.2.1. Une sauvegarde/restauration
est nécessaire.

<p>
<a name="20121011"></a>
<h3>2012/10/11 - Changement de syntaxe pour smtpd.conf</h3>
Le mot-clé <tt>"all"</tt> est devenu <tt>"any"</tt>. Vous devez mettre
à jour votre configuration. Faites bien attention lors du remplacement
des règles de:
<pre>	accept from all [...]</pre>
à
<pre>	accept from any [...]</pre>
parce que la syntaxe précédente est toujours valide, mais définit à présent
un comportement complètement différent, ce qui pourrait casser votre jeu de règles.

<p>
<a name="20121123"></a>
<h3>2012/11/23 - Changement des options sndiod(1)</h3>
Les options "rate" (-r) et d'encodage (-e) deviennent des paramètres
spécifiques à des périphériques et doivent par conséquent précéder le
périphérique auquel ils s'appliquent (-f). Exemple, changez:
<blockquote><pre><b>sndiod -frsnd/1 -r44100</b></pre></blockquote>
par
<blockquote><pre><b>sndiod -r44100 -frsnd/1</b></pre></blockquote>
Les "thru boxes" MIDI sont créées dynamiquement donc l'option -M doit
être supprimée. Les ports MIDI (-q) ne peuvent pas être connectés au
port de contrôle sndiod, donc un programme externe doit être utilisé
à cette fin (eg. aucat(1) ou le port audio/midish). Pour l'instant,
pour que rmidi/5 contrôle snd/0 faites:
<blockquote><pre><b>aucat -M -mmidi -qrmidi/5 -qsnd/0</b></pre></blockquote>

<p>
<a name="20121201"></a>
<h3>2012/12/01 - Les ports m88k passent à gcc 3</h3>
OpenBSD/luna88k et OpenBSD/mvme88k utilisent désormais gcc 3.3.6 en
tant que compilateur système. Une mise à jour vers un snapshot récent
est recommandée; cependant, les étapes de mise à jour manuelle sont:
<ul>
<li>Compilez et installez un nouvel assembleur:
<pre>
   cd /usr/src/gnu/usr.bin/gas
   make clean
   make obj
   make depend
   make
   make install
</pre>
<li>Compilez le nouveau compilateur C avec le compilateur existant:
<pre>
   cd /usr/src/gnu/usr.bin/gcc
   make -f Makefile.bsd-wrapper clean
   make -f Makefile.bsd-wrapper obj
   make -f Makefile.bsd-wrapper -DBOOTSTRAP depend
   make -f Makefile.bsd-wrapper -DBOOTSTRAP
   make -f Makefile.bsd-wrapper -DBOOTSTRAP includes
   make -f Makefile.bsd-wrapper -DBOOTSTRAP install
</pre>
<li>Faites en sorte que le reste du système sache que la plate-forme utilise gcc 3:
<pre>
   cd /usr/src/share/mk
   make install
</pre>
<li>Compilez et installez un préprocesseur à jour:
<pre>
   cd /usr/src/usr.bin/cpp
   make clean
   make obj
   make depend
   make
   make install
</pre>
<li>Recompilez libc et libiberty avec le nouveau compilateur C:
<pre>
   cd /usr/src/lib/libc
   make clean
   make obj
   make NOMAN= NOPROFILE= depend
   make NOMAN= NOPROFILE=
   make NOMAN= NOPROFILE= install

   cd /usr/src/gnu/lib/libiberty
   make -f Makefile.bsd-wrapper clean
   make -f Makefile.bsd-wrapper obj
   make -f Makefile.bsd-wrapper NOMAN= NOPROFILE= depend
   make -f Makefile.bsd-wrapper NOMAN= NOPROFILE=
   make -f Makefile.bsd-wrapper NOMAN= NOPROFILE= install
</pre>
<li>Maintenant recompilez l'ensemble du compilateur à nouveau:
<pre>
   cd /usr/src/gnu/usr.bin/gcc
   make -f Makefile.bsd-wrapper clean
   make -f Makefile.bsd-wrapper obj
   make -f Makefile.bsd-wrapper depend
   make -f Makefile.bsd-wrapper
   make -f Makefile.bsd-wrapper install
</pre>
<li>Le système est maintenant prêt à être recompilé avec gcc3:
<pre>
   cd /usr/src
   rm -fR /usr/include/g++
   make obj
   make build
</pre>
</ul>

<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../../images/back.gif" border= "0" alt="[back]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: current.html,v 1.360 ]<br>
$Translation: current.html,v 1.173 2012/12/22 07:41:20 rustybsd Exp $<br>
-->
$OpenBSD: current.html,v 1.122 2012/12/22 09:49:28 ajacoutot Exp $
</small>

</body>
</html>

<html>
<head>
<title>12.0 - For Advanced Users</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 1998-2002 by OpenBSD.">
<meta http-equiv="Content-Type" content="text/html;charset=iso-2022-jp">
</head>

<body bgcolor= "#ffffff" text= "#000000">

<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif">
<p>
<h2><font color=#e00000>12.0 - 高度なユーザのために</font><hr></h2>
</p>

<p>
<ul><h3>Table of Contents</h3>
<li><a href="#IDEDMA">12.1 - IDE ディスクで DMA アクセスを強制する</a>
<li><a href= "upgrade-minifaq.html">12.2 - 各種バージョンの OpenBSD を CVSでアップデートするには</a>
</ul>
</p> 
<hr>

<P>
ここでの<i>高度なユーザ</i>というのは、Unix系 OS の利用と管理について
実地の知識を持っている人のことだ。このページにあることを、
何をしているかきちんと理解しないで実行したら、
システムのオペレーションで問題が生じることもある。
<br>

<p>
<a name= "IDEDMA">
<h2>12.1 - IDE ディスクで DMA アクセスを強制する</h2>
</a>

<p>
PCI IDE コードは、あなたの使っているチップセットを知らないかもしれない。
その場合にはこんなメッセージが表示される:
<UL>
<PRE>
pciide0: DMA, (unused)
</PRE>
</UL>
このメッセージが出たら、カーネルの config ファイルで、pciide のエントリに
'flags 0x0001' と入れて DMA モードを強制してみる手がある。
それだとこんな感じになる:
<UL><PRE>
pciide* at pci ? dev ? function ? flags 0x0001
</PRE></ul>
これをやると、pciide コードはあなたのチップセットでのやり方を本当に知っているか
どうかにはおかまいなしに、DMA モードを使おうとする。これがうまくいって、
システムが起動時に fsck とその他起動プロセスを突破したら、たぶんこれはそのまま
ずっと使えるはず。これが失敗して、ブート直後にシステムがハングしたりパニック
したりするようなら、DMA モードは使えない（まだ。あなたのチップセットのサポート
が追加されるまで）。もしあなたの PCI-IDE コントローラのチップセットの完全な
ドキュメンテーションを見つけてくれたら、それを PCI-IDE コードでサポートする
出発点としては最適だというのをお忘れなく。メーカーの web サイトを見たり、
電話をかけたりしてみてほしい。もしその PCI-IDE コントローラがマザーボードの
一部なら、そのチップセットをつくったのがだれかを調べて、そいつらのリソースを
つついてみよう!
<P>
こんなメッセージが表示されたら、DMA サポートは有効になったと
いうことだ:
<UL><PRE>
cd0(pciide0:1:0): using PIO mode 3, DMA mode 1 (using DMA data transfers)
</PRE></UL>
これはつまり pciide0, channel 1, drive 0 (これは ATAPI
CD-ROMらしいね) が DMA データ転送を使っているということだ。
</p>
<p>
注記:
</p>
<p>
DMA は wdc* では、DMA チャンネル (drq) が指定されていないと機能しない。
ハードディスクコントローラの「標準」drqs がなんなのか、よくわからない。
有効にするには
<pre>
wdc0	at isa? port 0x1f0 irq 14 flags 0x00
</pre>
非-ultra DMA だと、必ずしもプロセッサIOに比べて帯域幅が増大するとは限らない。
でも、CPU の負荷はかなり下がる。
</p>

<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ トップに戻る]</a>
<a href= "../faq11.html">[11.0 - パフォーマンスのチューニング]</a>
<a href= "faq13.html">[13.0 - IPSec]</a>
</font>
</p>

<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../../images/back.gif" border= "0" alt="[back]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
Originally [OpenBSD: faq12.html,v 1.29 ]
<br>
$Translation: faq12.html,v 1.6 2002/04/27 13:21:12 toshi Exp $
<br>
$OpenBSD: faq12.html,v 1.6 2002/04/28 10:26:23 jufi Exp $
</small>
</p>
</body>
</html>

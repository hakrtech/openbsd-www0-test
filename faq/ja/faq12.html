<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>12 - Platform-Specific Questions</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html;charset=iso-2022-jp">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 2003-2004 by OpenBSD.">
</head>

<body bgcolor= "#ffffff" text= "#000000">

<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif">
<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ の目次]</a>
<a href= "faq11.html">[11 章 - パフォーマンスのチューニング]</a>
<a href= "faq14.html">[14 章 - ディスクの設定]</a>
</font>

<h1><font color=#e00000>12 - プラットフォーム固有の質問</font></h1>
<hr>

<p>
<h3>目次</h3>
<ul>
<li><a href="#General">12.1 - 一般的なハードウェアについて</a>
  <ul>
  <li><a href="#GenPCI">12.1.1 - PCI</a>
  <li><a href="#GenISA">12.1.2 - ISA</a>
  </ul>
<li><a href="#alpha">12.2 - DEC Alpha </a>
<li><a href="#hp300">12.3 - HP 9000 シリーズ 300, 400</a>
<li><a href="#hppa" >12.4 - HP Precision Architecture (PA-RISC)</a>
<li><a href="#i386" >12.5 - i386</a>
  <ul>
  <li><a href="#ISANIC">12.5.1 - ISA NIC</a>
  <li><a href="#FPU">12.5.2 - 私の 80386/80386SX/80486SX システム上で
       OpenBSD がブートしません</a>
  <li><a href="#IrqShare">12.5.3 - dmesg を見ると、同じ割り込みを
       複数のデバイスが共有してます</a>
  <li><a href="#i386USBkb">12.5.4 - USB キーボードはどのように使用するのでしょう ?</a>
  <li><a href="#i386smouse">12.5.5 - キーボード/マウスがロックされたままになります
       (または暴走してしまいます) !</a>
  </ul>
<li><a href="#mac68k">12.6 - Mac68k</a>
  <ul>
  <li><a href="#mac68kSupport">12.6.1 - 私の Mac68k システムが
       動かないようなのですが</a>
  <li><a href="#mac68kTime">12.6.2 - なぜ、Mac68k では時刻が大幅に遅れるのでしょう ?</a>
  <li><a href="#mac68k2disks">12.6.3 - ディスクがふたつあると、Mac68k
       システムが動きません</a>
  <li><a href="#mac68kInstCrash">12.6.4 - インストール中にインストーラが
       クラッシュしてしまいます</a>
  </ul>
<li><a href="#macppc">12.7 - MacPPC</a>
  <ul>
  <li><a href="#macppcbm">12.7.1 - なぜ、bm(4) ドライバはこんなに遅いのでしょう ?</a>
  </ul>
<li><a href="#mvme68k">12.8 - MVME68k</a>
<li><a href="#sparc">12.9 - SPARC</a>
<li><a href="#sparc64">12.10 - UltraSPARC</a>
  <ul>
  <li><a href="#sparc64Floppy">12.10.1 - UltraSPARC がフロッピーイメージから
       ブートしてくれません</a>
  </ul>
<li><a href="#vax">12.11 - DEC VAX</a>
</ul>

<hr>

<a name="General"></a>
<h2>12.1 - 一般的なハードウェアについて</h2>
 
<a name="GenPCI"></a>
<h3>12.1.1 - PCI デバイス</h3>

<ul>
<li>PCI デバイスはほぼ自動構成を行います。コンピュータと OS は、
カードが要求するリソースを割り当てます。

<li>PCI バス上では割り込みは共有されます。共有可能な場合だけではなく、
特に i386 システム上では、システムは IRQ が共有されている場合にも、
しばしばより良く共有を行おうとします。

<li>PCI バスには、いくつかの異なった規格があります。
場合によっては、PCI 2.1 仕様のシステムでは動作できない、
PCI 2.2 仕様のカードが見つかることがあるかも知れません。
(たとえば、マルチポートのネットワークカードのような) オンボードのブリッジを
使用する多くのカードもまた、古い目のシステムでは動作しないでしょう。

<li>PCI バスは 2 レベルの電気信号、3.3V と 5V をサポートしています。
3.3V の電気信号で動作するカードには、その PCI コネクタに
ふたつ目のノッチが刻まれています。
ほとんどの PCI カードは、ほとんどのコンピュータが使用する 5V の電気信号を使用します。
シングルボードコンピュータ Soekris (Net45x1 ならびに Net4801) は、
3.3V の電気信号のみをサポートする代表的なコンピュータでしょう。

</ul>

<a name="GenISA"></a>
<h3>12.1.2 - ISA デバイス</h3>
<ul>
<li>ISA デバイスはリソースの共有を行うことはできませんので、一般的には、
システム中の他のデバイスと設定が衝突しないよう、手動で設定を行わなければ
なりません。

<li>いくつかの ISA デバイスは "Plug and Play"
(<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=isapnp&amp;sektion=4">isapnp(4)</a>)
対応となっています。もし、このようなデバイスを使用した場合に何か問題があれば、
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dmesg&amp;sektion=8">dmesg(8)</a>
でそれらの構成を検証してください。ISAPnP は、いつも意図したように動くわけではありません。

<li>一般的に、選択できるのであれば、ほとんどの人たちは PCI を支持して
ISA カードを避けるようにという、最良のアドバイスをしてくれるでしょう。
ISA カードは構成が難しく、システムの性能に対して負の大きな影響を及ぼします。
</ul>



<p> <a name="alpha"></a>
<h2>12.2 - DEC Alpha</h2> [未完成]

<a name="hp300"></a>
<h2>12.3 - HP300</h2>
[未完成]

<a name="hppa"></a>
<h2>12.4 - HPPA</h2>
[未完成]

<a name="i386"></a>
<h2>12.5 - i386</h2>

<a name="ISANIC"></a>
<h3>12.5.1 - ISA NIC</h3>
OpenBSD は古いハードウェア上でも十分に実行可能なので、
ユーザはしばしば ISA の NIC を OpenBSD で使おうとすることがあります。
ISA のハードウェアは、PCI のハードウェアよりかなり多くの設定と知識を
要求します。
一般的に、コンピュータに多数の ISA カードを詰め込むことはできませんし、
それらが魔法でも使ったかのように動いてくれることも期待できません。
多くのマシンでは、ISA デバイスが "Plug 'n' Play" (PNP) モードで動作しない場合、
システムの BIOS でそのカードが使用するリソースを予約しておかなければなりません。

<h4>3Com 3C509B ep(4)</h4>
これは
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ep&amp;sektion=4">ep(4)</a>
ドライバでサポートされている、すばらしい性能の ISA NIC です。
'B' バージョンは、カード上のラベルや、ボード上の大きな主チップ
(おおまかに言って、一辺が 2.5cm のものが 'B' バージョンで、
一辺が 2cm のものが古いバージョンです) で 'B' ではないバージョンと
区別することができ、'B' バージョンは、フル装備の、あるいは 2 枚の
ネットワークカードを持つシステム上で、より良好な性能を発揮します。
3C509B のチップは PNP モードで構成されますが、
不幸にもそれは標準を満たしていないため、OpenBSD の
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=isapnp&amp;sektion=4"
>isapnp(4)</a> サポートで問題が発生してしまいます。
アダプタは、非 PNP デバイスとして最初に検出され、その後 PNP サポートが
利用可能になった後で再びオンラインになるため、余計な NIC が dmesg
に現れてしまいます。
それでも問題なく動作するかも知れませんし、他の問題の原因となるかも知れません。
3C509B カードの場合、PNP モードを無効にして、設定前に 3Com の DOS ベースの
設定ユーティリティを使用して衝突のない設定を調べた上で、手動構成を行うことを
強く推奨します。

<p>
ep(4) ドライバは、どのようなハードウェアの組み合わせにおいても、システムの
他のデバイスと衝突しないよう、カードを検出してくれるはずです。

<p>
もし、システムに複数の 3C509 カードが搭載されている場合、dmesg を使用して
どれがどれかを識別できるようにしておくため、カードのブラケットに MAC
アドレスをラベリングしておくことを推奨します。

<p>
3C509、3C905 および 3C590 はしばしば混同されることがあります。
3C509 は 10Mbps の ISA カードであり、3C905 と 3C590 は PCI
カードです。


<p>
<h4>NE2000</h4>
オリジナルの NE2000 NIC は 1980 年代中ごろに Novell 社で開発されました。
それ以来、多くの製造業者が、一般的に NE2000 互換あるいはクローンと呼ばれる、
非常によく似たカードを生産してきました。
これらのクローンカードの性能には、非常に大きなバラつきがあります。
いくつかの古い NE2000 互換のカードは非常に良好な性能を発揮しますが、
現時点で利用可能な互換カードの多くは低い性能しか発揮できません。
NE2000 互換カードは、OpenBSD では
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ne&amp;sektion=4">ne(4)</a>
ドライバでサポートされています。

<p>
OpenBSD は、ISAPNP モードが ON になっている場合には、
いくつかの ISAPNP で利用可能な NE2000 互換カードを取り扱うことができます。
他のカードは、ジャンパか DOS ベースの設定ユーティリティのいずれかを使用して
設定しなければなりません。
不幸にも、オリジナルの NE2000 カードはソフトウェアによる設定が不可能で、
ISAPNP もサポートされていないため、これについての標準が存在しません。
ですので、あなたのカードにもともと附属しているユーティリティが
必要となります。
しばしば、その入手が困難であることもあります。

<p>
ne(4) ドライバは、OpenBSD の GENERIC カーネルの中で、以下のように
ISA NE2000 カードの設定を 3 種類サポートしています。
<pre>
     ne0:  port 0x240 irq 9
     ne1:  port 0x300 irq 10
     ne2:  port 0x280 irq 9
</pre>
もし、これらの 3 種類の設定では使用できない場合、
<a href="../faq5.html#BootConfig">User Kernel Configuration (UKC)</a> を使用するか、
<a href="../faq5.html">カスタムカーネルを構築</a>することによって、設定を調整できます。

<p>
ne(4) ドライバはかなり "無能" であることに注意してください。I/O ポートしか
プローブしないので、もし上記 I/O アドレスのいずれかが検出された場合には、
それに関連した IRQ を<i>仮定してしまいます</i>。
ISA ne(4) ドライバの場合、
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dmesg&amp;sektion=8">dmesg(8)</a>
はアダプタの実際の IRQ を反映していません。ですので、これが
実際にカードに設定された IRQ ではない場合、このカードは動作しません。

<p>
ne(4) ドライバを使用する非 ISA カードが存在します。これらには、PCI および
PCMCIA ne(4) カードがありますが、これらのデバイスは自動設定されますので、
上記の注意事項はこれらのカードには適用されないということに注意してください。

<a name="80386"></a>
<a name="FPU"></a>  
<h3>12.5.2 - 私の 80386/80386SX/80486SX システム上で、OpenBSD がブートしません !</h3>
<h4>80386SX</h4>
80386SX でアドレッシング可能な最大の範囲は、OpenBSD/i386 のサポート可能な
最低限度の 16MB までです。
ほとんどの 80386SX システムでは、8MB 以上の RAM をサポートしていないため、
いくつかの些細ではない段階を踏み、そして 2 台目のコンピュータを用意しなければならないので、
"エキスパート専用" のカテゴリに置かれています。
また、次のセクションも参考にしてください。

<h4>80386</h4>

OpenBSD 3.4 は、80386 や 80386SX システムに 80387 や 80387SX ハードウェア
数値演算コプロセッサ (浮動小数点ユニット、FPU) を装備する限りは動作するでしょう。
不運にも、これらの FPU は一般的なものではなく、多くの 80386
システムではこれを装備していません。
OpenBSD は i386 プラットフォームでは FPU がない限りは動作しません。
もう一度述べますが、これは OpenBSD のように暗号機能を集約したオペレーティングシステムには、
非常に非力な処理能力しかないということに注意してください。
一般的な使用目的には、このようなマシンの性能では
幸せになることはできないでしょう。

<h4>80486SX</h4>
80486SX チップは、80486 の「低価格」バージョンであり、OpenBSD 3.4 の要求する
(80386 のような) ハードウェアによる浮動小数点のサポートが欠落しています。
幸運にも、フルスペックの 80486DX チップが利用可能であり、ほとんどのシステムにおいては、
簡単にこれにアップグレードすることができます。

<a name="IrqShare"></a>
<h3>12.5.3 - dmesg を見ると、同じ割り込み (IRQ) を
複数のデバイスが共有してます</h3>
これは全般的には受け入れられるものであり、事実、PCI デバイスにとっては、
意図されたことでさえあります。
これは PCI バスの設計機能なのです。
ある人たちは、割り込み要求 (IRQ) の共有は悪いことだと言うかも知れませんが、
彼らは、(IRQ の共有が許されていない) ISA バスの存在する状況で混乱してしまうか、
あるいは、太古のハードウェアやソフトウェアについての過去の経験に基づいているのかの
いずれかでしょう。

<p>
ISA デバイスは IRQ を共有することはできません。もし、ISA デバイスが IRQ
を共有してしまっている場合、この問題を修正しなければなりません。

<a name="i386USBkb"></a>
<h3>12.5.4 - USB キーボードはどのように使用するのでしょう ?</h3>
OpenBSD/i386 では、インストール後に普通に USB キーボードやマウスを使用することは
困難なことではありません。
しかし、USB キーボードのシステムへの OpenBSD のインストールは、
USB キーボードを完全にサポートするのに必要な USB ドライバが
インストール用のカーネルには含まれていないため、難しいかも知れません。
さまざまなマシンがありますので、ある程度の試行錯誤は必要かも知れません。
<ul>
<li>いくつかのシステムには、"Legacy USB support" やこれと同様の
BIOS オプションを持ちます。
これは BIOS が伝統的な PS/2 キーボードをエミュレートするオプションです。
もし、このオプションが有効化されていなければ、<tt>boot></tt> プロンプトで
コマンドを入力することは<i>できない</i>でしょう。
しかし、あるシステムでは、この機能を有効にすることでより良く実行できるかも知れませんし、
別のシステムでは、この機能を無効にした方が良いかも知れません。
さらに別のシステムでは、どちらかの設定でインストールを行って、
実行時は別の設定に切り替えた方がより良いかも知れません。
また、あるマシンでは、このオプションを持っていないかも知れません。
<li>"Legacy USB support" を使用する場合には、ブートが完了する前に
<a href="../faq5.html#BootConfig"><tt>User Kernel Configuration (UKC)</tt></a> のところで
"<tt>disable uhci</tt>" を入力してカーネルの USB サポートを無効化した方が
より良く実行できることもあります。
<li>PS/2 キーボード/マウス用 USB 変換アダプタは動作しないかも知れません。
<li>システムのインストールが完全に終了するまでは、マウスを接続しない方が
システムはより安定する *かも* 知れません。
<li>最悪の場合、他のコンピュータにインストールする方がより簡単だということが
わかるかも知れませんが、その場合には、ハードディスクを別の「遺産のない」
マシンに移設してください。
</ul>

OpenBSD をひとたびインストールできれば、
<ul>
<li><a href="../faq5.html#BootConfig">UKC</a> を使用して
pckbd0 を無効化することで、「カーネルメッセージのノイズ」(これは通常は
<tt>pckdc: cmd failed</tt> というものです) を抑えることができるかも知れませんが、
これを行うことで、PS/2 マウスを使用することができなくなるでしょう。
<li>USB キーボードとマウスは、ちょうど PS/2 キーボードや
X 上のマウスのように扱われます。
マウスドライバには "wscons" を使用してください。
<li>現時点では、「遺産のない」(シリアルポートやパラレルポート、PS/2 ポートを持たない)
システムでは、シリアルコンソールを設定する方法がありません。
あなたのシステムへのインストールが困難な場合、紙と鉛筆で
メッセージを記録しなければならないでしょう。
</ul>

不幸にも、さまざまな方法で PC の USB がサポートされている現状では、
あなたのシステム上で USB キーボードを正しく動作するようにするためには、
ある程度の試行錯誤が必要となるかも知れません。
他に、USB キーボードの秘訣について良くまとめられたドキュメントを見つけたら、
ぜひ <a href="mailto:faq@openbsd.og">faq@openbsd.org</a> に連絡してください。

<a name="i386smouse"></a>
<h3>12.5.5 - キーボード/マウスがロックされたままになります (または暴走してしまいます) !</h3>
ひとつのキーボードやモニタ、マウスと複数のコンピュータとを接続するための
「ディスプレイ/キーボード切換器」は割と良く見かけるものでしょう。
異なるブランドや設計の「ディスプレイ/キーボード切換器」を試行錯誤することもできますが、
OpenBSD は、他のオペレーティングシステムに比べて、マウスの切り換えが
よりデリケートであるように見えます。
この問題は、たいていマウスの切り換えの際に発生します。
もし、マウスを使用しない場合には、その解決策は単純で、
マウスケーブルをコンピュータに接続しないことです。
もし、マウスを使用する場合には、「一台のコンピュータにはひとつのマウス」
を接続し、キーボードとモニタを切り換えることが簡単な解決策です。
もし、マシンのコンソールへのアクセスが必要なだけでしたら、
代わりに<a href="faq7.html#SerCon">シリアルコンソール</a>の使用を
検討してみてください。


<a name="mac68k"></a>
<h2>12.6 - Mac68k</h2>

<a name="mac68kSupport"></a>
<h3>12.6.1 - 私の Mac68k システムが動かないようなのですが</h3>
不幸にも、私たちは、開発者にわたすことができる少数の異なる Mac68k マシンしか
所有していませんので、今のところ、正常に動作することがわかっているのは、
わずかなマシンしかありません。
現状では動作しないことがわかっているシステムのサポートを、あなたが
復活させられるのでしたら、あなたのコードは歓迎されることでしょう。

<a name= "mac68kTime"></a>
<h3>12.6.2 - なぜ、Mac68k では時刻が大幅に遅れるのでしょう ?</h3>
これはハードウェアのバグが原因です。OpenBSD は、現在の時間を追いかけるのに
クロック割り込みを使用していますが、この割り込みは <a href="../../mac68k.html">Mac68k</a>
アーキテクチャではプライオリティが最低になっているのです。
そのため、(たとえばディスクやネットワークの活動などで)
負荷が重くなってくると、クロック割り込みが捨てられてしまうため、
Unix のクロックがあまり進まないことになってしまうのです。
<a href="../../macppc.html">MacPPC</a> システムには
このような問題はありません。

<p>
MacOS は、常にハードウェアクロックを読みに行ってこの問題を回避しています。
OpenBSD は、ハードウェアクロックは起動時にしか読みません。
シャットダウン時には、カーネルは Unix 時間を元にハードウェアクロックを
修正するほどの自信がないことがおわかりいただけたでしょうか。
この時間のロス問題はよく知られていることだからなのです。

<p>
簡単な解決策は、rdate(8) を crontab エントリに記述して
定期的に実行することです。
もし、あなたが常時接続を使用していない場合に、
PPP を利用しているのでしたら、
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rdate&amp;sektion=8">rdate(8)</a>
を起動して利用可能な場合には、<i>/etc/ppp/ppp.linkup</i> ファイルで
rdate(8) を呼び出すようにしても良いでしょう。

<p>
<a href="http://www.macbsd.com/macbsd/macbsd-docs/faq/faq-3.html#ss3.17">
http://www.macbsd.com/macbsd/macbsd-docs/faq/faq-3.html#ss3.17</a>
も参照してください。


<a name="mac68k2disks"></a>
<h3>12.6.3 - ディスクがふたつあると、Mac68k システムが動きません</h3>
そうですね、不幸にも、これらはよく知られた問題なのです。
これは通常、システムがマルチユーザモードに移行後、短時間のうちに
クラッシュしてしまうのですが、このクラッシュは、ディスクシステムに
明らかに関係があるわけではないかも知れないのです。
この解決策は、今のところ、Mac68k システム上では、ただひとつの
ディスクしか使用しないことです。正しい修正を歓迎します。

<a name="mac68kInstCrash"></a>
<h3>12.6.4 - インストール中にインストーラがクラッシュしてしまいます</h3>
MacOS 上で実行されるインストーラは、"大きな" パーティションにはファイルを
コピーできません。もし、インストール先のパーティションサイズが 500MB
以上である場合、以下のような奇妙なエラーが発生してしまいます。
<pre>
    Error on SCSIRead(), #5
    pos = 0, i = 22, fs = /
    alloccgblk: can't find blk in cyl
</pre>
この解決策は、まず最小限のシステムを "小さな" root パーティションにインストール
してしまうことで、その後、OpenBSD をブートして、これらを希望どおりに再配置します。

<p>
たとえば、200MB の root パーティションが必要なら、そのサイズで root
パーティションを作成し、必要な他のパーティションも作成してください。そして、
MacOS のユーティリティを使用して、それらすべてに newfs を実行し、それから
etc34.tgz と base34.tgz とを、この root パーティションにインストールします。

<p>
他のパーティションを臨時のマウントポイントに mount して、
<a href="faq10.html#DupFS">こちら</a>
に例示されているように、希望するディレクトリをそこにコピーしてください。

<p>
ここで、/etc/fstab を変更してリブートし、残りの *.tgz ファイルを
<a href="../faq4.html#AddFileSet">こちら</a>
に書かれているとおりに展開してください。

<p>
この手順に従えば、どのようなサイズの非 root パーティションでも
設定することができます。


<a name="macppc"></a>
<h2>12.7 - MacPPC</h2>

<a name="macppcbm"></a>
<h3>12.7.1 - なぜ、bm(4) ネットワークアダプタがこんなに遅いのでしょう ?</h3>
初期の iMac を含む、いくつかの MacPPC システム上で使用されている BMAC チップをサポートする
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bm&amp;sektion=4&amp;arch=macppc">bm</a>
ドライバには
100Mbps で使用する場合に問題があります。
このため、<tt>/etc/hostname.bm0</tt> ファイル中に <tt>"media 10baseT"</tt>
オプションを指定して、強制的に 10Mbps に設定するか、あるいは
ハブもしくはスイッチを強制的に 10Mbps で使用することを強くお勧めします。


<a name="mvme68k"></a>
<h2>12.8 - MVME68k</h2>
[未完成]

<a name="sparc"></a>
<h2>12.9 - SPARC</h2>
[未完成]

<a name="sparc64"></a>
<h2>12.10 - UltraSPARC (sparc64)</h2>

<a name="sparc64Floppy"></a>
<h3>12.10.1 - UltraSPARC がフロッピーイメージからブートしてくれません</h3>
Ultra 1/1e と Ultra 2 だけが、<i>どのような</i> OS でもフロッピーディスクからブートすることができます。
インストール時には、代わりに、CD-ROM、Miniroot あるいはネットワークブートを使用してください。



<a name="vax"></a>
<h2>12.11 - DEC VAX</h2>
[未完成]



<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ の目次]</a>
<a href= "faq11.html">[11 章 - パフォーマンスのチューニング]</a>
<a href= "faq14.html">[14 章 - ディスクの設定]</a>
</font>

<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../../images/back.gif" border= "0" alt="[back]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
Originally [OpenBSD: faq12.html,v 1.49 ]
<br>
$Translation: faq12.html,v 1.25 2004/02/23 11:11:21 toshi Exp $
<br>
$OpenBSD: faq12.html,v 1.23 2004/02/25 17:40:57 jufi Exp $
</small>
</body>
</html>

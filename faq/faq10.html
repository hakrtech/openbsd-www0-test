<html>
<head>
<title>OpenBSD FAQ: 10.0 - System Administration</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 1998,1999 by OpenBSD.">
</head>

<body bgcolor= "#ffffff" text= "#000000" link= "#23238E">
<p>
<font color= "#0000e0">
<a href= "index.html">[Back to Main Index]</a>
<a href= "faq9.html">[To Section 9.0 - Migrating from Linux]</a>
<a href= "faq24.html">[To Section 11.0 - OpenBSD 2.4 Specific Information]</a>
</font>
</p>

<p>
<h1>10.0 - System Administration</h1>
<hr>
</p>

<p>
<a name= "10.1">
<h2>10.1 - Why does it say that I'm in the wrong group when I su to root?</h2>
</a>
</p>

<p>
To be able to use
<a href= "http://www.openbsd.org/cgi-bin/man.cgi?query=su&apropos=0&sektion=1&format=html">
su(1)</a> to root you must be in group 0, &quot;wheel&quot;. This
MUST be placed specifically in <kbd>/etc/group</kbd>. It isn't enough to have 
them listed in <kbd>/etc/passwd</kbd>. Once this is done you should be able to
su correctly.
</p>

<br>

<p>
<a name= "10.2">
<h2>10.2 - How do I duplicate a filesystem?</h2>
</a>
</p>

<p>
Use dump/restore. For example. To duplicate everything under directory 
<kbd>SRC</kbd> to directory <kbd>DST</kbd>, do a:
<pre>
# cd /SRC; dump 0f - . | (cd /DST; restore -rf - )
</pre>
</p>

<p>
<a name="10.3">
<h2>10.3 - How do I get httpd, sendmail, etc to startup with the
system?</h2>
</a>
</p>

<p>
OpenBSD uses rc-style startup to control starting applications with the
system. For common daemons you can simply edit 
<a href="http://www.openbsd.org/cgi-bin/cvsweb/src/etc/rc.conf?rev=1.35">/etc/rc.conf</a>.
<br>
For example: To have ftpd started on boot change - 
<br>
<pre>
ftpd_flags=NO -- > ftpd_flags="-D"
</pre>
</p>
<p>
You can add any flags that you wish ftpd to start with.
</p>
<p>
If you have your own daemon's that you want to be started, here is a
simple entry that you can put into /etc/rc.local.<br>
<pre>
if [ -x /usr/local/sbin/mydaemon ]; then
        echo -n ' mydaemon';       /usr/local/sbin/mydaemon
fi
</pre>
<br>
Once in there, it will come up with the system each time.
</p>

<p>
<a name="10.4">
<h2>10.4 - Why do users get relaying access denied when they are remotely sending mail through my OpenBSD system?</h2>
</a>
</p>

<p>
Try this:
</p>

<pre>
cat /etc/sendmail.cf | grep relay-domains
</pre>
<p>
The output may look something like this:
</p>

<pre>
FR-o /etc/mail/relay-domains
</pre>

<p>
If this file doesn't exist, create it.  You will need to enter the users
who are sending mail remotely with the following syntax:
</p>

<pre>
.domain.com    #if it is dynamic
sub.domain.com #if static
</pre>

<p>
Don't forget to:
</p>
<pre>
kill -1 `cat /var/run/sendmail.pid`
</pre>
<br>


<p>
<a name="10.5">
<h2>10.5 - I've set up POP, but users have trouble accessing mail thru POP. What can i do?</h2>
</a>
</p>

<p>
Most issues dealing with pop are accessing files, mainly temp files.
Some clients give errors such as:
</p>
<pre>
-ERR Couldn't open temporary file, do you own it?K
</pre>
<p>
Try setting up your permissions as such:
</p>
<pre>
permission in  /var
drwxrwxr-x   2 bin     mail     512 May 26 20:08 mail


permissions in  /var/mail
-rw-------   1 username   username        0 May 26 20:08 username
</pre>
<p>
Double check that the user owns his file in /var/mail , this should be
done by default.
</p>

<p>
<a name="10.6">
<h2>10.6 - Setting up a Secure HTTP server with SSL(8)</h2>
</p>

<p>
This will take you through all the steps it takes to set up your own
Secure HTTP server. Since the OpenBSD 2.5 release, OpenBSD has shipped
with ssleay. Because of copyrighted RSA algorigthms, these cannot be
shipped with OpenBSD. libssl includes support for SSL version 2, SSL
version 3, and TLS version 1. So for now, because of copyright
restictions, OpenBSD must ship without a fully-functional libssl. But it
is still completely useable. If you are able to use the RSA patented
library's you can easily upgrade your libssl with a command like this.
</p>
<p>
<kbd>#pkg_add ftp://ftp.openbsd.org/pub/OpenBSD/${ver}/packages/${arch}/libssl-1.1.tgz </kbd>
<br>
Where ${ver} is the OpenBSD version number, and ${arch} is your
architecture.
</p>

<p>
The steps shown here are taken pretty much from the <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssl&apropos=0&sektion=8&format=html">ssl(8)</a>
man page. So you can refer to that for further information. Also, this faq
will only go over creating a RSA certificate for web servers, not a DSA
server certificate. To find out how to do so, please refer to the ssl(8)
man page.
</p>

<p>
I will no show how to create your key and certificate. These will go to
<strong>/etc/ssl/private/</strong>. This means that you will have to have
upgraded your libssl. Now we can create our key. You can do so with a line
like such:
</p>
<p>
<strong># ssleay genrsa -out /etc/ssl/private/server.key 1024</strong>
</p>
<p>
This will create a key of 1024 bits. Next you need to create a
<strong>Certificate Signing Request</strong> which is used to get a
<strong>CA</strong> or <strong>Certificate Authority</strong> to sign your
key. Here is the command to do so.
</p>
<p>
<strong># ssleay req -new -key /etc/ssl/private/server.key -out /etc/ssl/private/server.csr</strong>
</p>
<p>
You would now give /etc/ssl/private/server.csr to the <strong>CA</strong>
to get it signed. Or you could also sign the certificate for yourself.
Here is how you would do this.
</p>
<p>
<strong># ssleay x509 -req -days 365 -in /etc/ssl/private/server.csr -signkey /etc/ssl/private/server.key -out /etc/ssl/server.crt</strong>
</p>
<p>
This will sign your key, and it will be valid for up to 365 days. With
this done you can now start the httpd server. To start httpd(8) with ssl
you must start the daemon with the -DSSL flag. You can start this on boot
in <strong>/etc/rc.conf</strong> by changing the httpd line to look like
so:
</p>
<p>
<pre>
httpd_flags="-DSSL"
</pre>
</p>
<p>
This server will run on port 443.
</p>

<p>
<font color= "#0000e0">
<a href= "index.html">[Back to Main Index]</a>
<a href= "faq9.html">[To Section 9.0 - Migrating from Linux]</a>
<a href= "faq24.html">[To Section 11.0 - OpenBSD 2.4 Specific Information]</a>
</font>
</p>
<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../images/back.gif" border= "0" alt="[back]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>$OpenBSD: faq10.html,v 1.12 1999/05/29 05:25:01 ericj Exp $</small>
</p>
</body>
</html>


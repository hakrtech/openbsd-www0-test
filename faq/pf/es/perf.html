<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>PF: Rendimiento</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="resource-type" content="document">
<meta name="description"   content="the OpenBSD FAQ page">
<meta name="keywords"      content="openbsd,faq,pf">
<meta name="distribution"  content="global">
</head>

<!--
Copyright (c) 2003, 2004, 2008 Nick Holland <nick@openbsd.org>

Permission to use, copy, modify, and distribute this documentation for
any purpose with or without fee is hereby granted, provided that the
above copyright notice and this permission notice appear in all copies.

THE DOCUMENTATION IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL
WARRANTIES WITH REGARD TO THIS DOCUMENTATION INCLUDING ALL IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE
AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS DOCUMENTATION
-->

<body bgcolor="#ffffff" text="#000000">
<!-- Passes validator.w3.org, please keep it this way;
please, use a max of 72 chars per line -->

<a href="../../../es/index.html">
<img alt="[OpenBSD]" height="30" width="141" src="../../../images/smalltitle.gif" border="0">
</a>
<p>
[<a href="logging.html">Anterior: Registros de
Bitácora</a>]
[<a href="index.html">Contenido</a>]
[<a href="ftp.html">Siguiente: Cuestiones relacionadas con FTP</a>]

<p>
<h1><font color="#e00000">PF: Rendimiento</font></h1>
<hr>

<h3>
&laquo;&iquest;Cuánto ancho de banda puede gestionar
PF?&raquo;<br>
&laquo;&iquest;Qué características debe tener mi
máquina para gestionar mi conexión a Internet?&raquo;
</h3>

<!--XXX outdated?
	could probably use updating to make it more relevant;
	maybe pcengines/soekris instead of 486/66? -->

<p>
No existen respuestas concretas para estas preguntas.  Para algunas
aplicaciones, un 486/66 con un par de buenas tarjetas de red
ISA de buena calidad pueden filtrar y gestionar NAT a unos 5Mbps, pero
para otras aplicaciones podría no ser suficiente una
máquina mucho más rápida con unas tarjetas de red PCI mucho
más eficientes.  La cuestión real no es la cantidad de bits por
segundo, sino la cantidad de paquetes por segundo y la complejidad del
grupo de reglas.

<p>
El rendimiento de PF se determina mediante algunas variables:
<ul>
<li>El número de paquetes por segundo.  La cantidad de
procesamiento necesaria para un paquete con 1500 bytes de carga
útil es casi la misma que para un paquete con un byte de carga
útil.  El número de paquetes por segundo determina el
número de veces que hay que evaluar la tabla de estado y, en caso
de no econtrar ahí la concordancia, las reglas de filtrado
tendrán que ser evaluadas cada segundo, lo que a su vez determina
la demanda efectiva en el sistema.

<li>El rendimiento del <i>bus</i> del sistema.  El bus ISA tiene
un ancho de banda máximo de 8MB/s, y cuando está siendo
accedido por el procesador tiene que disminuir hasta la velocidad
efectiva de un 80286 a 8MHz, sin que importe lo rápido que pueda
ser en realidad el procesador.  El bus PCI tiene un ancho de
banda efectivo mucho mayor, y el impacto del procesador es menor.

<li>La eficiencia de la tarjeta de red.  Algunos adaptadores de red son
más eficientes que otros.  Las viejas tarjetas basadas en Realtek 8139
(<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rl&amp;sektion=4"
>rl(4)</a>) 
tienden a ofrecer un rendimiento relativamente pobre (las más recientes
Realtek basadas en <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=re&amp;sektion=4"
>re(4)</a> son mucho mejores), mientras que las
tarjetas basadas en Intel 21143
(<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dc&amp;sektion=4&amp;manpath=OpenBSD+3.5">dc(4)</a>)
tienden a ofrecer un rendimiento bastante bueno.  Para obtener un
máximo de rendimiento, hay que considerar el uso de las tarjetas
gigabit Ethernet, aun cuando no se vaya a conectar a redes gigabit, ya
que disponen de una memoria mucho más avanzada.

<li>La complejidad y el diseño del grupo de reglas.  Cuanto
más complejo sea el grupo de reglas, más lento
funcionará.  Cuantos más paquetes se filtren con
<tt>keep state</tt> y <tt>quick</tt>, mejor será el rendimiento.
Cuantas más líneas deban ser evaluadas por cada paquete,
menor será el rendimiento.

<li>También hay que mencionar la CPU y la RAM.  Como PF es un
proceso basado en el núcleo del sistema, no usa espacio de
memoria de intercambio (<i>swap</i>).  Por lo tanto, si tenemos
suficiente RAM funcionará, pero en caso contrario generará
estados de pánico a causa del agotamiento de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pool&amp;sektion=9"
>pool(9)</a>.
No son necesarias enormes cantidades de RAM;  32MB deberían ser
suficientes para unos 30.000 estados, que son muchos estados para una
aplicación en una pequeña oficina o en casa.  La
mayoría de usuarios se encontrarán con que una
máquina &laquo;reciclada&raquo; es más que suficiente para
un sistema de filtros PF;  un sistema con 300MHz moverá un gran
número de paquetes con rapidez, siempre que esté
respaldado con unas buenas NIC y un buen grupo de reglas.
</ul>


<h3>&iquest;Ayudará el uso de varios procesadores?</h3> 
PF sólo utilizará un procesador, por lo que varios procesadores 
(o varios núcleos) NO mejorará el rendimiento de PF. 
<!--XXX outdated?
	this is probably talking about apic, which GENERIC now uses -->
NO OBSTANTE, en algunas circunstancias, la ejecución de la versión SMP
de OpenBSD (<tt>bsd.mp</tt>) en lugar de <tt>bsd</tt> ofrecerá
un mejor rendimiento debido a las diferencias en la forma de manejo 
de las interrupciones. 
En muchos casos, <tt>bsd.mp</tt> dará peor rendimiento. 
SI usted se encuentra con problemas de rendimiento, experimente 
con esto, la mayoría de los usuarios 
nunca alcanzará los límites para preocuparse. 

<h3>&iquest;Existen comparativas?</h3>
Los usuarios suelen preguntar por comparativas o bancos de pruebas 
para PF.  El único banco de pruebas digno de tener en cuenta es el 
rendimiento del <i>propio</i> sistema en el <i>propio</i> entorno.  
Un banco de pruebas que no replique nuestro entorno no nos ayudará a 
planear correctamente nuestro sistema de cortafuegos.  Lo mejor que 
podemos hacer para obtener un banco de pruebas de PF es simular 
nosotros mismos un entorno con las mismas condiciones de red &ndash;o lo 
más parecidas que sea posible&ndash; que experimentaría el cortafuegos 
real, y en el mismo <i>hardware</i> que usaría el cortafuegos.

<p>
PF se usa en algunas aplicaciones muy grandes con mucho tráfico,
y los mismos desarrolladores son usuarios avanzados de PF.  
Lo más seguro es que el funcionamiento para un usuario
normal sea excelente.

<p>
[<a href="logging.html">Anterior: Registros de
bitácora</a>]
[<a href="index.html">Contenido</a>]
[<a href="ftp.html">Siguiente: Cuestiones relacionadas con FTP</a>]

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../../../images/back.gif" border="0" alt="[back]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: perf.html,v 1.24 ]<br>
$Translation: perf.html,v 1.14 2011/02/17 21:25:35 mvidal Exp $<br>
-->
$OpenBSD: perf.html,v 1.11 2011/02/17 23:28:45 ajacoutot Exp $
</small>

</body>
</html> 

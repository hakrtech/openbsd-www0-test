<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>PF: Configuration</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="resource-type" content="document">
<meta name="description"   content="the OpenBSD FAQ page">
<meta name="keywords"      content="openbsd,faq,pf">
<meta name="distribution"  content="global">
<meta name="copyright"     content="This document copyright 2003 by OpenBSD.">
</head>

<body bgcolor="#ffffff" text="#000000">
<!-- Passes validator.w3.org, please keep it this way;
please, use a max of 72 chars per line -->

<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif">
<p>
[<a href="index.html">Contents</a>]
[<a href="macros.html">Next: Lists and Macros</a>]

<p>
<h1><font color="#e00000">PF: Configuration</font></h1>

<hr>

<a name="activate"></a>
<h2>Activation</h2>
To activate PF and have it read its configuration file at boot edit the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf&amp;sektion=8&amp;manpath=OpenBSD+3.3">
<tt>/etc/rc.conf</tt></a> file so that the PF line reads:

<blockquote>
<tt>
pf=YES
</tt>
</blockquote>

<p>
Reboot your system to have it take effect.

<p>
You can also activate and deactivate PF by using the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.3">
pfctl(8)</a> program:

<blockquote>
<tt>
# pfctl -e<br>
# pfctl -d
</tt>
</blockquote>

<p>
to enable and disable, respectively.

<h2>Configuration</h2>
<p>
PF reads its configuration rules from 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+3.3">
<tt>/etc/pf.conf</tt></a> at boot
time, as loaded by the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc&amp;sektion=8&amp;manpath=OpenBSD+3.3">
rc scripts</a>.  Note that while 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+3.3">
<tt>/etc/pf.conf</tt></a> is the default and is
loaded by the system rc scripts, it is just a text file loaded and interpreted
by 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.3">
pfctl(8)</a> and inserted into
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.3">
pf(4)</a>.  For some applications, other rule sets may be loaded from other
files after boot.  As with any well designed Unix application, PF offers great
flexibility.

<p>
The <tt>pf.conf</tt> file has seven parts:
<ul>
<li><b>Macros:</b> User-defined variables that can hold IP addresses, interface
names, etc.
<li><b>Tables:</b> A structure used to hold lists of IP addresses.
<li><b>Options:</b> Various options to control how PF works.
<li><b>Scrub:</b> Reprocessing packets to normalize and defragment
them.
<li><b>Queueing:</b> Provides bandwidth control and packet prioritization.
<li><b>Translation:</b> Controls Network Address Translation and
packet redirection.
<li><b>Filter Rules:</b> Allows the selective filtering or blocking
of packets as they pass through any of the interfaces.
</ul>

<p>
With the exception of <b>macros</b> and <b>tables</b>, each section
should appear in this order in the configuration file, though not all
sections have to exist for any particular application.

<p>
Blank lines are ignored and lines beginning with <tt>#</tt> are treated
as comments.

<h2>Control</h2>
After boot, PF operation can be managed using the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.3">
pfctl(8)</a> program.  Some example commands are:

<pre>
     # pfctl -f /etc/pf.conf     <i>loads the pf.conf file</i>
     # pfctl -nf /etc/pf.conf    <i>parse the file, but don't load it</i>
     # pfctl -Nf /etc/pf.conf    <i>Load only the NAT rules from the file</i>
     # pfctl -Rf /etc/pf.conf    <i>Load only the filter rules from the file</i>

     # pfctl -sn                 <i>Show the current NAT rules</i> 
     # pfctl -sr                 <i>Show the current filter rules</i>
     # pfctl -ss                 <i>Show the current state table</i>
     # pfctl -si                 <i>Show filter stats and counters</i>
     # pfctl -sa                 <i>Show EVERYTHING it can show</i>
</pre>

<p>
For a complete list of commands, please see the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.3">
pfctl(8) manpage</a>.

<p>
[<a href="index.html">Contents</a>]
[<a href="macros.html">Next: Lists and Macros</a>]

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../../images/back.gif" border="0" alt="[back]"></a> 
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>$OpenBSD: config.html,v 1.1 2003/05/01 01:46:06 nick Exp $</small>

</body>
</html> 

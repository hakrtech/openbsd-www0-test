<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>PF: Výkon</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="resource-type" content="document">
<meta name="description"   content="the OpenBSD FAQ page">
<meta name="keywords"      content="openbsd,faq,pf">
<meta name="distribution"  content="global">
</head>

<!--
Copyright (c) 2003, 2004, 2008 Nick Holland <nick@openbsd.org>

Permission to use, copy, modify, and distribute this documentation for
any purpose with or without fee is hereby granted, provided that the
above copyright notice and this permission notice appear in all copies.

THE DOCUMENTATION IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL
WARRANTIES WITH REGARD TO THIS DOCUMENTATION INCLUDING ALL IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE
AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS DOCUMENTATION
-->

<body bgcolor="#ffffff" text="#000000">
<!-- Passes validator.w3.org, please keep it this way;
please, use a max of 72 chars per line -->

<a href="../../../cs/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../../images/smalltitle.gif" border="0">
</a>
<p>
[<a href="../logging.html">Předchozí: Logging</a>]
[<a href="index.html">Obsah</a>]
[<a href="../ftp.html">Další: Otázky okolo FTP</a>]

<p>
<h1><font color="#e00000">PF: Výkon</font></h1>
<hr>

<h3>
"Jak velkou šířku pásma PF zvládá?"<br>
"Jak silný potřebuji počítač aby zvládal mé Internetové připojení?"
</h3>

<!--XXX outdated?
	could probably use updating to make it more relevant;
	maybe pcengines/soekris instead of 486/66? -->
<p>
Neexistují žádné snadné odpovědi na tyto otázky. Pro některé aplikace a
486/66 s párem dobrých ISA NIC karet můžete filtrovat a NATovat skoro
5Mbps, ale pro jiné aplikace potřebujete mnohem rychlejší stroj 
s mnohem efektivnějšími PCI NIC kartami aby to bylo dostatečné.
Opravdová otázka neni počet bitů za sekundu, ale raději počet
paketů za sekundu a komplexnost pravidel.

<p>
PF výkon je určen několika proměnnými:
<ul>
<li>Počet paketů za sekundu. Takřka stejné množstvi zpracování je nutné
udělat na paketu s 1500 bytů velkou datovou častí (payload) jako pro paket
s 1 bytem payload. Počet paketů za sekundu určuje, jak často jsou stavová 
tabulka a, v případě, že v ní není odpovídající záznam, filtrovací pravidla
vyhodnocována každou vteřinu což určuje efektiní dopad na systém.

<li>Výkon vaší systémové sběrnice. ISA sběrnice má maximální šířku pásma
8MB/sec a pokud k ní přistupuje procesor, tak sama sebe musí zpomalit na
efektivní rychlost 80286 běžící na 8MHz bez ohledu na to jak je procesor
ve skutečnosti rychlý. PCI sběrnice má mnohem větší efektivní šířku pásma
a menší dopad na procesor.

<li>Efektivita vaší síťové karty. Některé síťové adaptéry jsou prostě
efektivnější než jiné.
Starší <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rl&amp;sektion=4"
>rl(4)</a> karty založené na Realtek 8139 mají tendenci poskytovat relativně
ubohý výkon
(novější
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=re&amp;sektion=4"
>re(4)</a> karty založené na Realtek jsou mnohem lepší), zatímco Intel 21143 
(<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dc&amp;sektion=4"
>dc(4)</a>)
karty fungují velmi dobře. Pro maximální výkon pouvažujte nad použitím
gigabitových Ethernet karet i když se nebudete připojovat k gigabitovým 
sítím, protože mají mnohem pokročilejší buffering.

<li>Komplexnost a návrh vašich pravidel. Čím složitější jsou vaše pravidla,
tak tím pomalejší to je. Čím více paketů je filtrováno pomocí
<tt>keep state</tt> a <tt>quick</tt> pravidel, tím lepší budete mít výkon. 
Čím více řádků se musí pro každý paket vyhodnocovat, tím nižší výkon.

<li>Sotva stojí za zmínku: CPU a RAM.  Protože je PF proces běžící v jádru, 
tak nebude používat swap prostor. Takže pokud máte dostatek RAM, tak funguje,
pokud ne, tak to vyvolá panic z důvodu
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pool&amp;sektion=9"
>pool(9)</a> přetečení. Velké množství RAM není potřeba -- 32MB by mělo
být dostatečné pro skoro 30.000 stavů což je mnoho stavů pro malou kancelář
nebo domácnost. Většina uživatelů zjistí, že "recyklovaný" počítač je více
než dostatečný pro PF systém -- 300MHz systém je schopný zpracovat velké
množství paketů velmi rychle pokud má alespoň dobré NIC a dobré filtrovací
pravidla.
</ul>

<h3>Pomůže více procesorů?</h3>
PF použije pouze jeden procesor, takže více procesorů (nebo více jader)
NEZLEPŠÍ PF výkon.
<!--XXX outdated?
	this is probably talking about apic, which GENERIC now uses -->
OVŠEM v některých případech, použití SMP verze OpenBSD
(<tt>bsd.mp</tt>) místo <tt>bsd</tt> nabídne lepší výkon z důvodu
rozdílu v tom, jak je zpracováváno přerušení.
V mnoha případech dá <tt>bsd.mp</tt> menší výkon.
POKUD vídíte výkonové problémy, tak to zkuste. Většina uživatelů nikdy
nedosáhne žádný z limitů aby je toto muselo trápit.


<h3>Jsou dostupné nějáké benchmarky?</h3>
Lidé se často ptají na PF benchmarky. Jediný benchmark, který se počítá je
výkon <i>vašeho</i> systému ve <i>vašem</i> prostředí. Benchmark, který
nesimuluje vaše prostředí vám nepomůže správně naplánovat váš firewall 
systém. Nejlepší cestou je benchmarkovat PF pro vás samotné pod stejnýma, 
nebo co nejpodobnějšíma síťovýma podmínkama, které pak firewall zažije na
hardware, který bude používat.

<p>
PF je používán v některých velmi velkých aplikacích s vysokým množstvím
provozu a vývojaři jsou tzv. "power uživatelé" PF. Je tak šance, že bude
velmi dobře sloužit i pro vás.

<p>
[<a href="../logging.html">Předchozí: Logování</a>]
[<a href="index.html">Obsah</a>]
[<a href="../ftp.html">Další: Otázky okolo FTP</a>]

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../../../images/back.gif" border="0" alt="[back]"></a> 
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: perf.html,v 1.24 ]<br>
$Translation: perf.html,v 1.2 2012/11/07 13:31:10 bodie Exp $<br>
-->
$OpenBSD: perf.html,v 1.2 2012/11/08 08:49:02 ajacoutot Exp $
</small>

</body>
</html> 

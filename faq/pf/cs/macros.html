<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>PF: Seznamy a makra</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-2">
<meta name="resource-type" content="document">
<meta name="description"   content="the OpenBSD FAQ page">
<meta name="keywords"      content="openbsd,faq,pf">
<meta name="distribution"  content="global">
<meta name="copyright"     content="This document copyright 2002-2003 by OpenBSD.">
</head>

<body bgcolor="#ffffff" text="#000000">
<!-- Passes validator.w3.org, please keep it this way;
please, use a max of 72 chars per line -->

<img alt="[OpenBSD]" height=30 width=141 src="../../../images/smalltitle.gif">
<p>
[<a href="config.html">Pøedchozí: Konfigurace</a>]
[<a href="index.html">Obsah</a>]
[<a href="tables.html">Dále: Tabulky</a>]

<h1><font color="#e00000">PF: Seznamy a makra</font></h1>
<hr>

<h3>Obsah</h3>
<ul>
<li><a href="#lists">Seznamy</a>
<li><a href="#macros">Makra</a>
</ul>

<hr>

<a name="lists"></a>
<h2>Seznamy</h2>
Seznamy umo¾òují specifikovat vícenásobná podobná kriteria v jednom
pravidle. Napøíklad vícenásobné protokoly, èísla portù, adresy apod.
Tak¾e místo psaní zvlá¹tního pravidla pro ka¾dou IP adresu, která má být
blokována, mù¾e být napsáno jedno pravidlo specifikující IP adresy v
seznamu. Seznamy se definují vyjmenování polo¾ek mezi slo¾enými závorkami
<tt>{ }</tt>.

<p>
Kdy¾
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.3"
>pfctl(8)</a> narazí pøi zpracovávání sady pravidel na seznam, vytvoøí
více pravidel, jedno pro ka¾dou polo¾ku seznamu. Napøíklad:
<blockquote>
<tt>
block out on fxp0 from { 192.168.0.1, 10.5.32.6 } to any
</tt>
</blockquote>

<p>
je expandováno na:
<blockquote>
<tt>
block out on fxp0 from 192.168.0.1 to any<br>
block out on fxp0 from 10.5.32.6 to any
</tt>
</blockquote>

<p>
Je mo¾né specifikovat více seznamù v jednom pravidle a jejich pou¾ití
není omezeno pouze na pravidla filtru:
<blockquote>
<tt>
rdr on fxp0 proto tcp from any to any port { 22 80 } -&gt; \<br>
&nbsp;&nbsp;&nbsp;192.168.0.6<br>
block out on fxp0 proto { tcp udp } from { 192.168.0.1, \<br> 
&nbsp;&nbsp;&nbsp;10.5.32.6 } to any port { ssh telnet }
</tt>
</blockquote>

<p>
V¹imnìte si, ¾e èárky mezi polo¾kami seznamu jsou nepovinné.

<a name="macros"></a>
<h2>Makra</h2>
makra jsou u¾ivatelsky definované promìnné, které mohou obsahovat IP
adresy, èísla portù, názvy rozhraná apod. Makra mohou sní¾it slo¾itost
sady pravidel a také velmi usnadnit jejich správu.

<p>
Makro musí zaèínat písmenem a mù¾e obsahovat písmena, èísla a
podtr¾ítka. Název makra nemù¾e být rezervované slovo jako <tt>pass</tt>,
<tt>out</tt>, nebo <tt>queue</tt>.
<blockquote>
<tt>
ext_if = "fxp0"<br>
<br>
block in on $ext_if from any to any<br>
</tt>
</blockquote>

<p>
Tím je vytvoøeno makro pojmenované <tt>ext_if</tt>. Pøi odkazování se na
makro po jeho vytvoøení pøidáváme pøed jeho jméno znak <tt>$</tt>.

<p>
Makro mù¾e být také expandováno na seznam, jako tøeba:
<blockquote>
<tt>
friends = "{ 192.168.1.1, 10.0.2.5, 192.168.43.53 }"
</tt>
</blockquote>

<p>
Makra mohou být definována rekurzivnì. Proto¾e makra nejsou expandována
uvnitø uvozovek, musí být pou¾ita následující syntaxe:
<blockquote>
<tt>
host1      = "192.168.1.1"<br>
host2      = "192.168.1.2"<br>
all_hosts  = "{" $host1 $host2 "}"<br>
</tt>
</blockquote>

<p>
Makro <tt>$all_hosts</tt> bude nyní expandováno na 192.168.1.1, 192.168.1.2.

<p>
[<a href="config.html">Pøedchozí: Konfigurace</a>]
[<a href="index.html">Obsah</a>]
[<a href="tables.html">Dále: Tabulky</a>]

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../../../images/back.gif" border="0" alt="[back]"></a> 
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<small>
<br>
Originally [OpenBSD: macros.html,v 1.6 ]
<br>
$Translation: macros.html,v 1.3 2003/11/10 13:34:59 horacio Exp $
<br>
$OpenBSD: macros.html,v 1.3 2003/11/10 14:42:48 horacio Exp $
</small>

</body>
</html> 

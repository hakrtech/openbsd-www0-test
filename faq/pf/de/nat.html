<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>PF: Network Address Translation (NAT)</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="resource-type" content="document">
<meta name="description"   content="the OpenBSD FAQ page">
<meta name="keywords"      content="openbsd,faq,pf">
<meta name="distribution"  content="global">
</head>

<!--
Copyright (c) 2003, Nick Holland <nick@openbsd.org>
Copyright (c) 2003, 2004, Joel Knight <enabled@myrealbox.com>

Permission to use, copy, modify, and distribute this documentation for
any purpose with or without fee is hereby granted, provided that the
above copyright notice and this permission notice appear in all copies.

THE DOCUMENTATION IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL
WARRANTIES WITH REGARD TO THIS DOCUMENTATION INCLUDING ALL IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE
AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS DOCUMENTATION
-->

<body bgcolor="#ffffff" text="#000000">
<!-- Passes validator.w3.org, please keep it this way;
please, use a max of 72 chars per line -->

<a href="../../../de/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../../images/smalltitle.gif" border="0">
</a>
<p>
[<a href="filter.html">Zurück: Pakete filtern</a>]
[<a href="index.html">Inhalt</a>]
[<a href="rdr.html">Weiter: Verkehr-Umleitung (Port-Weiterleitung)</a>]

<p>
<h1><font color="#e00000">PF: Network Address Translation (NAT)</font></h1>

<hr>

<h3>Inhaltsverzeichnis</h3>
<ul>
<li><a href="#intro">Einführung</a>
<li><a href="#works">Wie NAT funktioniert</a>
<li><a href="#ipfwd">IP-Weiterleitung</a>
<li><a href="#config">NAT konfigurieren</a>
<li><a href="#binat">Bidirektionales Mapping (1:1 mapping)</a>
<li><a href="#except">Übersetzungsregel-Ausnahmen</a>
<li><a href="#status">Den NAT-Status abfragen</a>
</ul>

<hr>

<a name="intro"></a>
<h2>Einführung</h2>
Network Address Translation (NAT) ist ein Weg, um ein gesamtes
Netzwerk (oder Netzwerke) einer einzigen IP-Adresse zuzuweisen.
NAT ist notwendig, wenn du mehr Rechner besitzt, denen du
Internetzugriff ermöglichen möchtest, als dir dein Internetanbieter
IP-Adressen bereitgestellt hat. Im
<a href="http://www.geektools.com/rfc/rfc1631.txt">RFC 1631</a>
»The IP Network Address Translator (NAT)« wird NAT beschrieben.

<p>
NAT erlaubt dir den Vorteil der reservierten Adressblöcke zu
nutzen, wie sie in
<a href="http://www.geektools.com/rfc/rfc1918.txt">RFC 1918</a>
»Address Allocation for Private Internets« beschrieben werden.
Normalerweise wird dein internes Netzwerk so eingerichtet sein, dass
einer dieser Netzwerkblöcke verwendet wird. Diese sind:
<pre>
        10.0.0.0/8       (10.0.0.0 - 10.255.255.255)
        172.16.0.0/12    (172.16.0.0 - 172.31.255.255)
        192.168.0.0/16   (192.168.0.0 - 192.168.255.255)
</pre>

<p>
Ein OpenBSD-System, das NAT durchführt, muss mindestens zwei
Netzwerkadapter besitzen: einen in Richtung Internet und die anderen
in Richtung internes Netzwerk. NAT wird die Anfragen vom internen
Netzwerk so übersetzen, dass sie so wirken, als wenn sie alle vom
OpenBSD-NAT-System kommen würden.

<a name="works"></a>
<h2>Wie NAT funktioniert</h2>
<p>
Wenn ein Client im internen Netzwerk eine Maschine im Internet
kontaktiert, sendet er IP-Pakete, die für diese Maschine bestimmt
sind. Diese Pakete beinhalten alle Adressinformationen, die benötigt
werden, um am Ziel anzukommen. NAT befasst sich mit diesen
Informationen:
<ul>
<li>Quell-IP-Adresse (zum Beispiel 192.168.1.35)
<li>Quell-TCP- oder -UDP-Port (zum Beispiel 2132)
</ul>

<p>
Wenn das Paket durch das NAT-Gateway gesendet wird, wird es so
modifiziert, dass es wirkt, als wenn es vom NAT-Gateway geschickt
worden wäre. Das NAT-Gateway wird sich die Änderungen in der
Statustabelle merken, sodass es a) die Änderungen für die
Antwortpakete wieder rückgängig machen kann und b) sicherstellen kann,
dass die Antwortpakete durch die Firewall gelassen und nicht geblockt
werden. Zum Beispiel können die folgenden Änderungen durchgeführt
werden:
<ul>
<li>Quell-IP: ersetzt mit der externen Adresse des Gateways
(zum Beispiel 24.5.0.5)
<li>Quell-Port: ersetzt mit einem zufällig gewählten, unbenutzten Port
des Gateways (zum Beispiel 53136)
</ul>

<p>
Weder die interne Maschine noch der Internethost wissen etwas von
diesen Übersetzungsschritten. Für die interne Maschine ist das
NAT-System einfach ein Internetgateway. Für den Internethost
scheinen die Pakete vom NAT-System direkt zu kommen; er weiß noch
nicht einmal, dass die interne Workstation überhaupt existiert.

<p>
Wenn der Internethost auf die Pakete der internen Maschine antwortet,
werden sie an die externe IP des NAT-Gateways (24.5.0.5) und den
Übersetzungsport (53136) gerichtet sein. Das NAT-Gateway durchsucht dann
die Statustabelle, ob die Antwortpakete zu einer bereits erstellten
Verbindung gehören. Ein einzigartiger Treffer (basierend auf der
IP/Port-Kombination) wird gefunden, der PF mitteilt, dass die
Pakete zu einer Verbindung gehören, die von der internen Maschine
192.168.1.35 eröffnet wurde. PF wird dann die entgegengesetzten
Änderungen, die an den gesendeten Paketen gemacht worden sind,
vornehmen und die Antwortpakete an die interne Maschine weiterleiten.

<p>
Die Übersetzung von ICMP-Paketen findet auf eine ähnliche Art und Weise
statt, aber ohne der Quellport-Modifizierung.

<!-- legacy anchor; can eventually be removed -->
<a name="filter"></a>
<a name="enable"></a>
<a name="ipfwd"></a>
<h2>IP-Weiterleitung</h2>
<p>
Da NAT fast ausschließlich auf Routern und Netzwerkgateways verwendet
wird, ist es wahrscheinlich notwendig, IP-Weiterleitung zu aktivieren,
sodass die Pakete zwischen den Netzwerkinterfaces der OpenBSD-Maschine
ausgetauscht werden können. IP-Weiterleitung wird über den
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=3"
>sysctl(3)</a>-Mechanismus aktiviert:
<blockquote>
<tt>
# sysctl net.inet.ip.forwarding=1<br>
# sysctl net.inet6.ip6.forwarding=1 <i>(wenn IPv6 verwendet wird)</i>
</tt>
</blockquote>

<p>
Um diese Änderungen dauerhaft zu machen, sollten die folgenden
Zeilen in die
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl.conf&amp;sektion=5"
><tt>/etc/sysctl.conf</tt></a> eingetragen werden:
<blockquote>
<tt>
net.inet.ip.forwarding=1<br>
net.inet6.ip6.forwarding=1
</tt>
</blockquote>

<p>
Diese Zeilen sind zwar in der Standardinstallation bereits vorhanden,
aber auskommentiert (vor ihnen steht eine Raute <tt>#</tt>).
Entferne die <tt>#</tt> und speicher die Datei. IP-Weiterleitung
wird aktiviert, wenn die Maschine neustartet.

<a name="config"></a>
<h2>NAT konfigurieren</h2>
<font color="#ff0000">Anmerkung:</font> Diese Information ist für OpenBSD 4.7.
Die Konfiguration von NAT unterschied sich in früheren Versionen signifikant.
<p>

NAT wird durch einen optionalen Parameter <tt>nat-to</tt> zu einer abgehenden
<tt>pass</tt>-Regel spezifiziert.
Oft wird, statt des direkten Setzens in der <tt>pass</tt>-Regel, eine
<tt>match</tt>-Regel benutzt.
Wird ein Paket durch eine <tt>match</tt>-Regel selektiert, so werden die
Parameter dieser Regel (z.&nbsp;B. <tt>nat-to</tt>) erinnert und auf das Paket
angewandt, wenn eine auf das Paket passende <tt>pass</tt>-Regel erreicht wird.
Dies erlaubt die Verarbeitung einer ganzen Klasse von Paketen durch eine
einzige <tt>match</tt>-Regel, woraufhin spezifische Entscheidungen darüber, ob
der Verkehr zugelassen werden soll, mit Hilfe von <tt>block</tt> und
<tt>pass</tt>-Regeln getroffen werden können.
<p>
Das generelle Format der <tt>pf.conf</tt> sieht in etwa so aus:
<blockquote>
<tt>
match out on <i>interface</i> [<i>af</i>] \<br>
&nbsp;&nbsp;&nbsp;from <i>src_addr</i> to <i>dst_addr</i> \<br>
&nbsp;&nbsp;&nbsp;nat-to <i>ext_addr</i> [<i>pool_type</i>] [static-port]<br>
...<br>
pass out [log] on <i>interface</i> [<i>af</i>] [proto <i>protocol]</i> \<br>
&nbsp;&nbsp;&nbsp;from <i>ext_addr</i> [port <i>src_port</i>] \<br>
&nbsp;&nbsp;&nbsp;to <i>dst_addr</i> [port <i>dst_port</i>]
</tt>
</blockquote>

<dl>
<dt><tt>match</tt>
<dd>Wenn ein Paket einen Regelsatz durchläuft und in einer <tt>match</tt>-Regel
eine Entsprechung findet, so werden alle spezifizierten optionalen Parameter
der Regel für die spätere Nutzung erinnert (sie werden »sticky« gemacht).

<dt><tt>pass</tt>
<dd>Diese Regel erlaubt die Übertragung des Pakets.
Wurde das Paket vorher einer <tt>match</tt>-Regel mit Parametern zugeordnet, so
werden selbige auf das Paket angewandt.
<tt>pass</tt>-Regeln können ihre eigenen Parameter haben; diese haben Vorrang
über Parameter, die in <tt>match</tt>-Regeln spezifiziert wurden.

<dt><tt>out</tt>
<dd>Spezifiziert die Richtung des Paketflusses, auf welche diese Regel
zutrifft.
<tt>nat-to</tt> darf nur auf ausgehende Pakete angewandt werden.

<dt><tt>log</tt>
<dd>Zeichne zutreffende Pakete mittels
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pflogd&amp;sektion=8&amp;manpath=OpenBSD+5.2"
>pflogd(8)</a> auf.
Normalerweise wird nur das erste
zutreffende Paket aufgezeichnet. Damit alle Pakete protokolliert
werden verwende <tt>log (all)</tt>.

<dt><tt><i>interface</i></tt>
<dd>Der Name oder die Gruppe der Netzwerkschnittstelle, auf dem die Pakete
überstragen werden sollen.

<dt><tt><i>af</i></tt>
<dd>Die Adressfamilie: <tt>inet</tt> für IPv4 oder <tt>inet6</tt>
für IPv6. PF ist normalerweise in der Lage, das selbst anhand der
Quell/Ziel-Adresse(n) herauszufinden.

<dt><tt><i>protocol</i></tt>
<dd>Die Protokollfamilie (z.&nbsp;B. tcp, udp, icmp), deren Pakete erlaubt
werden sollen.
Wenn <i>src_port</i> oder <i>dst_port</i> spezifiziert sind, so <em>muss</em>
das Protokoll ebenfalls angegeben werden.

<dt><tt><i>src_addr</i></tt>
<dd>Die (interne) Quelladresse der Pakete, die übersetzt werden
sollen.
Die Quelladresse kann wie folgt angegeben werden:
<ul>
<li>Eine einzelne IPv4- oder IPv6-Adresse.
<li>Ein
<a href="http://public.pacbell.net/dedicated/cidr.html">CIDR</a>-Netzwerkblock.
<li>Ein »fully qualified domain name«, der per DNS aufgelöst werden
kann, wenn der Regelsatz geladen wird. Alle resultierenden IP-Adressen
werden in die Regel eingesetzt.
<li>Der Name oder die Gruppe eines Netzwerkinterfaces. Jegliche
IP-Adressen, die dem Interface zugeordnet worden sind, werden in die
Regel zur Ladezeit eingesetzt.
<li>Der Name eines Netzwerkinterfaces, gefolgt von
<tt>/<i>netmask</i></tt> (z.&nbsp;B. <tt>/24</tt>). Jede IP-Adresse auf
dem Interface wird mit der Netzmaske kombiniert, um einen
CIDR-Netzwerkblock zu bilden, der in die Regel eingesetzt wird.
<li>Der Name oder die Gruppe eines Netzwerkinterfaces, gefolgt von einem
dieser Modifizierer:
  <ul>
  <li><tt>:network</tt> - fügt den CIDR-Netzwerkblock ein (z.&nbsp;B.
  192.168.0.0/24)
  <li><tt>:broadcast</tt> - fügt die Netzwerkbroadcastadresse ein
  (z.&nbsp;B. 192.168.0.255)
  <li><tt>:peer</tt> - fügt die IP-Adresse eines Peers von einem
  Point-to-Point-Link ein
  </ul>
  <dl>
  <dd>Zusätzlich kann der <tt>:0</tt>-Modifizierer einem
  Interfacenamen/der Interfacegruppe oder einem der vorher genannten
  Modifizierer angehängt werden, um PF mitzuteilen, dass keine
  IP-Adressaliase mit eingefügt werden sollen. Diese Modifizierer können
  ebenfalls verwendet werden, wenn das Interface sich in Klammern
  befindet. Beispiel: <tt>fxp0:network:0</tt>
  </dl>
<li>Eine <a href="tables.html">Tabelle</a>.
<li>Irgendeine der zuvor genannten Möglichkeiten, aber mit dem <tt>!</tt>-
(»nicht«) Modifizierer.
<li>Ein Satz an Adressen unter Verwendung einer
<a href="macros.html#lists">Liste</a>.
<li>Das Schlüsselwort <tt>any</tt>, das für alle Adressen steht
</ul>

<dt><tt><i>src_port</i></tt>
<dd>Der Quellport im Layer-4-Paketheader. Ports können wie folgt
angegeben werden:
<ul>
<li>Eine Nummer zwischen 1 und 65535
<li>Ein gültiger Servicename aus
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=services&amp;sektion=5"
><tt>/etc/services</tt></a>
<li>Ein Satz an Ports unter Verwendung einer
<a href="macros.html#lists">Liste</a>
<li>Ein Bereich:
	<ul>
	<li><tt>!=</tt> (ungleich)
	<li><tt>&lt;</tt> (kleiner als)
	<li><tt>&gt;</tt> (größer als)
	<li><tt>&lt;=</tt> (kleiner oder gleich)
	<li><tt>&gt;=</tt> (größer oder gleich)
	<li><tt>&gt;&lt;</tt> (Bereich)
	<li><tt>&lt;&gt;</tt> (invertierter Bereich)
	<dl>
	<dd>Die letzten beiden sind Binäroperatoren (sie nehmen zwei
	Argumente) und fügen diese Argumente nicht mit in den Bereich
	ein.
	</dl>
	<li><tt>:</tt> (inklusiver Bereich)
	<dl>
	<dd>Der Operator für den inklusiven Bereich ist ebenfalls ein
	Binäroperator und fügt die Argumente mit in den Bereich ein.
	</dl>
	</ul>
</ul>
Die <tt>port</tt>-Option wird normalerweise nicht in <tt>nat</tt>-Regeln
verwendet, da das Ziel normalerweise ist, NAT auf den Verkehr
auszuüben - unabhängig davon, welche Ports verwendet werden.

<dt><tt><i>dst_addr</i></tt>
<dd>Die Zieladresse der Pakete, die übersetzt werden sollen. Die
Zieladresse wird genauso wie die Quelladresse angegeben.

<dt><tt><i>dst_port</i></tt>
<dd>Der Zielport im Layer-4-Paketheader. Dieser Port wird genauso
wie der Quellport angegeben.

<dt><tt><i>ext_addr</i></tt>
<dd>Die externe (Übersetzungs-)Adresse des NAT-Gateways, die die
übersetzten Pakete annehmen soll. Die externe Adresse kann wie folgt
angegeben werden:
<ul>
<li>Eine einzelne IPv4- oder IPv6-Adresse.
<li>Ein
<a href="http://public.pacbell.net/dedicated/cidr.html">CIDR</a>-Netzwerkblock.
<li>Ein »fully qualified domain name«, der per DNS aufgelöst werden
kann, wenn der Regelsatz geladen wird. Alle resultierenden IP-Adressen
werden in die Regel eingesetzt.
<li>Der Name oder die Gruppe der externen Netzwerkschnittstelle.
Alle IP-Adressen, die der Schnittstelle zugeordnet wurden, werden zur Ladezeit
in die Regel eingesetzt.
<li>Der Name des externen Netzwerkinterfaces in Klammern <tt>( )</tt>.
Dies teil PF mit, dass die Regel neugeladen werden soll, wenn die
IP-Adresse(n) des genannten Interfaces sich über DHCP oder dial-up
ändern. Somit mus der Regelsatz nicht immer neugeladen werden, wenn sich
die Adresse ändert.
<li>Der Name oder die Gruppe einer Netzwerkschnittstelle, gefolgt von einem
dieser Modifikatoren:
  <ul>
  <li><tt>:network</tt> - fügt den CIDR-Netzwerkblock ein (z.&nbsp;B.
  192.168.0.0/24)
  <li><tt>:peer</tt> - fügt die IP-Adresse eines Peers von einem
  Point-to-Point-Link ein
  </ul>
  <dl>
  <dd>Zusätzlich kann der Modifikator <tt>:0</tt> entweder an einen
  Schnittstellen- oder Gruppennamen oder aber an einen der oben genannten
  Modifikatoren angehängt werden, um PF mitzuteilen, dass es keinerlei
  IP-Adressen-Alias mit einfügen soll.
  Diese Modifikatoren können ebenfalls verwendet werden, wenn die Schnittstelle
  sich in Klammern befindet.
  Beispiel: <tt>fxp0:network:0</tt>.
  </dl>
<li>Ein Satz an Adressen unter Verwendung einer
<a href="macros.html#lists">Liste</a>.
</ul>

<dt><tt><i>pool_type</i></tt>
<dd>Gibt den Typ des <a href="pools.html">Adresspools</a> an, der
für die Übersetzung verwendet werden soll.

<dt><tt>static-port</tt>
<dd>Teilt PF mit, den Quellport in TCP- und UDP-Paketen nicht zu
verändern.

</dl>

<p>
Dies würde in der einfachsten Form zu Zeilen ähnlich den folgenden führen:
<blockquote>
<tt>
match out on tl0 from 192.168.1.0/24 to any nat-to 24.5.0.5<br>
pass on tl0 from 192.168.1.0/24 to any
</tt>
</blockquote>
oder du benutzt einfach
<blockquote>
<tt>
pass out on tl0 from 192.168.1.0/24 to any nat-to 24.5.0.5
</tt>
</blockquote>


<p>
Diese Regel besagt, dass NAT auf dem <tt>tl0</tt>-Interface für
alle Pakete ausgeführt werden soll, die von 192.168.1.0./24 aus kommen,
und sie mit der Quell-IP-Adresse von 24.5.0.5 übersetzt werden sollen.

<p>
Während die vorher genannte Regel korrekt ist, ist es keine empfohlene
Form. Die Verwaltung könnte schwierig sein, da jegliche Änderung an
den internen oder externen Netzwerknummern eine Änderung der Zeile
zur Folge hätte. Vergleiche sie stattdessen mit dieser einfacher zu
verwaltenen Zeile (<tt>tl0</tt> ist extern, <tt>dc0</tt> intern):
<blockquote>
<tt>
pass out on tl0 from dc0:network to any nat-to tl0
</tt>
</blockquote>

<p>
Der Vorteil sollte recht klar sein: du kannst die IP-Adressen von
einem der Interfaces ändern, ohne die Regeln ändern zu müssen.

<p>
Wenn ein Interfacename für die Übersetzungsadresse wie zuvor
angegeben wird, wird die IP-Adresse zur <i>Lade</i>zeit von pf.conf
ermittelt - nicht während der Verwendung! Wenn du DHCP verwendest, um
dein externes Interface zu konfigurieren, kann dies zu einem Problem
werden.  Wenn deine zugewiesene IP-Adresse sich ändert, wird NAT
weiterhin die hinausgehenden Pakete mit der alten IP-Adresse übersetzen.
Dies wird dazu führen, dass ausgehende Verbindungen nicht mehr
funktionieren werden. Um dies zu umgehen, kannst du PF sagen, dass die
Übersetzungsadresse automatisch aktualisiert werden soll, indem
Klammern um den Interfacenamen herum gesetzt werden:
<blockquote>
<tt>
pass out on tl0 from dc0:network to any nat-to (tl0)
</tt>
</blockquote>

<p>
Diese Methode funktioniert für Übersetzungen von IPv4- und
IPv6-Adressen.

<a name="binat"></a>
<h2>Bidirektionale Abbildung (1:1 Abbildung)</h2>
Eine bidirektionales Abbildung kann durch die Verwendung des Parameters
<tt>binat-to</tt> erzielt werden.
Eine <tt>binat-to</tt>-Regel etabliert eine Eins-zu-eins-Umsetzung zwischen
einer internen IP-Adresse und einer externen Adresse.
Dies kann zum Beispiel nützlich sein, um einen Webserver im internen Netzwerk
mit seiner eigenen externen IP-Adresse auszustatten.
Verbindungen aus dem Internet zu der externen Adresse werden zu der internen
Adresse übersetzt werden, und Verbindungen des Webservers (wie DNS-Anfragen)
werden auf die externe Adresse übersetzt.
TCP- und UDP-Ports werden niemals mit <tt>binat-to</tt>-Regeln modifiziert,
da sie von <tt>nat</tt>-Regeln erfaßt werden.

<p>
Beispiel:
<blockquote>
<tt>
web_serv_int = "192.168.1.100"<br>
web_serv_ext = "24.5.0.6"<br>
<br>
pass on tl0 from $web_serv_int to any binat-to $web_serv_ext<br>
</tt>
</blockquote>

<a name="except"></a>
<h2>Übersetzungsregel-Ausnahmen</h2>

Wenn du den meisten Verkehr Übersetzen musst, aber für einige Fälle Ausnahmen
benötigst, so stelle sicher das die Ausnahmen von Filterregeln behandelt
werden, die keinen nat-to-Parameter enthalten.
Zum Beispiel, wenn obiges NAT-Beispiel modifiziert werden würde, um so
auszusehen:

<blockquote>
<tt>
pass out on tl0 from 192.168.1.0/24 to any nat-to 24.2.74.79<br>
pass out on tl0 from 192.168.1.208 to any<br>
</tt>
</blockquote>

<p>
Dann würde das gesamte 192.168.1.0/24-Netzwerk alle Pakete auf die externe
Adresse 24.2.74.79 übersetzt bekommen, mit Ausnahme von 192.168.1.208.

<a name="status"></a>
<h2>Den NAT-Status abfragen</h2>
Um die aktiven NAT-Übersetzungen zu betrachten, wird
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+5.2"
>pfctl(8)</a> mit der Option <tt>-s state</tt> verwendet. Diese Option
wird alle momentanen NAT-Sitzungen auflisten:

<pre>
   # pfctl -s state
   fxp0 tcp 192.168.1.35:2132 (24.5.0.5:53136) -&gt; 65.42.33.245:22 TIME_WAIT:TIME_WAIT
   fxp0 udp 192.168.1.35:2491 (24.5.0.5:60527) -&gt; 24.2.68.33:53   MULTIPLE:SINGLE
</pre>

<p>
Erklärungen (nur die erste Zeile):

<dl>
<dt>fxp0
<dd>Gibt das Interface an, an welches der Status gebunden ist. Das Wort
<tt>self</tt> wird erscheinen, wenn der Status
<a href="options.html#state-policy">»<tt>floating«</tt>«</a> ist.
</dl>

<dl>
<dt>TCP
<dd>Das Protokoll, das von der Verbindung genutzt wird.
</dl>

<dl>
<dt>192.168.1.35:2132
<dd>Die IP-Adresse (192.168.1.35) der Maschine im internen Netzwerk.
Der Quellport (2132) wird nach der Adresse angezeigt. Dies ist ebenfalls
die Adresse, die im IP-Header ersetzt wird.
</dl>

<dl>
<dt>24.5.0.5:53136
<dd>Die IP-Adresse (24.5.0.5) und Port (53136) vom Gateway, mit denen
die Pakete übersetzt werden.
</dl>

<dl>
<dt>65.42.33.245:22
<dd>Die IP-Adresse (65.42.33.245) und der Port (22), mit denen die
interne Maschine verbunden ist.
</dl>

<dl>

<dt>TIME_WAIT:TIME_WAIT
<dd>Dies gibt an, was PF glaubt, zu welchem Status die TCP-Verbindung
gehört.
</dl>

<p>
[<a href="filter.html">Zurück: Pakete filtern</a>]
[<a href="index.html">Inhalt</a>]
[<a href="rdr.html">Weiter: Verkehr-Umleitung (Port-Weiterleitung)</a>]

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../../../images/back.gif" border="0" alt="[zurück]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: nat.html,v 1.40 ]<br>
$Translation: nat.html,v 1.29 2012/11/01 20:43:18 steffen Exp $<br>
-->
$OpenBSD: nat.html,v 1.30 2012/11/02 07:24:05 ajacoutot Exp $
</small>

</body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>PF: Getting Started</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=big5">
<meta name="resource-type" content="document">
<meta name="description"   content="the OpenBSD FAQ page">
<meta name="keywords"      content="openbsd,faq,pf">
<meta name="distribution"  content="global">
</head>

<!--
Copyright (c) 2003, Nick Holland <nick@openbsd.org>
Copyright (c) 2003, 2004, Joel Knight <enabled@myrealbox.com>

Permission to use, copy, modify, and distribute this documentation for
any purpose with or without fee is hereby granted, provided that the
above copyright notice and this permission notice appear in all copies.

THE DOCUMENTATION IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL
WARRANTIES WITH REGARD TO THIS DOCUMENTATION INCLUDING ALL IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE
AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS DOCUMENTATION
-->

<body bgcolor="#ffffff" text="#000000">
<!-- Passes validator.w3.org, please keep it this way;
please, use a max of 72 chars per line -->

<img alt="[OpenBSD]" height=30 width=141 src="../../../images/smalltitle.gif">
<p>
[<a href="index.html">內容</a>]
[<a href="macros.html">下一頁: 列表和巨集</a>]

<p>
<h1><font color="#e00000">PF: 開始使用</font></h1>

<hr>

<h3>目錄</h3>
<ul>
<li><a href="#activate">啟用</a>
<li><a href="#config">設定</a>
<li><a href="#control">控制</a>
</ul>

<hr>

<a name="activate"></a>
<h2>啟用</h2>
為了在開機時就啟用 PF 並讀取 PF 設定檔，我們需要編輯
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf&amp;sektion=8&amp;manpath=OpenBSD+3.5"
><tt>/etc/rc.conf</tt></a> 檔案的 pf=NO 那一列，並修改為:

<blockquote>
<tt>
pf=YES
</tt>
</blockquote>

<p>
重新開機後就能啟用 PF。

<p>
你也可以使用 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.5"
>pfctl(8)</a> 程式來啟用或關閉 PF 功能:

<blockquote>
<tt>
# pfctl -e<br>
# pfctl -d
</tt>
</blockquote>

<p>
上面那一列是啟用，下面那一列是關閉 PF。
注意這個動作只是啟用或關閉 PF，事實上並未載入規則。不論在啟用 PF 之前或之後執行
，你都必須另外下指令載入規則。

<a name="config"></a>
<h2>設定</h2>
<p>
在開機時，
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc&amp;sektion=8&amp;manpath=OpenBSD+3.5"
>rc scripts</a> 會載入 PF，接著 PF 會從
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+3.5"
><tt>/etc/pf.conf</tt></a> 讀取設定規則。
注意當系統 rc script 載入預設的
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+3.5"
><tt>/etc/pf.conf</tt></a> 設定檔時，是經由
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.5"
>pfctl(8)</a> 載入並解譯 <tt>/etc/pf.conf</tt> 純文字檔後，再加入
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.5"
>pf(4)</a> 中。對某些應用程式而言，其他規則可能是在開機之後由其他的檔案載入。
PF 如同任何設計完善的 Unix 應用程式，提供極佳的彈性。

<p>
<tt>pf.conf</tt> 檔案共有七個部份:
<ul>
<li><b><a href="macros.html">巨集:</a></b> 包含 IP 位址、介面名稱等自定變數。
<li><b><a href="../tables.html">表格:</a></b> 包含 IP 位址列表的表格。
<li><b><a href="../options.html">選項:</a></b> 各種控制 PF 運作的選項。
<li><b><a href="../scrub.html">清理:</a></b> 正規化與重組分段封包等再處理。
<li><b><a href="../queueing.html">佇列:</a></b> 提供頻寬控制與封包優先順序。
<li><b><a href="../nat.html">轉譯:</a></b> 控制網路位址轉譯與
<a href="../rdr.html">封包轉向</a>.
<li><b><a href="../filter.html">過濾規則:</a></b> 當封包通過任何網路介面時，
允許選擇性的過濾或阻擋封包。
</ul>

<p>
設定檔中除了巨集與表格外，每個段落都會依照他們在設定檔的順序呈現，
但並非任何應用都必須包括所有段落。

<p>
空白列會被忽略，以 <tt>#</tt> 為起始字元的列則視為註解。

<a name="control"></a>
<h2>控制</h2>
開機後，PF 操作可以透過
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.5"
>pfctl(8)</a> 程式加以管理。以下是指令範例:

<pre>
     # pfctl -f /etc/pf.conf     <i>載入 pf.conf 檔案</i>
     # pfctl -nf /etc/pf.conf    <i>只解析語法而不載入檔案</i>
     # pfctl -Nf /etc/pf.conf    <i>只載入檔案中的 NAT 規則</i>
     # pfctl -Rf /etc/pf.conf    <i>只載入檔案中的過濾規則</i>

     # pfctl -sn                 <i>列出目前的 NAT 規則</i> 
     # pfctl -sr                 <i>列出目前的過濾規則</i>
     # pfctl -ss                 <i>列出目前的狀態表格</i>
     # pfctl -si                 <i>列出過濾狀態與次數頻率</i>
     # pfctl -sa                 <i>列出所有資料</i>
</pre>

<p>
如果需要完整的指令列表，請參考
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.5"
>pfctl(8) man 手冊</a>。

<p>
[<a href="index.html">內容</a>]
[<a href="macros.html">下一頁: 列表與巨集</a>]

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../../../images/back.gif" border="0" alt="[back]"></a> 
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
Originally [OpenBSD: config.html,v 1.12 ]<br>
$Translation: config.html,v 1.2 2004/09/17 14:34:47 sjhuang Exp $<br>
$OpenBSD: config.html,v 1.2 2004/09/17 15:04:47 jufi Exp $
</small>

</body>
</html> 

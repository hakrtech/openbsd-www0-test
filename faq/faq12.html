<html>
<head>
<title>OpenBSD FAQ: 12.0 - Performance Tuning</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 1998,1999 by OpenBSD.">
</head>

<body bgcolor= "#ffffff" text= "#000000" link= "#23238E">
<p>
<font color= "#0000e0">
<a href= "index.html">[Back to Main Index]</a>
<a href= "faq24.html">[To Section 11.0 - OpenBSD 2.4 Specific Information]</a>
</font>
</p>

<p>
<h1>12.0 - Performance Tuning</h1>
<hr>
</p>

<p>
<a name= "12.1">
<h2>12.1 - Networking</h2>
</a>
</p>

<p>
If you run a busy gateway or firewall, you should make sure you prevent memory
starvation.
</p>

<p>
Add these to your kernel config and compile a custom kernel:
</p>

<p>
<ul>
<li>option "NMBCLUSTERS=8192"</li>
<li>option "MAX_KMAP=120"</li>
<li>option "MAX_KMAPENT=6000"</li>
<li>option "NKMEMCLUSTERS=8192"</li>
</ul>
</p>

<p>
<a name= "12.2">
<h2>12.2 - Disk I/O</h2>
</a>
</p>

<p>
Disk I/O is, on any system, a main factor in the overall speed of the
computer. And is also a part of any system that needs protected the most.
OpenBSD has a couple of options you can choose from when it comes to disk
fault tolerence.
</p>

<p>
The first option is the use of <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ccd&apropos=0&sektion=4&format=html">ccd(4)</a>.
CCD(4) is what is called a Concatenated Disk Driver. This basically allows
you to combine one or more disks into what is called a "virtual disk" As
in, the system see's it as one disk, and uses it as such. This concept is
similar to that of LVM, which is found in many commercial flavors.
To start setup of CCD, you need to add support for it in your kernel. A
line such as:
</p>

<p>
<pre>
<strong>pseudo-device   ccd     4       # concatenated disk devices</strong>
</pre>
</p>

<p>
would allow for 4 CCD devices. Which happens to be the MAX number of CCD
devices allowed.
</p>
<p>
<strong>NOTE: Support is in the GENERIC Kernel.</strong>
</p>
<p>
One of the many things you can do through the use of CCD is provide for
"striping", which can definately give a performance boost.
</p>
<p>
Another solution is <a href= "http://www.openbsd.org/cgi-bin/man.cgi?query=raid&apropos=0&sektion=4&format=html">raid(4)</a>
which will have you use <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=raidctl&apropos=0&sektion=8&format=html">raidctl(8)</a>.
to control your raid devices. Through the use of RAIDframe devices you can
achieve both striping and mirroring. OpenBSD has support for RAID levels
of 0, 1, 4, and 5. With raid, as with CCD, support must be in the KERNEL.
</p>

<p>
<pre>
<strong>pseudo-device   raid   4       # RAIDframe disk device</strong>
</pre>
</p>
<p>
As with the CCD kernel support, Support is in the GENERIC kernel.
</p>
<p>
For fileservers with enough memory, you can increase BUFCACHEPERCENT. To
do this you should add a line to your kernel configuration like this:
</p>

<p>
<strong>option	BUFCACHEPERCENT=50</strong>
</p>
<p>
Or whatever number you want it set too.
</p>
<p>
Another tool that can be used to speed up your is softupdates. You can
read more about these at the <a href="faq4.html#4.9">softupdates FAQ</a> entry.
</p>

<p>
<font color= "#0000e0">
<a href= "index.html">[Back to Main Index]</a>
<a href= "faq24.html">[To Section 11.0 - OpenBSD 2.4 Specific Information]</a>
</font>
</p>

<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../images/back.gif" border= "0" alt="[back]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>$OpenBSD: faq12.html,v 1.4 1999/06/18 21:43:04 ericj Exp $</small>
</p>
</body>
</html>


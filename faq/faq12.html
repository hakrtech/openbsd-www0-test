<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>12 - Platform-Specific Questions</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 2003 by OpenBSD.">
</head>

<body bgcolor= "#ffffff" text= "#000000">

<img alt="[OpenBSD]" height=30 width=141 src="../images/smalltitle.gif">
<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
<a href= "faq11.html">[To Section 11 - Performance Tuning]</a>
<a href= "faq14.html">[To Section 14 - Disk Setup]</a>
</font>

<h1><font color="#e00000">12 - Platform-Specific Questions</font></h1>
<hr>

<p>
<h3>Table of Contents</h3>
<ul>
<li><a href="#General">12.1 - General hardware notes</a>
  <ul>
  <li><a href="#GenPCI">12.1.1 - PCI</a>
  <li><a href="#GenISA">12.1.2 - ISA</a>
  </ul>
<li><a href="#alpha">12.2 - DEC Alpha </a>
<li><a href="#hp300">12.3 - HP 9000 series 300, 400</a>
<li><a href="#hppa" >12.4 - HP Precision Architecture (PA-RISC)</a>
<li><a href="#i386" >12.5 - i386</a>
  <ul>
  <li><a href="#ISANIC">12.5.1 - ISA NICs</a>
  <li><a href="#FPU">12.5.2 - OpenBSD won't work on my 80386/80386SX/80486SX system</a>
  <li><a href="#IrqShare">12.5.3 - My dmesg shows multiple devices sharing
       the same interrupt</a>
  </ul>
<li><a href="#mac68k">12.6 - Mac68k</a>
  <ul>
  <li><a href="#mac68kSupport">12.6.1 - My Mac68k system doesn't seem to
       work</a>
  <li><a href="#mac68kTime">12.6.2 - Why is my Mac68k losing so much time?</a>
  <li><a href="#mac68k2disks">12.6.3 - My Mac68k system won't work with two
       disks</a>
  <li><a href="#mac68kInstCrash">12.6.4 - The installer crashed during
       install</a>
  </ul>
<li><a href="#macppc">12.7 - MacPPC</a>
<li><a href="#mvme68k">12.8 - MVME68k</a>
<li><a href="#sparc">12.9 - SPARC</a>
<li><a href="#sparc64">12.10 - UltraSPARC</a>
  <ul>
  <li><a href="#sparc64Floppy">12.10.1 - My UltraSPARC won't boot from the
       floppy image</a>
  </ul>
<li><a href="#vax">12.11 - DEC VAX</a>
</ul>

<hr>

<a name="General"></a>
<h2>12.1 - General hardware notes</h2>

<a name="GenPCI"></a>
<h3>12.1.1 - PCI devices</h3>

<ul>
<li>PCI devices are mostly self-configuring -- the computer and OS will
allocate resources to the cards as required.

<li>Interrupts can be shared on the PCI bus.  Not only can they be, the
system will often perform better when the IRQs are shared, especially on 
i386 systems.

<li>There are several different PCI bus standards.
You will occasionally find a PCI2.2 specification card that will just
not work in a PCI2.1 specification system.
Also, many cards with on-board bridges (such as, multi-port network
cards) will not work well in older systems.

<li>The PCI bus supports two levels of signaling, 3.3v and 5v.
Cards that work with 3.3v signaling have a second notch cut in their
PCI connector.
Most PCI cards use 5v signaling, which is used by most computers.
The Soekris single-board computers (Net45x1 and Net4801) are
commonly-encountered computers that only support 3.3v signaling.

</ul>

<a name="GenISA"></a>
<h3>12.1.2 - ISA devices</h3>
<ul>
<li>ISA devices cannot share resources, and in general, must be
manually configured to settings that don't conflict with other
devices in the system.

<li>Some ISA devices are "Plug and Play" 
(<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=isapnp&amp;sektion=4">isapnp(4)</a>)
-- if you have any problem with these devices, though, verify their
configuration in your
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dmesg&amp;sektion=8">dmesg(8)</a>, ISAPnP doesn't always work as desired.

<li>In general, if you have a choice, most people are best advised to avoid
ISA cards in favor of PCI.  ISA cards are more difficult to configure and 
have a much greater negative impact on the system's performance.
</ul>



<p> <a name="alpha"></a>
<h2>12.2 - DEC Alpha</h2> [nothing yet]

<a name="hp300"></a>
<h2>12.3 - HP300</h2>
[nothing yet]

<a name="hppa"></a>
<h2>12.4 - HPPA</h2>
[nothing yet]

<a name="i386"></a>
<h2>12.5 - i386</h2>

<a name="ISANIC"></a>
<h3>12.5.1 - ISA NICs</h3>
As OpenBSD runs well on older hardware, users often will end up using
ISA NICs on OpenBSD systems.
ISA hardware requires much more configuration and understanding than
does PCI hardware.
In general, you can't just stuff the card in the computer and expect it
to magically work.
In many machines, if your ISA device is not in a "Plug 'n' Play" (PNP)
mode, you must reserve the resources the card uses in the system's BIOS.

<h4>3Com 3C509B ep(4)</h4>
This is an excellent performing ISA NIC, supported by the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ep&amp;sektion=4">ep(4)</a>
driver.
The 'B' version can be distinguished from the non-B version by labeling
on the card and by the larger "main" chip on the board (approximately
2.5cm on a side for the 'B' version, vs. 2cm on a side on the older
version), and will provide better performance on a loaded or dual
network card system.
The 3C509B ships configured in a PNP mode, which unfortunately does not
comply with standards, and causes problems in OpenBSD's
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=isapnp&amp;sektion=4"
>isapnp(4)</a> support.
The adapter is picked up first as a non-PNP device, then again after the
PNP support comes on-line, resulting in an extra NIC showing in the
dmesg.
This may work fine, or it may cause other problems.  It is highly
recommended that the 3C509B cards have PNP mode disabled and manually
configured to non-conflicting settings using the 3Com DOS-based
configuration utilities before configuration.

<p>
The ep(4) driver will pick the cards up at any hardware combination that 
does not conflict with other devices in the system. 

<p>
If you have multiple 3C509 cards in your system, it is recommended that
you label the cards' spine with the MAC address, and use the dmesg to 
identify which is which. 

<p>
Note that the 3C509, the 3C905 and the 3C590 are often confused.
The 3C509 is a 10Mbps ISA card, the 3C905 and 3C590 are PCI
cards.


<p>
<h4>NE2000</h4>
The original NE2000 NIC was developed in the mid-1980s by Novell.
Since then, many manufacturers have produced cards that are very
similar, which are generally called NE2000-compatibles, or clones.
Performance of these clone cards varies greatly.
While some older NE2000-compatible cards performed very well, many of
the currently-available ones perform poorly.
NE2000-compatibles are supported by the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ne&amp;sektion=4">ne(4)</a>
driver in OpenBSD.

<p>
OpenBSD will handle some ISAPNP-capable NE2000-compatible cards well if
the ISAPNP mode is turned on.
Other cards will have to be set using either jumpers or a DOS-based
configuration utility.
Unfortunately, as the original NE2000 cards did not have software
configuration or ISAPNP support, there are no standards for this -- you
need the utility that will have been originally supplied with your
specific card.
This can often be difficult to obtain.

<p>
The ne(4) driver supports three configurations of the ISA NE2000 card
in the GENERIC OpenBSD kernel:
<pre>
     ne0:  port 0x240 irq 9
     ne1:  port 0x300 irq 10
     ne2:  port 0x280 irq 9
</pre>
If these settings are not acceptable, you can adjust them using
<a href="faq5.html#BootConfig">User Kernel Configuration (UKC)</a> or
by <a href="faq5.html">building a customized kernel</a>.

<p>
Note that the ne(4) driver is fairly "dumb" -- only the I/O port is
probed, if any of the above I/O addresses is detected, the corresponding 
IRQ is <i>assumed</i>.
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dmesg&amp;sektion=8">dmesg(8)</a>
will not reflect the actual IRQ of the adapter in the case of ISA ne(4)
drivers.
If this is not the actual IRQ your card is set to, it will not work.

<p>
Note that there are non-ISA cards that use the ne(4) driver -- PCI and
PCMCIA ne(4) cards exist. These notes do not apply to them, these
devices are auto-configuring.

<a name="80386"></a>
<a name="FPU"></a>
<h3>12.5.2 - OpenBSD won't work on my 80386/80386SX/80486SX system!</h3>
<h4>80386sx</h4>
The 80386sx has a maximum addressing range of 16M, which is at the very
low end of OpenBSD/i386's support.
Most 80386sx systems can't support more than 8M of RAM, which places
them in the "For Experts Only" category, as some non-trivial steps and a
second computer are required to get going.
Also, see the next section:

<h4>80386</h4>

OpenBSD 3.4 will run on an 80386 or 80386sx system IF it has a 80387 
or 80387sx hardware math coprocessor (Floating Point Unit, or FPU).
Unfortunately, these FPUs were not common, so many 80386 systems
will not have them.
OpenBSD will not run without the FPU on the i386 platform.
Again, be aware that this is a very small amount of processor for a
crypto-intensive operating system like OpenBSD.
You aren't likely to be happy with the performance of such a machine for
general use.

<h4>80486SX</h4>
The 80486SX chip was a "low-cost" version of the 80486, which lacked the
hardware floating point support (like the 80386) OpenBSD 3.4 requires.
Fortunately, full 80486DX chips are fairly available, and is an easy
upgrade in most systems.

<a name="IrqShare"></a>
<h3>12.5.3 - My dmesg shows multiple devices sharing the same Interrupt
(IRQ)!</h3>
This is entirely acceptable, and in fact, even desirable for PCI
devices.
This is a design feature of the PCI bus.
Some people will say that sharing interrupt requests (IRQs) is bad,
however they are either confusing the situation with the ISA bus (where
IRQ sharing is not permitted), or past experience with broken hardware
or software.

<p>
ISA devices can not share IRQs.  If you find ISA devices sharing IRQs,
you must correct this problem.

<a name="mac68k"></a>
<h2>12.6 - Mac68k</h2>

<a name="mac68kSupport"></a>
<h3>12.6.1 - My Mac68k system doesn't seem to work!</h3>
Unfortunately, we have a small number of different Mac68k machines in
the hands of OpenBSD developers, and thus, only a few are known to work 
well at this moment.
If you can help restore support to currently broken systems, your code
would be welcome!

<a name= "mac68kTime"></a>
<h3>12.6.2 - Why is my Mac68k losing so much time?</h3>
This is caused by a hardware bug. OpenBSD uses clock interrupts to keep
track of the current time, but these interrupts have the lowest priority
in the <a href="../mac68k.html">Mac68k</a> architecture.
So, under heavy load, (such as disk or network activity) clock
interrupts will be lost and the Unix clock will not advance as it
should.
<a href="../macppc.html">MacPPC</a> systems do not have this
issue.

<p>
MacOS gets around the time problem by always reading the hardware clock.
OpenBSD only reads the hardware clock at boot time and thereafter
ignores it. You may notice that, at shutdown, the kernel is not
confident enough to write the Unix time back into the hardware clock
because this time loss problem is well known.

<p>
A simple solution is to run rdate(8) on a
regular basis, by having a crontab entry for it.
Another good place to launch
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rdate&amp;sektion=8">rdate
(8)</a>
is in your <i>/etc/ppp/ppp.linkup</i> file if you are not permanently
connected and are a PPP user.

<p>
See also:
<a href="http://www.macbsd.com/macbsd/macbsd-docs/faq/faq-3.html#ss3.17">
http://www.macbsd.com/macbsd/macbsd-docs/faq/faq-3.html#ss3.17</a>


<a name="mac68k2disks"></a>
<h3>12.6.3 - My Mac68k system won't work with two disks</h3>
Yes, unfortunately, this is a known problem.
This usually shows itself by crashes shortly after the system goes
multi-user, and the crash may not be obviously related to the disk
system.
The solution is to only use one drive on your Mac68k systems.  A proper
fix would be welcomed!

<a name="mac68kInstCrash"></a>
<h3>12.6.4 - The installer crashed during install</h3>
The Mac68k installer running on MacOS will not install files to a
"large" partition.  If any partition you are installing to is more than
around 500M in size, you can expect the following strange error:
<pre>
    Error on SCSIRead(), #5
    pos = 0, i = 22, fs = /
    alloccgblk: can't find blk in cyl
</pre>
The solution to this is to first install a minimal system in a "small" 
root partition, then boot OpenBSD and relocate things as desired.

<p>
So, let's say you want a 200M / partition. 
Create the root partition, create the other partitions you
want, newfs them all using the MacOS utilities. 
Install etc34.tgz and base34.tgz to this / partition.

<p>
Mount your other partitions on a temporary mount point, and copy over
the directories you want to them, as demonstrated 
<a href="faq10.html#DupFS">here</a>.

<p>
Now, modify /etc/fstab, reboot, and unpack the rest of the *.tgz files as 
documented
<a href="faq4.html#AddFileSet">here</a>.

<p>
Following this process, any size can be achieved for the non-root
partitions.


<a name="macppc"></a>
<h2>12.7 - MacPPC</h2>
[nothing yet]

<a name="mvme68k"></a>
<h2>12.8 - MVME68k</h2>
[nothing yet]

<a name="sparc"></a>
<h2>12.9 - SPARC</h2>
[nothing yet]

<a name="sparc64"></a>
<h2>12.10 - UltraSPARC (sparc64)</h2>

<a name="sparc64Floppy"></a>
<h3>12.10.1 - My UltraSPARC won't boot from the floppy image</h3>
Only the Ultra 1/1e and Ultra 2 can boot <i>any</i> OS from floppy disk.
Use CD-ROM, Miniroot, or network boot to do your installation instead.



<a name="vax"></a>
<h2>12.11 - DEC VAX</h2>
[nothing yet]



<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
<a href= "faq11.html">[To Section 11 - Performance Tuning]</a>
<a href= "faq14.html">[To Section 14 - Disk Setup]</a>
</font>

<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../images/back.gif" border= "0" alt="[back]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>$OpenBSD: faq12.html,v 1.45 2003/10/30 22:43:42 nick Exp $</small>
</body>
</html>

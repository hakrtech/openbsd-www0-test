<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>跟踪 -current</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 2005-2008 by OpenBSD">
</head>

<body bgcolor= "#ffffff" text= "#000000">
<a href="../../zh/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif" border="0">
</a>
<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ 索引]</a>
</font>

<p>

<h1><font color="#e00000">跟踪 <i>-current</i></font></h1>
<hr>

<h3>目录</h3>
<p>
<ul>
<li><a href="#Intro">介绍</a>
<!-- Oldest on top... -->
<li><a href="#20080323">2008/03/23 - cwm 配置和命令行参数已经改变</a>
<li><a href="#20080328">2008/03/28 - landisk 启用共享库</a>
<li><a href="#20080421">2008/04/21 - rtadvd(8) 的命令行参数已经改变</a>
<li><a href="#20080508">2008/05/08 - file(1) 已经更新，需要新的 /etc/magic</a>
<li><a href="#20080522">2008/05/22 - spamd(8) 同步模式协议版本已经更新</a>
<li><a href="#20080606">2008/06/06 - httpd(8) 手册移动了位置</a>
<li><a href="#20080607">2008/06/07 - 不再支持 dhcpd.interfaces</a>
<li><a href="#20080609">2008/06/09 - nmeaattach(8) 被删除</a>
<li><a href="#20080609b">2008/06/09 - 增加名为 _rtadvd 的用户和组</a>
<li><a href="#20080610">2008/06/10 - 地址计数器不再是 pf(4) 表的默认选项</a>
<li><a href="#20080613">2008/06/13 - 删除了 mg(1) 中的 mailmode</a>
<li><a href="#20080616">2008/06/16 - pfsync(4) 版本号增加</a>
<li><a href="#20080627">2008/06/27 - 增加名为 _ypldap 的用户和组 </a>
<li><a href="#20080709">2008/07/09 - yacc(1) 已经更新</a>
<li><a href="#20080710">2008/07/10 - TCP/UDP baddynamic 列表, sysctl(8), named(8) 和 /etc/rc</a>
<li><a href="#20080711-0">2008/07/11 - Xenocara 增加视频驱动 openchrome(4)</a>
<li><a href="#20080711-1">2008/07/11 - 视频驱动 ati(4) 已经更新</a>
<li><a href="#20080719">2008/07/19 - 重写了 softraid 的元数据处理方法</a>
<li><a href="#20080724">2008/07/24 - libc 和 libm 的修改</a>
<li><a href="#20080907">2008/09/07 - ifconfig(8) 的语法修改</a>
<li><a href="#20080913">2008/09/13 - xcompmgr(1) 从 ports 移到了 xbase</a>
<li><a href="#20080929">2008/09/29 - Perl 升级到 5.10.0</a>
<li><a href="#20081003">2008/10/03 - sm-client.st 移动了位置</a>
<!-- New additions go on the bottom, please -->
</ul>

<hr>

<a name="Intro"></a>
<!-- XXXversion -->
<h2>介绍</h2>
此文档针对跟踪 <i>-current</i> 的用户。
它包含了从 4.3-release 到 <i>-current</i> 的修改信息，不能用于从 4.2
或更早版本的升级，或者想跟踪
<a href="../../stable.html"><i>-stable</i></a> 的用户。

<p>
如果你想从旧版本更新到 4.3-release 或
4.3-stable，参见<a href="../upgrade43.html">升级指南</a>。

<p>
在使用 -current 和执行下述操作之前，请确认已经阅读和理解了
<a href="../faq5.html">FAQ 5 - 从源代码构建系统</a>。

<p>
你始终应该使用快照作为运行 <i>-current</i> 的起点。
不支持从你自己的源代码编译升级。

<p>
如果你想查阅从早期的 OpenBSD 升级的信息，参见
<a href= "../upgrade-old.html">upgrade-old.html</a>。
它作为历史记录提供 -- 不能用做升级指南。

<p>
<a name="20080323"></a>
<h3>2008/03/23 - cwm 配置和命令行参数已经改变</h3>
cwm(1) 窗口管理器使用了新的配置解析器，所以配置文件需要依照
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cwmrc&amp;sektion=5">cwmrc(5)</a>
所述修改。
命令行参数 "-f" (字体) 和 "-s" (粘滞) 已经被配置指令代替。
请从 .xsession 中删除这些选项，否则登录 xdm(1) 会失败!

<p>
<a name="20080328"></a>
<h3>2008/03/28 - landisk 启用共享库</h3>
为了在 landisk 中从静态库切换到共享库，首先需要构建和安装 gcc 与 ld.so:
<blockquote><pre>
# <b>cd /usr/src/gnu/usr.bin/gcc</b>
# <b>make -f Makefile.bsd-wrapper obj</b>
# <b>make -f Makefile.bsd-wrapper depend</b>
# <b>make -f Makefile.bsd-wrapper</b>
# <b>make -f Makefile.bsd-wrapper install</b>
# <b>cd /usr/src/share/mk</b>
# <b>make install</b>
# <b>cd /usr/src/libexec/ld.so</b>
# <b>make obj</b>
# <b>make depend</b>
# <b>make</b>
# <b>make install</b>
</pre></blockquote>
然后按照
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=release&amp;sektion=8">
release(8)</a>
中的说明构建整个系统。

<p>
<a name="20080421"></a>
<h3>2008/04/21 - rtadvd(8) 的命令行参数已经改变</h3>
IPv6 路由广播后台程序
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rtadvd">rtadvd(8)</a>
的命令行参数已经改变。
<tt>"-f"</tt> (前台运行)，<tt>"-d"</tt> (调试) 和 <tt>"-D"</tt>
(更多调试信息)。
这些选项被合并到 <tt>“-d”</tt>，其行为更符合 OpenBSD 风格。

<p>
<a name="20080508"></a>
<h3>2008/05/08 - file(1) 已经更新，需要新的 /etc/magic</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=file">file(1)</a>
已经更新，需要安装新的
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=magic">magic(5)</a>
文件:
<blockquote><pre>
# <b>cd /tmp</b>
# <b>ftp ftp://mirror/path/to/snapshots/arch/etc43.tgz</b>
# <b>tar xzpf etc43.tgz ./etc/magic</b>
# <b>mv etc/magic /etc</b>
</pre></blockquote>

<p>
<a name="20080522"></a>
<h3>2008/05/22 - spamd(8) 同步模式协议版本已经更新</h3>
在同步模式中，<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=spamd">spamd(8)</a>
使用的协议已经更新，递增了协议版本号，用以修正各种问题。
因此，spamd 的新版本不能与旧版本同步(它们会忽略对方的数据包)，所以同一
spamd 同步组中的所有实例必须同时升级。

<p>
<a name="20080606"></a>
<h3>2008/06/06 - httpd(8) 手册移动了位置</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd">httpd(8)</a>
的手册从 <tt>/var/www/htdocs/manual/</tt> 移到
<tt>/usr/share/doc/html/httpd/</tt>。
而且它也从文件集 <i>etcXX</i> 移到了文件集 <i>miscXX</i> 中。

<p>
<a name="20080607"></a>
<h3>2008/06/07 - 不再支持 dhcpd.interfaces</h3>
不再支持 <tt>/etc/dhcpd.interfaces</tt>。它被 <tt>dhcpd_flags</tt>
取代，此参数在 <tt>/etc/rc.conf.local</tt> 中配置。

<p>
<a name="20080609"></a>
<h3>2008/06/09 - nmeaattach(8) 被删除</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=nmeaattach">nmeaattach(8)</a>
命令和 /etc/rc.conf 中的参数 nmeaattach_flags 已经从 -current 删除。
请使用
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ldattach">
ldattach(8)</a>。它的用法与 nmeaattach(8) 有些许不同: <tt>nmeaattach
cuaU0</tt> 成为 <tt>ldattach nmea cuaU0</tt>。

<p>
<a name="20080609b"></a>
<h3>2008/06/09 - 增加名为 _rtadvd 的用户和组</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rtadvd&amp;sektion=8">rtadvd(8)</a>
后台程序现在初始化后删除特权，以名为 _rtadvd 的用户和组的身份运行。
以 <i>root</i> 身份，使用
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8">useradd(8)</a>
增加名为 _rtadvd 的用户和组:
<blockquote><pre>
<b>useradd -u92 -g=uid -c "IPv6 Router Advertisement Daemon" -d /var/empty -s /sbin/nologin _rtadvd</b>
</pre></blockquote>

<p>
<a name="20080610"></a>
<h3>2008/06/10 - 地址计数器不再是 pf(4) 表的默认选项</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf">pf(4)</a>
表现在需要选项 <tt>counters</tt> 用来开启每个地址的字节和包计数器，例如:
<br>
<blockquote><tt>
table &lt;webservers&gt; counters { 192.168.33.4, 192.168.33.16/29 }
</tt></blockquote>
参见 <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf">pf.conf(5)</a>
以了解详细信息。

<p>
<a name="20080613"></a>
<h3>2008/06/13 - 删除了 mg(1) 中的 mailmode</h3>
因为
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mg">mg(1)</a>
中的 mail-mode 不过是 auto-fill-mode 的多虫的重新实现，所以被删除。
如果你使用了此特性，请修改对应的命令:<br>
<blockquote><tt>
mail-mode => auto-fill-mode<br>
mail-set-margin => set-fill-column
</tt></blockquote>
不要忘记同样修改你的 .mg 文件。

<p>
<a name="20080616"></a>
<h3>2008/06/16 - pfsync(4) 版本号增加</h3>
由于
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf">pf(4)</a>
状态表的修改，
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync">pfsync(4)</a>
协议的版本号已经增加; 使用不同版本号的防火墙将不能同步状态表，
断开的连接将不能容灾而终止。

<p>
<a name="20080627"></a>
<h3>2008/06/27 - 增加名为 _ypldap 的用户和组</h3>
即将到来的后台程序 ypldap(8) 需要新的用户和组。
以 <i>root</i> 身份, 使用
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8">useradd(8)</a>
增加名为 _ypldap 的用户和组:
<blockquote><pre>
useradd -u93 -g=uid -c"YP to LDAP Daemon" -d/var/empty -s/sbin/nologin _ypldap
</pre></blockquote>

<p>
<a name="20080709"></a>
<h3>2008/07/09 - yacc(1) 已经更新</h3>
在干净的对象目录执行 “make build” 之前，需要重新构建和安装
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=yacc">yacc(1)</a>，
以确保重新生成使用 yacc 产生的解析器。

<p>
<a name="20080710"></a>
<h3>2008/07/10 - TCP/UDP baddynamic 列表, sysctl(8), named(8) 和 /etc/rc</h3>
内核的 sysctls 参数
<em>net.inet.tcp.baddynamic</em> 和 <em>net.inet.udp.baddynamic</em>，以及工具
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=8">sysctl(8)</a>
已经被扩展到覆盖全部 TCP/UDP 端口。
这些列表指示从不动态分配其中的源端口，从而避免与知名服务冲突。
现在脚本 <tt>/etc/rc</tt> 在系统启动的时候，会自动从 <tt>/etc/services</tt> 中填充这些列表。
<p>
已经导入新版本
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=named&amp;sektion=8">named(8)</a>
(9.4.2-P1)，使用随机源端口用于查询，对于健壮的操作，这是必须的基础设施。
<p>
为了避免不兼容性，内核、
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=8">sysctl(8)</a>、
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=named&amp;sektion=8">named(8)</a> 和
<tt>/etc/rc</tt> 应该同步更新(在 "make build" 之前构建和安装内核)。
<p>
<a name="20080711-0"></a>
<h3>2008/07/11 - Xenocara 增加视频驱动 openchrome(4)</h3>
已经为 via 芯片组增加视频驱动 <a href="http://www.openchrome.org">xf86-video-openchrome</a>
到 Xenocara，用来代替已过时的老旧视频驱动 xf86-video-via。
<br>
如果你的配置文件中使用了 VIA 芯片组，将
<blockquote><tt>
  Driver "via"
</tt></blockquote>
替换为
<blockquote><tt>
  Driver "openchrome"
</tt></blockquote>
以使用新驱动。它一般出现在文件 <tt>/etc/X11/xorg.conf</tt> 中。请参阅
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=openchrome&amp;sektion=4">openchrome(4)</a>
手册页以了解更多的配置选项。

<p>
<a name="20080711-1"></a>
<h3>2008/07/11 - 视频驱动 ati(4) 已经更新</h3>
视频驱动 ati(4) 已经更新。更新的 xf86-video-ati 带来了一些重要变化。
<br>
<p>
不再需要 <a href="http://dri.freedesktop.org/wiki/MergedFB">MergedFB</a>:
<br>
<blockquote>
已经从 xrandr(1) 中删除了对 MergedFB 方式的支持。
</blockquote>

<p>
Macbook 的 Quirk 已经改变:
<blockquote>
使用下述 quirk 的 Mac 或 Macbook 用户
<blockquote>
<pre>
Option      "iBookHacks" "on"
</pre>
</blockquote>
如果遇到问题，应该阅读
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=radeon&amp;sektion=4">radeon(4)</a>
手册页，尤其是 <tt>"MacModel"</tt> 节。
<br>
此 quirk 已经被删除。
</blockquote>

<p>
<a name="20080719"></a>
<h3>2008/07/19 - 重写了 softraid 的元数据处理方法</h3>
完全重写了 <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=softraid&amp;sektion=4">softraid(4)</a></a>
的元数据处理方法。新代码与旧的元数据格式不兼容，随意用户必须备份和重新创建他们的 softraid 卷。
之前创建的 Softraid 卷不能被使用此代码的内核识别。

<p>
<a name="20080724"></a>
<h3>2008/07/24 - libc 和 libm 的修改</h3>
由于 libc 和 libm 的修改，必须在系统的后续构建之前执行如下步骤。

<p>0. 确保创建 obj

<blockquote><pre>
# <b>cd /usr/src</b>
# <b>make obj</b>
</blockquote>

<p>1. 安装头文件，构建和安装 libc

<blockquote><pre>
# <b>cd /usr/src/include</b>
# <b>make prereq</b>
# <b>make includes</b>
# <b>cd /usr/src/lib/libc</b>
# <b>make cleandir</b>
# <b>make depend</b>
# <b>make</b>
# <b>make install</b>
</pre></blockquote>

<p>2. 构建和安装 libm

<blockquote><pre>
# <b>cd /usr/src/lib/libm</b>
# <b>make cleandir</b>
# <b>make depend</b>
# <b>make</b>
# <b>make install</b>
</pre></blockquote>

<p>3. 构建和安装 libiberty

<blockquote><pre>
# <b>cd /usr/src/gnu/lib/libiberty</b>
# <b>make -f Makefile.bsd-wrapper cleandir</b>
# <b>make -f Makefile.bsd-wrapper depend</b>
# <b>make -f Makefile.bsd-wrapper</b>
# <b>make -f Makefile.bsd-wrapper install</b>
</pre></blockquote>

<p>4. 构建和安装 gcc

<pre>
    <b>如果你的平台使用 gcc 2.95.3:</b>
       # <b>rm -r /usr/obj/gnu/egcs/gcc/*</b>
       # <b>cd /usr/src/gnu/egcs/gcc</b>
        <i>- or -</i>
    <b>如果你的平台使用 gcc 3.3.5:</b>

       # <b>rm -r /usr/obj/gnu/usr.bin/gcc/*</b>
       # <b>cd /usr/src/gnu/usr.bin/gcc</b>

    <b>gcc v3.3.5 或 v2.95.3 的通用构建过程</b>
    # <b>make -f Makefile.bsd-wrapper clean</b>
    # <b>make -f Makefile.bsd-wrapper obj</b>
    # <b>make -f Makefile.bsd-wrapper depend</b>
    # <b>make -f Makefile.bsd-wrapper</b>
    # <b>make -f Makefile.bsd-wrapper install</b>
</pre>

当然，从快照开始相当简单，也是被强烈推荐的方法。

<p>
<a name="20080907"></a>
<h3>2008/09/07 - ifconfig(8) 的语法修改</h3>
某些 <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8">ifconfig(8)</a>
的选项已经修改。现在扫描无线网络时应该使用：
<pre>
    <b>ifconfig &lt;interface&gt; chan</b>
</pre>
枚举媒体类型时应该使用：
<pre>
    <b>ifconfig &lt;interface&gt; media</b>
</pre>

<p>
<a name="20080913"></a>
<h3>2008/09/13 - xcompmgr(1) 从 ports 移到了 xbase</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xcompmgr&amp;sektion=1">xcompmgr(1)</a>
已经从 ports 移到了 xbase。如果你已经从 ports 安装了 xcompmgr(1)，请使用 pkg_delete 删除之。

<p>
<a name="20080929"></a>
<h3>2008/09/29 - Perl 升级到 5.10.0</h3>
由于 Perl 发行版的改变，你需要在构建之前，手工删除旧的 perl obj 目录。例如：
<pre>
    # rm -rf /usr/obj/gnu/usr.bin/perl
</pre>
然后重新创建 obj 目录:
<pre>
    # cd /usr/src/gnu/usr.bin/perl
    # make -f Makefile.bsd-wrapper obj
</pre>
由于这是 Perl 的关键更新，你需要重新构建/安装全部 Perl XS 模块。
这些模块包含加载到 perl 进程中的共享对象。查看通过 package
子系统安装的 XS 模块列表的方法是：
<pre>
    # cd /var/db/pkg
    # fgrep .so p5-*/+CONTENTS | sed 's/+CONTENTS.*//' | sort -u
</pre>
使用“pkg_add -ui”升级到最新的 package 快照会处理这些升级。
在你升级完成后，你需要删除几个已经作为 Perl 基本包提供的模块：

<pre>
    # pkg_delete p5-Archive-Tar p5-Compress-Raw-Zlib p5-Compress-Zlib \
      p5-IO-Compress-Base p5-IO-Compress-Zlib p5-IO-Zlib p5-Module-Build \
      p5-Module-CoreList p5-Module-Load p5-version p5-Digest-SHA
</pre>

<p>
<a name="20081003"></a>
<h3>2008/10/03 - sm-client.st 移动了位置</h3>
(可选的) sendmail 递送状态文件已经从
<tt>/var/spool/clientmqueue/sm-client.st</tt> 移动到
<tt>/var/log/sm-client.st</tt>，从而与 <tt>/var/log/sendmail.st</tt>
文件的位置一致。

<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../../images/back.gif" border= "0" alt="[back]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>$OpenBSD: current.html,v 1.8 2008/10/24 19:56:03 tobias Exp $</small>

</body>
</html>
<!--
Originally [OpenBSD: current.html,v 1.124]<br>
$Translation: current.html,v 1.15 2008/10/21 01:33:17 dongsheng Exp $<br>
-->

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>OpenBSD 4.3 Przewodnik aktualizacji</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-2">
<meta name="resource-type" content="document">
<meta name="description"   content="OpenBSD Upgrade Process for 4.2 -> 4.3">
<meta name="keywords"      content="openbsd,faq,upgrade,4.3">
<meta name="distribution"  content="global">
<meta name="copyright"     content="This document copyright 2008 by OpenBSD">
</head>

<body bgcolor="#ffffff" text="#000000">
<a href="../../pl/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif" border="0">    

</a>
<p>
<font color="#0000e0">
<a href="upgrade35.html">[3.4 -> 3.5]</a> |
<a href="upgrade36.html">[3.5 -> 3.6]</a> |
<a href="upgrade37.html">[3.6 -> 3.7]</a> |
<a href="upgrade38.html">[3.7 -> 3.8]</a> |
<a href="upgrade39.html">[3.8 -> 3.9]</a> |
<a href="upgrade40.html">[3.9 -> 4.0]</a> |
<a href="upgrade41.html">[4.0 -> 4.1]</a> |
<a href="upgrade42.html">[4.1 -> 4.2]</a> |
<a href="index.html">[FAQ Index]</a>
</font>

<h1><font color="#e00000">Przewodnik po aktualizacji: z 4.2 do 4.3</font></h1>
<hr>

<i>Uwaga: upgrade jest dostêpny tylko z release do release, zalecane jest aby nie 
opuszczaæ wydañ po¶rednich.
Nie opuszczaj wersji release.</i>

<p><i>
Jest niezwykle wa¿ne aby¶ przeczyta³ ca³y dokument i dok³adnie zrozumia³
ca³y proces zanim bêdziesz usi³owa³ go przeprowadziæ.
Je¶li zamierzasz dzia³aæ na krytycznej lub fizycznie odleg³ej maszynie,
zalecamy aby¶ przetestowa³ ten proces na identycznej, lokalnej maszynie
i zweryfikowa³ szanse na powodzenie zanim przyst±pisz aktualizacji.
</i>

<p>
Upgrade to wygodny sposób na utrzymywanie twojego systemu OpenBSD aktualnym
z ostatni± aktualn± wersj±.
Jednak¿e, rezultat w zamierzeniu nie odpowiada dok³adnie wynikowi
instalacji wyczy¶æ-i-za³aduj.
W szczególno¶ci stare pliki bibliotek, nie s± usuwane w procesie aktualizacji,
poniewa¿ mog± byæ wymagane przez starsze aplikacje które mog±, lecz nie musz±
byæ zaktualizowane w danym momencie.
Je¿eli NAPRAWDÊ chcesz pozbyæ siê tych wszystkich plików, prawdopodobnie lepiej
bêdzie je¶li zainstalujesz wszystko od pocz±tku.

<p>
Spis tre¶ci:
<ul>
<li><a href="#before">Zanim rozpoczniesz</a>
  <ul>
    <li><a href="#libexpat"   >libexpat zosta³ przeniesiony do base43.tgz</a>
    <li><a href="#httpd.conf" >zmiany w httpd.conf</a>
    <li><a href="#relayd"     >hoststated(8) zmieni³ nazwê na relayd(8)</a>
    <li><a href="#carp"	      >zmiany w carp(4)</a>
    <li><a href="#xenocaramove">zmiana domy¶lnej lokalizacji ¼róde³ dla xenocara</a>
    <li><a href="#rc.conf"    >rc.conf</a>
    <li><a href="#kern"	      >Modyfikowany kernel</a>
  </ul>
<li><a href="#upgrade"	      >Aktualizacja</a>
<li><a href="#final"	      >Ostatnie kroki</a>
<ul>
    <li><a href="#UsersGroups">Nowi u¿ytkownicy i grupy</a>
    <li><a href="#etcUpgrade" >Aktualizacja <tt>/etc</tt></a>
    <li><a href="#Kernchk"    >Sprawdzenie kernela</a>
    <li><a href="#Pkgup"      >Aktualizacja pakietów</a>
    <li><a href="#rmxbase42"  >Usuniêcie xbase42.tgz</a>
  </ul>
</ul>

<hr>
<p>
<a name="before"></a>
<h2>Zanim rozpoczniesz: sprawy do przemy¶lenia i te którymi nale¿y siê martwiæ</h2>

To <i>nie</i> jest kompletna lista zmian jakie pojawi³y siê pomiêdzy
wersjami 4.1 i 4.2 lecz raczej zestawienie wa¿nych spraw na które
mo¿e natrafiæ znaczna liczba u¿ytkowników podczas procesu aktualizacji.
Szczegó³ow± listê zmian znajdziesz na stronie
<a href="../../plus43.html">plus43.html</a> oraz w logach zmian CVS.

<!-- XXX add new stuff -->

<a name="libexpat"></a>
<ul>
<li><b>libexpat zosta³ przeniesiony do base43.tgz</b><br>
Dla 4.2, libexpat zosta³ przeniesiony z portów do xbase42.tgz co okaza³o
siê wysoce k³opotliwe dla osób nie posiadaj±cych ¿adnych innych powodów
do instalacji X-ów.
Dla 4.3, libexpat przeniesiono do base43.tgz, zatem dla wielu aplikacji,
nie ma powodu instalowania xbase43.tgz.

<p>
Oznacza to ma³y problem je¿eli zainstalowa³e¶ xbase42.tgz aby mieæ libexpat
w systemie 4.2.
Powiniene¶ zatem usun±æ lub zaktualizowaæ xbase42.tgz.
W przypadku gdy instalacja xbase42.tgz wynika³a tylko z konieczno¶ci
posiadania libexpat, usuniêcie xbase42.tgz wydaje siê najlepszym rozwi±zaniem
Informacje o tym jak usun±æ xbase42.tgz znajdziesz <a href="#rmxbase42">
  tutaj</a>.

<p>
Zwróæ tak¿e uwagê ¿e kompilacja portów jest wspierana tylko przy pe³nej
instalacji, w³±cznie ze <i>wszystkimi</i> zestawami plików dla X-ów.


<p>
<a name="httpd.conf"></a>
<li><b>zmiany w httpd.conf</b><br>
<a href="faq15.html">Pakiety</a> dla modu³ów
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&amp;sektion=8">httpd(8)</a>
instaluj± obecnie pliki konfiguracyjne w <tt>/var/www/conf/modules.samples</tt>
i zalecane jest tworzenie dowi±zañ w do nich w katalogu <tt>/var/www/conf/modules</tt>.
Poni¿sze linie powinny byæ dodane do <tt>/var/www/conf/httpd.conf</tt>
po <tt>LoadModule</tt> (koniec sekcji 1):
<blockquote><pre>
#
# Include extra module configuration files
#
Include /var/www/conf/modules/*.conf
</pre></blockquote>

Zmiany te zawiera tak¿e plik <tt>upgrade43.patch</tt>, jednak ³atka ta mo¿e
nie zostaæ poprawnie na³o¿ona dla bardzo spersonalizowanych plików <tt>httpd.conf</tt>.
Powiniene¶ siê upewniæ, ¿e te linie znajduj± siê w twoim systemie - w przeciwnym
wypadku pakiety instalowane w przyszlo¶ci mog± nie dzia³aæ poprawnie.

<p>
<a name="relayd"></a>
<li><b>hoststated(8) zmieni³ nazwê na relayd(8):</b><br>
Nazwa
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hoststated&amp;manpath=OpenBSD+4.2&amp;sektion=8">hoststated(8)</a>
zosta³a zmieniona na 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=relayd&amp;sektion=8">relayd(8)</a>.
Zmiana ta wymaga modyfikacji u¿ytkownika i grupy <tt>_hoststated</tt> na <tt>_relayd</tt>,
zmian w konfiguracji <tt>/etc/pf.conf</tt> oraz ma³ych zmian polegaj±cych na przerobieniu
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hoststated.conf&amp;manpath=OpenBSD+4.2&amp;sektion=5">hoststated.conf(5)</a>
na
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=relayd.conf&amp;sektion=5">relayd.conf(5)</a>.
Instrukcje podane poni¿ej pomog± zainstalowaæ nowy plik <tt>relayd.conf</tt>.
Bêdziesz móg³ skonfigurowaæ go wedlug w³asnych potrzeb.

<p>
<a name="carp"></a>
<li><b>zmiany w carp(4):</b><br>
Aby uczyniæ konfiguracjê ³atwiejsz± zmieniony zosta³
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4">carp(4)</a>.
Je¿eli korzystasz z carp-a z
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4#LOAD+BALANCING">równowa¿eniem
  obci±¿enia</a> dla ARP lub IP, twoja konfiguracja powinna siê zmieniæ odpowiednio:

  <ul>
  <li> Wiele interfejsów carp(4) wspó³dziel±cych adres IP zosta³o zast±pione opcj±
  <tt>carpnodes</tt>.

  <li> <tt>net.inet.carp.arpbalance</tt> w 
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=8">sysctl(8)</a>
  zosta³ zamieniony z trybem rozk³adania <tt>arp</tt>.

  <li> Flagi <tt>link0, link1</tt>, oraz <tt>link2</tt> u¿ywane w równowa¿eniu IP
  zosta³y zast±pione trybami równowa¿enia <tt>ip,ip-stealth</tt> oraz <tt>ip-unicast</tt>.

  </ul>

<p>
<a name="xenocaramove"></a>
<li><b>zmiana domy¶lnej lokalizacji ¼róde³ dla xenocara:</b><br>
Domy¶lnym po³o¿eniem drzewa ¼róde³ xenocary (<a href="faq11.html">X</a>) 
jest teraz <tt>/usr/xenocara</tt>.
Fakt ten ma szczególne znaczenie dla osób
<a href="faq5.html#Xbld">tworz±cych X-y ze ¼róde³</a>.
Po prostu przenie¶ twoje drzewo xenocara:
<blockquote><pre>
# <b>mv /usr/src/xenocara /usr</b>
</pre></blockquote>


<p>
<a name="rc.conf"></a>
<li><b>rc.conf:</b><br>
W odró¿nieniu od poprzednich wersji tego procesu, od
<a href="upgrade41.html">4.1</a> zak³adamy, ¿e plik
<tt>/etc/rc.conf</tt> nie jest edytowany przez u¿ytkownika.

Je¿eli wykonywa³e¶ zmiany w swoim pliku <tt>/etc/rc.conf</tt> przenie¶
je do <tt>/etc/rc.conf.local</tt>.
Je¿eli NIE masz pliku <tt>/etc/rc.conf.local</tt> po prostu skopiuj
swój plik <tt>/etc/rc.conf</tt> do <tt>/etc/rc.conf.local</tt>
i <i>usuñ ostatni± liniê z tego skryptu!</i>
W przeciwnym wypadku umie¶æ zawarto¶æ obecnego pliku <tt>rc.conf</tt>
na pocz±tku istniej±cego pliku <tt>rc.conf.local</tt> a nastêpnie
<i>usuñ ostatni± liniê skryptu</i> zanim przejdziesz do dalszych
etapów procesu.


<p>
<a name="kern"></a>
<li><b>Modyfikowany kernel:</b><br>
Sprawd¼ czy wykonywa³e¶ jakichkolwiek modyfikacji twojego kernela.
Przyk³adowo, mog³e¶ zmodyfikowaæ twoj± kartê sieciow± by korzysta³a 
z innych ni¿ domy¶lne ustawieñ, korzystaj±c z config(8).
Zapisz te ustawienia, aby je odtworzyæ dla nowego j±dra w 4.3.

</ul>

<p>
<hr>
<a name="upgrade"></a>
<h2>Proces uaktualnienia</h2>

<h3>Uaktualnienie za pomoc± kernela instalacyjnego</h3>
Je¿eli posiadasz dostêp do konsoli serwera wówczas naj³atwiejsz± i
najbezpieczniejsz± metod± na uaktualnienie systemu jest uruchomienie
systemu z medium instalacyjnego lub z
<a href="faq4.html#bsd.rd">bsd.rd</a> i wykonanie procesu uaktualnienia
który bardzo przypomina <a href="faq4.html">proces instalacji systemu</a>.
Nastêpnie nale¿y wykonaæ przedstawione poni¿ej <a href="#final">ostatnie
kroki</a>.

<p>
Jedn± z naj³atwiejszych metod na uruchomienie systemu z instalacyjnego kernela
jest umieszczenie pliku <i>bsd.rd</i> dla wersji 4.3 w g³ównym drzewie 
systemu plików i poinstruowanie boot loadera by wystartowa³ z 
pliku <i>bsd.rd</i>.
Dla amd64 oraz i386 wykonasz to wpisuj±c po prostu "<tt>boot bsd.rd</tt>"
gdy pojawi siê znak zachêty <tt>boot&gt;</tt>. 


<h3>Uaktualnienie bez kernela instalacyjnego</h3>
<i>NIE jest to zalecany proces. Korzystaj z medium instalacyjnego gdy to 
tylko jest to mo¿liwe!</i>

<p>
Czasem kto¶ mo¿e potrzebowaæ aktualizacji na maszynie na której nie mo¿na
w ³atwy sposób przeprowadziæ normalnego procesu aktualizacji.
Mo¿na wówczas wykonaæ aktualizacjê ostro¿nie postêpuj±c w procesie podobnym
do aktualizacji opartej na ¼ród³ach:

<ul>
<li><b>Umie¶æ pliki instalacyjne w "dobrej" lokalizacji</b>.
Upewnij siê ¿e posiadasz wystarczaj±c± ilo¶æ miejsca!

<p>
<li><b>Wy³±cz wszystkie "niebezpieczne" aplikacje ze startu podczas uruchomienia systemu:</b>
Podczas upgrade Mo¿e wyst±piæ moment gdy prawdopodobnie nie bêdzie w³±czony PF,
jednak twoje aplikacje mog± pracowaæ poprawnie.
Ka¿da aplikacja zale¿na w sensie bezpieczeñstwa od PF powinna zostaæ wy³±czona zanim
wy³±czony zostanie PF i nie powinna byæ w³±czana a¿ do poprawnej weryfikacji dzia³ania
PF po aktualizacji.
Mog± dzia³aæ równie¿ inne aplikacje które chcesz by dzia³a³y podczas aktualizacji systemu,
je równie¿ zatrzymaj i wy³±cz.

<p>
<li><b>Sprawd¼ swój kernel:</b>
Pomimo ¿e <b>wiêkszo¶æ osób mo¿e pomin±æ ten krok</b>, je¿eli modyfikowa³e¶ 
swój kernel w wersji 4.2, prawdopodobnie bêdziesz musia³ to zrobiæ równie¿ 
w wersji 4.3.
W szczególno¶ci gdy przeprowadzasz proces aktualizacji zdalnie, teraz 
jest dobry czas, aby siê upewniæ ¿e nowy kernel bêdzie dzia³a³ po 
restarcie maszyny.
Je¶li jakiekolwiek zmiany musz± byæ wprowadzone do kernela, 
najbezpieczniejsz± rzecz± jak± mo¿na zrobiæ, jest wykonanie tych zmian na 
lokalnym systemie 4.3.
Mo¿e to byæ równie proste jak modyfikacja okre¶lonego urz±dzenia korzystaj±c z config(8),
lub mo¿e poci±gaæ za sob± rekompilacjê, je¶li dana opcja nie jest w³±czona w kernelu
GENERIC.
Prosimy zobacz <a href="faq5.html">FAQ 5 - Tworzenie systemu ze ¼róde³</a>,
zanim zdecydujesz siê na rekompilacjê kernela.

<p>
<li><b>Instalacja nowego kernela(-li)</b>
<blockquote><pre>
<b>export RELEASEPATH=</b><i>/usr/rel</i>   <i># gdzie maj± znajdowaæ siê pliki</i>
<b>cd ${RELEASEPATH}</b>
<b>rm /obsd ; ln /bsd /obsd && cp bsd /nbsd && mv /nbsd /bsd</b>
<b>cp bsd.rd bsd.mp /</b>
</pre></blockquote>

Zauwa¿ dodatkowe polecenia kopiuj±ce pierwotne j±dro: wykonywane s± aby 
mieæ pewno¶æ ¿e zawsze istnieje w³a¶ciwa kopia j±dra na dysku tak, ¿e 
mo¿liwy bêdzie boot systemu w sytuacji gdy przytrafi siê przerwa w 
zasilaniu w niew³a¶ciwym momencie lub awaria systemu.

<p>
<li><b>Instalacja nowych plików <tt>/etc/firmware</tt>:</b>
Z uwagi na fakt, ¿e niektóre za³adowane fragmenty "firmware" zosta³y
przeniesione z j±dra do katalogu <tt>/etc/firmware</tt>.
Dotyczy to wprawdzie tylko u¿ytkowników kilku urz±dzeñ, jednak nie 
zaszkodzi jak wszyscy wszyscy wykonaj± ten krok.
Aby rozpakowaæ pliki mikrokodu z <tt>base43.tgz</tt>, jako root u¿yj
polecenia:

<blockquote><pre>
<b>cd /</b>
<b>tar -C / -xzphf ${RELEASEPATH}/base43.tgz ./etc/firmware</b>
</pre></blockquote>

<p>
<li><b>Reboot na nowym j±drze:</b>
Mo¿e kusiæ chêæ opuszczenia tego kroku, ale powinien on byæ wykonany teraz,
jak zwykle, nowe j±dro uruchomi stare aplikacje przestrzeni u¿ytkownija
(takie jak bêd±cy wkrótce wa¿ny <tt>reboot</tt>!), jednak czêsto nowe
aplikacje NIE bêd± dzia³a³y ze starym j±drem.

<p>
<li><b>Instalacja nowych aplikacji przestrzeni u¿ytkownika</b>
<i>NIE instaluj teraz <tt>etc43.tgz</tt> oraz <tt>xetc43.tgz</tt>, poniewa¿
proces ten nadpisze twoje aktualne pliki konfiguracyjne!</i>

<blockquote><pre>
<b>export RELEASEPATH=</b><i>/usr/rel</i>
<b>cd ${RELEASEPATH}</b>
<b>tar -C / -xzphf base43.tgz</b>
<b>tar -C / -xzphf comp43.tgz</b>
<b>tar -C / -xzphf game43.tgz</b>
<b>tar -C / -xzphf man43.tgz</b>
<b>tar -C / -xzphf misc43.tgz</b>
<b>tar -C / -xzphf xbase43.tgz</b>
<b>tar -C / -xzphf xfont43.tgz</b>
<b>tar -C / -xzphf xserv43.tgz</b>
<b>tar -C / -xzphf xshare43.tgz</b>
</pre></blockquote>

Uwaga: nie wszystkie elementy musz± byæ zainstalowane dla wszystkich aplikacji,
jednak¿e, je¿eli zainstalowa³e¶ dany zbiór orginalnie, powiniene¶ z pewno¶ci±
uaktualniæ go teraz nowym zbiorem.

<p>
Ponadto pliki z <tt>/etc</tt> s± zarz±dzane oddzielnie, zatem <tt>etc43.tgz</tt> 
oraz <tt>xetc43.tgz</tt> NIE s± tutaj rozpakowywane.

<p>
<li><b>Aktualizacja <tt>/dev</tt>.</b>
Nowy plik 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=MAKEDEV&amp;sektion=8&amp;arch=i386">MAKEDEV</a>
zostanie skopiowany do /dev/ podczas instalacji <tt>base43.tgz</tt>, zatem powiniene¶
zwyczajnie wykonaæ poni¿sze: 

<blockquote><pre>
<b>cd /dev</b>
<b>./MAKEDEV all</b>
</pre></blockquote>

<p>
<li><b>Zaktualizuj <tt>/etc</tt> jak poni¿ej</b>.

<p>
<li><b>Reboot</b>
</ul>

Podczas tego procesu,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sendmail&amp;sektion=8">sendmail(8)</a>
mo¿e zwróciæ pewien b³±d podobny do poni¿szego:

<pre>
    Nov 1 12:47:05 puffy sm-mta[16733]: filesys_update failed: No such file or dire
    ctory, fs=., avail=-1, blocksize=380204
</pre>
Wiadomo¶æ ta mo¿e byæ bezpiecznie zignorowana, mo¿esz te¿ chcieæ zatrzymaæ
sendmail(8)-a na czas aktualizacji.
Zwracamy uwagê, ¿e sendmail nie dzia³a w tym punkcie aktualizacji dobrze
i wymagany jest jego restart (jako czê¶æ restartu maszyny), zanim poczta
bêdzie mog³a byæ obs³ugiwana zgodnie z oczekiwaniami.

<p>

<hr>
<a name="final"></a>
<h2>Ostatnie kroki</h2>

Jakkolwiek wykonujesz aktualizacjê, czy to przez kernel instalacyjny
i wykonanie "formalnego" procesu aktualizacji, czy te¿ aktualizacjê
binarn± "w-miejsce", musisz wykonaæ kilka kroków.

<a name="UsersGroups"></a>
<h3>1. Nowi u¿ytkownicy i grupy</h3>
Wymagane jest utworzenie nowych u¿ytkowników dla
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ospfd&amp;sektion=8">ospf6d</a>
oraz
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=snmpd&amp;sektion=8">snmpd</a>.
Mo¿esz dodaæ odpowiednie konta korzystaj±c z polecenia
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8">useradd(8)</a>.

<blockquote><pre>
<b>useradd -u90 -g=uid -c"OSPF6 Daemon" -d/var/empty -s/sbin/nologin _ospf6d
useradd -u91 -g=uid -c"SNMP Daemon" -d/var/empty -s/sbin/nologin _snmpd</b>
</pre></blockquote>

Musisz tak¿e u¿yæ
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>
do zmiany pliku z has³ami oraz ulubionego edytowa do zmiany pliku
<tt>/etc/group</tt>, zmieniaj±c <tt>_hoststated</tt> na <tt>_relayd</tt>, oraz
zmieniaj±c w vipw(8) opis z "HostState Daemon" na "Relay Daemon".
Nie zmieniaj innych linii.

<a name="etcUpgrade"></a>
<h3>2. Aktualizacja <tt>/etc</tt></h3>

<p>
Rozpakuj plik <tt>etc43.tgz</tt> do tymczasowej lokalizacji:

<blockquote><pre>
<b>tar -C /tmp -xzphf ${RELEASEPATH}/etc43.tgz</b>
</pre></blockquote>

Pliki które prawdopodobnie mog± byæ skopiowane z <tt>etc43.tgz</tt> "w takiej postaci
w jakiej s±":

<blockquote><pre>
etc/mail/README
etc/moduli
etc/mtree/4.4BSD.dist
etc/mtree/BSD.local.dist
etc/mtree/special
etc/netstart
etc/ospf6d.conf
etc/rc
etc/rc.conf
etc/relayd.conf
etc/security
etc/snmpd.conf
var/named/etc/root.hint
</pre></blockquote>

Zauwa¿, ¿e JEST mo¿liwe by lokalnie zmodyfikowaæ te pliki, je¿eli to 
by³o zrobione, bêdzie konieczne rêczne scalenie.
Zwróæ szczególn± uwagê na <tt>mail/*</tt> je¿eli u¿ywasz czego¶
innego ni¿ domy¶lna konfiguracja Sendmail(8)-a. 
Tutaj s± linie kopiuj/wklej do kopiowania tych plików, zak³adaj±c ¿e
rozpakowa³e¶ <tt>etc43.tgz</tt> w miejscu sugerowanym powy¿ej:

<blockquote><pre>
<b>cd /tmp/etc
cp moduli netstart ospf6d.conf rc rc.conf relayd.conf security snmpd.conf /etc
cp mtree/* /etc/mtree/
cp mail/README /etc/mail
cp ../var/named/etc/root.hint /var/named/etc</b>
</pre></blockquote>

<p>
<a name="patchfile"></a>
Pliki które musz± byæ rêcznie w³±czone, uwzglêdniaj±c lokalne
zmiany w nich wykonane (je¿eli by³y modyfikowane z domy¶lnych),
w przeciwnym wypadku po prostu równie¿ je skopiuj:

<blockquote><pre>
etc/changelist
etc/chio.conf
etc/ftpusers
etc/mail/aliases
etc/ssh/sshd_config
etc/sudoers
etc/sysctl.conf
var/named/etc/named-dual.conf
var/named/etc/named-simple.conf
var/named/etc/named.conf
var/www/conf/httpd.conf
var/www/conf/mime.types
var/www/htdocs/manual/mod/core.html
var/www/htdocs/manual/server-wide.html
</pre></blockquote>

Zmiany w tych plikach znajduj± siê w <a href="../upgrade43.patch">tej ³atce</a>.
Mo¿esz spróbowaæ z niego skorzystaæ wykonuj±c jako root nastepuj±ce polecenie:

<blockquote><pre>
<b>cd /</b>
<b>patch -C -p0 &lt; upgrade43.patch</b>
</pre></blockquote>

Spowoduje to przetestowanie ³atki jak dobrze pasuje do TWOJEGO systemu,
aby j± zastosowaæ opu¶æ opcjê "<tt>-C</tt>".
Zauwa¿ ¿e w sytuacji w której posiadasz zmodyfikowane pliki, lub pliki które 
nie s± wystarczaj±co aktualne, a tak¿e w sytuacji w której zosta³y zaktualizowane
z wersji "snapshot" 4.2, pliki te mog± nie zostaæ "czysto" zaakceptowane.
W takiej sytuacji, bêdziesz musia³ rêcznie uwzglêdniæ zmiany.
Prosimy wykonaj test tego procesu zanim siê na niego zdecydujesz dla maszyny
do której nie mo¿esz siê w ³atwy sposób dostaæ.

<p>
<b><tt>/etc/ttys</tt></b> zosta³ uzgodniony pomiêdzy platformami,
wymagaj± one jednak dodatkowych dzia³añ na tym pliku.
Zalecane jest skopiowanie nowego pliku i rêczne wprowadzenie do niego
zmian.
<blockquote><pre>
<b>mv /etc/ttys /etc/ttys.orig
cp /tmp/etc/ttys /etc</b>
</pre></blockquote>

<p>
W poni¿szych plikach zosta³y wprowadzone pewne zmiany na które nale¿y zwróciæ
uwagê, lecz nie mog± byæ bezpo¶rednio skopiowane lub scalone (przyk³adowo
je¿eli korzystasz z pf.conf, przyj¿yj siê sugerowanej zmianie strategii i 
zdecyduj czy jest w³a¶ciwa dla twoich potrzeb).

<blockquote><pre>
etc/pf.conf
</pre></blockquote>

<p>
Kilka plików musi zostaæ usuniêtych z systemu poniewa¿ nie s± u¿ywane w 4.3:

<blockquote><pre>
<b>rm /etc/hoststated.conf /var/named/standard/root.hint</b>
</pre></blockquote>

Ostatecznie skorzystaj z
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=newaliases&amp;sektion=8">newaliases(8)</a>
aby zaktualizowaæ bazê aliasów oraz
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&amp;sektion=8">mtree(8)</a>
aby utorzyæ jakiekolwiek nowe katalogi oraz zmieniæ w³a¶ciciela i prawa dostêpu do
<tt>/etc/chio.conf</tt>:

<blockquote><pre>
<b>newaliases</b>
<b>mtree -qdef /etc/mtree/4.4BSD.dist -p / -u</b>
<b>chown root:operator /etc/chio.conf</b>
<b>chmod 644 /etc/chio.conf</b>
</pre></blockquote>

<a name="Kernchk"></a>
<h3>3. Sprawdzanie kernela</h3>
Uwaga: <b>wiêkszo¶æ osób mo¿e pomin±æ ten krok!</b>

<p>
Je¿eli pod±¿a³e¶ za instrukcjami procesu aktualizacji bez instalacji
nowego kernela, juz zakoñczy³e¶ ten krok procesu.
Jednak¿e, je¶li korzysta³e¶ z medium instalacyjnego, i posiada³e¶
zmodyfikowany kernel w 4.2, istnieje prawdopodobieñstwo, ¿e bêdziesz
musia³ zmodyfikowaæ kernel w 4.3.
Mo¿e to byæ równie proste jak modyfikacja okre¶lonego urz±dzenia korzystaj±c z config(8),
lub mo¿e poci±gaæ za sob± rekompilacjê, je¶li dana opcja nie jest w³±czona w kernelu
GENERIC.
Prosimy zobacz <a href="faq5.html">FAQ 5 - Tworzenie systemu ze ¼róde³</a>,
zanim zdecydujesz siê na rekompilacjê kernela.


<a name="Pkgup"></a>
<h3>4. Aktualizacja pakietów</h3>
Je¶li instalowa³e¶ jakiekolwiek pakiety w twoim systemie, powiniene¶
zaktualizowaæ je po zakoñczeniu aktualizacji systemu bazowego.
Jednak¿e pamiêtaj ¿e niektóre pakiety mog± wymagaæ dalszej konfiguracji
przed i/lub po uaktualnieniu pakietu.
Sprawd¼ informacje dotycz±ce aktualizacji koniecznych pakietów.

<p>
Narzêdzia obs³ugi pakietów pozwalaj± na aktualizacjê
"w miejsce", poprzez u¿ycie <tt>pkg_add -u</tt>.
Przyk³adowo, aby zaktualizowaæ twoje pakiety, upewnij siê ze <tt>PKG_PATH</tt>
wskazuje na katalog z pakietami dla 4.2 na twoim CD lub najbli¿szym
mirrorze FTP (przyp. t³um. lub na katalog na lokalnym dysku),
i u¿yj polecenia podobnego to poni¿szego
 
<blockquote><pre>
<b># pkg_add -ui -F update -F updatedepends</b>
</pre></blockquote>

gdzie opcja <tt>-u</tt> wskazuje tryb aktualizacji, <tt>-i</tt> okre¶la 
tryb interaktywny, wiêc pkg_add bêdzie zwraca³ siê do ciebie gdy
napotka niejasno¶æ. Przeczytaj stronê manuala dla 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_add&amp;sektion=1&amp;manpath=OpenBSD+4.3">
  pkg_add(1)</a> oraz dokument FAQ dotycz±cy 
<a href="faq15.html#PkgMgmt">zarz±dzania pakietami</a>.

<a name="rmxbase42"></a>
<h3>5. Usuniêcie xbase42.tgz</h3>
Je¶li instalowa³e¶ <tt>xbase42.tgz</tt> aby mieæ zainstalowane
biblioteki libexpat wymagane dla niektórych pakietów, nie potrzebujesz
tego w 4.3.
Mo¿esz go usun±æ lub zainstalowaæ <tt>xbase43.tgz</tt>.

<p>
Je¿eli chcesz usun±æ, wykonaj poni¿sze polecenia:

<blockquote><pre>
# <b>mv /usr/X11R6/lib/libexpat.so.* /usr/lib</b>
# <b>rm -r /usr/X11R6 /etc/X11 /etc/fonts</b>
</pre></blockquote>

<p>
Je¿eli chcesz zainstalowaæ <tt>xbase43.tgz</tt>, musisz wykonaæ porz±dki
ze starymi plikami dla libexpat:

<blockquote><pre>
# <b>mv /usr/X11R6/lib/libexpat.so.* /usr/lib</b>
# <b>rm /usr/X11R6/lib/libexpat*</b>
# <b>rm /usr/X11R6/include/expat*</b>
</pre></blockquote>

<p>
<font color="#0000e0">

<a href="upgrade35.html">[3.4 -> 3.5]</a> |
<a href="upgrade36.html">[3.5 -> 3.6]</a> |
<a href="upgrade37.html">[3.6 -> 3.7]</a> |
<a href="upgrade38.html">[3.7 -> 3.8]</a> |
<a href="upgrade39.html">[3.8 -> 3.9]</a> |
<a href="upgrade40.html">[3.9 -> 4.0]</a> |
<a href="upgrade41.html">[4.0 -> 4.1]</a> |
<a href="upgrade42.html">[4.1 -> 4.2]</a> |
<a href="index.html">[FAQ Index]</a>
</font>

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../../images/back.gif" border="0" alt="[back]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: upgrade43.html,v 1.14 ]<br>
$Translation: upgrade43.html,v 1.4 2008/05/07 02:10:15 tkniaz Exp $<br>
-->
$OpenBSD: upgrade43.html,v 1.3 2008/05/12 07:23:52 tobias Exp $
</small>
</body>
</html>


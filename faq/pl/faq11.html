<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0051)http://openbsdpl.sourceforge.net/www/faq/faq11.html -->
<HTML><HEAD>
<meta name="translated_by" content="Pawel 'Stygmat' Baranowski">
<TITLE>11 - Dostrajanie wydajno¶ci</TITLE>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-2"><LINK 
rev=made href="mailto:www@openbsd.org">
<META content=document name=resource-type>
<META content="the OpenBSD FAQ page" name=description>
<META content=openbsd,faq name=keywords>
<META content=global name=distribution>
<META content="This document copyright 1998-2003 by OpenBSD." name=copyright>
</HEAD>
<BODY text=#000000 bgColor=#ffffff><IMG height=30 alt=[OpenBSD] 
src="../../images/smalltitle.gif" width=141> 
<P>
<font color="#0000e0">
<a href="index.html">[Spis tre¶ci]</a>
<a href="faq10.html">[Sekcja 10 - Zarz±dzanie systemem]</a>
<a href="faq12.html">[Sekcja 12 - Pytania dotycz±ce poszczególnych platform]</a>
</font>

<H1><font color="#e00000">11 - Dostrajanie wydajno¶ci</font></h1>

<!--
UNCOMMENT ONLY WHEN THE FILE IS OUT OF SYNC

<hr>
<p>
<b><font color="#e00000">Uwaga:</font></b>Zawarto¶æ tego pliku
jest ju¿ bardzo nieaktualna w stosunku do
<a href="../faq11.html">bie¿±cej wersji anglojêzycznej</a>.

<p>
Je¶li chcesz pomóc w aktualizacji tego pliku, zajrzyj na
<a href="../../translation.html">stronê t³umaczeñ</a>.

-->

<hr>

<P>
<H3>Tablica zawarto¶ci</H3>
<UL>
<LI><A href="#Network">11.1 - Sieæ</A> 
<LI><A href="#Disk">11.2 - Optymalizacja operacji dyskowych</A> 
<!-- li> <a href="#kmem">11.3 - Tuning kmem</a></li -->
<LI><A href="#HW">11.4 - Wybór sprzêtu</A> 
<LI><A href="#Async">11.5 - Dlaczego nie u¿ywaæ asynchronicznego montowania dysków? </A> 
<LI><A href="#XF86">11.6 - Dostrajanie rozdzielczo¶ci ekranu pod XFree86</A>
</UL>
<HR>

<P>Je¿eli zamierzasz uruchomiæ wydajny serwer, bramê sieciow± lub firewall, 
to w celu uzyskania optymalnej wydajno¶ci bêdziesz byæ mo¿e potrzebowa³ zmieniæ 
niektóre z domy¶lnych parametrów j±dra. O opcjach kernela opisanych poni¿ej przeczytasz 
na stronach podrêcznika ekranowego man pod has³em 
<A href="http://www.openbsd.org/cgi-bin/man.cgi?query=options&amp;sektion=4">options(4)</A>. 
Opcje te umieszcza siê w pliku konfiguracyjnym kernela przed rozpoczêciem 
kompilacji w³asnego j±dra systemu. Wiêcej informacji na ten temat uzyskasz w 
rozdziale <A href="faq5.html">FAQ 5</A>. 

<P>
<A name=Network></A>
<H2>11.1 - Sieæ</H2>
<!-- XXXchanges - changes with OpenBSD 3.3 -->

<P>
Parametrem, który mo¿esz zmieniæ w j±drze obci±¿onego serwera, bramy czy 
firewalla jest NMBCLUSTERS. Kontroluje on rozmiar mbuf cluster map j±dra systemu. Je¶li w 
trakcie pracy sytemu otrzymasz komunikat "mb_map full&quot; lub podobny, oznacza to, 
¿e potrzebne jest zwiêkszenie warto¶ci tego parametru. Innym powodem do 
zwiêkszenia warto¶ci parametru NMBCLUSTERS jest sytuacja, w której ruch sieciowy na 
karcie sieciowej zatrzymuje siê z niewiadomej przyczyny. Sensown± warto¶ci± dla platwormy i386, 
dla wiêkszo¶ci kart sieciowych o szybko¶ci 100Mbps jest 8192 
(bez wzglêdu na fakt ile kart zainstalowanych jest w maszynie). 
<BLOCKQUOTE><STRONG>option NMBCLUSTERS=8192 </STRONG></BLOCKQUOTE>

<P>
Domy¶lna warto¶æ parametru NMBCLUSTERS zale¿y z jak± platform± sprzêtow± mamy 
do czynienia i waha siê od 256 do 2048. Parametr ten jest ustawiony w jednym z 
plików nag³ówkowych danej platformy, chyba ¿e zostanie on nadpisany lini± 
zamieszczon± w pliku konfiguracyjnym kernela. 

<P>
Parametr NMBCLUSTERS mo¿e byæ ustawione przy u¿yciu 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&sektion=8">config(8)</a>, 
co zapobiega konieczno¶ci kompilacji kernela w celu zmiany tego parametru:

<blockquote><pre>
# <b>config -e -o bsd.new /bsd</b>
OpenBSD 3.4 (GENERIC) #18: Wed Sep 17 03:34:47 MDT 2003
  deraadt@i386.openbsd.org:/usr/src/sys/arch/i386/compile/GENERIC
Enter 'help' for information
ukc> <b>nmbclust</b>
nmbclusters = 2048
ukc> <b>nmbclust 8192</b>
nmbclusters = 8192
ukc> <b>quit</b>
Saving modified kernel.
</pre></blockquote>

Wykonanie powy¿szych czynno¶ci spowoduje utworzenie w bie¿±cym katalogu nowego kernela, <tt>bsd.new</tt>, 
<i>oraz</i> ustawi parametr NMBCLUSTERS dzia³aj±cego 
j±dra.  Je¶li wszystko siê powiedzie, nie zapomnij skopiowaæ <tt>bsd.new</tt> na
<tt>bsd</tt> przed ponownym rozruchem komputera.

<P>
<A name=Disk></A>
<H2>11.2 - Optymalizacja operacji dyskowych</H2>


<P>Szybko¶æ operacji wej¶cia/wyj¶cia systemów dyskowych ma znacz±cy wp³yw na 
ca³kowit± wydajno¶æ komputera. Ma to szczególne znaczenie wtedy, gdy twój 
komputer pracuje w ¶rodowisku wielodostêpnym (z systemu korzysta wielu 
u¿ytkowników ró¿nego rodzaju, tacy którzy logujê siê do niego interaktywnie, 
tacy którzy korzystaj± z niego jako serwera plików albo serwera www). Dane 
przechowywane wymagaj± ci±g³ej uwagi, szczególnie wtedy, gdy na partycjach 
zaczyna brakowaæ miejsca lub wtedy, gdy dysk ulegnie uszkodzeniu. OpenBSD 
posiada wiele mechanizmów na zwiêkszenie szybko¶ci systemów dyskowych czy te¿ 
zapewniaj±cych odporno¶æ na uszkodzenia.<p>Oto one:</p>
<UL>
<LI><A href="#ccd">CCD</A> - Driver dysków po³±czonych. 
<LI><A href="#raid">RAID</A> 
<LI><A href="#buf">Filesystem Buffer</A> - bufor systemu plików 
<LI><A href="#softu">Soft Updates</A> 
<LI><A href="#maxvnodes">Rozmiar pamiêci podrêcznej namei()</A>
</UL>

<P>
<A name=ccd></A>
<H3>11.2.1 - CCD</H3>
<BLOCKQUOTE>Pierwsz± mo¿liwo¶ci± jest u¿ycie 
<A href="http://www.openbsd.org/cgi-bin/man.cgi?query=ccd&amp;sektion=4">ccd(4)</A>, 
czyli sterownika dysków po³±czonych. Pozwala to na po³±czenie wielu partycji 
w jeden wirtualny dysk (czyli spowodujesz, ¿e wiele dysków widziane jest jako 
jeden). Jest to podobne do LVM (logical volume management) rozwi±zanie, 
które zaimplementowane jest w wielu komercyjnych wersjach Unixa.

<P>
Je¶li twój system pracuje na j±drze GENERIC, sterownik ccd jest w nim zawarty (w pliku 
<TT>/usr/src/sys/conf/GENERIC</TT>). Je¶li jednak przebudowa³e¶ kernel, byæ 
mo¿e bêdziesz potrzebowa³ w³±czyæ odpowiedni± opcjê w pliku konfiguracyjnym. 
Innymi s³owy, w pliku konfiguracyjnym musi znale¼æ siê wpis wygl±daj±cy w 
nastêpuj±cy sposób:
<PRE>     <STRONG>pseudo-device   ccd     4       # concatenated disk devices</STRONG>
</PRE>

<P>
Powy¿sza linia daje Ci mo¿liwo¶æ utworzenia maksymalnie 4 urz±dzeñ ccd 
(dysków wirtualnych, logicznych). Teraz musisz zdecydowaæ, które partycje 
z zainstalowanych w systemie dysków w³±czysz do urz±dzenia ccd. 
Nastêpn± czynno¶ci± jest u¿ycie narzêdzia disklabel, w celu oznaczenia 
tych partycji jako dostêpnych dla ccd. Na niektórych platformach sprzêtowych, 
narzêdzie disklabel mo¿e nie zezwoliæ na wykonanie tej czynno¶ci. 
W tym wypadku oznacz je jako ffs. 

<P>
Je¶li u¿ywasz ccd w celu zwiêkszenia wydajno¶ci poprzez zastosowanie 
striping'u, zwróæ uwagê na fakt, ¿e optymaln± wydajno¶æ uzyskasz 
tylko wtedy, gdy zastosujesz te same modele dysków z identycznymi 
ustawieniami wprowadzonymi programem disklabel. 

<P>
Plik /etc/ccd.conf powinien wygl±daæ podobnie do tego: 
(wiêcej informacji o konfiguracji ccd znajdziesz w podrêczniku 
man pod has³em 
<A href="http://www.openbsd.org/cgi-bin/man.cgi?query=ccdconfig&amp;sektion=8">ccdconfig(8)</A>) 

<BLOCKQUOTE>
<PRE># Configuration file for concatenated disk devices
#
# ccd   ileave  flags   component devices
ccd0   16      none    /dev/sd2e /dev/sd3e
</PRE>
</BLOCKQUOTE>


<P>
Aby zastosowaæ wprowadzone ustawienia wykonaj nastêpuj±ce polecenie 
<BLOCKQUOTE>
<PRE># ccdconfig -C
</PRE>
</BLOCKQUOTE>

<P>
Tak d³ugo jak istnieje plik /etc/ccd.conf, tak d³ugo ccd bêdzie automatycznie 
konfigurowaæ siê podczas startu systemu. Od tego momentu masz w systemie nowy 
dysk nazwany ccd bêd±cy kombinacj± urz±dzeñ /dev/sd2e oraz /dev/sd3e. Wystarczy 
ponownie u¿yæ polecenia disklabel na urz±dzeniu ccd0, jak zwykle wtedy, 
gdy tworzysz partycjê lub partycje, które chcesz u¿ywaæ. Nie u¿ywaj partycji 'c' 
jako aktualnej partycji tworzonej na nowym urz±dzeniu. Upewnij siê, ¿e pocz±tek 
nowo tworzonej partycji rozpoczyna siê co najmniej 1 cylinder za pocz±tkiem dysku.
</BLOCKQUOTE>

<P>
<A name=raid></A>
<H3>11.2.2 - RAID</H3>

<BLOCKQUOTE>Innym rozwi±zaniem jest 
<A href="http://www.openbsd.org/cgi-bin/man.cgi?query=raid&amp;sektion=4">raid(4)</A>. 
Aby kontrolowaæ macierze RAID u¿yj narzêdzia 
<A href="http://www.openbsd.org/cgi-bin/man.cgi?query=raidctl&amp;sektion=8">raidctl(8)</A>. 
System macierzy dyskowych RAID w systemie OpenBSD bazuje na oprogramowaniu Grega Ostera CMU 
<A href="http://www.pdl.cmu.edu/RAIDframe/">RAIDframe</A>, porcie znanym z systemu NetBSD (zobacz 
<A href="http://www.cs.usask.ca/staff/oster/raid.html">NetBSD port</A>). OpenBSD 
wspiera nastêpuj±ce poziomy RAID: 0, 1, 4, oraz 5.

<P>
Mo¿liwo¶æ u¿ycia RAID, podobnie jak i ccd, definiuje siê w pliku konfiguracyjnym kernela. Niestety 
j±dro GENERIC nie wspiera systemu RAID, dlatego te¿ musi on byæ wkompilowany w j±dro. 
(obs³uga RAID zwiêksza rozmiar j±dra o oko³o 500K na platformie i386)

<BLOCKQUOTE>
<PRE><STRONG>pseudo-device   raid   4       # RAIDframe disk device</STRONG>
</PRE>
</BLOCKQUOTE>

<P>
W przypadku niektórych systemów operacyjnych, konfiguracja RAID jest nu¿±ca 
i trudna do przedstawienia. Ale nie jest tak w przypadku RAIDframe. Wiêcej 
informacji uzyskasz, je¶li przeczytasz nastêpuj±ce tematy, 
<A href="http://www.openbsd.org/cgi-bin/man.cgi?query=raid&amp;sektion=4">raid(4)</A> 

oraz <A href="http://www.openbsd.org/cgi-bin/man.cgi?query=raidctl&amp;sektion=8">raidctl(8)</A>, 
w podrêczniku man. Podsystem RAID posiada wiele opcji konfiguracyjnych, 
a szczegó³owe przedstawienie wszystkich wykracza poza ramy tego dokumentu.
</BLOCKQUOTE>

<P>
<A name=buf></A>
<H3>11.2.3 - Filesystem Buffer</H3>

<BLOCKQUOTE>W przypadku maszyn z du¿± ilo¶ci± pamiêci pracuj±cych jako serwer 
plików, dobrym rozwi±zaniem jest zwiêkszenie parametru BUFCACHEPERCENT. Mówi on, 
jaki procent pamiêci RAM ma byæ u¿ywana na bufor systemu plikowego. Opcjê t± mo¿e
zmieniæ sam system operacyjny wtedy, kiedy Unified Buffer Cache zostanie zape³niony.
Aby samemu zwiêkszyæ parametr BUFCACHEPERCENT, powiniene¶ dodaæ nastêpuj±c± liniê 
do pliku konfiguracyjnego kernela: 
</BLOCKQUOTE>

<BLOCKQUOTE>
<STRONG>option BUFCACHEPERCENT=30</STRONG><BR>
</BLOCKQUOTE>

<BLOCKQUOTE>
Oczywi¶cie mo¿esz ustawiæ ten parametr na nisk± warto¶æ 5 procent (warto¶æ 
domy¶lna) lub te¿ wysok± np. 50 procent (lub wiêcej).
</BLOCKQUOTE>

<blackquote>
Opcjê BUFCACHEPERCENT mo¿na ustawiæ za pomoc± 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&sektion=8">config(8)</a>,
<a href="#Network">(zobacz wy¿ej)</a>, co eliminuje potrzebê rekompilacji j±dra po ka¿dej 
zmianie tego parametru.
</blackquote>

<P>
<A name=softu></A>
<H3>11.2.4 - Soft updates</H3>

<BLOCKQUOTE>Innym narzêdziem, które mo¿e byæ u¿yte do poprawienia wydajno¶ci 
twojego systemu s± softupdates'y. Jedn± z najwolniejszych operacji w tradycyjnym
systemie plików systemu BSD jest uaktualnianie informacji metainfo (co ma miejsce 
miêdzy innymi wtedy, gdy kasujesz lub tworzysz&nbsp; pliki/katalogi). Softupdates 
próbuj± uaktualniæ informacje metainfo w pamiêci RAM zamiast zapisywaæ na dysk 
ka¿de pojedyncze uaktualnienie. Innym efektem tego dzia³anie jest fakt, ¿e 
informacje metainfo zapisane na dysku powinny zawsze byæ kompletne, jednak¿e 
nie oznacza to i¿ s± one najbardziej aktualne. Tak wiêc po padzie systemu, 
system nie powinien uruchomiæ 
<A href="http://www.openbsd.org/cgi-bin/man.cgi?query=fsck&amp;sektion=8">fsck(8)</A> 
w trakcie ponownego startu, wymaga tylko aby fsck dokona³ zmian metainfo w 
RAM'ie (przy pomocy softupdates). Skutkuje to szybszym startem serwera po 
awarii, jako ¿e nie musi on czekaæ na zakoñczenie fsck. (OpenBSD nie posiada 
jeszcze zaimplementowanych softupdates'ów.) Wiêcej mo¿esz dowiedzieæ siê 
czytaj±c o softupdates'ach w 
<A href="faq14.html#SoftUpdates">Softupdates FAQ</A>.
</BLOCKQUOTE>

<P>
<A name=maxvnodes></A>
<H3>11.2.5 - Rozmiar pamiêci podrêcznej namei()</H3>
<DL>
<DD>
Uwaga: do niedawna, strony podrêcznika man 
(<A href="http://www.openbsd.org/cgi-bin/man.cgi?query=options&amp;sektion=4">options(4)</A>) 
zaleca³y stosowanie opcji <TT>NVNODE=integer</TT> w pliku konfiguracyjnym 
kernela. Obecnie nie zaleca siê stosowaæ takiego rozwi±zania; powiniene¶ 
u¿ywaæ w tym celu komendy 
<A href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=8">sysctl(8)</A>. 

<P>
Rozmiar pamiêci podrêcznej konwersji name-inode ( znanej tak¿e jako, namei()) 
determinuje szybko¶æ translacji ¶cie¿ek do inode'ów 
(<A href="http://www.openbsd.org/cgi-bin/man.cgi?query=inode&amp;sektion=5">inode(5)</A>). 
Domy¶lnie, pamiêæ ta ma <TT>NPROC * (80 + NPROC / 8)</TT> wpisów. <TT>NPROC</TT> 
ustawione jest na warto¶æ <TT>20 + 16 * MAXUSERS</TT>; aby uzyskaæ wiêcej 
informacji na temat parametru MAXUSERS zobacz co napisane jest w sekcji 
<A href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</A> 
podrêcznika man. Ma³y rozmiar tej pamiêci podrêcznej skutkuje du¿± ilo¶ci± 'cache misses', 
któr± mo¿na odczytaæ za pomoc± odpowiednich narzêdzi np. 
<A href="http://www.openbsd.org/cgi-bin/man.cgi?query=systat&amp;sektion=1">systat(1)</A>. 
Odczyt aktualnej warto¶ci parametru (<TT>kern.maxvnodes</TT>) odpowiadaj±cego 
za wielko¶æ pamiêci podrêcznej name-inode mo¿na dokonaæ programem 
<A href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=8">sysctl(8)</A>. 
Równie¿ tym programem mo¿na dokonaæ zmiany tego parametru. Po zmianie nale¿y 
obserwowaæ wydajno¶æ komputera. Je¿eli zmiany s± 
satysfakcjonuj±ce mo¿emy ustawiæ ten parametr na sta³e tak, aby by³ stosowany 
przy ka¿dym starcie systemu. W tym celu nale¿y w pliku 
<A href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl.conf&amp;sektion=5">sysctl.conf(5)</A> 
dodaæ odpowiedni wpis.
</DD>
</DL>

<P>
<A name=HW></A>
<H2>11.4 - Wybór sprzêtu</H2>

<P><I>(Uwaga: Ta czê¶æ przeznaczona jest szczególnie dla u¿ytkowników platform 
i386 lub PC. Generalnie mówi±c ... inne architektury sprzêtowe nie oferuj± 
takiego wyboru sprzêtu jak i386/PC!)</I>

<P>Wydajno¶æ aplikacji ¶ci¶le zale¿y od systemu operacyjnego oraz udogodnieñ 
jakich on dostarcza. Mo¿e byæ to przyczyn± do zastosowania systemu operacyjnego OpenBSD. 
Wydajno¶æ aplikacji zale¿y równie¿ od hardware'u jakiego u¿ywasz. Dla 
wielu osób wspó³czynnik Cena/Wydajno¶æ nowych komputerów PC z procesorem 
Intel Pentium IV lub AMD Athlon jest o wiele lepszy ni¿ ten wspó³czynnik 
dla platformy Sun UltraSparc 60! Jest rzecz± oczywist±, i¿ cena systemu OpenBSD 
jest nie do pobicia. 

<P>
Je¶li kupujesz nowy komputer PC, niezale¿nie od tego czy sk³adasz go z 
podzespo³ów, czy te¿ kupujesz ju¿ z³o¿ony, musisz upewniæ siê, ¿e kupujesz 
czê¶ci sprawdzone i niezawodne. Nie jest to zadanie ³atwe do zrealizowania. <B>
Uszkodzone, zawodne lub ¼le dobrane komponenty mog± spowodowaæ, ¿e system 
OpenBSD bêdzie pracowa³, delikatnie mówi±c, kiepsko, a nawet czêsto wiesza³ siê. </B>
Najlepsza rad±, jak± mo¿emy Ci daæ to bycie ostro¿nym oraz kupowanie podzespo³ów 
znanych producentów i z pewnego ¼ród³a. Czasami zyskuj±c niewiele na cenie, 
tracisz wiêcej na jako¶ci!<P>Oto ustalone normy, które mog± pomóc w uzyskaniu 
maksymalnej wydajno¶ci z twojego hardware'u:

<UL>
<LI><B>U¿ywaj wielu dysków.</B> Zamiast kupowaæ jeden dysk o du¿ej pojemno¶ci, 
kup kilka mniejszych dysków. Mimo, i¿ mo¿e byæ to rozwi±zanie dro¿sze, roz³o¿enie 
obci±¿enia pomiêdzy wiele talerzy jednego dysku obni¿y ilo¶æ czasu potrzebn± 
na dostêp do danych. W przypadku wielu dysków, uzyskasz pewniejszy i szybszy 
dostêp do danych stosuj±c systemy RAID.
<p>
<LI><B>U¿ywaj dysków SCSI, je¶li potrzebujesz bardzo wysokiej wydajno¶ci 
operacji wej¶cia/wyj¶cia.</B> Dyski IDE pracuj± z prêdko¶ci± wirowania talerzy 
do 7200 obr/min. Nawet u¿ywaj±c dysków IDE wysokiej jako¶ci, jest rzecz± 
niemo¿liw± oczekiwanie transferu przekraczaj±cego 15-20 Mbytes/s (throughput) 
z jednego dysku. U¿ywaj±c wysokiej klasy dysków SCSI (dro¿sze, 10k-15k RPM), 
mo¿esz uzyskaæ lepsz± wydajno¶æ od dysków IDE. Z drugiej strony patrz±c, przy 
u¿yciu dysków SCSI ¶redniej lub niskiej klasy marnujesz pieni±dze, gdy¿ dobre 
dyski IDE maj± podobne parametry je¶li nie lepsze.
<P>
Buduj±c serwer i planujesz wyposa¿yæ go w wiele dysków,  
powiniene¶ rozwa¿yæ u¿ycie urz±dzeñ SCSI. Kontrolery IDE ograniczaj± ilo¶æ do dwóch 
urz±dzeñ na kontroler (kana³ kontrolera, przyp. t³um.). Równoczesny dostêp do dwóch 
urz±dzeñ wpiêtych na jeden kana³ mo¿e negatywnie wp³yn±æ na wydajno¶æ operacji 
wej¶cia/wyj¶cia tych urz±dzeñ. Wide SCSI ogranicza liczbê urz±dzeñ do 15 na 
kontroler (kana³, przyp. t³um.), ponadto posiadaj± one lepsze wsparcie dla 
równoczesnego dostêpu ni¿ urz±dzenia IDE. Mimo, i¿ urz±dzenia SCSI s± dro¿sze, 
to ich uniwersalno¶æ oraz wydajno¶æ usprawiedliwia zwiêkszenie nak³adów 
finansowych w powa¿niejszych zastosowaniach.
<P>
<LI><B>U¿ywaj pamiêci SDRAM zamiast DRAM.</B> Odnosi siê to g³ównie do 
komputerów klasy PC. Wiele innych platform nie daje mo¿liwo¶ci wyboru co do 
rodzaju instalowanej pamiêci. W wiêkszo¶ci PC'tów nadal masz mo¿liwo¶æ wyboru. 
Nie osi±gniesz wy¿szej wydajno¶ci stosuj±c DRAM (modu³y SIMM) w porównaniu z 
zastosowaniem SDRAM. Je¶li twój system wspiera zastosowanie pamiêci RDRAM, DDR 
lub innego, nowszego typu pamiêci RAM, bêdziesz nawet nieco naprzód... 
(obecnie pamiêci DDR powoli wypieraj± SDRAM, przyp. t³um.)
<P>
<LI><b>U¿ywaj pamiêci ECC lub pamiêci z kontrol± parzysto¶ci.</b> Parzysto¶æ 
dodaje mo¿liwo¶æ wykrycia, czy dane w pamiêci nie zosta³y uszkodzone. Wiêksz± 
funkcjonalno¶æ oferuje pamiêæ ECC, która umo¿liwia korekcjê w locie 
pojedynczego bitu, który uleg³ uszkodzeniu. Punkt ten odnosi siê g³ównie do 
architektury PC. Wiêkszo¶æ platform sprzêtowych wymaga zastosowania pamiêci z 
parzysto¶ci± b±d¼ pamiêci ECC. Wiêkszo¶æ komputerów nie bêd±cych PC'tami nie 
wystartuje z pamiêci± bez obs³ugi parzysto¶ci. Je¶li nie wykorzystujesz w 
systemie pamiêci ECC/parity RAM mo¿esz naraziæ siê na uszkodzenie danych lub inne anormalne 
zachowanie systemu. Wielu producentów tanich pamiêci nie oferuje nawet 
modeli pamiêci ECC! Wystrzegaj siê ich! Producenci komputerów klasy PC oferuj± 
w sprzeda¿y kilka linii produktów, podzielonych na serwery (servers) i stacje 
robocze (workstation). Linie serwerowe zawieraj± ECC RAM w swojej 
architekturze. Producenci unixowych stacji roboczych stosuj± pamiêci z 
kontrol± parzysto¶ci (obecnie z ECC) od lat we wszystkich swoich liniach 
produkcyjnych.
<P>
<LI><B>Wystrzegaj siê urz±dzeñ ISA.</B> Podczas, gdy wiêkszo¶æ u¿ytkowników 
wystrzega siê stosowania urz±dzeñ ISA, poniewa¿ s± one generalnie 
trudniejsze w konfiguracji oraz delikatnie mówi±c nie najnowszej daty, jest 
jeszcze w u¿yciu wiele takich urz±dzeñ. (obecnie raczej nie mo¿na ju¿ kupiæ nowych 
urz±dzeñ ISA, przyp. t³um.) U¿ywaj±c urz±dzeñ pod³±czanych przy pomocy 
magistrali ISA (np. kontrolerów IDE/SCSI lub kart sieciowych), pamiêtaj, i¿ 
mog± one stanowiæ &quot;w±skie gard³o&quot; ca³ego systemu. O wiele wydajniejsze s± 
urz±dzenia oparte o magistrale PCI. Oczywi¶cie jest wiele kart rozszerzeñ 
opartych o magistralê ISA, które pracuj± wydajnie. W wiêkszo¶ci jednak s± to 
karty graficzne oraz karty d¼wiêkowe.
<P>
<LI><B>Nie stosuj tanich kart sieciowych PCI.</B> OpenBSD wspiera obs³ugê 
wielu tanich kart sieciowych. Karty te sprawdzaj± siê nie¼le w zastosowaniach 
domowych, ale w powa¿niejszych zastosowaniach mog± one nie byæ wystarczaj±co 
wydajne. Je¶li jednak potrzebujesz wy¿szej wydajno¶ci przy niskim obci±¿eniu 
serwera, lepszym rozwi±zaniem bêdzie zakup markowej karty sieciowej. Niestety, 
niektóre z dro¿szych, markowych kart sieciowych (takich jak 3Com serii XL) nie 
s± o wiele lepsze ni¿ te tanie. Jedn± z dobrych kart LAN o szybko¶ci 10/100Mbs 
jest Intel EtherExpress PRO/100. 
</UL>

<P>
<A name=Async></A>
<H2>11.5 - Dlaczego nie u¿ywaæ asynchronicznego montowania dysków?</H2>

<P>
Pytanie: "Robiê tak "mount -u -o async /", co powoduje, 
¿e u¿ywana przeze mnie paczka (oprogramowanie przyp. t³um.)
(które posiada od czasu do czasu dostêp do ró¿nych danych) jest w dalszym ci±gu zdatna do u¿ycia.
Dlaczego montowanie asynchroniczne nie jest zalecane 
i nie jest w³±czone domy¶lnie (jak to jest w innych unix'ach)? 
Czy¿ nie jest to prostsze oraz nie zwiêksza wydajno¶ci niektórych aplikacji?

<P>
Odpowied¼: "W rzeczy samej, asynchroniczne montowanie jest szybsze ni¿ synchroniczne, 
lecz jest mniej bezpieczne. Co stanie siê w przypadku zaniku zasilania? Czy te¿ problemu z hardwarem? 
D±¿enie do uzyskanie wiêkszej szybko¶ci nie powinno byæ okupione kosztem integralno¶ci i stabilno¶ci 
systemu. Przeczytaj opis polecenia 
<A href="http://www.openbsd.org/cgi-bin/man.cgi?query=mount&amp;sektion=8">mount(8)</A> w podrêczniku man." 

<PRE>	async    Wszystkie operacje wej¶cia/wyj¶cia w systemie plików 
        	 powinny byæ wykonane asynchronicznie. Jest to niebezpieczne,
	     	 poniewa¿ nie gwarantuje to spójno¶ci struktury systemu plików 
		 na dysku. Nie powiniene¶ u¿ywaæ tej opcji, chyba, ¿e jeste¶ 
		 przygotowany do ponownego utworzenia systemu plików w przypadku
		 awarii systemu. Najczê¶ciej u¿ywa siê tej flagi w celu przy¶pieszenia 
		 przywracania systemu plików poleceniem restore(8), co mo¿e przyczyniæ siê
		 do nawet dwukrotnego przy¶pieszenia operacji dyskowych.
</PRE>

<P>
Z innej strony, kiedy masz do czynienia z danymi tymczasowymi, które mo¿esz odtworzyæ 
po awarii systemu, mo¿esz zwiêkszyæ szybko¶æ u¿ywaj±c odrêbnej, asynchronicznie montowanej partycji
tylko i wy³±cznie dla tego typu danych. Rób to jednak <I>tylko je¶li</I> nie poniesiesz straty wszystkich danych 
w przypadku, gdy co¶ pójdzie nie tak jak by¶ siê tego spodziewa³. W tym celu, partycje <A 
href="http://www.openbsd.org/cgi-bin/man.cgi?query=mfs&amp;sektion=8">mfs(8)</A> 
s± montowane asynchronicznie, jako ¿e s± one czyszczone i ponownie tworzone po ka¿dym reboocie systemu.

<P>
<A name=XF86></A>
<H2>11.6 - Dostrajanie rozdzielczo¶ci ekranu pod XFree86</H2>

<P>
Ustawienie optymalnej rozdzielczo¶ci na wiêkszo¶ci monitorów typu multi-sync
jest mo¿liwe. Ktokolwiek próbowa³by zrobiæ to przy pomocy standardowych narzêdzi 
xf86config or XF86Setup, prawdopodobnie nie osi±gnie najlepszych, mo¿liwych 
do osi±gniêcia rezultatów. Jedn± z bardziej uci±¿liwych rzeczy jest zbyt niskie 
od¶wie¿anie (72-75 Hz) (czêstotliwo¶æ od¶wie¿ania pionowego VSYNC, przyp. t³um) 
przy preferowanej rozdzielczo¶ci ekranu, co powoduje, ¿e dra¿ni±ce oczy migotanie 
jest jedynie mniej widoczne dla ludzi. A co je¶li spróbujesz ustawiæ ten parametr 
na bardzo nisk± warto¶æ? Mo¿esz zobaczyæ to przy ustawieniu VSYNC na 50 Hz, tak by¶ 
móg³ zapisaæ obraz na video bez migotania, ale metody te nie s± tak oczywiste 
jak standardowe narzêdzia z XFree86 oraz dokumentacja.

<P>
Obecnie, w oferowanych przez niedrogie monitory rozdzielczo¶ciach 
(800x600, 1024x768, 1152x900, 1280x1024), których normalnie u¿ywa wiêkszo¶æ 
ludzi, mo¿liwe jest uzyskanie VSYNC na poziomie 85Hz lub wiêcej, co powoduje,
i¿ obraz jest czysty i stabilny. XFree86 X serwer posiada mechanizm (ModeLine) 
pozwalaj±cy opisaæ szczegó³owo tryb graficzny którego zamierzasz u¿ywaæ. 
Mechanizm ten sk³ada siê z czterech czê¶ci, pierwsza z nich to czêstotliwo¶æ rysowania pixela 
(pixel clock), nastêpna czê¶æ - cztery liczby - to takty synchronizacji poziomej, 
kolejna - cztery liczby - takty synchronizacji pionowej, wreczcie ostatnia, opcjonalna czê¶æ
zawieraj±ca listê dodatkowych parametrów (np. Interlace, DoubleScan ..).
Wiêcej informacji na ten temat znajdziesz w sekcji XF86Config(5) podrêcznika man.

<P>
Utworzenie ModeLine'a jest czarn± magi±... Na szczê¶cie, jest kilka skryptów, 
które zrobi± to za Ciebie. Jendnym z nich jest 
<A href="http://www-sop.inria.fr/cgi-bin/koala/nph-colas-modelines">Colas XFree86 ModeLine Generator</A>. 
Kolejny to 
<A href="http://xtiming.sourceforge.net/">The XFree86 Modeline Generator</A> 
umieszczony na witrynie SourceForge, inne znajdziesz na witrynie 
<a href="http://freshmeat.net/search/?q=modeline">Freshmeat</A>. Zanim zaczniesz ich u¿ywaæ, 
musisz dowiedzieæ siê w jakich zakresach VSYNC i HSYNC pracuje Twój monitor.
Jest to czêsto udokumentowane w instrukcji lub na witrynie www producenta.
Je¶li nie mo¿esz tego znale¼æ, przeszukaj sieæ www podaj±c producenta i model monitora. 
Niektóre osoby podaj± te dane na swoich stronach.

<P>
Na przyk³ad, powiedzmy, ¿e masz monitor Dell D1226H. Dowiedzia³e¶ siê, ¿e 
pracuje on przy nastêpuj±cych warto¶ciach parametrów HSYNC 30-95 kHz oraz 
VSYNC 50-160 Hz. Odwied¼ teraz stronê ModeLine generator i wprowad¼ te informacje. 
Potem wprowad¼ minimaln± warto¶æ VSYNC, jakiej chcesz u¿yæ.  
Powy¿ej 72 Hz migotanie obrazu nie powinno byæ widoczne. Im wy¿sza ta warto¶æ 
tym czystszy i stabilniejszy staje siê obraz.

<P>
Przy pomocy tych informacji, skrypt wygeneruje ModeLine'y dla w ka¿dej mo¿liwej
rozdzielczo¶ci przy proporcjach ekranu 4x3, przy od¶wie¿aniu powy¿ej minimalnej, 
wprowadzonej wcze¶niej warto¶ci VSYNC. Skrypt ten wygeneruje nastêpuj±ce wpisy: 

<PRE>ModeLine "320x240" 20.07 320 336 416 448 240 242 254 280 #160Hz
ModeLine "328x246" 20.86 328 344 424 456 246 248 260 286 #160Hz
...
ModeLine "816x612" 107.39 816 856 1056 1136 612 614 626 652 #145Hz
ModeLine "824x618" 108.39 824 864 1064 1144 618 620 632 658 #144Hz
ModeLine "832x624" 109.38 832 872 1072 1152 624 626 638 664 #143Hz
...
ModeLine "840x630" 109.58 840 880 1080 1160 630 632 644 670 #141Hz
ModeLine "848x636" 110.54 848 888 1088 1168 636 638 650 676 #140Hz
...
ModeLine "1048x786" 136.02 1048 1096 1336 1432 786 788 800 826 #115Hz
ModeLine "1056x792" 136.58 1056 1104 1344 1440 792 794 806 832 #114Hz
ModeLine "1064x798" 137.11 1064 1112 1352 1448 798 800 812 838 #113Hz
...
ModeLine "1432x1074" 184.07 1432 1496 1816 1944 1074 1076 1088 1114 #85Hz
ModeLine "1576x1182" 199.86 1576 1648 2008 2152 1182 1184 1196 1222 #76Hz
ModeLine "1584x1188" 198.93 1584 1656 2016 2160 1188 1190 1202 1228 #75Hz
</PRE>

<P>
Wiemy, i¿ monitor pracuje w rodzileczo¶ci 1600x1200 @ 75 Hz,
a skrypt tego nie poda³. Z tego powodu, je¶li chcemy pracowaæ w rozdzielczo¶ci
1600x1200, musimy obni¿yæ minimalny VSYNC do 70Hz. Po tych zmianach skrypt 
zwróci nastêpuj±ce wyniki:

<PRE>ModeLine "1592x1194" 197.97 1592 1664 2024 2168 1194 1196 1208 1234 #74Hz
ModeLine "1600x1200" 199.67 1600 1672 2032 2176 1200 1202 1214 1240 #74Hz
ModeLine "1608x1206" 198.65 1608 1680 2040 2184 1206 1208 1220 1246 #73Hz
ModeLine "1616x1212" 197.59 1616 1688 2048 2192 1212 1214 1226 1252 #72Hz
ModeLine "1624x1218" 199.26 1624 1696 2056 2200 1218 1220 1232 1258 #72Hz
ModeLine "1632x1224" 198.15 1632 1704 2064 2208 1224 1226 1238 1264 #71Hz
ModeLine "1640x1230" 199.81 1640 1712 2072 2216 1230 1232 1244 1270 #71Hz
ModeLine "1648x1236" 198.64 1648 1720 2080 2224 1236 1238 1250 1276 #70Hz
</PRE>

<P>
Teraz widzimy ,i¿ monitor pracuje naprawdê w rozdzielczo¶ci 1600x1200 @ 74 Hz 
co jest spowodowane maksymaln± warto¶ci± szeroko¶ci pasma (200 MHz). 
Ustaw tê warto¶æ stosownie do parametrów monitora.

<P>
Po wygenerowaniu w³asnych ModeLine'ów, nale¿y umie¶ciæ je w pliku /etc/X11/XF86Config. 
Ponadto nale¿y zakomentowaæ stare ModeLine'y, na wypadek gdyby¶ musia³ ich ponownie u¿yæ,
co mo¿e mieæ miejsce, gdy nowo dodane nie chc± dzia³aæ. Nastêpnie nale¿y ustawiæ 
rozdzielczo¶æ ekranu, przy której zamierzasz pracowaæ. Po pierwsze, sprawd¼ czy system X 
pracuje w trybie z akceleracj± (co jest normalne dla wiêkszo¶ci kart graficznych),
wiêc ju¿ wiesz, któr± sekcjê <TT>"Screen"</TT> pliku XF86Config nale¿y zmieniæ. 
Inn± mo¿liwo¶ci± jest zmiana wszystkich sekcji Screen. 
<PRE>Section "Screen"
   Driver          "Accel"
   Device          "Primary Card"
   Monitor         "Primary Monitor"
   DefaultColorDepth 32
   SubSection "Display"
      Depth        32
      Modes        "1280x1024" "1024x768"
   EndSubSection
</PRE>

<P>
Pierwsza rozdzielczo¶æ, któr± widzisz po s³owie "Modes" jest rozdzielczo¶ci±, 
w której system X wystartuje. Poprzez wci¶niêcie kombinacji CTRL-ALT-KEYPAD MINUS 
lub or CTRL-ALT-KEYPAD PLUS, mo¿esz prze³±czaæ siê pomiêdzy rozdzielczo¶ciami 
z tej listy. System X bêdzie próbowa³ wystartowaæ w trybie 32-bitowego koloru 
(zgodnie z derektyw± DefaultColorDepth, bez której wystartowa³by w trybie 8-bitowym).
Pierwsz± rozdzielczo¶ci±, któr± system X bêdzie próbowa³ u¿yæ jest 1280x1024 
(zgodnie z kolejno¶ci± wpisów w linii Modes). Zauwa¿, i¿ "1280x1024" jest etykiet±
warto¶ci zdefiniowanych w ModeLine'ach. 

<P>
Ponadto skrypt 'ModeLine generator' posiada opcje do regulacji taktowania (timings) dla starszych 
czy te¿ mniejszych monitorów, dodatkowo posiada tak¿e mo¿liwo¶æ tworzenia ModeLine'ów 
dla nietypowych rozdzielczo¶ci. W zale¿no¶ci od typu sprzêtu jaki posiadasz mo¿e nie byæ 
prostym zadaniem u¿ywanie skryptu z domy¶lnymi przy zastosowaniu opcji 
domy¶lnych. Je¶li obraz jest zbyt 
wysoki, zbyt szeroki, zbyt ma³y przesuniêty w pionie lub poziomie, a manipulacja 
ustawieniami monitora nie umo¿liwia korekcji tych zniekszta³ceñ, mo¿esz u¿yæ 
xvidtune(1) w celu lepszego dostosowania taktowania (timings) monitora.

<P>
W wiêkszo¶ci nowoczesnych monitorów nie ma ustalonego limitu pasma, 
tak wiêc nie podaje siê go w parametrach technicznych. Jedynym objawem przekroczenia
tego parametru jest to, i¿ im bardziej go przekraczasz, tym bardziej niewyra¼ny 
staje siê obraz. Tak wiêc mo¿esz uwa¿aæ za stosowne okre¶lenie tego paramertu dla swojej karty
(inaczej nazywany jest "dotclock") w celach testowych (nie mo¿na w ten sposób uszkodziæ monitora), 
a po odpowiednim obni¿eniu tej warto¶ci otrzymasz wyra¼ny obraz.

<P>
Mo¿e wydawaæ Ci siê to zbyt skomplikowane, poniewa¿ tak jest w rzeczywisto¶ci. 
XFree86 4.0 sam wyznacza ten parametr, co upraszcza proces odk±d posiada wiele 
wbudowanych trybów i jest zdolny odczytaæ mo¿liwo¶ci monitorów "plug and play" 
poprzez DDC oraz DDC2. 

<P>
Mo¿esz pobraæ skrypt Colas XFree86 ModeLine Generator z <A 
href="http://koala.ilog.fr/ftp/pub/Klone/">http://koala.ilog.fr/ftp/pub/Klone/</A>. 
Potrzebne bêdzie pobranie 'Klone interpreter' i jego kompilacja. Znajduje siê on w portach 
pod pozycj± <TT>lang/klone</TT>. Skrypty umieszczone s± w strukturze katalogów dystybucji 
Klone'a. (Port ten instaluje te skrypty w /usr/local/lib/klone/scripts.) 

<P>
S± tam za³±czone dwie wersje, pierwsza oparta o CGI identyczna z t± na stronie. 
Druga, nie CGI, analizuje plik XF86Config , dekoduje parametry monitora wpisane w 
xf86config/XF86Setup (Teraz pomy¶l, czy aktualnie wpisa³e¶ specyfikacje swojego monitora, 
czy u¿y³e¶ domy¶lnego pliku?), i koryguje jak nale¿y istniej±ce ModeLine'y.

<P>
<FONT color=#0000e0>
<A href="index.html">[Spis tre¶ci]</A>
<A href="faq10.html">[Sekcja 10 - Zarz±dzanie systemem]</A>
<A href="faq12.html">[Sekcja 12 - Pytanie dotycz±ce poszczególnych platform]</A>
</FONT>

<P>
<HR>
<A href="index.html"><IMG height="24"  src="../../images/back.gif" width="24" border="0" alt="[back]"></A> 
<A href="mailto:www@openbsd.org">www@openbsd.org</A> 
<BR>
<SMALL>
Originally [OpenBSD: faq11.html,v 1.47 ]<BR>
$Translation: faq11.html,v 1.11 2004/02/07 23:15:34 pl-team Exp $<BR>
$OpenBSD: faq11.html,v 1.10 2004/02/08 12:15:50 jufi Exp $
</SMALL>
</BODY>
</HTML>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Antyaliasing i czcionki TrueType w systemie OpenBSD</title>
<link rev="made" href="www@OpenBSD.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-2">
<meta name="resource-type" content="document">
<meta name="description"   content="the OpenBSD FAQ page">
<meta name="keywords"      content="openbsd,faq,antialiasing,anti-aliasing,truetype,fonts,X.org,XF4">
<meta name="distribution"  content="global">
<meta name="copyright"     content="This document copyright 2001-2004 by OpenBSD.">
</head>

<body bgcolor="#ffffff" text="#000000">
<a href="http://www.openbsd.org/"><img alt="[OpenBSD]" border="0"
  height=30 width=141 src="../../images/smalltitle.gif"></a>

<h1>Antyaliasing i czcionki TrueType w systemie OpenBSD</h1>

<h3>Spis tre¶ci:</h3>
<ul>
<li><a href="truetype.html#xterm">Zrzut ekranu xterm`a</a>
<li><a href="truetype.html#konqueror">Zrzut ekranu Konqueror`a</a>
<li><a href="truetype.html#how">W jaki sposób to dzia³a?</a>
<li><a href="truetype.html#work">Co trzeba zrobiæ, aby to mieæ?</a>
<li><a href="truetype.html#applications">Które aplikacje mog± z tego korzystaæ?</a>
<li><a href="truetype.html#manualfonts">Jak mogê dodaæ fonty rêcznie?</a>
</ul>
<hr>

<a name="xterm"></a>
<h2>Zrzut ekranu xterm'a</h2>
porównanie dwóch
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xterm&amp;sektion=1"
>xterm(1)</a>'ów z czcionkami z aliasingiem i bez:
<div align="center"><img src="../images/xterm_diff.jpg"
  alt="[Standard and anti-aliased xterm]"></div>

<a name="konqueror"></a>
<h2>Zrzut ekranu Konqueror`a</h2>
Wci±¿ niezbyt przekonany?
Rzuæ zatem okiem na to:

<p>
Porównanie dwóch <a href="http://konqueror.kde.org/">przegl±darki
Konqueror</a> z czcionkami z aliasingiem i bez:
<div align="center"><img src="../images/konqueror_diff.jpg"
  alt="[Standard and anti-aliased Konqueror]"></div>

<a name="how"></a>
<h2>W jaki sposób to dzia³a?</h2>
Obliczenia aliasingowe s± wykonywane przez
<a href="http://www.freetype.org/">FreeType</a>, wolnodostêpny
standard fontów, który stanowi czê¶æ X.org. X.org dodatkowo
posiada rozszerzenie tzw.
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=Xft&amp;sektion=3">Xft(3)</a>,
rozszerzenie X FreeType, które wspó³pracuje z FreeType podczas
operacji renderowania. Xft wspó³pracuje tak¿e z rozszerzeniem o nazwie
<i>Xrender</i>, rozszerzenie X Render, który przekszta³ca obliczenia w
cyfrowe obrazy.

<a name= "work"></a>
<h2>Co trzeba zrobiæ, aby to mieæ?</h2>
OpenBSD rozpowszechniane jest z X.org i za³±czonym rozszerzeniem
X Render.
Aby móc z niego korzystaæ, twój serwer X`ów (sterownik karty graficznej)
musi je wspieraæ. Niektóre sterowniki nie zosta³y jeszcze dostosowane do
kodu 'fb' i dlatego nie s± w stanie wykorzystywaæ rozszerzenia Render,
co jest niezbêdne.

<p>
Mo¿esz sprawdziæ jak jest w przypadku twojej karty komend±:

<blockquote><pre>
$ <strong>/usr/X11R6/bin/xdpyinfo | grep RENDER</strong>
RENDER
</pre></blockquote>

Je¶li nie zostanie wypisane &quot;RENDER&quot; na li¶cie rozszerzeñ,
bêdziesz musia³ poczekaæ a¿ kto¶ zaimplementuje niezbêdne rozszerzenie
dla twojej karty.

<p>
Nastêpnym krokiem jest pobranie i instalacja jaki¶ fontów TrueType.
Zestaw popularnych fontów zosta³ skompilowany i jest dostêpny w
<a href="faq8.html#Ports">drzewie portów OpenBSD</a>, dok³adnie w
<tt>/usr/ports/x11/msttcorefonts</tt>. Mo¿esz jest zainstalowaæ w systemie
wykonuj±c:

<blockquote><pre>
# <b>cd /usr/ports/x11/msttcorefonts</b>
# <b>make</b>
# <b>make install</b>
</pre></blockquote>

W tym momencie powiniene¶ odwo³aæ siê do <a href="#manualfonts">innej
sekcji tego dokumentu</a>, aby dowiedzieæ siê jak zarejestrowaæ fonty
w X`ach.

<a name= "applications"></a>
<h2>Które aplikacje mog± z tego korzystaæ?</h2>
Ka¿da aplikacja zdolna do wspó³pracy z Xft mo¿e wy¶wietlaæ antyaliasingowe
fonty. S± to w szczególno¶ci aplikacje oparte o QT 3.x (KDE 3.x) i GTK+2
(Gnome 2.x). Standardowe programy X, które wspó³pracuj± z Xft to
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xterm&amp;sektion=1">xterm(1)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xditview&amp;sektion=1">xditview(1)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xfd&amp;sektion=1">xfd(1)</a>,
i kilka innych.

<h3>xterm</h3>
<tt>xterm</tt> mo¿e byæ wywo³any z argumentami uruchamiaj±cymi wy¶wietlanie
fontów poprzez Xft:

<blockquote><pre>
$ <strong>xterm -fa 'Andale Mono' -fs 14</strong>
</pre></blockquote>

Opcje te to:
<blockquote><pre>
Option   Resource         Meaning
----------------------------------------
 -fa     XTerm*faceName   Font face name
 -fs     XTerm*faceSize   Font size
</pre></blockquote>

Alternatywnie, mo¿na wykorzystaæ zasoby X`ów. S± one domy¶lnie
konfigurowane w <tt>$HOME/.Xdefaults</tt> i kontrolowalne poprzez program
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xrdb&amp;sektion=1">xrdb(1)</a>.

<p>
Niektóre czcionki TrueType (jak np. Arial, Georgia czy Verdana)
nie wspó³pracuj± dobrze z <tt>xterm</tt>. Dzieje siê tak, poniewa¿
<tt>xterm</tt> wykorzystuje maksymaln± szeroko¶æ spo¶ród wszystkich znaków
podanej czcionki, aby wy¶wietlaæ znaki. W przypadku fontów o sta³ej
szeroko¶ci wszystko jest w porz±dku. W przypadku czcionki o zmiennej
szeroko¶ci, proporcjonalnej, tak jak wymienione wcze¶niej przyk³ady,
<tt>xterm</tt> wy¶wietla ka¿dy znak rozci±gniêty do maksymalnej szeroko¶ci,
tworz±c nieczytelne, du¿e przestrzenie miêdzy znakami.

<h3>Aplikacje QT 3.x/KDE 3.x</h3>
Aplikacje, które korzystaj± z QT 3.x, takie jak dowolna aplikacja KDE 3.x,
w³±czaj±c Konqueror, mog± korzystaæ z wy¶wietlania poprzez Xft dziêki
ustawieniu w sekcji <tt>[General]</tt> pliku <tt>$HOME/.qt/qtrc</tt>:

<blockquote><pre>
useXft=true
</pre></blockquote>

W graficznym programie konfiguracyjny Qt, <tt>qtconfig</tt> (lub
<tt>qtconfig-mt</tt> je¶li wielow±tkowa wersja Qt zosta³a zainstalowana),
mo¿na skonfigurowaæ t± zmienn± poprzez prze³±cznik <b>Enable Anti-aliased
Font Support</b> w zak³adce <b>Fonts</b>.

<h3>Aplikacje GTK+2</h3>
Aplikacje GTK+2 wymagaj± ustawienia zmiennej ¶rodowiskowej
<tt>GDK_USE_XFT</tt>. GDK to zakulisowa bibliotek wykorzystywana
przez GTK do odseparowania detali operacji rysowania i przeka¿e
swoje operacje wy¶wietlania do Xft, gdy wykryje zmienn± ¶rodowiskow±.

<p>
Ta komenda uruchamia oparty o GTK+2 komunikator
<a href="http://gaim.sourceforge.net/">Gaim</a>, dostêpny w
<b>/usr/ports/net/gaim</b>:

<blockquote><pre>
$ env GDK_USE_XFT=1 gaim
</pre></blockquote>

<a name="manualfonts"></a>
<h2>Jak mogê dodaæ fonty rêcznie?</h2>
Dodawanie fontów TrueType &quot;do X`ów&quot; wymaga rejestracji fontów
zarówno w serwerze X`ów jak i
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fontconfig&amp;sektion=3">fontconfig(3)</a>,
poniewa¿ oba programy ¶ledz± czcionki niezale¿nie. Prawdê mówi±c, niektóre
typy fontów s± rozpoznawane jedynie przez w³a¶ciwy X`serwer, a inne tylko
przez fontconfig. Czcionki TrueType s± jednym z typów rozpoznawanym przez
oba.

<h3>Serwer X`ów</h3>
¦cie¿ki do czcionek (np, kartotek zawieraj±cych czcionki) s± zarz±dzane
bezpo¶rednio przez X`y w <tt>/etc/X11/xorg.conf</tt> lub poprzez osobny
program, taki jak
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xfs&amp;sektion=1">xfs(1)</a>.
Aby dodaæ czcionkê, dodaj kartotekê w której siê ona znajduje do
<tt>/etc/X11/xorg.conf</tt>:

<blockquote><pre>
Section "Files"
	FontPath	"/usr/X11R6/lib/X11/fonts/TTF/"
	FontPath	"<i>/usr/local/lib/X11/fonts/myfonts/</i>"
	...
EndSection
</pre></blockquote>

Lub je¶li korzystasz z <tt>xfs</tt>, dodaj kartoteki do
<tt>/etc/X11/fs/config</tt>:

<blockquote><pre>
catalogue = /usr/X11R6/lib/X11/fonts/TTF/,
	    <i>/usr/local/lib/X11/fonts/myfonts/</i>
</pre></blockquote>

Nastêpnie, serwer X`ów musi zostaæ powiadomiony o czcionce zindeksowanej
w tej kartotece, np w piku <tt>fonts.dir</tt>. Tradycyjnie, wszystkie
dostêpne wielko¶ci fontów s± wylistowane w pliku indeksuj±cym,
wygenerowanym przez komendê
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mkfontdir&amp;sektion=1">mkfontdir(1)</a>.
Niemniej, poniewa¿ czcionki TrueType mog± byæ skalowane do dowolnej
wielko¶ci, wylistowanie ka¿dej mo¿liwej wielko¶ci nie jest konieczne.
Zamiast tego, skalowalne czcionki s± wylistowane w pliku
<tt>fonts.scale</tt> i s± rozpoznawane przez <tt>mkfontdir</tt>
podczas generowania indeksów <tt>fonts.dir</tt>.

<p>
Aby utworzyæ plik <tt>fonts.scale</tt>, mo¿na skorzystaæ z programu
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mkfontscale&amp;sektion=1">mkfontscale(1)</a>:

<blockquote><pre>
# <b>cd <i>/usr/local/lib/X11/fonts/myfonts</i></b>
# <b>/usr/X11R6/bin/mkfontscale</b>
# <b>/usr/X11R6/bin/mkfontdir</b>
</pre></blockquote>

W koñcu, aby zaaplikowaæ zmiany w obecnej sesji X`ów, zamiast restartowaæ
X`y, mo¿na u¿yæ poni¿szej komendy powoduj±cej ponowne sprawdzenie obecnie
zarejestrowanych ¶cie¿ek w poszukiwaniu zmian:

<blockquote><pre>
$ <b>xset fp rehash</b>
</pre></blockquote>

Lub, je¶li zosta³a dodana nowa ¶cie¿ka:

<blockquote><pre>
$ <b>xset +fp <i>/usr/local/lib/X11/fonts/myfonts</i></b>
</pre></blockquote>

Je¶li korzysta¿ z <tt>xfs</tt>, nale¿y zamiast tego skorzystaæ z:

<blockquote><pre>
# <b>pkill -HUP xfs</b>
</pre></blockquote>

<h3>fontconfig</h3>
Innym komponentem X`ów, który musi byæ powiadomiony o nowym foncie to
fontconfig, którego Xft u¿ywa do wyszukiwania czcionek. fontconfig
korzysta z pliku <tt>/etc/fonts/fonts.conf</tt> do swojej g³ównej,
ogólnosystemowej konfiguracji, jednak poniewa¿ plik ten bêdzie
podmieniany podczas kolejnych aktualizacji X`ów, nale¿y korzystaæ z
<tt>/etc/fonts/local.conf</tt> do aplikowania ogólnosystemowych
zmian.

<p>
Dodaj kartotekê zawieraj±cych czcionkê do tego pliku konfiguracyjnego:

<blockquote><pre>
&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;!DOCTYPE fontconfig SYSTEM &quot;/etc/fonts/fonts.dtd&quot;&gt;
&lt;fontconfig&gt;
  &lt;dir&gt;<i>/usr/local/lib/X11/fonts/myfonts</i>&lt;/dir&gt;
&lt;/fontconfig&gt;
</pre></blockquote>

Lub, je¶li tylko jeden u¿ytkownik deklaruje chêæ dodania danych
czcionek do swojej sesji X'ów, powy¿sza konfiguracja mo¿e zostaæ
umieszczona w pliku <tt>$HOME/.fonts.conf</tt> tego u¿ytkownika.

<p>
Zwróæ uwagê, ¿e fontconfig bêdzie rekurencyjnie przegl±da³ wszystkie
podkatalogi w poszukiwaniu dostêpnych fontów, podczas gdy standardowy
serwer X`ów nie bêdzie tego robi³.

<p>
Po tym jak dodany zostanie katalog, cache kartotek czcionek musi
zostaæ wygenerowany na nowo. Nastêpuj±ca komenda poinstruuje fontconfig
aby ponownie wygenerowaæ cache dla wszystkich kartotek czcionek
wylistowanych w swojej konfiguracji:

<blockquote><pre>
# <b>/usr/X11R6/bin/fc-cache -v</b>
</pre></blockquote>

Zmiany te nie bêd± mieæ miejsca w obecnej sesji X`ów, wiêc same X`y
nie musz± byæ zrestartowane, niemniej ju¿ uruchomione aplikacje
tego wymagaj±.

<hr>
<a href="../index.html"><img height="24" width="24" src="../../images/back.gif"
  border="0" alt="[back]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: truetype.html,v 1.17 ]<br>
$Translation: truetype.html,v 1.6 2006/05/20 18:23:10 tkniaz Exp $<br>
-->
$OpenBSD: truetype.html,v 1.6 2006/05/24 06:48:44 jufi Exp $
</small>
</body>
</html>

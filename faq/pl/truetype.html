<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Antyaliasing i czcionki TrueType w systemie OpenBSD</title>
<link rev="made" href="www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-2">
<meta name="resource-type" content="document">
<meta name="description"   content="the OpenBSD FAQ page">
<meta name="keywords"      content="openbsd,faq,antialiasing,anti-aliasing,truetype,fonts,X.org,XF4">
<meta name="distribution"  content="global">
<meta name="copyright"     content="This document copyright 2001-2008 by OpenBSD.">
</head>

<body bgcolor="#ffffff" text="#000000">
<a href="http://www.openbsd.org/"><img alt="[OpenBSD]" border="0"
  height=30 width=141 src="../../images/smalltitle.gif"></a>

<h1>Antyaliasing i czcionki TrueType w systemie OpenBSD</h1>

<h3>Spis tre¶ci:</h3>
<ul>
<li><a href="truetype.html#xterm">Zrzut ekranu xterm`a</a>
<li><a href="truetype.html#konqueror">Zrzut ekranu Konqueror`a</a>
<li><a href="truetype.html#how">W jaki sposób to dzia³a?</a>
<li><a href="truetype.html#work">Co trzeba zrobiæ, aby to mieæ?</a>
<li><a href="truetype.html#applications">Które aplikacje mog± z tego korzystaæ?</a>
<li><a href="truetype.html#manualfonts">Jak mogê dodaæ fonty rêcznie?</a>
</ul>
<hr>

<a name="xterm"></a>
<h2>Zrzut ekranu xterm'a</h2>
porównanie dwóch
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xterm&amp;sektion=1"
>xterm(1)</a>'ów z czcionkami z aliasingiem i bez:
<div align="center"><img src="../images/xterm_diff.jpg"
  alt="[Standard and anti-aliased xterm]"></div>

<a name="konqueror"></a>
<h2>Zrzut ekranu Konqueror`a</h2>
Wci±¿ niezbyt przekonany?
Rzuæ zatem okiem na to:

<p>
Porównanie dwóch <a href="http://konqueror.kde.org/">przegl±darki
Konqueror</a> z czcionkami z aliasingiem i bez:
<div align="center"><img src="../images/konqueror_diff.jpg"
  alt="[Standard and anti-aliased Konqueror]"></div>

<a name="how"></a>
<h2>W jaki sposób to dzia³a?</h2>
Ze wzglêdu na zapotrzebowanie obs³ugi antyaliasowanych czcionek, w 2001 r.
zosta³ wprowadzony, <i>dzia³aj±cy po stronie klienta</i>, silnik renderuj±cy.

Obliczenia aliasingowe s± wykonywane przez
<a href="http://www.freetype.org/">FreeType</a>, wolnodostêpny
standard fontów, który jest wykorzystywany przez bibliotekê 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=Xft&amp;sektion=3">Xft(3)</a>,
rozszerzenie X FreeType.
Rozszerzenie <a href="http://keithp.com/~keithp/talks/usenix2001/">Render</a>
zapewnia wykonywanie operacji koniecznych do wymieszania sub-pikselowych cieni
na tle aplikacji.

<p>
Ponadto X.Org korzysta z biblioteki
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fontconfig&amp;sektion=3">fontconfig(3)</a>
do zarz±dzania zainstalowanymi czcionkami, a tak¿e ich nazwami oraz w³a¶ciwo¶ciami.

<a name= "work"></a>
<h2>Co trzeba zrobiæ, aby to mieæ?</h2>
W³a¶ciwie, nic. OpenBSD zawiera X.Org wraz z w³±czonym rozszerzeniem X Render
dla ka¿dego sterownika kart graficznych w trybie 8-bit/piksel lub wy¿szym.

<p>
Mo¿na sprawdziæ czy w³±czone jest rozszerzenie X Render poprzez polecenie:

<blockquote><pre>
$ <strong>/usr/X11R6/bin/xdpyinfo | grep RENDER</strong>
RENDER
</pre></blockquote>


<p>
Dodatkowo wraz z OpeBSD dostarczana jest rodzina czcionek <b>Bitstream Vera</b>,
czyli zestaw popularnych czcionek True Type, s± one dostêpne w
<a href="faq8.html#Ports">drzewie portów OpenBSD</a>, dok³adnie w
<tt>/usr/ports/x11/msttcorefonts</tt>. Mog± byæ zainstalowane w systemie
poprzez wykonanie:

<blockquote><pre>
# <b>cd /usr/ports/x11/msttcorefonts</b>
# <b>make install</b>
</pre></blockquote>

<p>
Zestaw portów zawiera tak¿e inne pakiety czcionek True Type, szczególnie
czcionki <b>uwolnione</b>, które mog± zast±piæ czcionki Microsoft Web
i s± rozpowszechniane ze znacznie bardziej akceptowaln± licencj±.


<a name= "applications"></a>
<h2>Które aplikacje mog± korzystaæ z antyaliasowanych czcionek?</h2>
Ka¿da aplikacja zdolna do wspó³pracy z Xft mo¿e wy¶wietlaæ antyaliasingowe
czcionki. S± to w szczególno¶ci aplikacje oparte o QT 3.x (KDE 3.x) i GTK+2
(Gnome 2.x). Standardowe programy X, które wspó³pracuj± z Xft to
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xterm&amp;sektion=1">xterm(1)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xclock&amp;sektion=1">xclock</a>,
i kilka innych.

<h3>xterm</h3>
<tt>xterm</tt> mo¿e byæ wywo³any z argumentami uruchamiaj±cymi wy¶wietlanie
fontów poprzez Xft:

<blockquote><pre>
$ <strong>xterm -fa 'Mono' -fs 14</strong>
</pre></blockquote>

Opcje te to:
<blockquote><pre>
Option   Resource         Meaning
----------------------------------------
 -fa     XTerm*faceName   Font face name
 -fs     XTerm*faceSize   Font size
</pre></blockquote>

Alternatywnie, mo¿na wykorzystaæ zasoby X`ów. S± one domy¶lnie
konfigurowane w <tt>$HOME/.Xdefaults</tt> i kontrolowalne poprzez program
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xrdb&amp;sektion=1">xrdb(1)</a>.

<p>
Niektóre czcionki TrueType (jak np. Arial, Georgia czy Verdana)
nie wspó³pracuj± dobrze z <tt>xterm</tt>. Dzieje siê tak, poniewa¿
<tt>xterm</tt> wykorzystuje maksymaln± szeroko¶æ spo¶ród wszystkich znaków
podanej czcionki, aby wy¶wietlaæ znaki. W przypadku fontów o sta³ej
szeroko¶ci wszystko jest w porz±dku. W przypadku czcionki o zmiennej
szeroko¶ci, proporcjonalnej, tak jak wymienione wcze¶niej przyk³ady,
<tt>xterm</tt> wy¶wietla ka¿dy znak rozci±gniêty do maksymalnej szeroko¶ci,
tworz±c nieczytelne, du¿e przestrzenie miêdzy znakami.

<h3>Aplikacje QT 3.x/KDE 3.x</h3>
Aplikacje, które korzystaj± z QT 3.x, takie jak dowolna aplikacja KDE 3.5.x,
w³±czaj±c Konqueror, domy¶lnie korzystaj± z Xft.

<h3>Aplikacje GTK+2</h3>
Aplikacje GTK+2 teraz równie¿ domy¶lnie korzystaj± z Xft.

<a name="manualfonts"></a>
<h2>Jak mogê dodaæ fonty rêcznie?</h2>
Dodawanie fontów TrueType &quot;do X`ów&quot; wymaga rejestracji fontów
zarówno w serwerze X`ów jak i w bibliotece fontconfig,
poniewa¿ oba programy ¶ledz± czcionki niezale¿nie.

<h3>Renderowanie czcionek po stronie klienta</h3>
Czcionki zainstalowane jako pakiety z portów s± automatycznie rejestrowane
w systemie fontconfig.

Fontconfig korzysta z pliku <tt>/etc/fonts/fonts.conf</tt> jako swojego
podstawowego pliku konfiguracyjnego, jednak ze wzglêdu na mo¿liwo¶æ
zast±pienia tego pliku podczas pó¼niejszych aktualizacji X-ów, powinno
siê korzystaæ z pliku <tt>/etc/fonts/local.conf</tt>.

Fontconfig bêdzie przeszukiwa³ wszystkie podkatalogi w katalogach
podanych w <tt>/etc/fonts/fonts.conf</tt>. Nie ma wiêc potrzeby edytowaæ tego
pliku w przypadku gdy nowe czcionki dodawane s± do tej hierarchii.

<p>
Po dodaniu katalogu konieczne jest wygenerowanie dla niego pliku "cache".
Podane poni¿ej polecenie nakazuje fontconfig wykonanie przebudowy pamiêci
podrêcznej czcionek dla wszystkich podkatalogów okre¶lonych w jego konfiguracji:

<blockquote><pre>
# <b>/usr/X11R6/bin/fc-cache -v</b>
</pre></blockquote>

Zmiany te zostan± uwzglêdnione w bierz±cej sesji X-ów, nie istnieje zatem
potrzeba restartu X-ów, jednak wymagane jest ponownie uruchomienie aplikacji.

<p>
Polecenie <b>fc-list</b> mo¿e zostaæ u¿yte do wylistowania wszystkich czcionek
znanych w systemie. Uwa¿aj jednak na fakt, ¿e wynik tego polecenia zawiera
miêdzynarodowe nazwy czcionek w kodowaniu UTF-8. Zdecydowanie lepiej jest
wiêc wykonywaæ to polecenie w terminalu zdolnym do obs³ugi UTF-8, np.
<b>uxterm</b>.


<h3>Renderowanie czcionek po stronie serwera</h3>
¦cie¿ki do czcionek (np, kartotek zawieraj±cych czcionki) s± zarz±dzane
bezpo¶rednio przez serwer X-ów, poprzez <tt>/etc/X11/xorg.conf</tt>, lub poprzez osobny
program, taki jak
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xfs&amp;sektion=1">xfs(1)</a>.
Aby dodaæ czcionkê, dodaj kartotekê w której siê ona znajduje do
<tt>/etc/X11/xorg.conf</tt>:

<blockquote><pre>
Section "Files"
	FontPath	"/usr/X11R6/lib/X11/fonts/TTF/"
	FontPath	"<i>/usr/local/lib/X11/fonts/myfonts/</i>"
	...
EndSection
</pre></blockquote>

Lub je¶li korzystasz z <tt>xfs</tt>, dodaj kartoteki do
<tt>/etc/X11/fs/config</tt>:

<blockquote><pre>
catalogue = /usr/X11R6/lib/X11/fonts/TTF/,
	    <i>/usr/local/lib/X11/fonts/myfonts/</i>
</pre></blockquote>

Nastêpnie, serwer X`ów musi zostaæ powiadomiony o czcionce zindeksowanej
w tej kartotece, np w piku <tt>fonts.dir</tt>. Tradycyjnie, wszystkie
dostêpne wielko¶ci fontów s± wylistowane w pliku indeksuj±cym,
wygenerowanym przez komendê
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mkfontdir&amp;sektion=1">mkfontdir(1)</a>.
Niemniej, poniewa¿ czcionki TrueType mog± byæ skalowane do dowolnej
wielko¶ci, wylistowanie ka¿dej mo¿liwej wielko¶ci nie jest konieczne.
Zamiast tego, skalowalne czcionki s± wylistowane w pliku
<tt>fonts.scale</tt> i s± rozpoznawane przez <tt>mkfontdir</tt>
podczas generowania indeksów <tt>fonts.dir</tt>.

<p>
Aby utworzyæ plik <tt>fonts.scale</tt>, mo¿na skorzystaæ z programu
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mkfontscale&amp;sektion=1">mkfontscale(1)</a>:

<blockquote><pre>
# <b>cd <i>/usr/local/lib/X11/fonts/myfonts</i></b>
# <b>/usr/X11R6/bin/mkfontscale</b>
# <b>/usr/X11R6/bin/mkfontdir</b>
</pre></blockquote>

W koñcu, aby zaaplikowaæ zmiany w obecnej sesji X`ów, zamiast restartowaæ
X`y, mo¿na u¿yæ poni¿szej komendy powoduj±cej ponowne sprawdzenie obecnie
zarejestrowanych ¶cie¿ek w poszukiwaniu zmian:

<blockquote><pre>
$ <b>xset fp rehash</b>
</pre></blockquote>

Lub, je¶li zosta³a dodana nowa ¶cie¿ka:

<blockquote><pre>
$ <b>xset +fp <i>/usr/local/lib/X11/fonts/myfonts</i></b>
</pre></blockquote>

Je¶li korzysta¿ z <tt>xfs</tt>, nale¿y zamiast tego skorzystaæ z:

<blockquote><pre>
# <b>pkill -HUP xfs</b>
</pre></blockquote>


<hr>
<a href="index.html"><img height="24" width="24" src="../../images/back.gif"
  border="0" alt="[back]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: truetype.html,v 1.19 ]<br>
$Translation: truetype.html,v 1.10 2008/03/08 12:00:53 tkniaz Exp $<br>
-->
$OpenBSD: truetype.html,v 1.10 2008/03/09 13:37:13 tobias Exp $
</small>
</body>
</html>

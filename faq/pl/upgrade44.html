<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>OpenBSD 4.3 Przewodnik aktualizacji</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-2">
<meta name="resource-type" content="document">
<meta name="description"   content="OpenBSD Upgrade Process for 4.3 -> 4.4">
<meta name="keywords"      content="openbsd,faq,upgrade,4.4">
<meta name="distribution"  content="global">
<meta name="copyright"     content="This document copyright 2008 by OpenBSD">
</head>

<body bgcolor="#ffffff" text="#000000">
<a href="../../pl/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif" border="0">    

</a>
<p>
<font color="#0000e0">
<a href="upgrade35.html">[3.4 -> 3.5]</a> |
<a href="upgrade36.html">[3.5 -> 3.6]</a> |
<a href="upgrade37.html">[3.6 -> 3.7]</a> |
<a href="upgrade38.html">[3.7 -> 3.8]</a> |
<a href="upgrade39.html">[3.8 -> 3.9]</a> |
<br>
<a href="upgrade40.html">[3.9 -> 4.0]</a> |
<a href="upgrade41.html">[4.0 -> 4.1]</a> |
<a href="upgrade42.html">[4.1 -> 4.2]</a> |
<a href="upgrade43.html">[4.2 -> 4.3]</a> |
<a href="index.html">[FAQ Index]</a>
</font>

<h1><font color="#e00000">Przewodnik po aktualizacji: z 4.3 do 4.4</font></h1>
<hr>

<i>Uwaga: upgrade jest mo¿liwy tylko z release do release - zalecane jest aby nie 
opuszczaæ wydañ po¶rednich.
Nie opuszczaj wersji release.</i>

<p><i>
Jest niezwykle wa¿ne aby¶ przeczyta³ ca³y dokument i dok³adnie zrozumia³
ca³y proces zanim bêdziesz usi³owa³ go przeprowadziæ.
Je¶li zamierzasz dzia³aæ na krytycznej lub fizycznie odleg³ej maszynie,
zalecamy aby¶ przetestowa³ ten proces na identycznej, lokalnej maszynie
i zweryfikowa³ szanse na powodzenie aktualizacji zanim do niej przyst±pisz.
</i>

<p>
Upgrade to wygodny sposób na utrzymywanie twojego systemu OpenBSD aktualnym
z ostatni± aktualn± wersj±.
Jednak¿e, rezultat w zamierzeniu nie odpowiada dok³adnie wynikowi
instalacji wyczy¶æ-i-za³aduj.
W szczególno¶ci stare pliki bibliotek nie s± usuwane w procesie aktualizacji,
poniewa¿ mog± byæ wymagane przez starsze aplikacje które mog±, lecz nie musz±
byæ zaktualizowane w danym momencie.
Je¿eli NAPRAWDÊ chcesz pozbyæ siê tych wszystkich plików prawdopodobnie lepiej
bêdzie je¶li zainstalujesz wszystko od pocz±tku.

<p>
Spis tre¶ci:
<ul>
<li><a href="#before">Zanim rozpoczniesz</a>
  <ul>
    <li><a href="#newsysmerge">Nowe narzêdzie: sysmerge</a>
    <li><a href="#dhcpd.interfaces">dhcpd.interfaces nie jest wiêcej u¿ywane</a>
    <li><a href="#newXdrivers">Nowe sterowniki X-ów</a>
    <li><a href="#rc.conf"    >rc.conf</a>
    <li><a href="#kern"	      >Modyfikowany kernel</a>
  </ul>
<li><a href="#upgrade"	      >Aktualizacja</a>
<li><a href="#final"	      >Ostatnie kroki</a>
<ul>
    <li><a href="#UsersGroups">Nowi u¿ytkownicy i grupy</a>
    <li><a href="#etcUpgrade" >Aktualizacja <tt>/etc</tt></a>
    <li><a href="#Kernchk"    >Sprawdzenie kernela</a>
    <li><a href="#Pkgup"      >Aktualizacja pakietów</a>
    <li><a href="#rmxbase42"  >Usuniêcie xbase42.tgz</a>
  </ul>
</ul>

<hr>
<p>
<a name="before"></a>
<h2>Zanim rozpoczniesz: sprawy do przemy¶lenia i te którymi nale¿y siê martwiæ</h2>

To <i>nie</i> jest kompletna lista zmian jakie pojawi³y siê pomiêdzy
wersjami 4.3 i 4.4 lecz raczej zestawienie wa¿nych spraw na które
mo¿e natrafiæ znaczna liczba u¿ytkowników podczas procesu aktualizacji.
Szczegó³ow± listê zmian znajdziesz na stronie
<a href="../../plus44.html">plus44.html</a> oraz w logach zmian CVS.

<a name="newsysmerge"></a>
<ul>
  <li><b>Nowe narzêdzie
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysmerge&amp;sektion=8">sysmerge(8)</a>:</b><br>
Do OpenBSD 4.4 dodany zosta³ program
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysmerge&amp;sektion=8">sysmerge(8)</a>,
maj±cy pomagaæ administratorom w aktualizacji plików konfiguracyjnych po aktualizacji
systemu.
Sysmerge(8) porównuje aktualne pliki z twojego systemu z plikami które zosta³yby
zainstalowane podczas instalacji nowego systemu i daje u¿ytkownikowi mo¿liwo¶æ
pozostawienia starego pliku, instalacjê nowego lub wspomaga proces rêcznego ³±czenia
starego i nowego pliku, korzystaj±c z
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sdiff&amp;sektion=1">sdiff</a>.
W przypadku wcze¶niejszych systemów i ich aktualizacji zamieszczali¶my listê plików
które mog± byæ kopiowane "jak-s±", listê plików które powinny byæ zmienione oraz
³atkê która wprowadza³a zmiany do tych plików.
Dla aktualizacji z 4.3 do 4.4, zamiast korzystaæ z pliku z ³atk±, mo¿esz 
opcjonalnie skorzystaæ z sysmerge.

<p>
<b>Kto powinien korzystaæ z sysmerge(8):</b><br>
U¿ytkownicy korzystaj±cy z mocno zmodyfikowanych systemów, u¿ytkownicy którzy
nie rozpoczynali od poprzedniego wydania (np. korzystaj±cy ze snapshot-ów), 
u¿ytkownicy którzy aktualizowali system do snapshot-a a tak¿e ci którzy w przesz³o¶ci niezbyt
dok³adnie aktualizowali system zauwa¿± ogromn± przewagê sysmerge nad ³atkami,
poniewa¿ operuje on na tym co faktycznie znajduje siê w twoim systemie
zamiast zak³adaæ jego zawarto¶æ.
Dodaktowo daje u¿ytkownikowi mo¿liwo¶æ wiêkszej kontroli nad procesem aktualizacji.

<p>
<b>Kto NIE mo¿e nie chceæ korzystaæ z sysmerge(8):</b><br>
U¿ytkownicy posiadaj±cy wiele komputerów do aktualizacji o do¶æ prostej
konfiguracji, prawdopodobnie stwierdz± ¿e poprzedni system aktualizacji oparty na
³atce jest znacznie szybszy.

<p>
Zwróæ uwagê, ¿e wprawdzie sysmerge obs³uguje WSZYSTKIE zmiany w <tt>/etc</tt>,
<tt>/dev</tt>, <tt>/root</tt> oraz <tt>/var</tt>, zalecamy wykonanie kilku kroków
rêcznie, poniewa¿ pozwoli to zaoszczêdziæ czas i ogranicza mo¿liwo¶æ wyst±pienia
b³êdu ludzkiego.
W szczególno¶ci, wysoce zalecane jest by nie u¿ywaæ sysmerge do aktualizacji
kont u¿ytkowników oraz grup gdy¿ ³atwo mo¿na doprowadziæ do sytuacji w której z³±
opcj± zamazana zostanie baza kont u¿ytkowników i ustawione zostanie puste has³o
administratora - co w praktyce oznacza brak mo¿liwo¶ci zdalnego zalogowania do
systemu i naprawê b³êdu.

<p>
<a name="dhcpd.interfaces"></a>
<li><b>Plik dhcpd.interfaces nie jest wiêcej u¿ywany:</b><br>
Plik <tt>/etc/dhcpd.interfaces</tt> nie jest wiêcej u¿ywany do okre¶lenia
interfejsów na których nas³uchuje dhcpd.
Listê interfejsów mo¿na okre¶liæ poprzez flagê <i>dhcpd_flags</i> w
pliku <tt>/etc/rc.conf.local</tt>.
Wiêkszo¶æ u¿ytkowników prawdopodobnie pozwoli by
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dhcpd&amp;sektion=8">dhcpd(8)</a>
sam okre¶li³ na którym interfejsie powinien s³uchaæ na podstawie konfiguracji z
pliku dhcpd.conf.

<p>
<a name="newXdrivers"></a>
<li><b>Nowe sterowniki X-ów</b>
Do Xenocara-y dodany zosta³ sterownik xf86-video-openchrome dla uk³adów VIA, który
zastêpuje stary sterownik "via".
Je¿eli posiadasz chipset VIA z plikem konfiguracyjnym X-ów, zamieñ
<tt>Driver "via"</tt> przez <tt>Driver "openchrome"</tt> w
<tt>/etc/X11/xorg.conf</tt>.
Zobacz równie¿ stronê manuala
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=openchrome&amp;sektion=4">openchrome(4)</a>.

<p>
Sterownik
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ati&amp;sektion=4">ati(4)</a>
zosta³ zaktualizowany.
Ta aktualizacja w xf86-video-ati wprowadza kilka wa¿nych zmian.
<ul>
<li><a href="http://dri.freedesktop.org/wiki/MergedFB">MergedFB</a>:
Usuniête zosta³o wsparcie dla MergedFB na korzy¶æ:
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xrandr&amp;sektion=1">xrandr(1)</a>.

<li>Zmiany w dziwnych opcjach dla Macbook-ów:
U¿ytkownicy Mac-ów oraz Macbook-ów którzy korzystali z poni¿szego dziwad³a:
<tt>Option "iBookHacks" "on"</tt>
powinni przeczytaæ stronê manuala
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=radeon&amp;sektion=4">radeon(4)</a>,
w szczególno¶ci sekcjê <tt>"MacModel"</tt>.
<br>
Od tego wydania ta opcja zosta³a usuniêta
</ul>

<p>
<a name="rc.conf"></a>
<li><b>rc.conf:</b><br>
W odró¿nieniu od poprzednich wersji tego procesu, od
<a href="upgrade41.html">4.1</a> zak³adamy, ¿e plik
<tt>/etc/rc.conf</tt> nie jest edytowany przez u¿ytkownika.

Je¿eli wykonywa³e¶ zmiany w swoim pliku <tt>/etc/rc.conf</tt> przenie¶
je do <tt>/etc/rc.conf.local</tt>.
Je¿eli NIE masz pliku <tt>/etc/rc.conf.local</tt> po prostu skopiuj
swój plik <tt>/etc/rc.conf</tt> do <tt>/etc/rc.conf.local</tt>
i <i>usuñ ostatni± liniê z tego skryptu!</i>
W przeciwnym wypadku umie¶æ zawarto¶æ obecnego pliku <tt>rc.conf</tt>
na pocz±tku istniej±cego pliku <tt>rc.conf.local</tt> a nastêpnie
<i>usuñ ostatni± liniê skryptu</i> zanim przejdziesz do dalszych
etapów procesu.


<p>
<a name="kern"></a>
<li><b>Modyfikowany kernel:</b><br>
Sprawd¼ czy nie wykonywa³e¶ jakichkolwiek modyfikacji twojego kernela.
Przyk³adowo, mog³e¶ zmodyfikowaæ twoj± kartê sieciow± by korzysta³a 
z innych ni¿ domy¶lne ustawieñ, korzystaj±c z config(8).
Zapisz te ustawienia, aby je odtworzyæ dla nowego j±dra w 4.4.
</ul>

<p>
<hr>
<a name="upgrade"></a>
<h2>Proces uaktualnienia</h2>

<h3>Uaktualnienie za pomoc± kernela instalacyjnego</h3>
Je¿eli posiadasz dostêp do konsoli serwera wówczas naj³atwiejsz± i
najbezpieczniejsz± metod± na uaktualnienie systemu jest uruchomienie
systemu z medium instalacyjnego lub z
<a href="faq4.html#bsd.rd">bsd.rd</a> i wykonanie procesu uaktualnienia
który bardzo przypomina <a href="faq4.html">proces instalacji systemu</a>.
Nastêpnie nale¿y wykonaæ przedstawione poni¿ej <a href="#final">"ostatnie
kroki"</a>.

<p>
Jedn± z naj³atwiejszych metod na uruchomienie systemu z instalacyjnego kernela
jest umieszczenie pliku <i>bsd.rd</i> dla wersji 4.4 w g³ównym drzewie 
systemu plików i poinstruowanie boot loadera by wystartowa³ z 
pliku <i>bsd.rd</i>.
Dla amd64 oraz i386 wykonasz to wpisuj±c po prostu "<tt>boot bsd.rd</tt>"
gdy pojawi siê znak zachêty <tt>boot&gt;</tt>. 


<h3>Uaktualnienie bez kernela instalacyjnego</h3>
<i>NIE jest to zalecany proces. Korzystaj z medium instalacyjnego gdy
tylko jest to mo¿liwe!</i>

<p>
Czasem kto¶ mo¿e potrzebowaæ aktualizacji na maszynie na której nie mo¿na
w ³atwy sposób przeprowadziæ normalnego procesu aktualizacyjnego.
Mo¿na wówczas wykonaæ aktualizacjê ostro¿nie postêpuj±c w procesie podobnym
do aktualizacji opartej na ¼ród³ach:

<ul>
<li><b>Umie¶æ pliki instalacyjne w "dobrej" lokalizacji</b>.
Upewnij siê ¿e posiadasz wystarczaj±c± ilo¶æ przestrzeni dyskowej!

<p>
<li><b>Wy³±cz wszystkie "niebezpieczne" aplikacje ze startu podczas uruchomienia systemu:</b>
Podczas aktualizacji mo¿e wyst±piæ moment gdy prawdopodobnie nie bêdzie w³±czony PF,
jednak twoje aplikacje mog± pracowaæ poprawnie.
Ka¿da aplikacja zale¿na w sensie bezpieczeñstwa od PF powinna zostaæ wy³±czona zanim
wy³±czony zostanie PF i nie powinna byæ w³±czana a¿ do poprawnej weryfikacji dzia³ania
PF po aktualizacji.
Mog± dzia³aæ równie¿ inne aplikacje które chcesz by dzia³a³y podczas aktualizacji systemu,
je równie¿ zatrzymaj i wy³±cz.

<p>
<li><b>Sprawd¼ swój kernel:</b>
Pomimo ¿e <b>wiêkszo¶æ osób mo¿e pomin±æ ten krok</b>, je¿eli modyfikowa³e¶ 
swój kernel w wersji 4.3, prawdopodobnie bêdziesz musia³ to zrobiæ równie¿ 
w wersji 4.4.
W szczególno¶ci gdy przeprowadzasz proces aktualizacji zdalnie, teraz 
jest dobry czas, aby siê upewniæ ¿e nowy kernel bêdzie dzia³a³ po 
restarcie maszyny.
Je¶li jakiekolwiek zmiany musz± byæ wprowadzone do kernela, 
najbezpieczniejsz± rzecz± jak± mo¿na zrobiæ, jest wykonanie tych zmian na 
lokalnym systemie 4.4.
Mo¿e to byæ równie proste jak modyfikacja okre¶lonego urz±dzenia korzystaj±c z config(8),
lub mo¿e poci±gaæ za sob± rekompilacjê, je¶li dana opcja nie jest w³±czona w kernelu
GENERIC.
Prosimy zobacz <a href="faq5.html">FAQ 5 - Tworzenie systemu ze ¼róde³</a>,
zanim zdecydujesz siê na rekompilacjê kernela.

<p>
<li><b>Instalacja nowego kernela(-li)</b>
<blockquote><pre>
<b>export RELEASEPATH=</b><i>/usr/rel</i>   <i># gdzie maj± znajdowaæ siê pliki</i>
<b>cd ${RELEASEPATH}</b>
<b>rm /obsd ; ln /bsd /obsd && cp bsd /nbsd && mv /nbsd /bsd</b>
<b>cp bsd.rd bsd.mp /</b>
</pre></blockquote>

Zauwa¿ dodatkowe polecenia kopiuj±ce pierwotne j±dro: wykonywane s± aby 
mieæ pewno¶æ ¿e zawsze istnieje w³a¶ciwa kopia j±dra na dysku tak, ¿e 
mo¿liwy bêdzie boot systemu w sytuacji gdy przytrafi siê przerwa w 
zasilaniu w niew³a¶ciwym momencie lub awaria systemu.

<p>
<li><b>Instalacja nowych plików <tt>/etc/firmware</tt>:</b>
Z uwagi na fakt, ¿e niektóre za³adowane fragmenty "firmware" zosta³y
przeniesione z j±dra do katalogu <tt>/etc/firmware</tt>.
Dotyczy to wprawdzie tylko u¿ytkowników kilku urz±dzeñ, jednak nie 
zaszkodzi jak wszyscy wszyscy wykonaj± ten krok.
Aby rozpakowaæ pliki mikrokodu z <tt>base44.tgz</tt>, jako root u¿yj
polecenia:

<blockquote><pre>
<b>cd /</b>
<b>tar -C / -xzphf ${RELEASEPATH}/base44.tgz ./etc/firmware</b>
</pre></blockquote>

<p>
<li><b>Instalacja nowej wersji narzêdzia <tt>/sbin/ifconfig</tt>:</b>
Czasami sterowniki sieciowe (szczególnie bardziej z³o¿one jak np.
<tt>pppoe(4)</tt>) w nowszym kernelu wymagaja aktualizacji <tt>ifconfig</tt>
tak aby zosta³y poprawnie skonfigurowane po restarcie systemu w nastêpnym
kroku.
Ponownie, jest to sprawa która nie dotyczy wiêkszo¶ci u¿ytkowników,
jednak je¿eli wykonujesz aktualizacjê zdalnie poprzez po³±czenie 
<tt>pppoe(4)</tt> ten krok mo¿e byæ krytyczny.
Aby wypakowaæ <tt>ifconfig</tt> z <tt>base44.tgz</tt> u¿yj polecenia
(jako root):

<blockquote><pre>
<b>tar -C / -xzphf ${RELEASEPATH}/base44.tgz ./sbin/ifconfig</b>
</pre></blockquote>

<p>

<p>
<li><b>Reboot na nowym j±drze:</b>
Mo¿e kusiæ chêæ opuszczenia tego kroku, ale powinien on byæ wykonany teraz,
nowy kernel uruchomi stare aplikacje przestrzeni u¿ytkownika
(takie jak, bêd±cy wkrótce wa¿ny, <tt>reboot</tt>!), jednak czêsto nowe
aplikacje NIE bêd± dzia³a³y ze starym kernelem.

<p>
<li><b>Instalacja nowych aplikacji przestrzeni u¿ytkownika</b>
<i>NIE instaluj teraz <tt>etc44.tgz</tt> oraz <tt>xetc44.tgz</tt>, poniewa¿
proces ten nadpisze twoje aktualne pliki konfiguracyjne!</i>

<blockquote><pre>
<b>export RELEASEPATH=</b><i>/usr/rel</i>
<b>cd ${RELEASEPATH}</b>
<b>tar -C / -xzphf base44.tgz</b>
<b>tar -C / -xzphf comp44.tgz</b>
<b>tar -C / -xzphf game44.tgz</b>
<b>tar -C / -xzphf man44.tgz</b>
<b>tar -C / -xzphf misc44.tgz</b>
<b>tar -C / -xzphf xbase44.tgz</b>
<b>tar -C / -xzphf xfont44.tgz</b>
<b>tar -C / -xzphf xserv44.tgz</b>
<b>tar -C / -xzphf xshare44.tgz</b>
</pre></blockquote>

Uwaga: nie wszystkie elementy musz± byæ zainstalowane dla wszystkich aplikacji,
jednak¿e, je¿eli zainstalowa³e¶ dany zbiór oryginalnie, powiniene¶ z pewno¶ci±
uaktualniæ go teraz nowym zbiorem.

<p>
Pliki z <tt>/etc</tt> s± zarz±dzane oddzielnie, zatem <tt>etc44.tgz</tt> 
oraz <tt>xetc44.tgz</tt> NIE s± tutaj rozpakowywane.

<p>
<li><b>Aktualizacja <tt>/dev</tt>.</b>
Nowy plik 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=MAKEDEV&amp;sektion=8&amp;arch=i386">MAKEDEV</a>
zostanie skopiowany do /dev/ podczas instalacji <tt>base44.tgz</tt>, zatem powiniene¶
zwyczajnie wykonaæ poni¿sze: 

<blockquote><pre>
<b>cd /dev</b>
<b>./MAKEDEV all</b>
</pre></blockquote>

<p>
<li><b>Zaktualizuj <tt>/etc</tt> jak poni¿ej</b>.

<p>
<li><b>Reboot</b>
</ul>

Podczas tego procesu,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sendmail&amp;sektion=8">sendmail(8)</a>
mo¿e zwróciæ pewien b³±d podobny do poni¿szego:

<pre>
    Nov 1 12:47:05 puffy sm-mta[16733]: filesys_update failed: No such file or dire
    ctory, fs=., avail=-1, blocksize=380204
</pre>
Wiadomo¶æ ta mo¿e byæ bezpiecznie zignorowana; mo¿esz te¿ chcieæ zatrzymaæ
sendmail(8)-a na czas aktualizacji.
Zwracamy uwagê, ¿e sendmail nie dzia³a w tym punkcie aktualizacji dobrze
i wymagany jest jego restart (jako czê¶æ restartu maszyny), zanim poczta
bêdzie mog³a byæ obs³ugiwana zgodnie z oczekiwaniami.

<p>

<hr>
<a name="final"></a>
<h2>Ostatnie kroki</h2>

Jakkolwiek wykonujesz aktualizacjê, czy to przez kernel instalacyjny
i wykonanie "formalnego" procesu aktualizacji, czy te¿ aktualizacjê
binarn± "w-miejsce", musisz wykonaæ kilka dodatkowych czynno¶ci.

<a name="UsersGroups"></a>
<h3>1. Nowi u¿ytkownicy i grupy</h3>
Wymagane jest utworzenie nego u¿ytkownika dla
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rtadvd&amp;sektion=8">rtadvd</a>,
oraz ypldap(8).
Mo¿esz to wykonaæ korzystaj±c z 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8">useradd(8)</a>
<blockquote><pre>
<b>useradd -u92 -g=uid -c"IPv6 Router Advertisement Daemon" -d/var/empty -s/sbin/nologin _rtadvd</b>
<b>useradd -u93 -g=uid -c"YP to LDAP Daemon" -d/var/empty -s/sbin/nologin _ypldap</b>
</pre></blockquote>

<a name="etcUpgrade"></a>
<h3>2. Aktualizacja <tt>/etc</tt></h3>

<p>
Rozpakuj plik <tt>etc44.tgz</tt> do tymczasowej lokalizacji:

<blockquote><pre>
<b>tar -C /tmp -xzphf ${RELEASEPATH}/etc44.tgz</b>
</pre></blockquote>

Pliki które prawdopodobnie mog± byæ skopiowane z <tt>etc44.tgz</tt> "w takiej postaci
w jakiej s±":

<blockquote><pre>
etc/magic
etc/netstart
etc/rc
etc/rc.conf
etc/security
etc/services
etc/mail/localhost.cf
etc/mail/sendmail.cf
etc/mail/submit.cf
etc/mtree/4.4BSD.dist
</pre></blockquote>

Zauwa¿, ¿e JEST mo¿liwe by lokalnie zmodyfikowaæ te pliki, je¿eli to 
by³o zrobione, bêdzie konieczne rêczne scalenie.
Zwróæ szczególn± uwagê na <tt>mail/*</tt> je¿eli u¿ywasz czego¶
innego ni¿ domy¶lna konfiguracja Sendmail(8)-a. 
Tutaj s± linie kopiuj/wklej do kopiowania tych plików, zak³adaj±c ¿e
rozpakowa³e¶ <tt>etc44.tgz</tt> w miejscu sugerowanym powy¿ej:

<blockquote><pre>
<b>cd /tmp/etc
cp magic netstart rc rc.conf security services /etc
cp mtree/* /etc/mtree
cp mail/*.cf /etc/mail</b> <i># Uwaga na ten plik!!</i>
</pre></blockquote>

<p>
<a name="patchfile"></a>
<i>U¿yj pliku z ³atk± LUB <a href="#sysmerge">sysmerge</a>,
  nie obu</i>

<p>
Pliki poni¿ej najprawdopodobniej zawieraj± lokalne zmiany, musz±
byæ jednak zaktualizowane do wersji 4.4. Je¶li pliki te nie by³y
zmieniane, mo¿esz je po prostu skopiowaæ z nowszej wersji.

<blockquote><pre>
etc/changelist
etc/ftpusers
etc/hosts.lpd
etc/man.conf
etc/sudoers
etc/mail/aliases
etc/ssh/ssh_config
etc/ssh/sshd_config
</pre></blockquote>

Zmiany w tych plikach znajduj± siê w <a href="../upgrade44.patch">tej ³atce</a>.
Mo¿esz spróbowaæ z niego skorzystaæ wykonuj±c jako root nastepuj±ce polecenie:

<blockquote><pre>
<b>cd /</b>
<b>patch -C -p0 &lt; upgrade44.patch</b>
</pre></blockquote>

Spowoduje to przetestowanie ³atki jak dobrze pasuje do TWOJEGO systemu,
aby j± zastosowaæ opu¶æ opcjê "<tt>-C</tt>".
Zauwa¿ ¿e w sytuacji w której posiadasz zmodyfikowane pliki, lub pliki które 
nie s± wystarczaj±co aktualne, a tak¿e w sytuacji w której zosta³y zaktualizowane
z wersji "snapshot" 4.3, pliki te mog± nie zostaæ "czysto" zaakceptowane.
W takiej sytuacji, bêdziesz musia³ rêcznie uwzglêdniæ zmiany.
Prosimy wykonaj test tego procesu zanim siê na niego zdecydujesz dla maszyny
do której nie mo¿esz siê w ³atwy sposób dostaæ.

<p>
W poni¿szych plikach zosta³y wprowadzone pewne zmiany na które nale¿y zwróciæ
uwagê, lecz nie mog± byæ bezpo¶rednio skopiowane lub scalone (przyk³adowo
je¿eli korzystasz z pf.conf, przyj¿yj siê sugerowanej zmianie strategii i 
zdecyduj czy jest w³a¶ciwa dla twoich potrzeb).

<blockquote><pre>
etc/dhclient.conf
etc/pf.conf
var/www/conf/httpd.conf
</pre></blockquote>

<p>
Istnieje tak¿e plik który mo¿e byæ skasowany poniewa¿ nie jest wiêcej
u¿ywany w 4.4:

<blockquote><pre>
<b>rm /etc/dhcpd.interfaces</b>
</pre></blockquote>


Ostatecznie skorzystaj z
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=newaliases&amp;sektion=8">newaliases(8)</a>
aby zaktualizowaæ bazê aliasów oraz
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&amp;sektion=8">mtree(8)</a>
aby utworzyæ jakiekolwiek nowe katalogi:

<blockquote><pre>
<b>newaliases</b>
<b>mtree -qdef /etc/mtree/4.4BSD.dist -p / -u</b>
</pre></blockquote>

<a name="sysmerge"></a>

<h3>3b. £±czenie lokalnie zmienionych plików przy pomocy sysmerge(8)</h3>
<i>Pamiêtaj by u¿ywaæ albo opisanego poni¿ej procesu opartego na sysmerge(8)
  LUB mechanizmu z <a href="#patchfile">patchfile</a>, nigdy z obu.</i>

<p>
Nowy program
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysmerge&amp;sektion=8">sysmerge(8)</a>
porówna pliki które obecnie znajduj± siê w twoim systemie z plikami
które by³y by zainstalowane podczas ¶wierzej instalacji i asystuje
podczas ³±czenia ich zawarto¶ci.
Zwróæ uwagê, ¿e w przeciwieñstwie do rozwi±zania z ³atk±, nie przyjmowane
jest ¿adne za³o¿enie odno¶nie tego co rzeczywi¶cie znajduje siê w twoim
systemie, zatem mo¿esz korzystaæ z sysmerge(8) by przej¶æ z
<a href="faq5.html#Flavors">jednego punktu w procesie rozwoju systemu</a>,
np. z wcze¶niejszej wersji <i>-current</i> do <i>4.4-release</i> lub
z jednego <i>-current'a</i> do innego.

<p>
Prosimy zapoznaj siê ze stron± manuala
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysmerge&amp;sektion=8">sysmerge(8)</a>,
zanim zaczniesz korzystaæ z sysmerge w twoim systemie.
Zachêcamy tak¿e do zapoznania siê ze stronami manuali dla
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=diff&amp;sektion=1">diff(1)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sdiff&amp;sektion=1">sdiff(1)</a>
oraz
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=more&amp;sektion=1">more(1)</a>.

<p>
Zak³adaj±c ¿e pliki <tt>etc44.tgz</tt> oraz <tt>xetc44.tgz</tt>, istniej± na ustawionej
¶cie¿ce $RELEASEPATH, skorzystaj z:

<blockquote><pre>
# <b>sudo sysmerge -as $RELEASEPATH/etc44.tgz -x $RELEASEPATH/xetc44.tgz</b>
</pre></blockquote>

Sysmerge(8) wy¶wietli wówczas jednolity
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=diff&amp;sektion=1">diff(1)</a>,
korzystaj±c z twojej ulubionej przegl±darki plików podanej poprzez zmienn±
¶rodowiskow± $PAGER (np.
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=more&amp;sektion=1">more(1)</a>)
oraz, dla plików z najwiêksz± ilo¶ci± zmian, czy chcesz:

<blockquote><pre>
  Use 'd' to delete the temporary ./var/www/htdocs/index.html
  Use 'i' to install the temporary ./var/www/htdocs/index.html
  Use 'm' to merge the temporary and installed versions
  Use 'v' to view the diff results again

  Default is to leave the temporary file to deal with by hand
</pre></blockquote>

<p>
W przypadku gdy zechcesz zachowaæ istniej±cy plik, usuñ plik tymczasowy.
Je¶li chcesz zamieniæ istniej±cy plik now± wersj±, zainstaluj tymczasowy
plik.
Je¶li zamierzadz scaliæ dwa pliki, wybieraj±c opcjê 'm' uruchomiony zostanie
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sdiff&amp;sektion=1">sdiff(1)</a>,
gdzie bêdzie mo¿na wykonaæ t± operacjê rêcznie.
Domy¶lnym zachowaniem jest powrót i pozostawienie pliku do pó¼niejszej,
recznej, zmiany.

<p>
Wprawdzie mo¿e to zadzialaæ ale nie zalecamy korzystania z sysmerge do
dodawania nowych u¿ytkowników do systemu, zamiast tego zalecaj±c
podan± <a href="#UsersGroups">wcze¶niej</a> metodê z useradd(8).
Uwa¿amy, ¿e takie rozwi±zanie jest znacznie bardziej odporne na b³êdy.
(hint: <i>nie</i> <b>i</b>nstaluj tymczasowego pliku master.passwd
na istniej±cym!).

<p>
Sysmerge(8) zachowuje wszystkie zamienione pliki w katalogu tymczasowym,
podobnym do <tt>/var/tmp/sysmerge.24959/backups</tt>, zatem je¿eli przypadkowo
sprawisz, ¿e stanie siê co¶ co nie jest dobrym pomys³em, zawsze masz szansê
przywróciæ sytuacjê przed zmianami.
Zwracamy uwagê, ¿e
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=daily&amp;sektion=8">daily(8)</a>
usuwa stare pliki z tego katalogu.

<a name="Kernchk"></a>
<h3>3. Sprawdzanie kernela</h3>
Uwaga: <b>wiêkszo¶æ osób mo¿e pomin±æ ten krok!</b>

<p>
Je¿eli pod±¿a³e¶ za instrukcjami procesu aktualizacji bez instalacji
nowego kernela, ju¿ wykona³e¶ ten krok z ca³ego procesu.
Jednak¿e, je¶li korzysta³e¶ z medium instalacyjnego i posiada³e¶
zmodyfikowany kernel w 4.3, istnieje prawdopodobieñstwo ¿e bêdziesz
musia³ zmodyfikowaæ kernel tak¿e w 4.4.
Mo¿e to byæ równie proste jak modyfikacja okre¶lonego urz±dzenia korzystaj±c z config(8),
lub mo¿e poci±gaæ za sob± rekompilacjê, je¶li dana opcja nie jest w³±czona w kernelu
GENERIC.
Prosimy zobacz <a href="faq5.html">FAQ 5 - Tworzenie systemu ze ¼róde³</a>,
zanim zdecydujesz siê na rekompilacjê kernela.


<a name="Pkgup"></a>
<h3>4. Aktualizacja pakietów</h3>
Je¶li instalowa³e¶ jakiekolwiek pakiety w twoim systemie, powiniene¶
zaktualizowaæ je po zakoñczeniu aktualizacji systemu bazowego.
Jednak¿e pamiêtaj ¿e niektóre pakiety mog± wymagaæ dalszej konfiguracji
przed i/lub po zaktualizowaniu pakietu.
Sprawd¼ informacje dotycz±ce aktualizacji koniecznych pakietów.

<p>
Narzêdzia obs³ugi pakietów pozwalaj± na aktualizacjê
"w miejsce", poprzez u¿ycie <tt>pkg_add -u</tt>.
Przyk³adowo, aby zaktualizowaæ twoje pakiety, upewnij siê ze <tt>PKG_PATH</tt>
wskazuje na katalog z pakietami dla 4.4 na twoim CD lub najbli¿szym
mirrorze FTP (przyp. t³um. lub na katalog na lokalnym dysku),
i u¿yj polecenia podobnego to poni¿szego
 
<blockquote><pre>
<b># pkg_add -ui -F update -F updatedepends</b>
</pre></blockquote>

gdzie opcja <tt>-u</tt> wskazuje tryb aktualizacji, <tt>-i</tt> okre¶la 
tryb interaktywny, wiêc pkg_add bêdzie zwraca³ siê do ciebie gdy
napotka niejasno¶æ. Przeczytaj stronê manuala dla 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_add&amp;sektion=1&amp;manpath=OpenBSD+4.4">
  pkg_add(1)</a> oraz dokument FAQ dotycz±cy 
<a href="faq15.html#PkgMgmt">zarz±dzania pakietami</a>.


<p>
<font color="#0000e0">

<a href="upgrade35.html">[3.4 -> 3.5]</a> |
<a href="upgrade36.html">[3.5 -> 3.6]</a> |
<a href="upgrade37.html">[3.6 -> 3.7]</a> |
<a href="upgrade38.html">[3.7 -> 3.8]</a> |
<a href="upgrade39.html">[3.8 -> 3.9]</a> |
<br>
<a href="upgrade40.html">[3.9 -> 4.0]</a> |
<a href="upgrade41.html">[4.0 -> 4.1]</a> |
<a href="upgrade42.html">[4.1 -> 4.2]</a> |
<a href="upgrade43.html">[4.2 -> 4.3]</a> |
<a href="index.html">[FAQ Index]</a>
</font>

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../../images/back.gif" border="0" alt="[back]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: upgrade44.html,v 1.22 ]<br>
$Translation: upgrade44.html,v 1.1 2008/11/10 04:28:30 tkniaz Exp $<br>
-->
$OpenBSD: upgrade44.html,v 1.1 2008/11/26 08:25:03 tobias Exp $
</small>
</body>
</html>


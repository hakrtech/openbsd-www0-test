<html>
<head>
<title>4.0 - Installation Guide</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 1998-2002 by OpenBSD.">
</head>

<body bgcolor= "#ffffff" text= "#000000">

<img alt="[OpenBSD]" height=30 width=141 src="../images/smalltitle.gif">
<p>
<h2><font color=#e00000>4.0 - Installation Guide</font><hr></h2>
</p>

<p>
<ul><h3>Table of Contents</h3>
<li><a href= "#Overview"    >4.1 - Overview of the OpenBSD Installation Procedure.</a>
<li><a href= "#FilesNeeded" >4.2 - What files are needed for Installation?
                                   </a></li>
<li><a href= "#SpaceNeeded" >4.3 - How much space do I need for an
                                     OpenBSD installation?</a></li>
<li><a href= "#Multibooting">4.4 - Multibooting OpenBSD</a></li>
<li><a href= "#SendDmesg"   >4.5 - Sending your dmesg to dmesg@openbsd.org
                                     after the install</a></li>
<li><a href= "#AddFileSet"  >4.6 - Adding a file set after install</a></li>
<li><a href= "#bsd.rd"      >4.7 - What is 'bsd.rd'?</a></li>
</ul>
</p>
<hr>

<p>
<a name= "Overview"></a>
<a name= "4.1"></a>
<h2>4.1 - Overview of the OpenBSD installation procedure</h2>
</p>

<p>
This FAQ now contains installation instructions for OpenBSD 3.1. There
are differences between the 3.1 installation and installation of earlier
versions of OpenBSD, however this guide will help you through recent
releases.
</p>

<p>
OpenBSD has a very robust and adaptable  text-based install procedure.
In addition to its robustness, the install procedure can be done
using 1 floppy disk. Most architectures have a similar installation procedure,
however there are some differences in details.  In all cases, you are
urged to read the platform-specific INSTALL document in the platform
directory on the CDROM or FTP sites (for example, <tt>INSTALL.i386</tt>,
<tt>INSTALL.mac68k</tt> or <tt>INSTALL.sparc</tt>)
</p>

<p>
On most architectures, you have several installation options, 
including FTP, CDROM, and local disk files.  One option <b>not</b> supported is 
<a href="faq3.html#ISO">downloading an ISO image</a> to make your own
CDROM.  CDROMs are available for 
<a href="../orders.html">purchase</a>, however. 
</p>

<h3>4.1.1 - Supported OpenBSD Architectures</h3>

<p>
OpenBSD 3.1 supports a number of architectures listed below in alphabetical order.
Please refer to each architecture's page for specific information on what each
architecture supports.

<ul>
  <li><a href="../alpha.html">alpha</a> - DEC Alpha-based machines.
  <li><a href="../amiga.html">amiga</a> - Amiga m68k-based models (MMU required).
  <li><a href="../hp300.html">hp300</a> - Hewlett-Packard HP300/HP400 machines.
  <li><a href="../i386.html">i386</a> - Intel based PC's.
  <li><a href="../mac68k.html">mac68k</a> - Most MC680x0-based Apple Macintosh models.
  <li><a href="../mvme68k.html">mvme68k</a> -Motorola MVME147/16x/17x 68K VME cards.
  <li><a href="../macppc.html">macppc</a> - Support for Apple based PowerPC systems.
  <li><a href="../sparc.html">sparc</a> - SPARC Platform by Sun Microsystems.
  <li><a href="../sparc64.html">sparc64</a> - Sun's Ultra SPARC systems. 
  <li><a href="../vax.html">vax</a> - DEC's VAX computers.
</ul>

<h3>4.1.2 - Supported Installation Media</h3>

<p>
OpenBSD has the ability to install from multiple media types. The most
common and architecture independent options are laid out below. These
options can be used after booting from either an OpenBSD CD-ROM or floppy
disk. 
</p>

<table align="center" border="1" width="600">
	<tr>
		<td>
			<b>CD-ROM</b>
		</td>
		<td bgcolor="#EEEEEE">
			To do a CD-ROM install, you must have either purchased an 
			<a href="../orders.html">Official OpenBSD CD-ROM</a> or 
			created your own OpenBSD CD. This is certainly the easiest
			way to install an OpenBSD system. <br>
			<b>NOTE:</b> Official OpenBSD CDs are bootable if your BIOS
			supports it.
		</td>
	</tr><tr>
		<td>
			<b>FTP</b>
		</td>
		<td bgcolor="#EEEEEE">
			This installation option allows you to install OpenBSD
			by downloading the installation packages in realtime over
			the network. With this option you can choose either a 
			static IP for use or grab an IP via DHCP.
		</td>
	</tr><tr>
		<td>
			<b>Local Filesystem</b>
		</td>
		<td bgcolor="#EEEEEE">
			This option allows you to install from files on a 
			pre-existing filesystem. Support for DOS, EXT2FS and FFS 
			are included on the install disk. 
		</td>
	</tr>
</table>

<a name="Overview.3"></a>
<a name="4.1.3"></a>
<h3>4.1.3 - Creating bootable OpenBSD install floppies.</h3>

<p>
To create an installation floppy image you must first download the correct boot
floppy image from one of the OpenBSD distribution sites. You can find a list of FTP servers
at the <a href="../ftp.html">OpenBSD FTP Distribution</a> page.  Most architectures
have one or more boot floppy images to choose from, different images are for different
hardware variations.  The differences between the i386 platform installation
floppies will be outlined below. For the other architectures with multiple boot floppies,
see the INSTALL document in the respective FTP directory.  For those with only one, just
download the respective <i>floppy31.fs</i> image. <br>
<b>NOTE:</b> The <i>cdrom31.fs</i> image can be used to make a bootable 
OpenBSD installation CD-ROM.
</p>

<p>
The <a href="../i386.html">i386</a> platform has four separate installation 
disk images to choose from. The differences between each are outlined below.

<ul>
<li><b>floppy31.fs</b> supports most desktop systems, with supported
	PCI and ISA NICs, IDE and simple SCSI adapters.  Some PCMCIA
	support.
<li><b>floppyB31.fs</b> supports many RAID controllers, however 
	support for many standard SCSI adapters and many EISA and ISA 
	NICS has been removed.  This would be the boot disk of choice
	for many large servers.  Some more infrequently encountered 
	SCSI adapters are here, as well.
<li><b>floppyC31.fs</b> supports Cardbus and PCMCIA devices found in
	many laptops.  
<li><b>cdrom31.fs</b> supports most of the disk and network drivers
	of the installed system, it is, in effect a combination of 
	all three boot disks. It can be used to make a bootable 2.88M
	floppy, or more commonly,  as a boot image for a recordable CD. 
</ul>

<p>
Most i386 users will just use the <i>floppy31.fs</i> installation floppy. 
Yes, there may be situations where one install disk is required to 
support your SCSI adapter and another disk is required to support your
network adapter.  Fortunately, this is a rare event, and can usually be
worked around.
</p>

<p>
Once you have the correct floppy image, you need to get a clean floppy disk.
If there are ANY bad sectors on the floppy disk, the installation will most
likely fail. To prepare a floppy from another system running a UNIX-like 
operating system (including OpenBSD) use the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdformat&sektion=1&arch=i386">fdformat(1)</a>
command to both format and check for bad sectors.
</p>

<ul>
<table border=0 width="800"> <tr> <td nowrap bgcolor="#EEEEEE"><tt>
    # <b>fdformat /dev/fd0a</b><br>
    Format 1440K floppy `/dev/fd0a'? (y/n): y<br>
    processing VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV done.
</tt></td></tr> </table>
</ul>

<p>
If your output is like the above example, then your disk is OK. However, if you do not see
ALL &quot;V&quot;'s then your disk is most likely bad, and you should try a new one. 

<p>
If you are formatting in MS-DOS or Windows, simply use the DOS <tt>FORMAT</tt>
 command.
</p>

<p>
Once you have a clean, formatted floppy it is time to write the installation image to
floppy. If you are creating this on an OpenBSD machine or another UNIX-like OS, you can 
use the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&sektion=0">dd(1)</a> utility.
an example usage of dd(1) is below:
</p>

<ul>
  <table border=0 width="800"> <tr> <td nowrap bgcolor="#EEEEEE"><tt>
    # <b>dd if=floppy31.fs of=/dev/rfd0c bs=126b</b>
  </tt></td></tr></table>
</ul>

<p>
Once the image is written, check to make sure that the copied image is the same as the
original with the following command. If the test passes, you will just see another prompt.
</p>

<ul>
  <table border=0 width="800"><tr><td nowrap bgcolor="#EEEEEE"><tt>
    # <b>cmp /dev/rfd0c floppy31.fs</b>
  </tt></td> </tr> </table>
</ul>

<p>
Again, if you are creating this image on the Windows/DOS platform you can get tools from the
<a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.1/tools/">tools</a> directory on
any of the ftp mirrors, or in <b>3.1/tools</b> directory on CD1 of the OpenBSD CD set.
For users of DOS/Windows 9x, <i>rawrite</i> can be used to write your 
boot floppy.
</p>

<ul>
  Example usage of <i>rawrite</i>:
  <table border=0 width="800"> <tr> <td nowrap bgcolor="#EEEEEE"><tt>
    C:\> <b>rawrite</b><br>
    RaWrite 1.2 - Write disk file to raw floppy diskette<br><br>

    Enter source file name: <b>floppy31.fs</b><br>
    Enter destination drive: <b>a</b><br>
    Please insert a formatted diskette into drive A: and press -ENTER- : </tt><i><b>Enter</b></i><tt>
  </tt> </td> </tr> </table> 
</ul>

<p>
If you use NT, rawrite will not work for you. You can, however, use
<i>fdimage</i> or <i>ntrw</i> to write the boot floppy. Both of which
are available on the ftp sites (linked above), or the OpenBSD CD. Here are
example usages for each program.
</p>

<ul>
  Example Usage of <i>fdimage</i>:
  <table border=0 width="800"> <tr> <td nowrap bgcolor="#EEEEEE"><tt>
    C:\> <strong>fdimage -q floppy31.fs a:</strong>
  </tt></td></tr></table>

  Example Usage of <i>ntrw</i>:
  <table border=0 width="800"><tr><td nowrap bgcolor="#EEEEEE"><tt>
   C:\> <strong>ntrw floppy31.fs a:</strong><br>
   3.5", 1.44MB, 512 bytes/sector<br>
   bufsize is 9216<br>
   1474560 bytes written<br>
  </tt></td></tr></table>
</ul>

<p>
Note that <tt>FDIMAGE.EXE</tt> and <tt>RAWRITE.EXE</tt> are both 
MS-DOS applications, and thus, are limited to DOS's "8.3" file naming
convention.  As <tt>floppy31B.fs</tt> and <tt>floppy31C.fs</tt> have
longer file name, you will have to find out how your system stored 
the file in "8.3 format" before using <tt>FDIMAGE.EXE</tt> or 
<tt>RAWRITE.EXE</tt> to make your boot floppies.
</p>

<h3>4.1.4 - Booting OpenBSD Installation Images.</h3>

<p>
This section is initially broken down into architecture dependent
sections for popular architectures that OpenBSD supports. This is
so we can properly instruct each user on the what to do on their
respective platform.
</p>

<h4>Booting i386</h4>

<ul>
<p>
Booting an install image on the i386 architecture is nothing
new to most people. If you are using the floppy disk, simply stick
the floppy into your floppy drive and boot your system. Your install
image will automatically load. If you are planning on booting from CD,
you must go into your systems BIOS and set the boot options to allow
booting from CD. Some older BIOSs do not have this option, and you
must use a floppy for booting your installation image. Don't worry though,
even if you boot from floppy you can still install from the CD.
</p>
</ul>

<h4>Booting sparc</h4>

<ul>
<p>
To boot from floppy, place your floppy disk with the OpenBSD installation
image on it into your floppy drive. Then use the following command to 
boot from your floppy:
</p>

<ul>
 <table border=0 width="800"><tr><td nowrap bgcolor="#EEEEEE"><tt>
  ok <b>boot floppy</b>
 </tt></td></tr></table>
</ul>

<p>
To boot from CD-ROM, place your OpenBSD CD-ROM disk into your drive.
If your Sun only has one CD-ROM drive, then just go to the boot prompt,
where you can '<tt>boot cdrom</tt>':
</p>

<ul>
<table border=0 width="800"><tr><td nowrap bgcolor="#EEEEEE"><tt>
ok <b>boot cdrom</b>
</tt></td></tr></table>
</ul>

<p>
Of course, this will only work in new command mode.  If you are at the 
old command mode prompt (a right arrow), type 'n' for the new command mode.
(If you are using an old sparc that is pre-sun4c, you probably don't have
a new command mode.  In this case, you need to experiment.)
If you have multiple CD-ROM devices, you need to boot from the correct one.
Try <tt>probe-scsi</tt> from the new command mode.
</p>

<ul>
<table border=0 width="800"><tr><td nowrap bgcolor="#EEEEEE"><tt>
ok <b>probe-scsi</b><br>
Target 0<br>
  Unit 0   Disk     QUANTUM LIGHTNING 365S<br>
Target 1<br>
  Unit 0   Removable Disk     QUANTUM EMPIRE_1080S<br>
Target 3<br>
  Unit 0   Removable Disk     Joe's CD ROMs<br>
</tt></td></tr></table>
</ul>

<p>
Figure out which disk is the CD ROM you want to boot from.  Note the
target number.
</p>

<ul>
<table border=0 width="800"><tr><td nowrap bgcolor="#EEEEEE"><tt>
ok <b>boot /sbus/esp/sd@X,0</b>
</tt></td></tr></table>
</ul>
</ul>

<h3>Starting the Install</h3>
Now that your bootdisk has been created, it's time to boot it.
When you boot this floppy, the kernel and all of the programs
that OpenBSD uses to install itself are loaded into memory.  If problems arise,
and your bootdisk doesn't boot, the problem is probably due to a
bad floppy disk. This is an extremely common problem!  If your bootdisk fails
to boot, try it a second time, and if it fails again, throw away the floppy
and get a new one.  When your floppy fails to boot, even if the floppy worked
fine for you before, keep in mind that OpenBSD uses nearly every single
bit available from the floppy.
Any error in the disk will prevent OpenBSD from loading.
</p>

<p>
When your boot is successful, you will see a lot of white on blue text, the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dmesg&sektion=8">dmesg</a>, 
the kernel telling you what devices have been found,
and where.  Then, you will see the following:
</p>

<ul>
<table border=0 width="800"><tr><td nowrap bgcolor="#EEEEEE"><tt>
rootdev=0x1100 rrootdev=0x2f00 rawdev=0x2f02<br>
erase ^?, werase ^W, kill ^U, intr ^C, status ^T<br>
(I)nstall, (U)pgrade or (S)hell? <b>i</b><br>

Welcome to the OpenBSD/i386 3.1 installation program.<br>

This program is designed to help you put OpenBSD on your disk in a simple and<br>
rational way.<br>
<br>
As with anything which modifies your disk's contents, this program can cause<br>
SIGNIFICANT data loss, and you are advised to make sure your data is backed<br>
up before beginning the installation process.<br>
<br>
Default answers are displayed in brackets after the questions.  You can hit<br>
Control-C at any time to quit, but if you do so at a prompt, you may have<br>
to hit return.  Also, quitting in the middle of installation may leave your<br>
system in an inconsistent state.  If you hit Control-C and restart the<br>
install, the install program will remember many of your old answers.<br>
<br>
Proceed with install? [n] <b>y</b><br>
<br>
Cool!  Let's get to it...<br>
<br>
Specify terminal type [vt220]: </tt><i><b>Enter</b></i><tt><br>
Do you wish to select a keyboard encoding table? [n] </tt><i><b>Enter</b></i><tt><br>
</tt></td></tr></table>
</ul>

<p>
Depending on the architecture you are using, the terminal type you use might 
be different. For example, OpenBSD/sparc uses the &quot;sun&quot; terminal type.
</p>
</ul>

<h3>4.1.5 - Setting up disks during installation.</h3>

<p>
Setting up disks in OpenBSD varies a bit between platforms. For 
<a href="../i386.html">i386</a> and <a href="../macppc.html">macppc</a>,
disk setup is done in two stages.  First, the OpenBSD slice of the 
hard disk is defined using fdisk(8), then that partition is subdivided into 
OpenBSD partitions using disklabel(8). 

<p>
Some users may be a little confused by the terminology used here. It will 
appear we are using the word "partition" in two different ways. This
observation is correct. There are two layers of partitioning 
in several OpenBSD platforms, the first, one could consider 
the Operating System partitioning, which is how multiple OSs
on one computer mark out their own space on the disk, and the second one
is how the OpenBSD partition is sub-partitioned into individual file 
systems.  The first layer is visible as a disk partition to DOS, Windows, 
and any other OS that can coexist with other Operating Systems
on the IBM AT descended machines.  The second layer of partitioning 
is visible only to OpenBSD and those OSs which can directly read an 
OpenBSD file system.

<ul>
<table border=0 width="800"><tr><td nowrap bgcolor="#EEEEEE"><tt>
At any prompt except password prompts you can run a shell command by<br>
typing '!foo', or escape to a shell by typing '!'.<br>
<br>
The installation program needs to know which disk to consider the root disk.<br>
Note the unit number may be different than the unit number you used in the<br>
boot program (especially on a PC with multiple disk controllers).<br>
Available disks are:<br>
<br>
wd0<br>
<br>
Which disk is the root disk? [wd0] <i><b>&gt;Enter&lt;</b></i><br>
Do you want to use the *entire* disk for OpenBSD? [no] <b>yes</b><br>
<br>
[...]<br>
</tt></td></tr></table>
</ul>

<p>
This is the section in the install where you choose which disk you want
as your &quot;root&quot; disk. Your root disk will be where the / filesystem
and swap will be. <b>wd0</b> specifies an IDE disk;  if your disks are SCSI you
will most likely see <b>sd0</b>. There will be an entry for each disk that
OpenBSD finds, which is normally every disk in your system.  If your disks are 
not showing up here as you expect, you have improperly configured or 
unsupported hardware.  

<p> 
In this example, we have chosen to allocate the entire disk to OpenBSD.  This
will result in a simple partition table being written out to disk -- one 
partition, the size of the entire hard disk, set to the OpenBSD partition
type, and flagged as the bootable partition.  This will be a common option
for most production uses of OpenBSD, however, there are some systems this 
should not be done on.  Many Compaq systems, some Dell and other systems use
a "maintenance" partition, which should be kept intact.  If your system has 
any other partitions of any type you do not wish to erase, do not select 
"yes" to the above question. 

<p>
If you choose not to allocate the entire disk to OpenBSD, you will be placed 
in the OpenBSD disk partition editor, 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&sektion=8&arch=i386">fdisk(8)</a>.
For more information on using fdisk(8), refer to <a href="faq14.html#fdisk">FAQ 14, fdisk</a>.

<p>
<b>Important Note:</b>
i386 users with a large hard disk (larger than 8G, though on older machines, 
potentially much smaller) will want to see 
<a href="faq14.html#LargeDrive">this section</a> before going any further.


<h3>Creating a disklabel</h3>
The next step is to use 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=disklabel&sektion=8">disklabel(8)</a> 
to slice up the OpenBSD partition.  More details on using disklabel(8) 
can be found in 
<a href="faq14.html#disklabel">FAQ 14, disklabel</a>.
<p>
NOTE: OpenBSD does NOT support any sort of journaling filesystems like ReiserFS, 
IBM's JFS or SGI's XFS.  Instead we use <a href="faq14.html#SoftUpdates">Soft 
Updates</a>. The filesystem for OpenBSD is FFS.
</p>

<ul>
<table border=0 width="800"><tr><td nowrap bgcolor="#EEEEEE"><pre>
Inside the BIOS 'A6' ('OpenBSD') partition you just created, there resides an
OpenBSD partition table which defines how this BIOS partition is to be split
up. This table declares the offsets and sizes of your / partition, your swap
space, and any other partitions you might create.  (NOTE: The OpenBSD disk
label offsets are absolute, ie. relative to the start of the disk... NOT
relative to the start of the BIOS 'A6' partition).

If this disk is shared with other operating systems, those operating systems
should have a BIOS partition entry that spans the space they occupy completely.
For safety, also make sure all OpenBSD file systems are within the offset and
size specified in the 'A6' BIOS partition table.  (By default, the disklabel
editor will try to enforce this).  If you are unsure of how to use multiple
partitions properly (ie. separating /,  /usr, /tmp, /var, /usr/local, and other
things) just split the space into a root and swap partition for now.

# using MBR partition 3: type A6 off 63 (0x3f) size 12643092 (0xc0eb14)

Treating sectors 63-12658776 as the OpenBSD portion of the disk.
You can use the 'b' command to change this.

Initial label editor (enter '?' for help at any prompt)
> <b>?</b>
Available commands:
        p [unit]  - print label.
        M         - show entire OpenBSD man page for disklabel.
        e         - edit drive parameters.
        a [part]  - add new partition.
        b         - set OpenBSD disk boundaries.
        c [part]  - change partition size.
        d [part]  - delete partition.
        D         - set label to default.
        g [d|b]   - Use [d]isk or [b]ios geometry.
        m [part]  - modify existing partition.
        n [part]  - set the mount point for a partition.
        r         - recalculate free space.
        u         - undo last change.
        s [path]  - save label to file.
        w         - write label to disk.
        q         - quit and save changes.
        x         - exit without saving changes.
        X         - toggle expert mode.
        z         - zero out partition table.
        ? [cmnd]  - this message or command specific help.
Numeric parameters may use suffixes to indicate units:
        'b' for bytes, 'c' for cylinders, 'k' for kilobytes, 'm' for megabytes,
        'g' for gigabytes or no suffix for sectors (usually 512 bytes).
        Non-sector units will be rounded to the nearest cylinder.
Entering '?' at most prompts will give you (simple) context sensitive help.
> <b>p</b>
device: /dev/rwd0c
type: ESDI
disk: ESDI/IDE disk
label: Maxtor 86480D6
bytes/sector: 512
sectors/track: 63
tracks/cylinder: 15
sectors/cylinder: 945
cylinders: 13395
total sectors: 12658776
free sectors: 12658713
rpm: 3600

16 partitions:
#        size   offset    fstype   [fsize bsize   cpg]
  a: 12643092       63    unused        0     0
  c: 12658776        0    unused        0     0
> <b>d a</b>
> <b>a a</b>
offset: [63] <b><i>&gt;Enter&lt;</i></b>
size: [12658713] <b>80m</b>
Rounding to nearest cylinder: 163422
FS type: [4.2BSD] <b><i>&gt;Enter&lt;</i></b>
mount point: [none] <b>/</b>
> <b>a b</b>
offset: [163485] <b><i>&gt;Enter&lt;</i></b>
size: [12495291] <b>300m</b>
Rounding to nearest cylinder: 614250
FS type: [swap] <b><i>&gt;Enter&lt;</i></b>
> <b>a d</b>
offset: [777735] <b><i>&gt;Enter&lt;</i></b>
size: [11881041] <b>80m</b>
Rounding to nearest cylinder: 163485
FS type: [4.2BSD] <b><i>&gt;Enter&lt;</i></b>
mount point: [none] <b>/tmp</b>
> <b>a e</b>
offset: [941220] <b><i>&gt;Enter&lt;</i></b>
size: [11717556] <b>80m</b>
Rounding to nearest cylinder: 163485
FS type: [4.2BSD] <b><i>&gt;Enter&lt;</i></b>
mount point: [none] <b>/var</b>
> <b>a g</b>
offset: [1104705] <b><i>&gt;Enter&lt;</i></b>
size: [11554071] <b>2g</b>
Rounding to nearest cylinder: 4193910
FS type: [4.2BSD] <b><i>&gt;Enter&lt;</i></b>
mount point: [none] <b>/usr</b>
> <b>a h</b>
offset: [5298615] <b><i>&gt;Enter&lt;</i></b>
size: [7360161] <b><i>&gt;Enter&lt;</i></b>
FS type: [4.2BSD] <b><i>&gt;Enter&lt;</i></b>
mount point: [none] <b>/home</b>
> <b>p</b>
device: /dev/rwd0c
type: ESDI
disk: ESDI/IDE disk
label: Maxtor 86480D6
bytes/sector: 512
sectors/track: 63
tracks/cylinder: 15
sectors/cylinder: 945
cylinders: 13395
total sectors: 12658776
free sectors: 0
rpm: 3600

16 partitions:
#        size   offset    fstype   [fsize bsize   cpg]
  a:   163422       63    4.2BSD     1024  8192    16  # /
  b:   614250   163485      swap
  c: 12658776        0    unused        0     0
  d:   163485   777735    4.2BSD     1024  8192    16  # /tmp
  e:   163485   941220    4.2BSD     1024  8192    16  # /var
  g:  4193910  1104705    4.2BSD     1024  8192    16  # /usr
  h:  7360161  5298615    4.2BSD     1024  8192    16  # /home
> <b>w</b>
> <b>q</b>
No label changes.
</pre></td></tr></table>
</ul>

<p>
Notice how each mount point is split onto its own partition. For many 
applications, it is best to make at least five separate filesystems, one for 
your / filesystem, one for swap, one for /var, one for /tmp, 
and one for /usr. If users are going to log into the system,  
you want a separate /home filesystem too. 
</p>

<p>
The answer to the question, "How should I partition my system?" is 
"Exactly how you need it".  This will vary from application to application.
There is no universal answer.  If you are unsure of how you want to 
partition your system, see <a href="#SpaceNeeded">this discussion</a>.


<h3>4.1.6 - Configuring your mount points and formating your filesystems</h3>

<p>
Setting up your mount points is much more simple than it looks. After you setup your filesystems with disklabel, you will see text like the one below. This should 
be done for you automatically if you configured your mount points via disklabel(8). If you did not, you can do so here.
</p>

<ul>
<table border=0 width="800"><tr><td nowrap bgcolor="#EEEEEE"><pre>
You will now have the opportunity to enter filesystem information for wd0.
You will be prompted for the mount point (full path, including the prepending
'/' character) for each BSD partition on wd0. Enter "none" to skip a
partition or "done" when you are finished.

The following partitions will be used for the root filesystem and swap:<br>
        wd0a    /
        wd0b    swap


Mount point for wd0d (size=81742k) [/tmp, RET, none, or done]? <b><i>&gt;Enter&lt;</i></b>
Mount point for wd0e (size=81742k) [/var, RET, none, or done]? <b><i>&gt;Enter&lt;</i></b>
Mount point for wd0g (size=2096955k) [/usr, RET, none, or done]? <b><i>&gt;Enter&lt;</i></b>
Mount point for wd0h (size=3680080k) [/home, RET, none, or done]? <b><i>&gt;Enter&lt;</i></b>
Mount point for wd0d (size=81742k) [/tmp, RET, none, or done]? <b>done</b>

Now you can select another disk to initialize. (Do not re-select a disk
you have already entered information for). Available disks are:

wd0

Which one? [done] <b><i>&gt;Enter&lt;</i></b>

You have configured the following devices and mount points:

wd0a /
wd0h /home
wd0d /tmp
wd0g /usr
wd0e /var

============================================================
The next step will overwrite any existing data on:
        wd0a wd0h wd0d wd0g wd0e

Are you really sure that you're ready to proceed? [n] <b>y</b>
Creating filesystems...
Warning: 63 sector(s) in last cylinder unallocated
/dev/rwd0a:     163422 sectors in 173 cylinders of 15 tracks, 63 sectors
        79.8MB in 11 cyl groups (16 c/g, 7.38MB/g, 1792 i/g)
Warning: 445 sector(s) in last cylinder unallocated
/dev/rwd0h:     7360160 sectors in 7789 cylinders of 15 tracks, 63 sectors
        3593.8MB in 487 cyl groups (16 c/g, 7.38MB/g, 1792 i/g)
Warning: 1 sector(s) in last cylinder unallocated
/dev/rwd0d:     163484 sectors in 173 cylinders of 15 tracks, 63 sectors
        79.8MB in 11 cyl groups (16 c/g, 7.38MB/g, 1792 i/g)
/dev/rwd0g:     4193910 sectors in 4438 cylinders of 15 tracks, 63 sectors
        2047.8MB in 278 cyl groups (16 c/g, 7.38MB/g, 1792 i/g)
Warning: 1 sector(s) in last cylinder unallocated
/dev/rwd0e:     163484 sectors in 173 cylinders of 15 tracks, 63 sectors
        79.8MB in 11 cyl groups (16 c/g, 7.38MB/g, 1792 i/g)
</pre></td></tr></table>
</ul>

<p>
You may wonder why the installer again asks for mount points.  This
is because you can not mount (say) /usr/src before you have mounted /usr.
The "Mount point" dialog is to give you flexibility for the order that 
file systems are mounted in /etc/fstab.

<p>
Notice the "Are you really sure that you are ready to proceed?" 
question defaults to no, so you will have to deliberately tell it to 
proceed and format your partitions. If you chose no, you would simply 
be dropped 
into a shell and could start the install again by typing install, 
or just by rebooting again with your bootdisk. At this point it 
will format all filesystems for you.  This could take some time 
depending on the size of your disk. 
</p>

<h3>4.1.7 - Configuring your Network</h3>

<p>
Now it's time to setup your network configuration. This is extremely important if you are planning on doing any network based install, considering it will be based upon the
information you are about to enter. Here is a walk through of the network configuration section of the install process. 
</p>

<ul>
<table border=0 width="800"><tr><td nowrap bgcolor="#EEEEEE"><pre>
You will now be given the opportunity to configure the network. This will be
useful if you need to transfer the installation sets via FTP, HTTP, or NFS.
Even if you choose not to transfer installation sets that way, this information
will be preserved and copied into the new root filesystem.

Configure the network? [y] <b><i>&gt;Enter&lt;</i></b>
Enter system hostname (short form, e.g. 'foo'): [] <b>puffy</b>

If any interfaces will be configured using a DHCP server
it is recommended that you do not enter a DNS domain name,
a default route, or any name servers.

Enter DNS domain name (e.g. 'bar.com'): [] <b>example.com</b>

You may configure the following network interfaces (the interfaces
marked with [X] have been successfully configured):

        [ ] fxp0

Configure which interface? (or 'done') [fxp0] <b><i>&gt;Enter&lt;</i></b>
IP address (or 'dhcp')? [] <b>199.185.137.55</b>
Symbolic (host) name? [puffy] <b><i>&gt;Enter&lt;</i></b>
Netmask? [255.255.255.0] <b><i>&gt;Enter&lt;</i></b>
Your use of the network interface may require non-default
media directives. The default media is:
        media: Ethernet autoselect (none)
This is a list of supported media:
        media none
        media 10baseT
        media 10baseT mediaopt full-duplex
        media 100baseTX
        media 100baseTX mediaopt full-duplex
        media autoselect
        media none instance 1
        media 100baseTX instance 1
        media 100baseTX mediaopt full-duplex instance 1
        media 100baseT4 instance 1
If the default is not satisfactory, and you wish to use another
media, copy that line from above (e.g. "media 100baseTX")
Media directives? [] <b><i>&gt;Enter&lt;</i></b>

You may configure the following network interfaces (the interfaces
marked with [X] have been successfully configured):

        [X] fxp0

Configure which interface? (or 'done') [done] <b><i>&gt;Enter&lt;</i></b>
Enter IP address of default route: [none] <b>199.185.137.128</b>
Enter IP address of primary nameserver: [none] <b>199.185.137.1</b>
Would you like to use the nameserver now? [y] <b><i>&gt;Enter&lt;</i></b>
</pre></td></tr></table></ul>

In the above example, we use a static IP address. You can choose to use dhcp as well if you wish. In the case of DHCP, most of this information will be grabbed from a remote dhcp server.


<h3>4.1.8 - Choosing Installation Media</h3>

<p>
After your network is setup, the install script will give you a chance to make any changes to your network setup. Then the filesystems you
created will be mounted and a root password set. This will get your local disks ready for the OpenBSD packages to be installed upon them. After your 
local disks are ready, you will be asked if you plan to run X on this 
system.  If you answer 'Y', <tt>/etc/sysctl.conf</tt> will be modified to 
include the line <i>machdep.allowaperture=1</i>.  

<p>
Next, you will get a chance to choose your installation media. The options are listed below. 

<ul>
<table border=0 width="800"><tr><td nowrap bgcolor="#EEEEEE"><pre>
You will now be given the opportunity to escape to the command shell to do
any additional network configuration you may need. This may include adding
additional routes, if needed. In addition, you might take this opportunity
to redo the default route in the event that it failed above.
Escape to shell? [n] <b><i>&gt;Enter&lt;</i></b>
/dev/wd0a on /mnt type ffs (rw, asynchronous, local, ctime=Tue Apr 16 15:50:28 2
002)
/dev/wd0h on /mnt/home type ffs (rw, asynchronous, local, ctime=Tue Apr 16 15:50
:28 2002)
/dev/wd0d on /mnt/tmp type ffs (rw, asynchronous, local, ctime=Tue Apr 16 15:50:
28 2002)
/dev/wd0g on /mnt/usr type ffs (rw, asynchronous, local, ctime=Tue Apr 16 15:50:
28 2002)
/dev/wd0e on /mnt/var type ffs (rw, asynchronous, local, ctime=Tue Apr 16 15:50:
28 2002)

Please enter the initial password that the root account will have.
Password (will not echo): <b><i>&gt;enter root PW&lt;</i></b>
Password (again): <b><i>&gt;re-enter root PW&lt;</i></b>

Do you expect to run the X Window System? [y] <b><i>&gt;Enter&lt;</i></b>


You must now specify where the install sets you want to use are. They
must either be on a local device (disk, tape, or CD-ROM), an
accessible NFS filesystem or an accessible ftp or http network
server. You will have the chance to repeat this step or to extract
sets from several places, so you do not have to try to load all the
sets in one try and can recover from some errors.

Install from (f)tp, (h)ttp, (t)ape, (C)D-ROM or local (d)isk? <b>c</b>
</pre></td></tr></table>
</ul>

<p>
In this example we are installing via CD-ROM. This will bring up a list of devices on your computer identified as a CD-ROM. Most
people will only have one; if you don't, you need to make sure you pick the device which you will use to install OpenBSD from. After choosing the correct device, you will be
prompted for which filesystem the installation files will reside on. If you are using the OpenBSD CD-ROM you will choose 'c' here, for 'c' represents the whole disk. Here is an
example: 
</p>

<ul>
<table border=0 width="800"><tr><td nowrap bgcolor="#EEEEEE"><pre>
The following CD-ROM devices are installed on your system.
Please make sure the CD is in the CD-ROM drive and select
the device containing the CD with the installation sets:

cd0

Which CD-ROM contains the installation media? [cd0] <b><i>&gt;Enter&lt;</i></b>

Enter the directory relative to the mount point that contains
the file: [3.1/i386] <b><i>&gt;Enter&lt;</i></b>
</pre></td></tr></table>
</ul>

<p>
Here, you are prompted for which directory the installation files are, 
which is <tt>/3.1/i386/</tt> on the official CDROM.  

<h3>4.1.9 - Choosing installation packages and finishing the install.</h3>

<p>
Now it's time to choose which packages you will be installing. You can 
get a description of these files in <a href="#FilesNeeded">the next 
section</a>. The files that the install program finds will be shown to you 
on the screen. Your job is just to specify which files you want. By 
default all the non-X packages are selected, however, some people may
wish to limit this to the bare minimum required to run OpenBSD, which
would be <tt>base31.tar.gz</tt>, <tt>etc31.tar.gz</tt> and <tt>bsd</tt>. 
Others will wish to install all packages. The example
below is that of a full install, minus the games package. 
</p>

<ul>
<table border=0 width="800"><tr><td nowrap bgcolor="#EEEEEE"><pre>
You will now be asked which sets to install. Some of these sets are required
for your install and some are optional. You will want at least the
base and bsd sets. Consult the installation notes if you are not sure
which sets are required!

The following sets are available. Enter a filename, 'all' to select
all the sets, or 'done'. You may de-select a set by prepending a '-'
to its name.

        [X] base31.tgz
        [X] etc31.tgz
        [X] misc31.tgz
        [X] comp31.tgz
        [X] man31.tgz
        [X] game31.tgz
        [ ] xbase31.tgz
        [ ] xshare31.tgz
        [ ] xfont31.tgz
        [ ] xserv31.tgz
        [X] bsd
File name? [xbase31.tgz] <b>*</b>

The following sets are available. Enter a filename, 'all' to select
all the sets, or 'done'. You may de-select a set by prepending a '-'
to its name.

        [X] base31.tgz
        [X] etc31.tgz
        [X] misc31.tgz
        [X] comp31.tgz
        [X] man31.tgz
        [X] game31.tgz
        [X] xbase31.tgz
        [X] xshare31.tgz
        [X] xfont31.tgz
        [X] xserv31.tgz
        [X] bsd
File name? [done] <b>-game31.tgz</b>

The following sets are available. Enter a filename, 'all' to select
all the sets, or 'done'. You may de-select a set by prepending a '-'
to its name.

        [X] base31.tgz
        [X] etc31.tgz
        [X] misc31.tgz
        [X] comp31.tgz
        [X] man31.tgz
        [ ] game31.tgz
        [X] xbase31.tgz
        [X] xshare31.tgz
        [X] xfont31.tgz
        [X] xserv31.tgz
        [X] bsd
File name? [game31.tgz] <b>done</b>
Ready to install sets? [y] <b><i>&gt;Enter&lt;</i></b>
</pre></td></tr></table>
</ul>

<p>
Once you have successfully picked which packages you want, you will be prompted to make sure you want to extract these packages and they will then be installed. A progress
bar will be shown that will keep you informed on how much time it will 
take. The times range greatly depending on what system it is you are 
installing OpenBSD on, the packages installed, and the the speed of the 
source media.  This part may from a few minutes to several hours.
</p>

<ul>
<table border=0 width="800"><tr><td nowrap bgcolor="#EEEEEE"><pre>
Ready to install sets? [y] <b><i>&gt;Enter&lt;</i></b>

Getting base31.tgz ...
100% |**************************************************| 23299 KB    00:25
Getting etc31.tgz ...
100% |**************************************************|  1164 KB    00:02
Getting misc31.tgz ...
100% |**************************************************|  1664 KB    00:01
Getting comp31.tgz ...
100% |**************************************************| 16061 KB    00:18
Getting man31.tgz ...
100% |**************************************************|  5412 KB    00:08
Getting bsd ...
100% |**************************************************|  4436 KB    00:02
Getting xbase31.tgz ...
100% |**************************************************|  8520 KB    00:06
Getting xshare31.tgz ...
100% |**************************************************|  1815 KB    00:05
Getting xfont31.tgz ...
100% |**************************************************| 30657 KB    00:31
Getting xserv31.tgz ...
100% |**************************************************| 19339 KB    00:11

Extract more sets? [n] <b><i>&gt;don't answer yet!&lt;</i></b>
</pre></td></tr></table>
</ul>

<p>
If your system has a small amount of RAM (less than 20M on i386), do not 
hit return at that prompt quite yet!

<a name="SmallRAM">  </a>
<h4>Special steps for machines with little RAM</h4>
As OpenBSD has grown, the minimum RAM requirement has grown, and is likely to
continue to increase.  The next step in the install process will require more
than 16M RAM, and will fail on older machines with less than 20M RAM (again, 
these are i386 numbers -- some other platforms will require far less RAM, 
though this trick can be used with them as well, if they are running near the 
lower-limits.
<p>
During the install process, there is normally no swap, the real RAM is all 
you have.  The 'MAKEDEV' step that follows will require more than the rest 
of the install required.  As a system with small amounts of RAM can still 
be very usable for many applications, working around this limitation is 
a quite useful trick.
<p>
The solution is to activate swap now.  The swap partition has been created, 
the files are installed to the hard disk, the only trick here is to 
manually invoke it.  So, do not just hit 'ENTER' at the above prompt, but 
rather, hit '!', which will bring up a shell, and launch 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=swapon&sektion=8">swapon(8)</a>
from the mounted hard drive:

<ul><table border=0 width="800"><tr><td nowrap bgcolor="#EEEEEE"><tt>
Extract more sets? [n] <b>!</b><br>
Type 'exit' to return to install.<br>
# <b>/mnt/sbin/swapon /dev/wd0b</b><br>
# <b>exit</b><br>
<b>n</b><br>
</tt></td></tr></table>
</ul>

Note the 'n' as the last step.  Remember, we called up the shell from the 
"Extract more sets?" question, that last 'n' is answering that question.
<p>
You can now resume the normal installation.

<h3>Finishing up</h3>
Once this is done, all that's left is to set your timezone and install the boot blocks. Setting your timezone is extremely easy. Just pick the area you live in and enter the name. That's
it!. Only one more question, which is whether or not you will be running X on this server. If you plan to ever run X on this server you should choose yes, otherwise you might have to
change machdep.allowaperture=0 into machdep.allowaperture=1 in your <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl.conf&sektion=5">etc/sysctl.conf(5)</a>. After this is all done, just type 'reboot' at the shell prompt and your machine will
be booted with OpenBSD! 
</p>
<ul><table border=0 width="800"><tr><td nowrap bgcolor="#EEEEEE"><pre>
Extract more sets? [n]

Copying... fstab hostname.fxp0 hosts myname mygate resolv.conf ...done.

Select a time zone for your location. Timezones are represented on the system
by a directory structure rooted in "/usr/share/timezone". Most timezones can
be selected by entering a token like "CET" or "GMT-6". Other zones are
grouped by continent or country, with detailed zone information separated by
a slash ("/"), e.g. "US/Pacific" or "Canada/Mountain".

What timezone are you in? ('?' for list) [US/Pacific] <b>Canada</b>
Select a sub-timezone of 'Canada' ('?' for list): <b>?</b>
Atlantic            Eastern             Pacific
Central             Mountain            Saskatchewan
East-Saskatchewan   Newfoundland        Yukon
Sele of 'Canada' ('?' for list): <b>Mountain</b>
You have selected timezone 'Canada/Mountain'.
Making all device nodes (by running /dev/MAKEDEV all) ...... done.
Installing boot block...
boot: /mnt/boot
proto: /usr/mdec/biosboot
device: /dev/rwd0c
/usr/mdec/biosboot: entry point 0
proto bootblock size 512
room for 12 filesystem blocks at 0x16f
Will load 7 blocks of size 8192 each.
Using disk geometry of 63 sectors and 255 heads.
 0: 56 @(0 152 8) (9583-9638)
 1: 40 @(0 153 1) (9639-9678)
 2: 16 @(0 9 27) (593-608)
/mnt/boot: 3 entries total
using MBR partition 3: type 166 (0xa6) offset 63 (0x3f)

Enabling machdep.allowaperture. Read xf86(4) for more information.


Cleaning up...
/dev/wd0e: unmount from /mnt/var
/dev/wd0g: unmount from /mnt/usr
/dev/wd0d: unmount from /mnt/tmp
/dev/wd0h: unmount from /mnt/home
/dev/wd0a: unmount from /mnt
Done.

CONGRATULATIONS!  You have successfully installed OpenBSD!  To boot the
installed system, enter halt at the command prompt. Once the system has
halted, reset the machine and boot from the disk.

# halt
syncing disks... done

The operating system has halted.
Please press any key to reboot.
</pre></td></tr></table>
</ul>

<h3>After your reboot</h3>

<p>
This section will hopefully point you in the right direction for clues on what to do initially after you 
have installed your OpenBSD system. This is basically modeled after the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=afterboot&sektion=8&format=html">afterboot(8)</a> 
man page, which should definitely be one of your first steps after 
installing OpenBSD. Here is a table which will point you to relevant
FAQ sections.

<UL>
<LI><a href="faq10.html#AddDelUser">Adding users in OpenBSD</a> 
<LI><a href="faq6.html#Setup">Initial Network Setup</a>
<LI><a href="faq2.html#ManPages">Man Pages of popular/useful commands</a>
<LI><a href="http://www.openbsd.org/cgi-bin/man.cgi">OpenBSD man pages on the Web</a>
<li><a href="faq8.html#Packages">OpenBSD Packages</a> - Precompiled Binary Packages.
</UL>

<h3>One last thing...</h3>
The OpenBSD developers ask you to
<a href="#SendDmesg">Send in a copy of your dmesg</a>.  This is 
really appreciated by the developers, and ultimately, all 
users.
</p>


<a name="1.14"></a>
<h2>Other Information Resources</h2>

Additional documents already exist for those of you who might have 
special needs or interests. You can retrieve these from any of
the mirror ftp sites.
<LI><a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.1/i386/INSTALL.i386">INSTALL.i386</a> 
- Comprehensive installation document. Similar documents exist for all platforms.
<LI><a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.1/i386/INSTALL.linux">INSTALL.linux</a> - Installing OpenBSD along with Linux.
<LI><a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.1/i386/INSTALL.mbr">INSTALL.mbr</a> - Explaining the Master Boot Record.
<LI><a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.1/i386/INSTALL.pt">INSTALL.pt</a> - Explaining Partition Tables.
<LI><a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.1/i386/INSTALL.dbr">INSTALL.dbr</a> - DOS Floppy Disk Boot Sector.
<LI><a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.1/i386/INSTALL.chs">INSTALL.chs</a> - Explaining CHS Translation.
<LI><a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.1/i386/INSTALL.ata">INSTALL.ata</a> - ATA/ATA-1/ATA-2/IDE/EIDE/etc FAQ
<LI><a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.1/i386/INSTALL.os2br">INSTALL.os2br</a> - The os2 Boot Sector.
</UL>

<p>
<a name= "FilesNeeded"></a>
<a name= "4.2"></a>
<h2>4.2 - What files are needed for Installation?</h2>
</p>

<p>
There are many packages containing the OpenBSD binaries, but which ones do
you need to get your system up and running? Here is an overview of each
package.
</p>

<p>
<ul>
    <li><strong>base31.tgz</strong>    - Has the base OpenBSD system <b>Required</b></li>
    <li><strong>etc31.tgz</strong>     - Has all the files in /etc <b>Required</b></li>
    <li><strong>comp31.tz</strong>    - Has the compiler and its tools, libs. <b>Recommended</b></li>
    <li><strong>man31.tgz</strong>     - Holds man pages <b>Recommended</b></li>
    <li><strong>misc31.tgz</strong>    - Holds misc info, setup docs</li>
    <li><strong>game31.tgz</strong>    - Has the games for OpenBSD</li>
    <li><strong>xbase31.tgz</strong>   - Has the base install for X11</li>
    <li><strong>xfont31.tgz</strong>   - Holds X11's font server and fonts</li>
    <li><strong>xserv31.tgz</strong>   - Has X11's X servers</li>
    <li><strong>xshare31.tgz</strong>  - Has manpages, locale settings, includes, etc  for X</li>
    <li><strong>bsd</strong> 		  - This is the Kernel. <b>Required</b></li>
</ul>
</p>

<p>
<a name= "SpaceNeeded"></a>
<a name= "4.3"></a>
<h2> 4.3 - How much space do I need for an OpenBSD installation?</h2>
</p>

<p>
The following are minimum suggested sub-tree sizes for a full system install. 
The numbers include enough extra space to permit you to run a typical home
system that is connected to the Internet.

<ul>
<li>These are minimum values.  
<li>If you plan to install a significant amount of third party software, 
make your /usr partition large!  <strong>At least</strong> triple these values!
<li>For a system that handles lots of email or web pages (stored, 
respectively, in /var/mail and /var/www) you will want to make your 
/var partition significantly larger.
<li>For a
multiuser system which may generate lots of logs, you will still
want to make your /var partition significantly larger (/var/log). 
<li>If you plan to rebuild the kernel or system from source, you will
want to make the /usr partition significantly larger, <b>at least</b> 800M-1G 
larger than indicated below.
</ul>
As you read this, keep in mind that /usr and /usr/X11R6 are usually
both parts of the same filesystem, that is, /usr, as there is no big
advantage to making them into separate filesystems.
<ul>
<strong>
<pre>
SYSTEM          /       /usr    /var    /usr/X11R6
alpha           50M     250M    25M     100M
amiga           40M     200M    25M     180M
hp300           40M     200M    25M      80M
i386            40M     200M    25M     140M
mac68k          40M     200M    25M      80M
macppc          50M     200M    25M     100M
mvme68k         40M     200M    25M      80M
sparc           40M     259M    25M      49M
sparc64         50M     200M    25M     100M
vax             75M     125M    25M     180M
</pre>
</strong>
</ul>

<p>
When you are in the disklabel editor, you may choose to make your entire
system have just an 'a' (main filesystem) and 'b' (swap) .  The 'a' filesystem which you set up
in disklabel will become your root partition, which should be the sum of
all the 3 main values above (/, /usr, and /var) plus some space for /tmp.
The 'b' partition you set up automatically becomes your system swap
partition -- we recommend a minimum of 32MB but if you have disk to spare
make it at least 64MB.  If you have lots of disk space to spare, make this
256MB, or even 512MB.  

<P>
There are four main reasons for using separate filesystems, instead of shoving
everything into one or two filesystems:
<UL>
<LI><b>Security</b>: You can mark some filesystems as 'nosuid', 'nodev', 'noexec', 'readonly', etc..
<LI><b>Stability</b>: A user, or a misbehaved program, can fill a filesystem with garbage, if they have write permissions for it.  Your critical programs, which of course run on a different filesystem, do not get interrupted.
<LI><b>Speed</b>: A filesystem which gets written to frequently may get somewhat fragmented.  (Luckily, the ffs filesystem, what OpenBSD uses, is not prone to heavy fragmentation.)
<LI><b>Integrity</b>: If one filesystem is corrupted for some reason then your other filesystems are still OK.
<li><b>Size</b>: Many platforms have limits on the area of a disk where the
boot ROM can load the kernel from.  In some cases, this limit may be very
small (504M for an older 486), in other cases, a much larger limit (8G on
new i386 systems).  As the kernel can end up anywhere in the root partition,
the entire root partition should be within this area. For more details,
see <a href="faq14.html#LargeDrive">this section</a>.  A good guideline might
be to keep your / partition completely below 2G, unless you know your platform
(and particular machine!) can handle more (or less!) than that.
</UL>

<p>
Some additional thoughts on partitioning:
<ul>
 <li>For your first attempt at an experimentation system, one big / partition
and swap may be easiest until you know how much space you need.
 <li>A system exposed to the Internet or other hostile forces should
have a separate /var (and maybe even a separate /var/log) for logging.
 <li>A /home partition can be nice.  New version of the OS?  Wipe and
reload everything else, leave your /home partition untouched.
 <li>A separate partition for anything which may accumulate a large
quantity of files that may need to be deleted can be faster to reformat
and recreate than to delete.  See the
<a href="upgrade-minifaq.html#1.5">upgrade-minifaq</a> for an example (/usr/obj).
 <li>If you wish to rebuild your system from source for any reason, the
source will be in /usr/src.  If you don't make a separate partition
for /usr/src, make sure /usr has sufficient space.
 <li>A commonly forgotten fact: you do <b>not</b> have to allocate
all space on a drive when you set the system up! Since  
you will now find it a challenge to buy a new drive smaller than 20G,
it can make sense to leave a chunk of your drive unallocated.  If you
outgrow a partition, you can allocate a new partition from your
unused space, <a href="faq10.html#DupFS">duplicate</a> your existing
partition to the new partition, change
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fstab&sektion=5">/etc/fstab</a>
to point to the new partition, remount, you now have more space.
 <li>If you make your partitions to close to the minimum size required, 
you will probably regret it later, when it is time to upgrade your system.  
</ul>


<P>
<a name= "Multibooting"></a>
<a name="4.4"></a>
<h2>4.4 - Multibooting OpenBSD (i386, alpha)</h2>
</p>

<p>
<strong>OpenBSD & NT (or XP)</strong>
</p>

<p>
To multiboot OpenBSD and NT (or XP), you can use NTloader, the bootloader that NT uses. To multi-boot with NT,  you
need a copy of your OpenBSD pbr. After running installboot, you can copy it something like this:
</p>

<ul>
<pre>
	# <strong>dd if=/dev/rsd0a of=openbsd.pbr bs=512 count=1</strong>
</pre>
</ul>

<p>
Now boot NT and put openbsd.pbr in C:. Add a line like this to the end of <tt>C:\BOOT.INI</tt>: 
</p>

<ul>
<pre>
	c:\openbsd.pbr="OpenBSD"
</pre>
</ul>

<p>
When you reboot, you should be able to select OpenBSD from the NT loader menu. There is much more
information available about NTloader at the <a href="http://www.tburke.net/info/ntldr/ntldr_hacking_guide.htm">
NTLDR Hacking Guide. </a>
</p>
<p>
On Windows XP you can also edit the boot information using the GUI, see the
<a href="http://support.microsoft.com/default.aspx?scid=kb;EN-US;q289022">XP Boot.ini HOWTO</a>.
</p>

<p>
<strong>OpenBSD & Windows or DOS (i386)</strong>
</p>

<p>
To boot OpenBSD along with Windows 3.1, Windows95, or DOS you must use a boot loader on the system
that can handle OpenBSD, Windows, and DOS! Some bootloaders of choice are <a href="http://www.freebird.org/sw-map/bootmanager.html">
osbs20b8.zip</a> or <a href="http://www.ranish.com/part/">The Ranish Partition Manager</a>.
Both of these are able to boot OpenBSD partitions.
</p>

<p>
<strong>OpenBSD & Linux (i386)</strong>
</p>

<p>
Please refer to <a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.1/i386/INSTALL.linux">INSTALL.linux</a>, which gives in depth instructions on getting
OpenBSD working with Linux.
</p>

<p>
<a name= "SendDmesg"></a>
<a name="4.5"></a>
<h2>4.5 - Sending your dmesg to dmesg@openbsd.org after the install</h2>
</p>

<p>
Just to remind people, it's important for the OpenBSD developers to keep track
of what hardware works, and what hardware doesn't work perfectly..
</p>

<p>
A quote from /usr/src/etc/root/root.mail
<pre>
If you wish to ensure that OpenBSD runs better on your machines, please do us
a favor (after you have your mail system setup!) and type
        dmesg | mail dmesg@openbsd.org
so that we can see what kinds of configurations people are running.  We will
use this information to improve device driver support in future releases.
(We would be much happier if this information was for the supplied GENERIC
kernel; not for a custom compiled kernel).  The device driver information
we get from this helps us fix existing drivers.
</pre>
</p>
<p>
Make sure you send email from an account that is able to also receive
email so developers can contact you back if they have something they want
you to test or change in order to get your setup working. It's not important
at all to send the email from the same machine that is running OpenBSD, so
if that machine is unable to receive email, just
<pre>
 dmesg | mail your-account@yourmail.dom
</pre>
and then forward that message to
<pre>
 dmesg@openbsd.org
</pre>
where <tt>your-account@yourmail.dom</tt> is your regular email account.
(or transfer the dmesg output using ftp/scp/floppydisk/carrier-pigeon/...)
</p>

<p>
<strong>NOTE</strong> - Please send only GENERIC kernel dmesgs. Custom
kernels that have device drivers removed are not helpful.
</p>

<a name= "AddFileSet"></a>
<h2>4.6 - Adding a file set after install</h2>
"Oh no!  I forgot to add a file set when I did the install!"
<p>
Sometimes, you realize you really DID need <tt>comp31.tgz</tt> (or any
other system component) after all, but you didn't realize this at the
time you installed your system.  Good news: There are two easy ways to
add file sets after the initial install:

<h3>Using the Upgrade process</h3>
Simply boot your install media (CD-ROM or Floppy), and choose Upgrade
(rather than Install).  When you get to the lists of file sets to install,
choose the sets you neglected to install first time around, select
your source, and let it install them for you.

<h3>Using tar(1)</h3>
The install file sets are simply compressed tar files, and you can
expand them manually from the root of the file system:
<ul>
<table border=0 width="800"><tr><td nowrap bgcolor="#EEEEEE"><pre>
# cd /
# tar xzvpf comp31.tgz
</pre></td></tr></table>
</ul>
Do NOT forget the <tt>'p'</tt> option in the above command in
order to restore the file permissions properly!
<p>
One common mistake is to think you can use
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_add&sektion=1">pkg_add(1)</a>
to add a missing file sets.  This does not work.  pgk_add(1) is
for package files, not generic tar files like the install sets.
<p>

<a name="bsd.rd">
<h2>4.7 - What is 'bsd.rd'?</h2>
<b><tt>bsd.rd</tt></b> is a "RAM Disk" kernel.  This file can be very useful, many
developers are careful to keep it on the root of their system at all
times.
<p>
Calling it a "RAM Disk kernel" describes the root file
system of the kernel -- rather than being a physical drive, the 
utilities available after the boot of <tt>bsd.rd</tt> are stored 
in the kernel, and are run from a RAM-based file system.  
<tt>bsd.rd</tt> also includes a healthy set of utilities to 
allow you to do system maintenance and installation.
<p>
On some platforms, <tt>bsd.rd</tt> is actually the preferred 
installation technique -- you place this kernel on an existing 
file system, boot it, and run the install from it.  On most 
platforms, if you have a running older version of OpenBSD, you 
can FTP  a new version of <tt>bsd.rd</tt>, reboot from it, and 
install a new version of OpenBSD without using any removable 
media at all.
<p>
Here is an example of booting <tt>bsd.rd</tt> on an i386 system:

<ul>
<table border=0 width="800"><tr><td nowrap bgcolor="#EEEEEE"><pre>
Using Drive: 0 Partition: 3
reading boot.....
probing pc0 com0 com1 apm mem[639k 255M a20=on]
disk fd0 hd0
>> OpenBSD/i386 BOOT 1.28
boot> <b>boot hd0a:/bsd.rd</b>
<i>. . . normal boot to install . . .</i>
</pre></td></tr></table>
</ul>
As indicated, you will be brought to the install program, but you
can also drop to the shell to do maintenance on your system.
<p>
The general rule on booting <tt>bsd.rd</tt> is to change your boot
kernel from <tt>/bsd</tt> to <tt>bsd.rd</tt> through whatever 
means used on your platform.  
<p>
<br>

<font color= "#0000e0">
<a href= "index.html">[Back to Main Index]</a>
<a href= "faq3.html">[To Section 3.0 - Obtaining OpenBSD]</a>
<a href= "faq5.html">[To Section 5.0 - Kernel configuration and Disk Setup]</a>
</font>
</p>

<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../images/back.gif" border= "0" alt= "[back]"></a> 
<a href= "mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>$OpenBSD: faq4.html,v 1.102 2002/06/07 22:54:21 nick Exp $</small>
</p>
</body>
</html>




<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <title>OpenBSD Upgrading Mini-FAQ</title>
  </head>

  <body bgcolor="#FFFFFF" text="#000000" link="#23238E">

    <h1>MINI-FAQ: Upgrading OpenBSD</h1>

    <h2>Latest OpenBSD Release - 3.4</h2>

    <address>
      <p>Kjell Wooding 
	&lt;<a href="mailto:kjell@openbsd.com">kjell@openbsd.org</a>&gt;<br>
	Updated: 
	$OpenBSD: upgrade-minifaq.html,v 1.203 2004/04/29 03:28:47 nick Exp $</p>
    </address>
    <br>
    
    <blockquote>
      <p>This Mini-FAQ is an attempt to address the most common
      issues encountered when upgrading between OpenBSD releases,
      or from the releases to <em>-current</em>. Though hardly
      <em>Mini</em> anymore, this document retains the Mini-FAQ
      moniker for historical and/or consistency reasons.
      Information on older versions can be found in a <a href=
      "upgrade-old.html">separate document</a>.</p>
    </blockquote>

    <p>
      The Upgrade-MiniFAQ is intended for <b>Advanced Users</b>.
      If you are a beginner, or are <b>not completely confident</b>
      with your compiler and toolchain, then upgrading via source is
      <b>not for you</b>. Install a binary release or snapshot instead,
      then apply any relevant instructions below for upgrading
      <tt>/etc</tt>.
    </p>

    <h2>General Upgrade Questions</h2>
    
    <p>
      <a href="#1.1">1.1: Terminology. What is <em>-current</em>?
	What are Snapshots? What is <em>-stable</em>?</a><br>
      
      <a href="#1.2">1.2: What is the easiest way to upgrade to
	<em>-current</em>?</a><br>
      
      <a href="#1.3">1.3: I looked, but didn't see any snapshots on
	the FTP site. Where did they go?</a><br>
      
      <a href="#1.4">1.4: How do I get the latest source?</a><br>
      
      <a href="#1.5">1.5: Okay, I have the tree. How do I build
	it?</a><br>
      
      <a href="#1.6">1.6: My make build stopped halfway. Do I have
	to redo the whole thing?</a><br>
      
      <a href="#1.7">1.7: I'm getting errors during the build. What
	do I do?</a><br>
      
      <a href="#1.8">1.8: Is there a standard way of
	upgrading the compiler, <em>gcc</em>?</a><br>
      
      <a href="#1.9">1.9: What is the best way to upgrade
	<tt>/etc</tt>, <tt>/var</tt>, and <tt>/dev</tt>?</a><br>
      
      <a href="#1.10">1.10: How do I clean all the cruft out of my
	existing source tree?</a><br>
      
      <a href="#1.11">1.11: Do I have to be root to do a <em>make
	  build</em>?</a><br>
      
      <a href="#1.12">1.12: Why am I not seeing any new
	devices?</a><br>
      
      <a href="#1.13">1.13: Is there an easy way to make all the
	file hierarchy changes?</a><br>

      <a href="#1.14">1.14: After an upgrade, <em>ps</em> now reports
	"proc size mismatch."</a><br>

      <a href="#1.15">1.15: How can I upgrade to the latest snapshot?</a><br>


    </p>
    
    <h2>Upgrading from 3.5 to <i>-current</i></h2>
    <p>
      <a href="#3.5.1">3.5.1: pty device minor numbers changed</a><br>
      <a href="#3.5.2">3.5.2: New user and group _dhcp</a><br>
      <a href="#3.5.3">3.5.3: New user and group _mopd</a><br>
      <a href="#3.5.4">3.5.4: New user and group _tftpd</a><br>
    </p>

    <h2>Upgrading from 3.4 to 3.5</h2>
    <p>
      <a href="#3.4.1">3.4.1: svnd device minor numbers changed</a><br>
      <a href="#3.4.2">3.4.2: New user and group _pflogd</a><br>
      <a href="#3.4.3">3.4.3: Interface cloning</a><br>
      <a href="#3.4.4">3.4.4: New user and group _bgpd</a><br>
      <a href="#3.4.5">3.4.5: New version of join(1)</a><br>
      <a href="#3.4.6">3.4.6: sudo build change</a><br>
      <a href="#3.4.7">3.4.7: New user and group _tcpdump</a><br>
      <a href="#3.4.8">3.4.8: machdep.c change (i386)</a><br>
      <a href="#3.4.9">3.4.9: Switch to gcc3 (sparc64)</a><br>
    </p>
  
    <h2>Upgrading from 3.3 to 3.4</h2>

    <p>
      <a href="#3.3.1">3.3.1: i386 W^X support </a><br>
      <a href="#3.3.2">3.3.2: mquery syscall change</a><br>
      <a href="#3.3.3">3.3.3: i386 flag day, exe addr/MAXDSIZ change</a><br>
      <a href="#3.3.4">3.3.4: Removal of KerberosIV authentication</a><br>
      <a href="#3.3.5">3.3.5: config change</a><br>
      <a href="#3.3.6">3.3.6: Use __attribute__((bounded)) on certain
                functions</a><br>
      <a href="#3.3.7">3.3.7: New user and group _syslogd</a><br>
      <a href="#3.3.8">3.3.8: New format attribute __kprintf__ in kernel 
		headers</a><br>
    </p>
    
    <h2>Upgrading from 3.2 to 3.3</h2>
    
    <p>
      <a href="#3.2.1">3.2.1: New Perl</a><br>
      <a href="#3.2.2">3.2.2: New groups _radius, _token and _shadow</a><br>
      <a href="#3.2.3">3.2.3: Important compiler changes</a><br>
      <a href="#3.2.4">3.2.4: New user and group _spamd</a><br>
      <a href="#3.2.5">3.2.5: Alias for ipv6-icmp</a><br>
      <a href="#3.2.6">3.2.6: New group _lkm</a><br>
      <a href="#3.2.7">3.2.7: New libpthread</a><br>
      <a href="#3.2.8">3.2.8: Linker changes for ELF architectures </a><br>
      <a href="#3.2.9">3.2.9: Removal of /var/at and crontab changes </a><br>
    </p>

    <h2>Upgrading from Earlier Versions</h2>

    <p>Information on upgrading from OpenBSD 2.3 to 3.1 
      has been moved to a <a href="upgrade-old.html">separate
	document</a>. This document was getting just
      too darn big.</p>


    &nbsp;<hr width="30%">

    <a name="1.0"></a> 
    <h2>General Upgrade Questions</h2>

    <a name="1.1"></a> 
    <h3>1.1: Terminology. What is <em>-current</em>? What are
      Snapshots? What is <em>-stable</em>?</h3>
    
    <p>Prior to OpenBSD 2.7, OpenBSD development happened from a
      single, unbranched source tree. As of 2.7, a patch branch was
      introduced.</p>
    
    <p>At approximately six-month intervals, OpenBSD
      <em>releases</em> are produced. These are numbered in the
      conventional (2.x, 3.x) manner. The current OpenBSD release is
      indicated at the top of this document.</p>
    
    <p><em>-current</em>, short for <em>openbsd-current</em>,
      refers to the up-to-the-minute version of the source tree
      contained in the CVS repository. This is the tree most commonly
      used by OpenBSD developers. The <em>-current</em> tree contains
      all the code that is planned for the next release. From time to
      time, brave souls will abandon the formal releases and run
      openbsd-current, usually to take advantage of features that
      have not yet made it into the formal releases. Because of its
      uncertain nature, however, upgrading to <em>-current</em> is
      not recommended for non-technical users.</p>
    
    <p>Between formal releases, a series of <em>snapshot</em>
      releases are
      <a href="ftp://ftp.openbsd.org/pub/OpenBSD/snapshots/">made
	available.</a> Snapshots are test releases of the
      <em>-current</em> source tree. Because they reflect the current
      state of development, there is no guarantee that snapshot
      releases will work correctly (or even at all). Snapshots are
      quite useful when moving from a formal release (or older
      version of -current) to the current tree. If you happen to run
      <em>-current</em> it is strongly recommended to follow the
      <em>source-changes</em> <a href="/mail.html">mailing list</a>.
      The commit messages often contain valuable information about
      the latest and greatest features added.</p>
    
    <p>As of OpenBSD 2.7, a <a href="../stable.html">patch
	branch</a> (called <em>-stable</em>) was introduced. This
      branch contains the base release, and any important patches or
      fixes (important being the errata patches, plus others that are
      obvious and simple, but do not deserve an errata entry).</p>
    
    <p>The <a href="../ports.html">ports tree</a> is an integral
      part of the system. You should upgrade the ports tree at the
      same time as the rest of the system, following the same rules
      as for upgrading everything else; i.e., you should run -stable
      ports on a -stable system, and -current ports only on a
      -current system.</p>

    <a name="1.2"></a>
    <h3>1.2: What is the best way to upgrade to
      <em>-current</em>?</h3>
    
    <p>Due to changes in the underlying libraries, moving directly
      from a release to <i>-current</i> is rarely easy.
      <b>The best and only supported way to move up to
      <i>-current</i> is to first <a href="#1.15">upgrade to the
      latest snapshot</a>.</b>
      Once the snapshot is installed, the latest source can be 
      <a href="#1.4">fetched</a> and <a href="#1.5">built</a>. This
      procedure should eliminate most toolchain and library
      problems.
      Again, attempting to upgrade from source without first starting
      from the closest avaialable snapshot or release is <i>not
      supported</i>.

    <a name="1.3"></a> 
    <h3>1.3: I looked, but didn't see any snapshots on the FTP
      site. Where did they go?</h3>
    
    <p>Snapshots may be removed as they become old (or no longer
      relevant). If no snapshot is available, you should upgrade to
      the most recent release and build the remainder of the way from
      source.</p>

    <a name="1.4"></a> 
    <h3>1.4: How do I get the latest source?</h3>

    <p>Short answer: 
      <a href="../anoncvs.html">http://www.openbsd.org/anoncvs.html</a></p>
    
    <p>For example. To retrieve the entire tree via CVS: (using the
      ksh shell. Others substitute <em>setenv</em> for
      <em>export</em>)</p>

<pre>
  # export CVSROOT=anoncvs@anoncvs.ca.openbsd.org:/cvs
  # export CVS_RSH=/usr/bin/ssh
  # cd /usr
  # cvs -q get -P src
</pre>

    <p>Note that this gets you -current. You probably don't want that.
      For example, to retrieve 3.2-stable, use</p>

<pre>
  # cvs -q get -rOPENBSD_3_2 -P src
</pre>

    <a name="1.5"></a> 
    <h3>1.5: Okay, I have the tree. How do I build it?</h3>
    
    <p>Basic instructions are in 
      <a href="http://www.openbsd.org/cgi-bin/cvsweb/src/Makefile"
	 ><tt>/usr/src/Makefile</tt></a>.
      This is a slightly expanded version.</p>
    
    <ol>
      <li>
        <p>Clean out the old object files.</p>
	
        <p>If you created a separate /usr/obj directory, clean
	  that, and rebuild the symbolic links:</p>

<pre>
  # rm -rf /usr/obj/*
  # cd /usr/src
  # make obj
</pre>

        <p>If you find yourself performing this step a lot, you may
	  find it faster to place /usr/obj onto its own partition,
	  and use <em>newfs</em> instead of <em>rm</em>. For example,
	  I do a:</p>

<pre>
  # umount /usr/obj
  # newfs wd0h
  # mount /usr/obj
  # make obj
</pre>

        <p>If you're worried there are object files in your source
	  tree, do this:</p>

<pre>
  # cd /usr/src
  # find . -type l -name obj | xargs rm
  # make cleandir
  # rm -rf /usr/obj/*
  # make obj
</pre>

      </li>
      
      <li>
        <p>Perform any version-specific configuration changes. For
	  example, 2.3 users must add the <em>named</em> user and
	  group before moving to 2.4 or later. See the specific
	  Mini-FAQ section for your version.</p>
      </li>
      
      <li>
        <p>Make sure all the appropriate directories are created.
	  This is especially important when upgrading from older
	  versions, but is sometimes necessary in other cases. The
	  easiest way to do this is:</p>
<pre>
  # cd /usr/src/etc &amp;&amp; env DESTDIR=/ make distrib-dirs
</pre>

      </li>

      <li>
        <p>Compile a new kernel.</p>
<pre>
  # cd /usr/src/sys/arch/`machine`/conf
</pre>

        <p>Most users will want to use GENERIC:</p>
<pre>
  # config GENERIC
  # cd ../compile/GENERIC
</pre>

        <p><strong>NOTE:</strong> The truly masochistic in the
	  crowd may want to compile a custom kernel instead. In these
	  cases, it's usually best to start with GENERIC and trim
	  from there. Do the following procedure instead:</p>
<pre>
  # cp GENERIC MYKERNEL
  # vi MYKERNEL
  (edit MYKERNEL to your liking)
  # config MYKERNEL
  # cd ../compile/MYKERNEL
</pre>

        <p>In either case,</p>
<pre>
  # make clean &amp;&amp; make depend &amp;&amp; make
  (arc architecture only) copy bsd.ecoff to your FAT partition
  # cp /bsd /bsd.old &amp;&amp; cp bsd /bsd
  # chown root:wheel /bsd (if you compiled as someone else)
  (reboot)
</pre>
      </li>

      <li>
        <p>Compile the system.</p>
<pre>
  # cd /usr/src
  # make build
</pre>
      </li>

      <li>
        <p>Update <tt>/etc</tt> and <tt>/dev</tt> by hand. These
	  are not updated automatically. Choose a directory with
	  enough space to hold /, /dev, /var, and /etc. Here I'll use
	  <em>/home/newroot</em></p>
<pre>
  # mkdir /home/newroot          
  # export DESTDIR=/home/newroot
  # cd /usr/src/etc &amp;&amp; make distribution-etc-root-var
</pre>

        <p>Now compare the files in /home/newroot with their
	  installed counterparts. Replace or update the files as
	  necessary.</p>
<pre>
  # rm -rf /home/newroot   (when done)
</pre>
      </li>

      <li>
        <p>Reboot to make sure the new /etc files are correct</p>
      </li>
    </ol>

    <a name="1.6"></a> 
    <h3>1.6: My make build stopped halfway. Do I have to redo the
      whole thing?</h3>

    <p>I would, but if you really want to pick up where you left
      off, do a:</p>
<pre>
  # cd /usr/src
  # make -n build
</pre>

    <p>This will show you what make build is doing. For example,
      mine tells me:</p>
<pre>
  (cd /usr/src/share/mk &amp;&amp;  make install)
  (cd /usr/src/include; make prereq;  make includes)
  make cleandir
  (cd /usr/src/lib &amp;&amp; make depend &amp;&amp; make &amp;&amp;   make install)
  (cd /usr/src/gnu/lib &amp;&amp; make depend &amp;&amp; make &amp;&amp;   make install)
  (cd /usr/src/kerberosIV/lib &amp;&amp; make depend &amp;&amp; make &amp;&amp;   make install)
  (cd /usr/src/gnu/usr.bin/perl &amp;&amp;  make -f Makefile.bsd-wrapper config.sh &amp;&amp;  make -f Makefile.bsd-wrapper depend &amp;&amp;  make -f Makefile.bsd-wrapper perl.lib &amp;&amp;
  make -f Makefile.bsd-wrapper install.lib)
  make depend &amp;&amp; make &amp;&amp;  make install
</pre>

    <p>To pick up where you left off, just reissue the commands
      from the point where the compile died.</p>
    
    <p>If you do this procedure a lot, you may want to create a new
      target in your makefile. Simply copy the entry for
      <em>build</em> (to <em>build-noclean</em>, for example), and
      remove the <em>make cleandir</em> reference.</p>

    <a name="1.7"></a> 
    <h3>1.7: I'm getting errors during the build. What do I
      do?</h3>
    
    <p>If your <em>make build</em> ends with an error, chances are
      it is because you failed to delete your old objects before
      rebuilding. See <a href="#1.5">1.5</a> for details on cleaning
      out these objects.</p>

    <p>If you are sure your tree is clean of old object cruft, and
      you are still receiving a build error, one of three things has
      probably happened:</p>
    
    <ol>
      <li>You have encountered a known upgrade issue. Make sure you
	have read the appropriate section of this document, and
	followed the instructions there carefully.</li>
      
      <li>You have encountered a new upgrade issue. This is life on
	the bleeding edge. Search recent postings to 
	<a href="../mail.html">misc@ and tech@</a> for possible
	workarounds.</li>
      
      <li>Someone has temporarily broken the source tree. This type
	of break is pretty rare, and is usually fixed immediately.
	Try waiting a few hours, and re-fetching the source tree. If
	you can't wait, try fetching a tree from a day or two
	beforehand.</li>
    </ol>

    <p>If you have tried all of the alternatives above, and your
      problem persists for more than a couple of days, post your
      problem to misc@openbsd.org. Make sure to include the relevant
      error messages, and any peculiarities of your setup.</p>

    <a name="1.8"></a> 
    <h3>1.8: I'm upgrading to a newer version of the compiler
      (<em>gcc</em>). Is there a standard way of bootstrapping
      it?</h3>

    <p>OpenBSD now supports two compilers in-tree, gcc v2.95.3 used by
      most platforms, but also gcc v3.3.2 used by a few platforms which
      work better with it than with v2.95.3.

      The two compilers are in different parts of the tree:
       <ul>
       <li>gcc3: <tt>/usr/src/gnu/usr.bin/gcc</tt>
       <li>gcc2: <tt>/usr/src/gnu/egcs/gcc</tt>
       </ul>
      Some platforms will be switching to gcc3 in the future, but some
      are unlikely to ever switch, due to lack of gcc3 support.

    <p>Because upgrading a compiler is a bit of a chicken-and-egg
      problem, changes to the in-tree compiler require a little extra
      attention. In general, you'll want to perform the following
      procedure:</p>

    <p>(and yes, you are building it twice)</p>

<pre>
  <b>If your platform uses gcc 2.95.3:</b>
    # rm -r /usr/obj/gnu/egcs/gcc/*
    # cd /usr/src/gnu/egcs/gcc
        <i>- or -</i>
  <b>If your platform uses gcc 3.3.2:</b>
    # rm -r /usr/obj/gnu/usr.bin/gcc/*
    # cd /usr/src/gnu/usr.bin/gcc

  <b>Common build procedure for v3.3.2 or v2.95.3</b>
  # make -f Makefile.bsd-wrapper clean
  # make -f Makefile.bsd-wrapper obj
  # make -f Makefile.bsd-wrapper depend
  # make -f Makefile.bsd-wrapper 
  # make -f Makefile.bsd-wrapper install
  # make -f Makefile.bsd-wrapper clean
  # make -f Makefile.bsd-wrapper depend
  # make -f Makefile.bsd-wrapper 
  # make -f Makefile.bsd-wrapper install
</pre>

    <p>And then run a normal <em>make build</em>.</p>


    <a name="1.9"></a> 
    <h3>1.9: What is the best way to upgrade <tt>/etc</tt>,
      <tt>/var</tt>, and <tt>/dev</tt>?</h3>
    
    <p><strong>Short Answer</strong>: By Hand.</p>
    
    <p><strong>Long answer</strong>:</p>

    <p>As a policy, software in the OpenBSD tree does not modify
      files in <tt>/etc</tt> automatically. This means it is
      <em>always</em> up to the administrator to make the necessary
      modifications there. Upgrades are no exception. To update files
      in these directories, first determine what changes have
      occurred to the base (distribution) files, and then manually
      reapply these changes.</p>

    <p>For example, to see the files in the tree that have changed
      most recently, do a:</p>

<pre>
  # cd /usr/src/etc
  # ls -lt |more
</pre>

    <p>To see all the changes in <tt>/etc</tt> between arbitrary
      versions of OpenBSD, you can use 
      <a href="../anoncvs.html">CVS</a>. For example, to see the changes
      between 3.1 and 3.2, do a:</p>

<pre>
  # cd /usr/src/etc
  # cvs diff -u -rOPENBSD_3_1 -rOPENBSD_3_2
</pre>

    <p>Once you have identified the changes, reapply them to your
      local tree, preserving any local configuration you may have
      done.</p>

    <p>Typical <tt>/etc</tt> changes to watch out for between releases
      include:</p>
     
    <ul>
      <li>Additions to <tt>/etc/protocols</tt> and <tt>/etc/services</tt></li>
      <li>New sysctls. (see <tt>/etc/sysctl.conf</tt>)</li>
      <li>Changes to the default cron jobs. See <tt>/etc/daily</tt>, 
	<tt>/etc/weekly</tt>, <tt>/etc/monthly</tt>, and <tt>/etc/security</tt>
      </li>
      <li>All rc scripts, including netstart</li>
      <li>Device changes. See
	<a href="#1.12">1.12</a>
      </li>
      <li>File hierarchy changes in <tt>/etc/mtree</tt>. See 
	<a href="#1.13">1.13</a>
      </li>
      <li>
	New users (<tt>/etc/passwd</tt>)and groups (<tt>/etc/group</tt>)
      </li>
    </ul>


    <a name="1.10"></a> 
    <h3>1.10: How do I clean all the cruft out of my existing
      source tree?</h3>
    
    <p>The most important thing you can do is to clean out your obj
      directories. Here's a procedure to update source and kill any
      leftover objects:</p>

<pre>
  # cd /usr/src
  # cvs -q -d anoncvs@some.anon.server:/cvs up -Pd
  # find . -type l -name obj | xargs rm
  # make -k cleandir
  # rm -rf /usr/obj/*
  # make obj
</pre>

    <p>If you're still having trouble, you may want to try adding
      <tt>-I ! -I CVS -I obj</tt> to your CVS updates. This will
      identify any extra cruft in your source tree.</p>

    <a name="1.11"></a> 
    <h3>1.11: Do I have to be root to do a <em>make
	build</em>?</h3>

    <p>Though certain steps of the make build process require root
      privileges, the build process includes hooks to the 
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sudo&amp;sektion=8"
	 >sudo(8)</a> command that make this process relatively
      painless.</p>

    <p>If your <tt>/etc/sudoers</tt> file is configured correctly,
      you can use the sudo hooks in the following manner:</p>
    
    <ul>
      <li>Place SUDO=/usr/bin/sudo in your environment prior to
	starting the build, or</li>

      <li>Add the line "SUDO=/usr/bin/sudo" to your
	<tt>/etc/mk.conf</tt> file.</li>
    </ul>

    <a name="1.12"></a> 
    <h3>1.12: Why am I not seeing any new devices?</h3>
    
    <p>The <tt>/dev/MAKEDEV</tt> script is not updated
    automatically as part of the <em>make build</em> process. As a
      general rule, it is a good idea to copy and run this script
      from your source tree when performing an upgrade:</p>

<pre>
  # cd /dev
  # cp /usr/src/etc/etc.`machine`/MAKEDEV ./
  # ./MAKEDEV all
</pre>

    <a name="1.13"></a> 
    <h3>1.13: Is there an easy way to make all the file hierarchy
      changes?</h3>

    <p>From time to time, files or directories are added to, or
      removed from the file hierarchy. Also, ownership information
      for portions of the filesystem may change. An easy way to
      ensure that your file hierarchy is up-to-date is to use the 
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&amp;sektion=8">
	mtree(8)</a> utility.</p>
    
    <p>First, fetch the latest source, then do the following:</p>

<pre>
  # cd /usr/src/etc/mtree
  # install -c -o root -g wheel -m 600 special /etc/mtree
  # install -c -o root -g wheel -m 444 4.4BSD.dist /etc/mtree
  # mtree -qdef /etc/mtree/4.4BSD.dist -p / -u
</pre>

    <p>Your file hierarchy should now be up to date.</p>

    <a name="1.14"></a> 
    <h3>1.14: After an upgrade, <em>ps</em> now reports
      "proc size mismatch."</h3>

    <p>
      Your userland and kernel are out of sync. They must both be
      compiled from the same sources, as certain dependencies exist
      between them. Rebuild your kernel and userland from the same
      sources to correct the problem.
    </p>
    
    <p>
      Since you've already made one mistake, now is an ideal time to
      reread this document in its entirety, to catch any other things
      you may have missed.
    </p>


    <a name="1.15"></a>
    <h3>1.15: How can I upgrade to the latest snapshot?</h3>

    <p>
      Installing snapshot is a good way to keep up to date.
      We want you to test snapshots, especially at beta-time,
      to make sure the next release is of superior quality.
      And it is much less difficult than building the whole tree.
    </p>

    <p>
      The easiest way to get <em>-current</em> is to grab a boot image
      and prepare as described in the
      <a href="faq4.html">FAQ</a>. Once booted, you choose
      &quot;(U)pgrade&quot; and follow the instructions.
    </p>

    <p>
      There are several opportunities to start the upgrade program.
      Usually, the easiest methods are booting from floppy or CD-ROM
      or place a -current <a href="faq4.html#bsd.rd">bsd.rd</a> on your /
      and boot that instead of <tt>/bsd</tt>.
      Other options include booting over the network and booting from tape.
      Not all methods are available for all architectures, refer to the
      installation instructions for more information.
    </p>

    <p>
      While in-place upgrades sometimes work, this is not recommended.
      The only safe way to upgrade is booting from a new install/upgrade media
      as described above.
    </p>

    <p>
      In all cases, you must upgrade <a href="#1.9">/etc, /var and /dev</a>
      by hand.
    </p>

    <a name="3.5"></a>
    <h2>
      Upgrading from 3.5 to <i>-current</i>
    </h2>

    <a name="3.5.1"></a>
    <h3>
      3.5.1: pty device minor numbers changed (2004/04/11)
    </h3>
    <p>
      The device minor numbers of
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pty&amp;sektion=4">pty</a>
      devices have changed to increase the maximum number of pseudo-terminals
      from 256 to 992, so you will need to run the updated
      <tt>/dev/MAKEDEV</tt> before booting the new kernel:
        <ul>
          <li>Update your source code tree
          <li>Build and install a new kernel
          <li>Build the rest of the system (<em>make build</em>)
          <li>Copy the new MAKEDEV script to the <tt>/dev</tt> directory and 
              create the new pty devices.
<pre>
     # cp /usr/src/etc/etc.`machine`/MAKEDEV /dev
     # cd /dev && ./MAKEDEV pty0
</pre>
          <li>Boot the new kernel
	  <li>Remove the old pty devices no longer in use:
<pre>
     # cd /dev && rm -f [pt]ty[rq]*
</pre>
	  <li> Or, for the vax platform:
<pre>
     # cd /dev && rm -f [pt]tyr*
</pre>
        </ul>

    <a name="3.5.2"></a>
    <h3>
      3.5.2: New user and group _dhcp (2004/04/12)
    </h3>
    <p>The various dhcp related daemons are being reworked to drop privileges
      or to use privilege separation. Thus a new user and group _dhcp are
      required.
      Add the group by running
<pre>
  # groupadd -g 77 _dhcp
</pre>
      as root, and add the user entry using
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _dhcp:*:77:77::0:0:dhcp programs:/var/empty:/sbin/nologin
</pre>
    <p>

    <a name="3.5.3"></a>
    <h3>
      3.5.3: New user and group _mopd (2004/04/14)
    </h3>
    <p>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mopd&amp;sektion=8"
      >mopd(8)</a> daemon now drops privileges after initialization,
      and requires a new user and group _mopd.
      Add the group by running
<pre>
  # groupadd -g 78 _mopd
</pre>
      as root, and add the user entry using
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _mopd:*:78:78::0:0:MOP Daemon:/var/empty:/sbin/nologin
</pre>
    <p>

    <a name="3.5.4"></a>
    <h3>
      3.5.4: New user and group _tftpd (2004/04/17)
    </h3>
    <p>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tftpd&amp;sektion=8"
      >tftpd(8)</a> daemon now drops privileges after initialization to
      a new user and group _tftpd instead of nobody.
      Add the group by running
<pre>
  # groupadd -g 79 _tftpd
</pre>
      as root, and add the user entry using
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _tftpd:*:79:79::0:0:TFTP Daemon:/var/empty:/sbin/nologin
</pre>
    <p>

    <a name="3.4"></a>
    <h2>
      Upgrading from 3.4 to 3.5
    </h2>

    <a name="3.4.1"></a>
    <h3>
      3.4.1: svnd device minor numbers changed (2003/10/10)
    </h3>
    <p>
      The device minor numbers of 
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=svnd&amp;sektion=4">svnd</a>
      devices have changed, so you will need to run the updated
      <tt>/dev/MAKEDEV</tt> after installing the new kernel:
        <ul>
          <li>update your source code tree
          <li>Build a new kernel
          <li>copy the new MAKEDEV script to the dev directory, remove
              the existing svnd(4) and rsvnd devices, and create new ones:
<pre>
     # cp /usr/src/etc/etc.`machine`/MAKEDEV /dev
     # cd /dev
     # rm svnd* rsvnd*
     # ./MAKEDEV vnd
</pre>
          <li>Continue with build and release process
        </ul>

      This affects anyone using svnd devices, which includes those who
      <tt>make release</tt>.
    <p>

    <a name="3.4.2"></a>
    <h3>
      3.4.2: New user and group _pflogd (2003/10/23)
    </h3>
    <p>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pflogd&amp;sektion=8"
      >pflogd(8)</a> daemon now runs in privilege separated mode, and requires a new
      user and group _pflogd.
      Add the group by running
<pre>
  # groupadd -g 74 _pflogd
</pre>
      as root, and add the user entry using
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _pflogd:*:74:74::0:0:pflogd privsep:/var/empty:/sbin/nologin
</pre>
    <p>

    <a name="3.4.3"></a>
    <h3>
      3.4.3: Interface cloning (2003/12/07)
    </h3>
    <p>Several pseudo network drivers (like
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gif&amp;sektion=4">gif(4)</a>,
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=lo&amp;sektion=4">lo(4)</a>, and
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tun&amp;sektion=4">tun(4)</a>)
      have been moved to support cloning, i.e. creation and destruction of
      devices on the fly. If you depend on these interfaces, you have to
      install an updated
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8">ifconfig(8)</a>
      and
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=netstart&amp;sektion=8">netstart(8)</a>
      before rebooting your new kernel.

    <p>First build and install your new kernel as usual, then
      <pre>
  # cd /usr/src && make includes
  # cd sbin/ifconfig
  # make obj depend
  # make
  # make install
  # cp /usr/src/etc/netstart /etc
      </pre>
      Now reboot your machine and proceed with building a new userland.
    <p>

    <a name="3.4.4"></a>
    <h3>
       3.4.4: New user and group _bgpd (2003/12/17)
    </h3>
    <p>The new <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bgpd&amp;sektion=8"
      >bgpd(8)</a> daemon runs in privilege separated mode, and requires a new
      user and group _bgpd.
      Add the group by running
<pre>
  # groupadd -g 75 _bgpd
</pre>
      as root, and add the user entry using
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _bgpd:*:75:75::0:0:BGP Daemon:/var/empty:/sbin/nologin
</pre>
    <p>

    <a name="3.4.5"></a>
    <h3>
	3.4.5: New version of join(1) (2003/12/28)
    </h3>
    <p>The
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=join&amp;sektion=1">join(1)</a>
    command has been updated to follow the POSIX standard when writing
    non-matching lines.
    As a consequence
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=security&amp;sektion=8">security(8)</a>
    has to be updated:
     <pre>
  # cp /usr/src/etc/security /etc
     </pre>
    <p>

    <a name="3.4.6"></a>
    <h3>
	3.4.6: sudo build change (2004/01/15)
    </h3>
    <p>The way the
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sudo&amp;sektion=8">sudo(8)</a>
    command is built has changed.  A side-effect of this is that you will
    need to run:
     <pre>
  # rm -f /usr/obj/usr.bin/sudo/*
     </pre>
    before you can successfully do a "make build".  If this is not done,
    the build will abort when attempting to make obj dirs.
    <p>

    <a name="3.4.7"></a>
    <h3>
      3.4.7: New user and group _tcpdump (2004/01/19)
    </h3>
    <p>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tcpdump&amp;sektion=8"
      >tcpdump(8)</a> command now runs in privilege separated mode, and requires a new
      user and group _tcpdump.
      Add the group by running
<pre>
  # groupadd -g 76 _tcpdump
</pre>
      as root, and add the user entry using
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _tcpdump:*:76:76::0:0:tcpdump:/var/empty:/sbin/nologin
</pre>

    <p>
    <a name="3.4.8"></a>
    <h3>
      3.4.8: machdep.c change (i386) (2004/02/01)
    </h3>

    <p>
    A change to <tt>machdep.c</tt> requires that binutils be rebuilt
    before the kernel can be compiled.
    This only affects i386.

<pre>
  # cd /usr/src/gnu/usr.bin/binutils
  # make -f Makefile.bsd-wrapper cleandir
  # make -f Makefile.bsd-wrapper obj
  # make -f Makefile.bsd-wrapper depend
  # make -f Makefile.bsd-wrapper
  # make -f Makefile.bsd-wrapper install
</pre>

    <p> Now you can rebuild the kernel and rest of the system according
    to section <a href="#1.5">1.5</a>

    <p>
    <a name="3.4.9"></a>
    <h3>
      3.4.9:  Switch to gcc3 (sparc64) (2004/02/20)
    </h3>

    <p>
    OpenBSD/sparc64 has converted to gcc3.
    To upgrade,

<pre>
    # cd /usr/src/share/mk
    # make install
    # rm -rf /usr/include/g++
</pre>
    Now, <a href="#1.8">build gcc3</a>, (using the gcc3 directory) then
    build the kernel and system as <a href="#1.5">usual</a>.


    <a name="3.3"></a>
    <h2>
      Upgrading from 3.3 to 3.4
    </h2>
    
    <a name="3.3.1"></a>
    <h3>
      3.3.1: i386 W^X support (2003/04/16)
    </h3>

    <p>To enable i386 Writable xor eXecute support, OpenBSD/i386 has
      changed from a.out executable format to ELF. The flexibility of 
      ELF allows better control over the executable layout which
      allows for W^X support. a.out compatibility is only available in a
      limited form. Static a.out binaries will work as before, dynamic
      a.out binaries ARE NOT SUPPORTED.
    </p>
    <p>SOURCE UPGRADES FROM a.out -&gt; ELF WILL NOT BE SUPPORTED.
      INSTALL A SNAPSHOT and then you can rebuild from source.
      This is i386-only, other architectures are NOT affected by this change.
    </p>

    <a name="3.3.2"></a>
    <h3>
      3.3.2: mquery syscall change (2003/04/28)
    </h3>

    <p>The parameters to the mquery systemcall were changed to match mmap().
      This requires the system to be upgraded in the correct order:

      <pre>
      1. Build and boot new kernel.
      2. (cd /usr/src && sudo make includes)
      3. (cd /usr/src/libexec/ld.so && make && sudo make install)
      4. 'make build'
      </pre>

      Only i386 uses mquery, so other architectures do not need to
      follow this strict build order.

    <a name="3.3.3"></a>
    <h3>
      3.3.3: i386 flag day, exe addr/MAXDSIZ change (2003/05/05)
    </h3>

    <p>To allow MAXDSIZ to be changed back to 1G, the base
      address of all executables changes from 0 to 0x1c000000. The
      combination of these changes requires updating from snapshot.
      Updating from source is not supported.  This only affects i386.
    </p>
    
    <a name="3.3.4"></a>
    <h3>
      3.3.4: Removal of KerberosIV authentication (2003/05/13)
    </h3>

    <p>KerberosIV-based authentication has been removed. As a result, 
       you will need to remove all references to <tt>krb4</tt> in
       <tt>/etc/login.conf</tt>. 
    </p>

    <a name="3.3.5"></a>
    <h3>
      3.3.5: <tt>config</tt> change (2003/05/23)
    </h3>

    <p>Moving swapgeneric.c required a change to 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>.
      Before building a new kernel, you must first build and install
      the updated config(8):
<pre>
  # cd /usr/src/usr.sbin/config
  # make clean
  # make obj
  # make
  # make install
</pre>
      Now, <tt>config</tt> your kernel configuration and run 
      "<tt>make depend</tt>" in your kernel compile directory as detailed
      <a href="#1.5">above</a>. 

   <a name="3.3.6"></a>
   <h3>
    3.3.6: Use __attribute__((bounded)) on certain functions (2003/06/26)
   </h3>
      
   <p>
     __attribute__((bounded)) is now used to detect incorrect arguments
     for functions which take buffer lengths as one of their parameters.
     <br><br>You will need to rebuild gcc according to section
     <a href="#1.8">1.8</a>
     of the Mini-FAQ before proceeding with <tt>make build</tt>.
   </p>

    <a name="3.3.7"></a>
    <h3>
      3.3.7: New user and group _syslogd (2003/07/31)
    </h3>
    <p>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=syslogd&amp;sektion=8"
      >syslogd(8)</a> daemon now runs in privilege separated mode, and requires a new
      user and group _syslogd.
      Add the group by running
<pre>
  # groupadd -g 73 _syslogd
</pre>
      as root, and add the user entry using
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _syslogd:*:73:73::0:0:Syslog Daemon:/var/empty:/sbin/nologin
</pre>
    <p>

    <a name="3.3.8"></a>
    <h3>
      3.3.8: Use format attribute __kprintf__ in kernel headers (2003/08/23)
    </h3>
    <p>
      A new format attribute __kprintf__ is now used in kernel header files to 
      make gcc aware of the format extensions in the kernel
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=printf&amp;sektion=9">printf(9)</a>.
      <br><br>You will need to rebuild gcc according to section <a href="#1.8">1.8</a>
     of the Mini-FAQ before proceeding with <tt>make build</tt>. You only need to rebuild
     gcc once from current sources to also support the __bounded__ attribute described
     in section <a href="#3.3.5">3.3.5</a>.
    </p>

    <a name="3.2"></a>
    <h2>
      Upgrading from 3.2 to 3.3
    </h2>

    <a name="3.2.1"></a>
    <h3>
      3.2.1: New Perl (2002/11/05)
    </h3>

    <p>Perl has been updated to version 5.8.0.<br>
      In Perl 5.8.0, the XS module API has changed due to a switch
      from stdio to PerlIO (see the perldelta manual page for more information).
      This means that any XS modules (perl .so files) you have installed
      <strong>must</strong> be rebuilt.  If you encounter an error such as
      <em>Undefined symbol "perl_get_sv"</em> this is your problem.  If the
      only modules you have installed were installed as packages or via the
      ports system, you can check your system for XS modules by running:
      <pre>
	# grep '\.so' /var/db/pkg/p5-*/+CONTENTS | cut -d: -f1 | sort -u
      </pre>
      You can then remove the offending modules with <em>pkg_delete -f</em>
      and rebuild/install them from the ports tree.

    <a name="3.2.2"></a>
    <h3>
      3.2.2: New groups _radius, _token and _shadow (2002/11/21)
    </h3>
    <p>Several new groups have been added:
      <ul>
      <li>The <em>_radius</em> group controls read-only access to
	  <tt>/etc/raddb/servers</tt> file.
      <li>The <em>_token</em> group controls read-only access to the
	  token databases used by 
	  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tokeninit&amp;sektion=8">tokeninit(8)</a>,
	  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tokenadm&amp;sektion=8">tokenadm(8)</a>, and
	  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login_token&amp;sektion=8">login_token(8)</a>.
      <li>The <em>_shadow</em> group controls read-only access to
	  the shadow password database.
      </ul>

      You will need to add these groups and adjust the permissions on
      some files before running a &quot;make build&quot;.  The following
      commands, run as root, will do this:
	<pre>
	  # groupadd -g 63 _radius
	  # chgrp _radius /etc/raddb /etc/raddb/servers
	  # chmod g+x /etc/raddb
	  # chmod g+r /etc/raddb/servers

	  # groupadd -g 64 _token
	  # chgrp _token /etc/activ.db /etc/crypto.db /etc/snk.db
	  # chmod 0640 /etc/activ.db /etc/crypto.db /etc/snk.db

	  # groupadd -g 65 _shadow
	  # chgrp _shadow /etc/spwd.db
	  # chmod 0640 /etc/spwd.db
	</pre>

      Don't worry about error messages indicating that a file was not found.
      That just means you haven't setup <em>token</em> or <em>radius</em> authentication.

    <a name="3.2.3"></a>
    <h3>
      3.2.3: Important compiler changes (2002/12/02)
    </h3>
    <p>The <a href="http://www.trl.ibm.com/projects/security/ssp">propolice</a>
      stack protection extension has been merged into
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gcc-local&amp;sektion=1"
      >gcc</a>. This requires a slightly different upgrade scenario:
      <ul>
      <li>Do <b>not</b> build a new kernel yet.
      <li>Do <b>not</b> rebuild gcc yet.
      <li>Build and install a new ld.so dynamic loader if your system has
        shared libraries.
        <pre>
	  # cd /usr/src
	  # make obj
          For ELF platforms (alpha, macppc, sparc, sparc64):
          # cd /usr/src/libexec/ld.so
          # make depend &amp;&amp; make &amp;&amp; make install
	  For a.out platforms (amiga, hp300, i386, mac68k, mvme68k):
          # cd /usr/src/gnu/usr.bin/ld/rtld
          # make depend &amp;&amp; make &amp;&amp; make install
	</pre>
      <li>Rebuild and install a new libc, following the first few commands
        from <i>make build</i>.
	<pre>
          # cd /usr/src/include
	  # make prereq &amp;&amp; make includes
	  # cd /usr/src/lib/libc
	  # make depend &amp;&amp; make NOMAN=1 &amp;&amp; make NOMAN=1 install
	</pre>
	Note that, if your compiler is too old, it will not be able to build
	libc. In this case, you'll have to do a binary upgrade from a snapshot.
      <li>Rebuild and install gcc, as told in section <a href="#1.8">1.8</a>.
      <li>You can now recompile a kernel.
        Be sure to run
        <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8"
	>config</a> again to regenerate the kernel Makefile.
      <li>Reboot on the new kernel, and run a <i>make build</i> to
        benefit from the stack protection.
      </ul>

    <a name="3.2.4"></a>
    <h3>
      3.2.4: New user and group _spamd (2002/12/24)
    </h3>
    <p>A new user and a new group _spamd for the
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=spamd&amp;sektion=8"
      >spamd(8)</a> daemon have been added.
      Add the group by running
<pre>
  # groupadd -g 62 _spamd
</pre>
      as root, and add the user entry using
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _spamd:*:62:62::0:0:Spam daemon:/var/empty:/sbin/nologin
</pre>

    <a name="3.2.5"></a>
    <h3>
      3.2.5: Alias for ipv6-icmp (2002/12/30)
    </h3>

    <p>A new alias for ipv6-icmp, <em>icmp6</em> , has been added to
      <tt>/etc/protocols</tt>.  If you wish to use the <em>icmp6</em> alias
      (used in the
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8">pfctl(8)</a>
      regression tests) you must modify the <em>ipv6-icmp</em> line in
      <tt>/etc/protocols</tt>, adding the <em>icmp6</em> keyword before the #.
      The line should read as follows:
    </p>
<pre>
  ipv6-icmp 58    IPv6-ICMP icmp6 # ICMP for IPv6
</pre>

    <a name="3.2.6"></a>
    <h3>
      3.2.6: New group _lkm (2003/01/05)
    </h3>

    <p>The <em>_lkm</em> group controls access to
	  <tt>/dev/lkm</tt>.
	  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=modstat&amp;sektion=8">modstat(8)</a>
          is now setgid _lkm.
    <p>
      You will need to add this group and adjust the permissions on
      <tt>/dev/lkm</tt> before running a &quot;make build&quot;.  The following
      commands, run as root, will do this:
<pre>
  # groupadd -g 61 _lkm
  # chgrp _lkm /dev/lkm
</pre>

    <a name="3.2.7"></a>
    <h3>
      3.2.7: New libpthread (2003/01/14)
    </h3>

    <p><em>libc_r</em> and <em>libnpthread</em> have been removed and
    replaced by <em>libpthread</em>.  Threaded programs should still
    be compiled using the <em>-pthread</em> option; the compiler does
    the right thing.

    <p>Before removing <em>libc_r</em> and <em>libnpthread</em> threaded
    applications must be re-compiled using <em>libpthread</em>.  The
    recommended build sequence is:

    <ol>
      <li>
        <p>build gcc according to section <a href="#1.8">1.8</a>.
      <li>
        <p>re-build the system according to section <a href="#1.5">1.5</a>.
      <li>
        <p>re-build all threaded ports.
      <li>
        <p>remove the now unused libraries:
<pre>
  # rm /usr/lib/libc_r* /usr/lib/libnpthread*
</pre>
    </ol>

    <a name="3.2.8"></a>
    <h3>
      3.2.8: Linker changes for ELF architectures (2003/01/17)
    </h3>

    <p>Binutils/ld have been changed to introduce a new security feature to ELF
    executables. Instead of allowing the data section of executables and
    shared libraries to be marked executable by the linker, the layout has
    been changed to only mark the appropriate sections of the program image
    as executable. This change only affects ELF based architectures: alpha,
    sparc, sparc64, macppc.
    <p>
    It is recommended that binutils be rebuilt before the rest of the system.
    <p>
<pre>
  # cd /usr/src/gnu/usr.bin/binutils
  # make -f Makefile.bsd-wrapper cleandir
  # make -f Makefile.bsd-wrapper obj
  # make -f Makefile.bsd-wrapper depend
  # make -f Makefile.bsd-wrapper
  # make -f Makefile.bsd-wrapper install
</pre>
    <p>
    Then re-build the system according to section <a href="#1.5">1.5</a>

    <a name="3.2.9"></a>
    <h3>
      3.2.9: Removal of /var/at and crontab changes (2003/02/19)
    </h3>

    <p>The contents of <tt>/var/at</tt> have been merged into <tt>/var/cron</tt>
    now that <em>at</em> has been integrated into <em>cron</em>.  Furthermore,
    the <em>cron</em> allow and deny files have been renamed cron.allow and
    cron.deny for POSIX compliance and consistency with at.allow and at.deny.
    <p>
    First re-build the system according to section <a href="#1.5">1.5</a>
    Then move the existing files and restart cron as follows:
    <p>
<pre>
  # mv /var/at/* /var/cron
  # mv /var/cron/jobs /var/cron/atjobs
  # mv /var/cron/allow /var/cron/cron.allow
  # mv /var/cron/deny /var/cron/cron.deny
  # rm -rf /var/at 
  # kill `cat /var/run/cron.pid`
  # /usr/sbin/cron
</pre>
    <p>
    Disregard any warnings about missing allow or deny files.
    Not all of them are part of the default installation.
    <p>
    If you do not already have a cron.deny file (it was not installed
    prior to OpenBSD 3.3) you will need one to run <em>crontab</em> as
    a user other than the superuser.
<pre>
  # install -c -o root -g crontab -m 660 /dev/null /var/cron/cron.deny
</pre>

    <hr>

    <address>
      <p>
	<small>$OpenBSD: upgrade-minifaq.html,v 1.203 2004/04/29 03:28:47 nick Exp $</small><br>
	Copyright &copy; 1998-2004, Kjell Wooding.<br>
	Please send any comments, questions, or suggestions to <a
          href="mailto:kjell@openbsd.org">kjell@openbsd.org</a></p>
    </address>
  </body>
</html>


<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>10 - Systeembeheer</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 1998-2006 by OpenBSD.">
</head>

<body bgcolor= "#ffffff" text= "#000000">

<a href="../../nl/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif" border="0">    
</a>
<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
<a href= "faq9.html">[Naar Sectie 9 - Migreren naar OpenBSD]</a>
<!-- a href= "faq11.html">[Naar Sectie 11 - Prestatie Tuning]</a -->
<a href="faq12.html">[Naar Sectie 12 - Platform-specifieke Vragen]</a>
</font>

<h1><font color="#e00000">10 - Systeembeheer</font></h1>
<hr>

<p>
<h3>Inhoudsopgave</h3>
<ul>
<li><a href="#wheel"         >10.1 - Wanneer ik su naar root probeer, zegt hij dat ik in de verkeerde groep zit.</a>
<li><a href="#DupFS"         >10.2 - Hoe dupliceer ik een bestandssysteem?</a>
<li><a href="#rc"            >10.3 - Hoe start ik daemons op met het systeem? (Overzicht van rc(8))</a>
<li><a href="#RelayingDenied">10.4 - Waarom krijgen gebruikers relaying access denied wanneer ze van ergens anders mail versturen via mijn OpenBSD systeem?</a>
<li><a href="#POP"           >10.5 - Ik heb POP ingesteld, maar ik krijg fouten wanneer ik mijn mail opvraag via POP. Wat kan ik doen?</a>
<li><a href="#SendmailDNS"   >10.6 - Waarom negeert Sendmail /etc/hosts?</a>
<li><a href="#HTTPS"         >10.7 - Een Secure HTTP Server opzetten met ssl(8)</a>
<li><a href="#vipw"          >10.8 - Ik bracht met een editor wijzigingen aan in /etc/passwd, maar de wijzigingen lijken niet plaatsgevonden te hebben. Waarom?</a>
<li><a href="#AddDelUser"    >10.9 - Hoe voeg ik een gebruiker toe? Of verwijder ik een gebruiker?</a>
<li><a href="#FTPOnly"       >10.10 - Hoe maak ik een ftp-only account aan?</a>
<li><a href="#Quotas"        >10.11 - Schijfquota's voor gebruikers instellen</a>
<li><a href="#Kerberos"      >10.12 - KerberosV Clients en Servers instellen</a>
<li><a href="#AnonFTP"       >10.13 - Een Anonymous FTP Server opzetten</a>
<li><a href="#ftpchroot"     >10.14 - Gebruikers vastzetten in hun home directories in ftpd(8)</a>
<li><a href="#Patches"       >10.15 - Patches in OpenBSD aanbrengen</a>
<li><a href="#httpdchroot"   >10.16 - Vertel me eens over chroot() Apache?</a>
<li><a href="#rootshell"     >10.17 - Kan ik de root shell wijzigen?</a>
<li><a href="#ksh"           >10.18 - Wat kan ik nog doen met ksh?</a>
</ul>

<hr>

<p>
<a name= "wheel"></a>
<h2>10.1 - Waarom zegt hij dat ik in de verkeerde groep zit wanneer ik door su root probeer te worden?</h2>

<p>
Bestaande gebruikers moeten met de hand toegevoegd worden aan de
<kbd>&quot;wheel&quot;</kbd> groep.
Dit wordt gedaan om veiligheidsredenen, en u kan beter voorzichtig zijn met
aan wie u toegang geeft. Op OpenBSD is het gebruikers die in de 
<kbd>wheel</kbd> groep zitten, toegelaten om het
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=su&amp;sektion=1">su(1)</a>
userland programma te gebruiken om root te worden. Gebruikers die niet in
<kbd>&quot;wheel&quot;</kbd> zitten, kunnen su(1) niet gebruiken.
Hier is een voorbeeld van een <kbd>/etc/group</kbd> entry om de gebruiker
<b>ericj</b> in de <kbd>&quot;wheel&quot;</kbd> groep te plaatsen.

<p>
Als u een gebruiker aan het toevoegen bent met
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&amp;sektion=8">adduser(8)</a>,
kan u ze in de wheel groep zetten door wheel te antwoorden op de vraag
"<tt>Invite <i>user</i> into other groups:</tt>". Dit zal hen toevoegen aan
/etc/group, dat er ongeveer als volgt zal uitzien:

<blockquote><pre>
wheel:*:0:root,ericj
</pre></blockquote>

<p>
Als u een manier zoekt om gebruikers beperkte toegang tot superuser
privileges te geven zonder hen in de <kbd>&quot;wheel&quot;</kbd> groep te
zetten, gebruik dan
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sudo&amp;sektion=8">sudo(8)</a>.

<p>
<a name= "DupFS"></a>
<h2>10.2 - Hoe dupliceer ik een bestandssysteem?</h2>

<p>
Om uw bestandssysteem te dupliceren, gebruikt u
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dump&amp;sektion=8">dump(8)</a> en
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=restore&amp;sektion=8">restore(8)</a>.
Om bijvoorbeeld alles onder directory <kbd>SRC</kbd> naar
directory <kbd>DST</kbd> te dupliceren, doet u:

<blockquote><pre>
# <b>cd /SRC; dump 0f - . | (cd /DST; restore -rf - )</b>
</pre></blockquote>

<p>
dump is ontworpen om u een waaier aan backup mogelijkheden te geven, en het kan
overkill zijn als u gewoon een onderdeel van (of een volledig) bestanddsysteem
wil dupliceren. Het commando
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tar&amp;sektion=1">tar(1)</a>
kan voor deze handeling sneller zijn. Het formaat ziet er heel gelijkaardig
uit:

<blockquote><pre>
# <b>cd /SRC; tar cf -  . | (cd /DST; tar xpf - )</b>
</pre></blockquote>

<p>
<a name= "rc"></a>
<h2>10.3 - Hoe start ik daemons op met het systeem? (Overzicht van rc(8))</h2>

<p>
OpenBSD gebruikt een
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc&amp;sektion=8">rc(8)</a>
stijl startup. Deze gebruikt een aantal sleutelbestanden om op te starten.

<ul>
  <li>/etc/rc - Hoofdscript. Wordt best niet gewijzigd.
  <li>/etc/rc.conf - Configuratiebestand gebruikt door <i>/etc/rc</i> om te
  weten welke daemons moeten starten met het systeem.
  <li>/etc/rc.conf.local - Configuratiebestand dat u kan gebruiken om
  instellingen in /etc/rc.conf te overschrijven zodat u /etc/rc.conf zelf niet
  hoeft aan te raken, wat handig is bij het upgraden van uw systeem.
  <li>/etc/netstart - Script gebruikt om het netwerk te initialiseren. Wordt
  best niet gewijzigd.
  <li>/etc/rc.local - Script gebruikt voor lokale administratie. Dit is waar
  nieuwe daemons of host-specifieke informatie bewaard zou moeten worden.
  <li>/etc/rc.securelevel - Script dat commando's uitvoert die moeten
  uitgevoerd worden voordat het security level verandert. Zie
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=init&amp;sektion=8">init(8)</a>
  <li>/etc/rc.shutdown - Script uitgevoerd bij het afsluiten. Zet in dit
  bestand gelijk wat u wil dat er gedaan wordt vóór het
  afsluiten. Zie
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.shutdown&amp;sektion=8">rc.shutdown(8)</a>
</ul>

<h3>Hoe werkt rc(8)?</h3>

<p>
De hoofdbestanden waarop een systeembeheerder zich zou moeten concentreren,
zijn <i>/etc/rc.conf</i> (of <i>/etc/rc.conf.local</i>), <i>/etc/rc.local</i>
en <i>/etc/rc.shutdown</i>. Om een zicht te krijgen op hoe de rc(8) procedure
werkt, volgt hier het schema:

<p>
Nadat de kernel geboot is, wordt <i>/etc/rc</i> gestart:
<ul>
  <li>Bestandssystemen worden gecontroleerd.
  <li>Configuratievariabelen worden ingelezen vanuit <i>/etc/rc.conf</i> en,
      nadien, <i>/etc/rc.conf.local</i>. Instellingen in rc.conf.local
      zullen die in rc.conf overschrijven.
  <li>Bestandssystemen worden gemount
  <li>Veegt <i>/tmp</i> leeg en behoudt gelijk welke editor bestanden
  <li>Configureert het netwerk via <i>/etc/netstart</i>
  <ul>
    <li>Configureert uw interfaces als "up".
    <li>Stelt uw hostname, domeinnaam, enz. in
  </ul>
  <li>Start de systeemdaemons op
  <li>Voert verscheidene andere controles uit (quota's, savecore, enz.)
  <li>Lokale daemons worden opgestart, via <i>/etc/rc.local</i>
</ul>

<h3>Daemons en Services Starten die bij OpenBSD zitten</h3>

<p>
De meeste daemons en services die standaard bij OpenBSD zitten, kunnen bij
het booten gestart worden door eenvoudigweg het <i>/etc/rc.conf</i>
configuratiebestand te bewerken.
Neem om te beginnen een kijkje naar het standaard
<a href="http://www.openbsd.org/cgi-bin/cvsweb/src/etc/rc.conf">/etc/rc.conf</a>
bestand. U zal lijnen zien gelijkaardig aan deze:

<blockquote><pre>
ftpd_flags=NO           # for non-inetd use: ftpd_flags="-D"
</pre></blockquote>

<p>
Een lijn als deze toont dat ftpd niet samen met het systeem moet opstarten
(tenminste niet via rc(8), lees de
<a href="faq10.html#AnonFTP">Anonymous FTP FAQ</a> om hierover meer te lezen).
In elk geval heeft elke lijn een stukje commentaar dat u de vlaggen toont voor
<b>NORMAAL</b> gebruik van die daemon of service. Dit betekent niet dat u die
daemon of service met die vlaggen moet draaien.
Lees de relevante manual pagina om te zien hoe u die daemon of service kan
laten opstarten op gelijk welke manier die u graag hebt. Hier is bijvoorbeeld
de standaard lijn die hoort bij httpd(8).

<blockquote><pre>
httpd_flags=NO          # for normal use: "" (or "-DSSL" after reading ssl(8))
</pre></blockquote>

<p>
Hier kan u duidelijk zien dat bij het normaal opstarten van httpd geen vlaggen
nodig zijn. Dus een lijn als: &quot;<b> httpd_flags=""</b>&quot; zou nodig
zijn. Maar om httpd op te starten met ssl ingeschakeld (raadpleeg de
<a href="#HTTPS">SSL FAQ</a> of <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssl&amp;sektion=8">ssl(8)</a>)
zou u moeten beginnen met een lijn als: &quot;httpd_flags="-DSSL"&quot;.

<p>
Een goede aanpak is om nooit <i>/etc/rc.conf</i> zelf aan te raken. Maak in
plaats daarvan het bestand <i>/etc/rc.conf.local</i> aan, kopieer gewoon de
lijnen die u gaat veranderen vanuit <i>/etc/rc.conf</i> en pas ze aan zoals u
wenst.
Dit maakt toekomstige upgrades makkelijker -- alle veranderingen zitten
in één bestand.

<h3>Lokale daemons opstarten en configuratie</h3>

<p>
Voor andere daemons die u misschien op het systeem zou installeren via
packages of andere manieren, gebruikt u best het <i>/etc/rc.local</i> bestand.
Ik heb bijvoorbeeld een daemon geïnstalleerd op
/usr/local/sbin/daemonx. Ik wil hem opstarten bij het booten. Ik zou een
entry als deze in <i>/etc/rc.local</i> zetten:

<blockquote><pre>
if [ -x /usr/local/sbin/daemonx ]; then
             echo -n ' daemonx';       /usr/local/sbin/daemonx
fi
</pre></blockquote>

<p>
(Als de daemon zich niet automatisch losmaakt bij het opstarten, onthou dan
om een "&amp;" toe te voegen aan het uiteinde van de commandoregel.)

<p>
Van nu af zal deze daemon gestart worden bij het booten. U zal fouten
kunnen zien bij het booten, een normale boot zonder errors zou een lijn als
deze vertonen:

<blockquote><pre>
Starting local daemons: daemonx.
</pre></blockquote>

<h3>rc.shutdown</h3>

<p>
<i>/etc/rc.shutdown</i> is een script dat uitgevoerd wordt bij het afsluiten.
Al wat u wil dat er gedaan wordt alvorens het systeem afsluit, moet aan dit
bestand toegevoegd worden. Als u apm hebt, kan u ook &quot;powerdown=YES&quot;
instellen, wat u het equivalent van &quot;shutdown -p&quot; zal geven.

<p>
<a name= "RelayingDenied"></a>
<h2>10.4 - Waarom krijgen gebruikers "relaying denied" wanneer ze van ergens
anders mail versturen via mijn OpenBSD systeem?</h2>

<p>
Probeer dit:

<blockquote><pre>
# <b>grep relay-domains /etc/mail/sendmail.cf</b>
</pre></blockquote>

<p>
De uitvoer kan er ongeveer zo uitzien:

<blockquote><pre>
FR-o /etc/mail/relay-domains
</pre></blockquote>

<p>
Als dit bestand niet bestaat, maak het dan aan. U zal de hosts moeten
invoeren die vanop afstand mail versturen, met de volgende syntaxis:

<blockquote><pre>
.domain.com    #Allow relaying for/to any host in domain.com
sub.domain.com #Allow relaying for/to sub.domain.com and any host in that domain
10.2           #Allow relaying from all hosts in the IP net 10.2.*.*
</pre></blockquote>

<p>
Vergeet niet om een 'HangUP' signaal te sturen naar sendmail, (een signaal
dat de meeste daemons hun configuratiebestand opnieuw laat inlezen):

<blockquote><pre>
# <b>kill -HUP `head -1 /var/run/sendmail.pid`</b>
</pre></blockquote>

<p>

<h3>Verdere Leesvoer</h3>

<p>
<ul>
<li><a href="http://www.sendmail.org/~ca/email/relayingdenied.html">http://www.sendmail.org/~ca/email/relayingdenied.html</a>
<li><a href="http://www.sendmail.org/tips/relaying.html">http://www.sendmail.org/tips/relaying.html</a>
<li><a href="http://www.sendmail.org/antispam.html">http://www.sendmail.org/antispam.html</a>
</ul>

<p>
<a name= "POP"></a>
<h2>10.5 - Ik heb POP ingesteld, maar gebruikers hebben problemen met mail opvragen via POP. Wat kan ik doen?</h2>

<p>
De meeste problemen die te maken hebben met POP, zijn problemen met
tijdelijke bestanden en lock-bestanden. Als uw pop server een foutboodschap
als deze stuurt:

<blockquote><pre>
-ERR Couldn't open temporary file, do you own it?
</pre></blockquote>

<p>
Probeer dan uw permissies als volgt in te stellen:

<blockquote><pre>
permissie in  /var
drwxrwxr-x   2 bin     mail     512 May 26 20:08 mail


permissies in  /var/mail
-rw-------   1 username   username        0 May 26 20:08 username
</pre></blockquote>

<p>
Iets anders om na te gaan is dat de gebruiker werkelijk zijn/haar eigen
/var/mail bestand bezit. Natuurlijk zou dit het geval moeten zijn
(zoals /var/mail/joe bezit van joe zou moeten zijn) maar als dit niet
correct is ingesteld, zou dat het probleem kunnen zijn!

<p>
Natuurlijk, /var/mail schrijfbaar maken voor de groep mail opent enkele
vage en obscure beveiligingsproblemen. Het is waarschijnlijk dat u er nooit
problemen mee zal hebben. Maar het zou kunnen (vooral als u een high profile
site, ISP,... bent)!  Er zijn verscheidene POP servers die u meteen kan
installeren vanuit de ports collectie. Indien mogelijk, gebruik dan
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=popa3d&amp;sektion=8">popa3d</a>
die beschikbaar is in de OpenBSD basisinstallatie.
Of, u zou gewoon de verkeerde opties geselecteerd kunnen hebben voor uw pop
daemon (zoals dot locking). Of, u moet misschien gewoon de directory
veranderen waarin hij lockt (hoewel de locking dan alleen waardevol zou
zijn voor de POP daemon.)

<p>
<b>Opmerking:</b> OpenBSD heeft geen groepnaam &quot;mail&quot;.
U moet deze aanmaken in uw <i>/etc/group</i> bestand als u hem nodig hebt.
Een entry als:

<blockquote><pre>
mail:*:6:
</pre></blockquote>

<p>
zou volstaan.

<a name="SendmailDNS"></a>
<h2>10.6 - Waarom negeert Sendmail het <tt>/etc/hosts bestand?</tt></h2>

<p>
Standaard gebruikt Sendmail DNS voor naamresolutie, niet het
<tt>/etc/hosts</tt> bestand. Het gedrag kan veranderd worden door gebruik van
het <tt>/etc/mail/service.switch</tt> bestand.

<p>
Indien u het hosts bestand wil raadplegen vóór DNS servers,
maak dan een <tt>/etc/mail/service.switch</tt> bestand aan dat de volgende
lijn bevat:

<blockquote><pre>
hosts       files dns
</pre></blockquote>

<p>
Als u ENKEL het hosts bestand wenst te raadplegen, gebruik dan het volgende:

<blockquote><pre>
hosts       files
</pre></blockquote>

<p>
Stuur Sendmail een HUP signaal:

<blockquote><pre>
# <b>kill -HUP `head -1 /var/run/sendmail.pid`</b>
</pre></blockquote>

<p>
en de veranderingen zullen resultaat hebben.


<p>
<a name= "HTTPS"></a>
<h2>10.7 - Een Secure HTTP server opzetten met SSL(8)</h2>

<p>
OpenBSD wordt verspreid met een SSL-ready httpd en RSA libraries. Voor gebruik
met
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&amp;sektion=8">httpd(8)</a>, 
moet u eerst een certificaat laten aanmaken. Dit zal bewaard worden in 
<i>/etc/ssl/</i> met de overeenkomstige sleutel in <i>/etc/ssl/private/</i>.
De hier getoonde stappen zijn voor een deel overgenomen van de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssl&amp;sektion=8">ssl(8)</a> 
man pagina. Raadpleeg die voor verdere informatie.
Deze FAQ entry schetst alleen hoe u een RSA certificaat aanmaakt voor web
servers, niet een DSA server certificaat. Om te weten te komen hoe u dat doet,
raadpleeg alstublieft de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssl&amp;sektion=8">ssl(8)</a> 
man pagina.

<p>
Om te beginnen, moet u uw server sleutel en certificaat maken met
OpenSSL:

<blockquote><pre>
# <b>openssl genrsa -out /etc/ssl/private/server.key 1024</b>
</pre></blockquote>

<p>
Of, als u wenst dat de sleutel vercijferd wordt met een passphrase die u zal
moeten intypen bij het starten van de servers

<blockquote><pre>
# <b>openssl genrsa -des3 -out /etc/ssl/private/server.key 1024</b>
</pre></blockquote>

<p>
De volgende stap is het genereren van een Certificate Signing Request dat
gebruikt wordt om een Certifying Authority (CA) uw certificaat te laten
ondertekenen. Om dit te doen, gebruikt u het commando:

<blockquote><pre>
# <b>openssl req -new -key /etc/ssl/private/server.key -out /etc/ssl/private/server.csr</b>
</pre></blockquote>

<p>
Dit <i>server.csr</i> bestand kan vervolgens aan een Certifying Authority
gegeven worden die de sleutel zal ondertekenen. Eén zulke CA is
<b>Thawte Certification</b> die u kan bereiken op
<a href="http://www.thawte.com/">http://www.thawte.com/</a>.

<p>
Als u zich dat niet kan veroorloven, of gewoon zelf het certificaat wil
ondertekenen, kan u het volgende gebruiken.

<blockquote><pre>
# <b>openssl x509 -req -days 365 -in /etc/ssl/private/server.csr \
       -signkey /etc/ssl/private/server.key -out /etc/ssl/server.crt</b>
</pre></blockquote>

<p>
Met <i>/etc/ssl/server.crt</i> en <i>/etc/ssl/private/server.key</i>
op hun plaats, zou u
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&amp;sektion=8">httpd(8)</a>
moeten kunnen starten met de <b>-DSSL</b> vlag (zie de <a href="#rc">sectie
over rc(8)</a> in deze faq), wat https transacties met uw machine toelaat op
poort 443.

<p>
<a name= "vipw"></a>
<h2>10.8 - Ik bewerkte /etc/passwd, maar de veranderingen leken geen effect
te hebben. Waarom?</h2>

<p>
Als u <i>/etc/passwd</i> rechtstreeks bewerkt, zullen uw wijzigingen verloren
gaan.
OpenBSD genereert <i>/etc/passwd</i> dynamisch met
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pwd_mkdb&amp;sektion=8">pwd_mkdb(8)</a>.
Het hoofdwachtwoordbestand in OpenBSD is <i>/etc/master.passwd</i>.
Volgens pwd_mkdb(8),

<blockquote><pre>
FILES
     /etc/master.passwd  current password file
     /etc/passwd         a 6th Edition-style password file
     /etc/pwd.db         insecure password database file
     /etc/pwd.db.tmp     temporary file
     /etc/spwd.db        secure password database file
     /etc/spwd.db.tmp    temporary file
</pre></blockquote>

<p>
In een traditioneel Unix wachtwoordbestand, zoals /etc/passwd, is alles, met
inbegrip van het vercijferde wachtwoord van de gebruiker, beschikbaar voor
gelijk wie op het systeem (en is een uitstekend doelwit voor programma's
als Crack).
4.4BSD introduceerde het master.passwd bestand, dat een uitgebreid formaat
heeft (met bijkomende opties bovenop die voorzien door /etc/passwd) en enkel
door root leesbaar is. Voor snellere toegang tot gegevens, lezen de library
aanroepen die deze gegevens opvragen, normaal gezien /etc/pwd.db en
/etc/spwd.db.

<p>
OpenBSD voorziet een tool waarmee u uw wachtwoordbestand zou moeten bewerken.
Het heet vipw(8).
Vipw zal vi (of uw favoriete editor gedefinieerd door $EDITOR) gebruiken om
/etc/master.passwd te bewerken. Nadat u gedaan hebt met bewerken, zal het
/etc/passwd, /etc/pwd.db, en /etc/spwd.db opnieuw aanmaken met uw wijzigingen.
Vipw zorgt ook voor het locken van deze bestanden, zodat als iemand anders
probeert om ze terzelfdertijd te veranderen, hun de toegang geweigerd zal
worden.

<p>
<a name= "AddDelUser"></a>
<h2>10.9 - Wat is de beste manier om gebruikers toe te voegen en te
verwijderen?</h2>

<p>
OpenBSD voorziet twee commando's om gemakkelijk gebruikers toe te voegen aan
het systeem:

<ul>
<li><a href="#adduser">adduser(8)</a>
<li><a href="#user">user(8)</a>
</ul>

U kan ook met de hand gebruikers toevoegen met
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>,
maar dit is moeilijker voor de meeste handelingen.

<a name="adduser"></a>
<p>
De gemakkelijkste manier om een gebruiker toe te voegen in OpenBSD is door het
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&amp;sektion=8">adduser(8)</a>
script te gebruiken. U kan adduser(8) configureren door
<i>/etc/adduser.conf</i> te bewerken.
adduser(8) laat consistentiecontrole toe op <i>/etc/passwd</i>,
<i>/etc/group</i>, en shell databanken. Het zal de entries en $HOME directories
voor u maken. Het kan zelfs een bericht naar de gebruiker versturen om ze
te verwelkomen. Hier is een voorbeeldgebruiker, <b>testuser</b>, die
toegevoegd wordt aan het systeem.
Hij/zij zal de $HOME directory <i>/home/testuser</i> krijgen, lid gemaakt
worden van de groep <b>guest</b>, en de shell <i>/bin/ksh</i> krijgen.

<blockquote><pre>
# <b>adduser</b>
Use option ``-silent'' if you don't want to see all warnings and questions.

Reading /etc/shells
Reading /etc/login.conf
Check /etc/master.passwd
Check /etc/group

Ok, let's go.
Don't worry about mistakes. I will give you the chance later to correct any input.
Enter username []: <b>testuser</b>
Enter full name []: <b>Test FAQ User</b>
Enter shell csh ksh nologin sh [sh]: <b>ksh</b>
Uid [1002]: <b><i>Enter</i></b>
Login group testuser [testuser]: <b>guest</b>
Login group is ``guest''. Invite testuser into other groups: guest no 
[no]: <b>no</b>
Login class auth-defaults auth-ftp-defaults daemon default staff 
[default]: <b><i>Enter</i></b>
Enter password []: <b><i>Type password, then Enter</i></b>
Enter password again []: <b><i>Type password, then Enter</i></b>

Name:        testuser
Password:    ****
Fullname:    Test FAQ User
Uid:         1002
Gid:         31 (guest)
Groups:      guest
Login Class: default
HOME:        /home/testuser
Shell:       /bin/ksh
OK? (y/n) [y]: <b>y</b>
Added user ``testuser''
Copy files from /etc/skel to /home/testuser
Add another user? (y/n) [y]: <b>n</b>
Goodbye!
</pre></blockquote>

<p>
Om gebruikers te verwijderen zou u de 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rmuser&amp;sektion=8">rmuser(8)</a>
utility moeten gebruiken. Dit zal elk bestaan van een gebruiker verwijderen.
Het zal
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=crontab&amp;sektion=1">crontab(1)</a>
entries, hun $HOME dir (als deze toebehoort aan de gebruiker in kwestie),
en hun mail verwijderen.
Natuurlijk zal het ook hun <i>/etc/passwd</i> en <i>/etc/group</i> entries
verwijderen. Het volgende is een voorbeeld van het verwijderen van de
gebruiker die hierboven werd toegevoegd.
Merk op dat u gevraagd wordt om de naam, en of u al dan niet de home directory
van de gebruiker wil verwijderen.

<blockquote><pre>
# <b>rmuser</b>
Enter login name for user to remove: <b>testuser</b>
Matching password entry:

testuser:$2a$07$ZWnBOsbqMJ.ducQBfsTKUe3PL97Ve1AHWJ0A4uLamniLNXLeYrEie:1002
:31::0:0:Test FAQ User:/home/testuser:/bin/ksh

Is this the entry you wish to remove? <b>y</b>
Remove user's home directory (/home/testuser)? <b>y</b>
Updating password file, updating databases, done.
Updating group file: done.
Removing user's home directory (/home/testuser): done.
</pre></blockquote>

<a name="user"></a>
<h3>Gebruikers toevoegen met user(8)</h3>

<p>
Deze tools zijn minder interactief dan het
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&amp;sektion=8">adduser(8)</a> 
commando, wat ze gemakkelijker maakt om in scripts te gebruiken.

<p>
De volledige verzameling tools is:
<ul>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=group&amp;sektion=8">group(8)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=groupadd&amp;sektion=8">groupadd(8)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=groupdel&amp;sektion=8">groupdel(8)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=groupinfo&amp;sektion=8">groupinfo(8)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=groupmod&amp;sektion=8">groupmod(8)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=user&amp;sektion=8">user(8)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8">useradd(8)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=userdel&amp;sektion=8">userdel(8)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=userinfo&amp;sektion=8">userinfo(8)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=usermod&amp;sektion=8">usermod(8)</a>
</ul>

<h4>Daadwerkelijk gebruikers toevoegen</h4>

<p>
Aangezien user(8) niet interactief is, is de gemakkelijkste manier om
gebruikers efficiënt toe te voegen, het adduser(8) commando te gebruiken.
Het eigenlijke commando
<i>/usr/sbin/user</i> is gewoon een front-end voor de rest van de
<i>/usr/sbin/user*</i> commando's. Daarom kunnen de volgende commando's
toegevoegd worden door <b>user add</b> of <b>useradd</b> te gebruiken, het
is uw keuze zoals u wil, en het verandert het gebruik van de commando's
helemaal niet.

<p>
In dit voorbeeld voegen we dezelfde gebruiker toe met dezelfde specificaties
als de gebruiker die <a href="#adduser">hierboven</a> werd toegevoegd.
useradd(8) is veel gemakkelijker om te gebruiken als u de standaard instelling
kent alvorens een gebruiker toe te voegen. Deze instellingen staan in
<i>/etc/usermgmt.conf</i> en kunnen als volgt gezien worden:

<blockquote><pre>
$ <b>user add -D</b>
group           users
base_dir        /home
skel_dir        /etc/skel
shell           /bin/csh
inactive        0
expire          Null (unset)
range           1000..60000
</pre></blockquote>

<p>
De bovenstaande instellingen zijn wat zal ingesteld worden tenzij u anders
specificeert met commandoregelopties. In ons geval willen we de gebruiker
bijvoorbeeld tot de groep <b>guest</b>, niet <b>users</b> laten horen.
Nog een kleine hindernis bij het toevoegen van gebruikers, is dat wachtwoorden
gespecificeerd moeten worden op de commandoregel. Het gaat om de vercijferde
wachtwoorden, dus u moet eerst de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=encrypt&amp;sektion=1">encrypt(1)</a>
utility gebruiken om het wachtwoord aan te maken. Bijvoorbeeld: OpenBSD's
wachtwoorden gebruiken standaard het Blowfish algoritme voor 6 rondes.
Hier is een voorbeeldlijn om een vercijferd wachtwoord aan te maken om
op te geven aan useradd(8).

<blockquote><pre>
$ <b>encrypt -p -b 6</b>
Enter string:
$2a$06$YOdOZM3.4m6MObBXjeZtBOWArqC2.uRJZXUkOghbieIvSWXVJRzlq
</pre></blockquote>

<p>
Nu we ons vercijferd wachtwoord hebben, zijn we klaar om de gebruiker toe
te voegen.

<blockquote><pre>
# <b>user add -p '$2a$06$YOdOZM3.4m6MObBXjeZtBOWArqC2.uRJZXUkOghbieIvSWXVJRzlq' -u 1002 \
-s /bin/ksh -c "Test FAQ User" -m -g guest testuser</b>
</pre></blockquote>

<p>
<b>Opmerking:</b> Zorg ervoor om '&nbsp;' (enkelvoudige aanhalingstekens)
rond de wachtwoordstring te gebruiken, geen
&quot;&nbsp;&quot; (dubbele aanhalingstekens)
aangezien de shell deze zal interpreteren alvorens het naar user(8) te sturen.
Zorg er bovendien voor dat u de <b>-m</b> optie specificeert als u wil dat de
home directory van de gebruiker wordt aangemaakt en de bestanden vanuit
<i>/etc/skel</i> overgekopieerd worden.

<p>
Om te zien of de gebruiker juist werd aangemaakt, kunnen we vele verschillende
utilities gebruiken. Hieronder zijn een aantal commando's die u kan gebruiken
om snel na te gaan of alles juist werd aangemaakt.

<blockquote><pre>
$ <b>ls -la /home</b>
total 14
drwxr-xr-x   5 root      wheel   512 May 12 14:29 .
drwxr-xr-x  15 root      wheel   512 Apr 25 20:52 ..
drwxr-xr-x  24 ericj     wheel  2560 May 12 13:38 ericj
drwxr-xr-x   2 testuser  guest   512 May 12 14:28 testuser
$ <b>id testuser</b>
uid=1002(testuser) gid=31(guest) groups=31(guest)
$ <b>finger testuser</b>
Login: testuser                         Name: Test FAQ User
Directory: /home/testuser               Shell: /bin/ksh
Last login Sat Apr 22 16:05 (EDT) on ttyC2
No Mail.
No Plan.
</pre></blockquote>

<p>
Bovenop deze commando's, voorziet user(8) zijn eigen utility om
gebruikerseigenschappen te tonen, genaamd userinfo(8).

<blockquote><pre>
$ <b>userinfo testuser</b>
login   testuser
passwd  *
uid     1002
groups  guest
change  Wed Dec 31 19:00:00 1969
class
gecos   Test FAQ User
dir     /home/testuser
shell   /bin/ksh
expire  Wed Dec 31 19:00:00 1969
</pre></blockquote>

<h4>Gebruikers verwijderen</h4>

<p>
Om gebruikers te verwijderen met de user(8) hiërarchie van commando's,
zal u userdel(8) gebruiken. Dit is een heel eenvoudig, maar bruikbaar
commando. Om de gebruiker die in het laatste voorbeeld werd aangemaakt, te
verwijderen, doet u gewoon

<blockquote><pre>
# <b>userdel -r testuser</b>
</pre></blockquote>

<p>
Bemerk de <b>-r</b> optie, die moet opgegeven worden als u wil dat de home
directory van de gebruiker eveneens verwijderd wordt. Als alternatief kan u
<b>-p</b> en niet <b>-r</b> specificeren en dit zal de account van de
gebruiker locken, maar geen informatie verwijderen.

<p>
<a name= "FTPOnly"></a>
<h2>10.10 - Hoe maak ik een ftp-only account aan (niet anonymous FTP!)?</h2>

<p>
Er zijn een aantal manieren om dit te doen, maar een veel voorkomende manier
om dit te doen is door "<tt>/usr/bin/false</tt>" toe te voegen aan
"<tt>/etc/shells</tt>". Wanneer u vervolgens de shell van een gebruiker
instelt op "<tt>/usr/bin/false</tt>", zullen ze niet interactief kunnen
inloggen, maar wel ftp mogelijkheden kunnen gebruiken. U wil misschien ook
de toegang beperken door
<a href="#ftpchroot">gebruikers in hun home directory vast te zetten in
ftpd</a>.


<p>
<a name= "Quotas"></a>
<h2>10.11 - Quota's instellen</h2>

<p>
Quota's worden gebruikt om ruimte voor gebruikers die ze voor zichzelf
ter beschikking hebben, te beperken op uw schijven. Dit kan heel nuttig zijn
in situaties waarin u beperkte middelen hebt. Quota's kunnen ingesteld worden
per gebruiker en/of per groep.

<p>
De eerste stap om quota's in te stellen is er voor te zorgen dat
"<tt>option QUOTA</tt>" in uw <a href="faq5.html#Options">Kernel
Configuratie</a> staat. Deze optie staat in de GENERIC kernel. Daarna moet u
in
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fstab&amp;sektion=5"><tt>/etc/fstab</tt></a>
de bestandssystemen aangeven waarbij quota's zullen ingeschakeld worden.
De sleutelwoorden <tt>userquota</tt> en <tt>groupquota</tt> moeten gebruikt
worden om elk bestandssysteem aan te duiden waarop u quota's zal gaan
gebruiken. Standaard zullen de bestanden <tt>quota.user</tt> en
<tt>quota.group</tt> aangemaakt worden in de root van dat bestandssysteem
om de quota informatie te bewaren. Deze standaard kan overschreven worden door
de bestandsnaam te specificeren bij de quota optie in <tt>/etc/fstab</tt>,
zoals
"<tt>userquota=/var/quotas/quota.user</tt>".
Hier is een voorbeeld van <tt>/etc/fstab</tt> die één
bestandssysteem heeft met userquota's ingeschakeld, en het quotabestand in
een niet-standaard locatie:

<blockquote><pre>
/dev/wd0a / ffs rw,userquota=/var/quotas/quota.user 1 1
</pre></blockquote>

<p>
Nu is het tijd om de quota's voor de gebruiker in te stellen. Om dat te doen
gebruikt u de utility
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=edquota&amp;sektion=8">edquota(8)</a>.
Een eenvoudig gebruik is gewoon "<tt>edquota&nbsp;&lt;user&gt;</tt>".
edquota(8) zal vi(1) gebruiken om de quota's aan te passen tenzij de
omgevingsvariabele EDITOR ingesteld is op een andere editor. Bijvoorbeeld:

<blockquote><pre>
# <b>edquota ericj</b>
</pre></blockquote>

<p>
Dit zal uitvoer geven gelijkaardig aan deze:

<blockquote><pre>
Quotas for user ericj:
/: blocks in use: 62, limits (soft = 0, hard = 0)
        inodes in use: 25, limits (soft = 0, hard = 0)
</pre></blockquote>

<p>
Om limieten toe te voegen, bewerkt u het om resultaten als deze te geven:

<blockquote><pre>
Quotas for user ericj:
/: blocks in use: 62, limits (soft = 1000, hard = 1050)
        inodes in use: 25, limits (soft = 0, hard = 0)
</pre></blockquote>

<p>
Merk op dat de quota toekenning in 1k blokken gebeurt.
In dit geval is de softlimit ingesteld op 1000k, en de hardlimit op 1050k.
Een softlimit is een limiet waarbij de gebruikers gewoon gewaarschuwd worden
als ze er over gaan en tot hun grace period voorbij is, de tijd hebben
om hun schijfgebruik onder hun limiet te brengen.
Grace periods kunnen ingesteld worden met de
<b>-t</b> optie van edquota(8). Nadat de grace period voorbij is,
wordt de softlimit behandeld als een hardlimit. Dit leidt gewoonlijk tot
een allocatiefout.

<p>
Nu de quota's ingesteld zijn, moet u de quota's aanzetten. Om dit te doen
gebruikt u
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=quotaon&amp;sektion=8">quotaon(8)</a>.
Bijvoorbeeld:

<blockquote><pre>
# <b>quotaon -a</b>
</pre></blockquote>

<p>
Dit loopt <tt>/etc/fstab</tt> af om de bestandssystemen met quota-opties aan
te zetten. Nu de quota's goed en wel draaien, kan u ze zien met
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=quota&amp;sektion=1">quota(1)</a>.
Een commando "<tt>quota &lt;user&gt;</tt>" zal de informatie voor die gebruiker
geven. Wanneer het opgeroepen wordt zonder argumenten, zal het quota(1)
commando uw quota statistieken geven. Bijvoorbeeld:

<blockquote><pre>
# <b>quota ericj</b>
</pre></blockquote>

<p>
Zal leiden tot uitvoer gelijkaardig aan:

<blockquote><pre>
Disk quotas for user ericj (uid 1001): 
     Filesystem  blocks   quota   limit   grace   files   quota   limit   grace
              /      62    1000    1050              27       0       0        
</pre></blockquote>

<p>
Standaard zullen quota's ingesteld in <tt>/etc/fstab</tt> opgestart worden
bij het booten. Om ze uit te zetten, gebruikt u

<blockquote><pre>
# <b>quotaoff -a</b>
</pre></blockquote>

<p>
<a name= "Kerberos"></a>
<h2>10.12 - KerberosV Clients en Servers instellen</h2>

<p>
OpenBSD bevat KerberosV als een voorgeïnstalleerde component van het
standaard systeem.

<p>
Gebruik voor meer informatie over KerberosV, vanaf uw OpenBSD systeem, het
commando:
<blockquote><pre>
# <b>info heimdal</b>
</pre></blockquote>


<p>
<a name= "AnonFTP"></a>
<h2>10.13 - Anonymous FTP Diensten opzetten</h2>

<p>
Anonymous FTP laat gebruikers zonder account toe om bestanden op uw computer
op te vragen via het File Transfer Protocol. Hier zal een overzicht gegeven
worden van het instellen van de anonymous FTP server, zijn logging, enz.

<h3>De FTP account toevoegen</h3>

<p>
Om te beginnen moet u een <i>ftp</i> account op uw systeem hebben. Deze account
mag geen bruikbaar wachtwoord hebben. Hier zullen we de login directory op
/home/ftp instellen, maar u kan deze zetten waar u maar wil.
Bij gebruik van anonymous ftp, zal de daemon zichzelf chroot'en in de
home directory van de <i>ftp</i> gebruiker.
Om daarover meer te lezen, leest u de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8">ftpd(8)</a> en
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chroot&amp;sektion=2">chroot(2)</a>
man pagina's. Hier is een voorbeeld van het toevoegen van de <i>ftp</i> gebruiker. Ik zal dit doen met
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&amp;sektion=8">adduser(8)</a>.
We moeten ook /usr/bin/false toevoegen aan onze <i>/etc/shells</i>, dit is de
&quot;shell&quot; die we aan de <i>ftp</i> gebruiker zullen geven.
Dit zal hun niet toelaten in te loggen, ook al zullen we hen een leeg
wachtwoord geven. Om dit te doen kan u gewoon het volgende doen:

<blockquote><pre>
echo /usr/bin/false &gt;&gt; /etc/shells
</pre></blockquote>

Daarna bent u klaar om de <i>ftp</i> gebruiker toe te voegen:

<blockquote><pre>
# <b>adduser</b>
Use option ``-silent'' if you don't want to see all warnings and questions.

Reading /etc/shells
Reading /etc/login.conf
Check /etc/master.passwd
Check /etc/group

Ok, let's go.
Don't worry about mistakes. I will give you the chance later to correct any input.
Enter username []: <b>ftp</b>
Enter full name []: <b>anonymous ftp</b>
Enter shell csh false ksh nologin sh tcsh zsh [sh]: <b>false</b>
Uid [1002]: <b><i>Enter</i></b>
Login group ftp [ftp]: <b><i>Enter</i></b>
Login group is ``ftp''. Invite ftp into other groups: guest no 
[no]: <b>no</b>
Login class auth-defaults auth-ftp-defaults daemon default staff 
[default]: <b><i>Enter</i></b>
Enter password []: <b><i>Enter</i></b>
Set the password so that user cannot logon? (y/n) [n]: <b>y</b>

Name:        ftp
Password:    ****
Fullname:    anonymous ftp
Uid:         1002
Gid:         1002 (ftp)
Groups:      ftp
Login Class: default
HOME:        /home/ftp
Shell:       /usr/bin/false
OK? (y/n) [y]: <b>y</b>
Added user ``ftp''
Copy files from /etc/skel to /home/ftp
Add another user? (y/n) [y]: <b>n</b>
Goodbye!
</pre></blockquote>

<h3>Directory Instelling</h3>

<p>
Samen met de gebruiker, heeft dit de directory <i>/home/ftp</i> aangemaakt.
Dit is wat we willen, maar er zijn enkele veranderingen die we zullen moeten
doen om het klaar te maken voor anonymous ftp. Opnieuw worden deze
veranderingen uitgelegd in de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8">ftp(8)</a> man pagina.

<p>
U moet <b>NIET</b> een /home/ftp/usr of /home/ftp/bin directory aanmaken.
<ul>
<li><i>/home/ftp</i> - Dit is de hoofddirectory. Deze zou owner root en
permissies 555 moeten hebben.
<li><i>/home/ftp/etc</i> - Dit is volledig optioneel en niet aanbevolen, omdat
het enkel dient om informatie te geven aan gebruikers die bestaan op uw
machine. Als u wil dat uw anonymous ftp directory verschijnt alsof ze
uw bestanden met werkelijke gebruikers heeft verbonden, moet u /etc/pwd.db
en /etc/group naar deze directory kopiëren. Deze directory zou mode
511 moeten hebben, en de twee bestanden zouden mode 444 moeten hebben.
Deze worden gebruikt om owner namen te geven in tegenstelling tot getallen.
Er worden geen wachtwoorden bewaard in pwd.db, die staan allemaal in spwd.db,
dus kopieer die laatste niet.
<li><i>/home/ftp/pub</i> - Dit is een standaard directory om bestanden in te
zetten die u wenst te delen. Deze directory zou ook mode 555 moeten hebben.
</ul>

<p> 
Merk op dat al deze directories ''root'' als owner zouden moeten hebben.
Hier is een lijst van hoe de directories er zouden moeten uitzien na het
aanmaken.

<blockquote><pre>
# pwd
/home
# ls -laR ftp
total 5
dr-xr-xr-x  5 root  ftp    512 Jul  6 11:33 .
drwxr-xr-x  7 root  wheel  512 Jul  6 10:58 ..
dr-x--x--x  2 root  ftp    512 Jul  6 11:34 etc
dr-xr-xr-x  2 root  ftp    512 Jul  6 11:33 pub

ftp/etc:
total 43
dr-x--x--x  2 root  ftp    512 Jul  6 11:34 .
dr-xr-xr-x  5 root  ftp    512 Jul  6 11:33 ..
-r--r--r--  1 root  ftp    316 Jul  6 11:34 group
-r--r--r--  1 root  ftp  40960 Jul  6 11:34 pwd.db

ftp/pub:
total 2
dr-xr-xr-x  2 root  ftp  512 Jul  6 11:33 .
dr-xr-xr-x  5 root  ftp  512 Jul  6 11:33 ..
</pre></blockquote>

<h3>De server opstarten en loggen</h3>

<p>
U kan kiezen of u ftpd laat opstarten door
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=inetd&amp;sektion=8">inetd(8)</a>
of via de
<a href="#rc">rc</a> scripts.
Deze voorbeelden zullen tonen dat onze daemon opgestart wordt vanuit
inetd.conf.
Eerst moeten we vertrouwd raken met enkele van de opties van ftpd.
De standaard lijn van <i>/etc/inetd.conf</i> is:

<blockquote><pre>
<b>ftp             stream  tcp     nowait  root    /usr/libexec/ftpd       ftpd -US</b>
</pre></blockquote>

<p>
Hier wordt ftpd aangeroepen met <i>-US</i>. Dit zal anonymous verbindingen
loggen naar <i>/var/log/ftpd</i> en aan de gang zijnde sessies naar
<i>/var/run/utmp</i>. Dat zal toelaten om deze sessies te zien met
who(1). Voor sommigen wil u misschien alleen een anonymous server draaien,
en ftp niet toestaan voor gebruikers. Om dat te doen moet u ftpd aanroepen
met de <i>-A</i> optie. Hier is een lijn die ftpd opstart enkel voor anonymous
verbindingen. Deze gebruikt ook <i>-ll</i> wat elke verbinding logt naar
syslog, samen met de get, retrieve, enz, ftp commando's.

<blockquote><pre>
<b>ftp             stream  tcp     nowait  root    /usr/libexec/ftpd       ftpd -llUSA</b>
</pre></blockquote>

<p>
<b>Opmerking:</b> Voor mensen die DRUK verkeer ftp servers gebruiken,
wil u misschien
ftpd niet aanroepen vanuit inetd.conf. De beste optie is om de ftpd lijn in
inetd.conf te commentariëren en ftpd te starten vanuit rc.conf.local samen met
de <i>-D</i> optie. Dit zal ftpd starten als een daemon, en heeft veel minder
overhead dan ftp starten vanuit inetd.
Hier is een voorbeeldlijn om het te starten vanuit rc.conf.local.

<blockquote><pre>
ftpd_flags="-DllUSA"           # for non-inetd use: ftpd_flags="-D"
</pre></blockquote>

<p>
Dit werkt natuurlijk alleen als u ftpd uit
<i>/etc/inetd.conf</i> gehaald hebt en inetd zijn configuratiebestand opnieuw
heeft laten lezen.

<h3>Andere relevante bestanden</h3>

<ul>
<li><i>/etc/ftpwelcome</i> - Dit bevat het Welkom bericht voor mensen zodra ze
verbonden zijn met uw ftp server.
<li><i>/etc/motd</i> - Dit bevat het bericht voor mensen zodra ze met succes
zijn ingelogd op uw ftp server.
<li><i>.message</i> - Dit bestand kan in gelijk welke directory geplaatst
worden. Het zal getoond worden zodra een gebruiker die directory binnengaat.
</ul>


<p>
<a name= "ftpchroot"></a>
<h2>10.14 - Gebruikers vastzetten in hun home directories in ftpd(8)</h2>

<p>
Standaard kunnen gebruikers, wanneer ze inloggen via ftp, naar gelijk welke
directory gaan op het bestandssysteem waar ze toegang toe hebben. Dit kan in
sommige gevallen niet gewenst zijn.
Het is mogelijk om te beperken wat gebruikers kunnen zien via ftp sessies,
door ze te chroot'en in hun home directory.

<p>
Als u alleen chrooted ftp logins wenst toe te laten, gebruik dan de <b>-A</b>
optie van
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8">ftpd(8)</a>.

<p>
Als u ze nauwkeuriger wil toepassen, maken OpenBSD's
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login.conf&amp;sektion=5">login
capability infrastructuur</a> en
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftpd&amp;sektion=8">ftpd(8)</a>
dit samen gemakkelijk.
<p>

Gebruikers in een login klasse met de <tt>ftp-chroot</tt> variabele
ingesteld, worden automatisch gechroot.
Bovendien kan u een gebruikersnaam toevoegen aan het bestand
<b>/etc/ftpchroot</b> om die gebruikersnamen te chroot'en.
Een gebruiker moet slechts op één van deze plaatsen vermeld
staan.


<p>
<a name= "Patches"></a>
<h2>10.15 - Patches aanbrengen in OpenBSD</h2>

<p>
Zelfs in OpenBSD komen er bugs voor.
Sommige bugs kunnen tot betrouwbaarheidsproblemen leiden (dus iets kan
ervoor zorgen dat het systeem ophoudt te functioneren zoals gewenst).
Andere bugs kunnen tot beveiligingsproblemen leiden (wat anderen kan
toelaten uw computer op onbedoelde manieren te "gebruiken").
Wanneer een kritieke bug gevonden wordt, zal de correctie gecommit worden in
de <i>-current</i> source tree, en zullen patches verschijnen voor de
<a href="faq5.html#Flavors">ondersteunde versies</a> van OpenBSD.
Deze patches verschijnen op de <a href="../../errata.html">errata webpagina</a>,
en worden onderverdeeld in "algemene" errata die alle
<a href="../../nl/plat.html">platformen</a> treffen, en errata die slechts
individuele platformen treffen.

<p>
Merk echter op dat er geen patches gemaakt worden voor nieuwe toevoegingen
aan OpenBSD, en dat dit alleen gedaan wordt voor belangrijke betrouwbaarheids-
of beveiligingsproblemen die best meteen worden aangepakt op getroffen systemen
(wat vaak NIET alle systemen is, afhankelijk van hun doel).

<p>
Er zijn drie manieren om uw systeem te updaten met gepatchte code:

<ul>
<li><b>Upgrade uw systeem naar
<a href="../current.html"><i>-current</i></a>.</b>
Aangezien alle correcties aangebracht worden in de <i>-current</i> code base,
is het updaten van uw systeem naar het laatste snapshot een heel goede manier
om herstelde code toe te passen. Het draaien van <i>-current</i> is echter
niet voor iedereen.
<li><b>Update uw systeem naar <a href="../../nl/stable.html"><i>-stable</i></a>.</b>
Dit gebeurt door uw source tree af te halen of te updaten met de gepaste
<i>-stable</i> branch, en de kernel en de userland bestanden te hercompileren.
Al bij al is dit waarschijnlijk de gemakkelijkste manier, hoewel het langer
duurt (aangezien het gehele systeem gehercompileerd wordt) en een volledige
checkout van de broncode kan lang duren als u over beperkte bandbreedte
beschikt.
<li><b>Patch, compileer en installeer individuele getroffen bestanden.</b>
Dit is wat we zullen gebruiken voor ons voorbeeld hieronder.
Hoewel dit minder bandbreedte vereist, en typisch minder tijd dan een gehele
cvs(1) checkout/update en broncode compilatie, is dit soms de moeilijkste
optie, aangezien er geen universele set van instructies is om te volgen.
Soms moet u één applicatie patchen, hercompileren en installeren,
maar een andere keer moet u gehele secties van de tree hercompileren als het
probleem in een library bestand zit.
</ul>

Opnieuw, individuele bestanden patchen is niet altijd eenvoudig, dus denk
ernstig na over het volgen van de <a href="../../nl/stable.html"><i>-stable</i></a>
(of "patch") branch van OpenBSD.
Het mengen en laten overeenstemmen van patch-oplossingen kan gedaan worden
als u begrijpt hoe alles werkt, maar nieuwe gebruikers kiezen er best een
methode uit en houden zich daaraan.

<h3>Hoe verschillen "errata" patches van wat er in de CVS tree zit?</h3>

<p>
Alle patches vermeld op de
<a href="../../errata.html">errata webpagina</a> zijn patches rechtstreeks
tegen de source tree van de aangegeven release. Patches tegen de
laatse CVS tree zouden ook andere veranderingen kunnen bevatten die
niet gewenst zouden zijn op een release systeem.
Dit is belangrijk: Als u een snapshot geïnstalleerd hebt, de source
trees uitgecheckt hebt op het tijdstip wanneer u dat snapshot verkreeg en
deze probeert
te patchen met een gepubliceerde patch, kan u mogelijk vaststellen dat de
patch niet werkt, aangezien de code kan veranderd zijn.



<h3>Patches aanbrengen.</h3>

<p>
Patches voor het OpenBSD Besturingssysteem worden verspreid als "Unified
diffs", dit zijn
tekstbestanden die verschillen met de oorspronkelijke broncode bevatten.
Ze worden <b>NIET</b> verspreid in binaire vorm. Dit betekent dat u om uw
systeem te patchen, de broncode van de <b>RELEASE</b> versie van OpenBSD
beschikbaar en klaar voor gebruik moet hebben.
In het algemeen moet u de volledige source tree ter beschikking hebben.
Als u een release van de officiële CD-ROM draait, zijn de source trees
beschikbaar op schijf 3, ze zijn ook als bestanden beschikbaar via de
<a href="../../nl/ftp.html">FTP servers</a>.
We zullen veronderstellen dat u de volledige tree uitgecheckt hebt.

<p>
Voor ons voorbeeld hier, zullen we naar patch 001 voor OpenBSD 3.6 kijken,
die te maken heeft met de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=st&amp;sektion=4">st(4)</a>
driver, die tape drives afhandelt.
Zonder deze patch, is het herstellen van gegevens van backups erg moeilijk.
Mensen die een tape drive gebruiken hebben deze patch <i>nodig</i>, zij
zonder tape drive hebben misschien niet bepaald de behoefte om deze te
installeren.
Laten we de patch bekijken:

<blockquote><pre>
# <b>more 001_st.patch</b>
Apply by doing:
        cd /usr/src
        patch -p0 < 001_st.patch

Rebuild your kernel.

Index: sys/scsi/st.c
===================================================================
RCS file: /cvs/src/sys/scsi/st.c,v
retrieving revision 1.41
retrieving revision 1.41.2.1
diff -u -p -r1.41 -r1.41.2.1
--- sys/scsi/st.c       1 Aug 2004 23:01:06 -0000       1.41
+++ sys/scsi/st.c       2 Nov 2004 01:05:50 -0000       1.41.2.1
@@ -1815,7 +1815,7 @@ st_interpret_sense(xs)
        u_int8_t skey = sense->flags & SSD_KEY;
        int32_t info;
 
-       if (((sense->flags & SDEV_OPEN) == 0) ||
+       if (((sc_link->flags & SDEV_OPEN) == 0) ||
            (serr != 0x70 && serr != 0x71))
                return (EJUSTRETURN); /* let the generic code handle it */
</pre></blockquote>

Zoals u zal opmerken, bevat het bovenste deel van de patch korte instructies
omtrent het aanbrengen ervan.
We zullen aannemen dat u deze patch in de <tt>/usr/src</tt> directory gezet
hebt, in dat geval worden de volgende stappen gebruikt:

<blockquote><pre>
# <b>cd /usr/src</b>
# <b>patch -p0 < 001_st.patch</b>
Hmm...  Looks like a unified diff to me...
The text leading up to this was:
--------------------------
|Apply by doing:
|        cd /usr/src
|        patch -p0 < 001_st.patch
|
|Rebuild your kernel.
|
|Index: sys/scsi/st.c
|===================================================================
|RCS file: /cvs/src/sys/scsi/st.c,v
|retrieving revision 1.41
|retrieving revision 1.41.2.1
|diff -u -p -r1.41 -r1.41.2.1
|--- sys/scsi/st.c      1 Aug 2004 23:01:06 -0000       1.41
|+++ sys/scsi/st.c      2 Nov 2004 01:05:50 -0000       1.41.2.1
--------------------------
Patching file sys/scsi/st.c using Plan A...
Hunk #1 succeeded at 1815.              <i>&lt;-- Hou deze boodschap in de gaten!</i>
done
</pre></blockquote>

Let op de "<tt>Hunk #1 succeeded</tt>" boodschap hierboven.
Dit geeft aan dat de patch met succes werd aangebracht.
Vele patches zijn complexer dan deze, en zullen meerdere "hunks" en meerdere
bestanden met zich meebrengen, in dat geval moet u verifiëren dat alle
hunks gelukt zijn op alle bestanden.
Als dat niet gelukt is, betekent het gewoonlijk dat uw source tree niet juist
is, u de instructies niet nauwkeurig gevolgd hebt, of uw patch vermengd was.
Patches zijn heel gevoelig aan "white space" -- kopiëren en plakken
vanuit uw browser zal vaak tab tekens veranderen naar spaties of op een
andere manier de white space van een bestand veranderen, waardoor de patch
ontoepasbaar wordt.

<p>
Op dit punt kan u <a href="faq5.html#Building">de kernel bouwen</a>
zoals normaal, hem installeren en het systeem herstarten.

<p>
Niet alle patches zijn voor de kernel.
In sommige gevallen zult u individuele utilities moeten herbouwen. Andere keren
zal het vereist zijn dat u alle utilities hercompileert die statisch gelinkt
zijn met een gepatchte library.
Volg de begeleiding in de hoofding van de patch, en indien u onzeker bent,
bouw dan het gehele systeem opnieuw.

<p>
Patches die irrelevant zijn voor uw bepaald systeem, hoeven niet aangebracht
te worden -- gewoonlijk.
Bijvoorbeeld, als u geen tape drive op uw systeem had, zou u geen voordeel
hebben bij de bovenstaande patch.
Patches worden echter verondersteld om "in volgorde" aangebracht te worden
-- het is mogelijk dat een latere patch afhankelijk is van een vroegere.
Wees u hiervan bewust als u verkiest om "uit te kiezen" welke patches u
aanbrengt, en indien u twijfelt, breng ze dan allemaal aan, in volgorde.


<a name="httpdchroot"></a>
<h2>10.16 - Vertel me over die chroot() Apache?</h2>

<p>
In OpenBSD werd de Apache 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&amp;sektion=8">httpd(8)</a>
server standaard
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chroot&amp;sektion=2">chroot(2)</a>ed.
Hoewel dit een enorme bevordering is voor de veiligheid, kan het problemen
scheppen, als u zich niet voorbereidt.

<h3>Wat is een chroot?</h3>

<p>
Een
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chroot&amp;sektion=2">chroot(2)</a>ed
toepassing wordt opgesloten in een bepaalde directory en kan niet rondwaren
in de rest van de directory tree, en ziet deze directory als zijn
"<tt>/</tt>" (root) directory.
In het geval van httpd(8), start het programma, opent zijn logbestanden,
maakt zich vast aan zijn TCP poorten (het aanvaardt echter nog geen gegevens),
en leest zijn configuratie. Vervolgens sluit het zichzelf op in
<i>/var/www</i> en laat privileges vallen, daarna begint het aanvragen
te aanvaarden.
Dit betekent dat alle bestanden bediend en gebruikt door Apache in de
<i>/var/www</i> directory moeten staan. Dit helpt de veiligheid enorm --
als er een beveiligingsprobleem is met Apache, zal de schade beperkt blijven
tot een enkele directory met slechts "read only" permissies en zonder middelen
om onheil mee aan te richten.

<h3>Wat betekent dit voor de gebruiker?</h3>

<p>
Botweg gezegd, is Apache chroot(2)en iets nieuw, en het gebeurt niet standaard
in de meeste andere besturingssystemen.
Vele toepassingen en systeemconfiguraties zullen niet werken in een chroot(2)
zonder wat aanpassing.

<ul>
<li><b>Historische bestandssysteem layouts:</b> Servers opgewaardeerd van
oudere versies van OpenBSD kunnen hun webbestanden in gebruikersdirectories
hebben staan, wat duidelijk niet zal werken in een chroot(2)ed omgeving,
aangezien httpd(8) de <i>/home</i> directory niet kan bereiken.
Systeembeheerders kunnen ook ontdekken dat hun /var/www partitie te klein is
om alle webbestanden te bevatten. Uw opties zijn dan om te herstructureren
of om de chroot(2) functionaliteit niet te gebruiken. U kan natuurlijk
symbolische links gebruiken in de home directories van de gebruikers die
verwijzen naar subdirectories in <i>/var/www</i>, maar u kan NIET links
gebruiken in <i>/var/www</i> die verwijzen naar andere delen van het
bestandssysteem -- dat wordt verhinderd te werken door het chroot(2)en.
Merk op dat als u wil dat uw gebruikers
<a href="faq10.html#ftpchroot">chroot(2)ed FTP toegang</a> hebben, dit niet
zal werken, aangezien de FTP chroot u (opnieuw) zal beletten om de doelen
van de symbolische links te bereiken. Een oplossing hiervoor is om niet
<i>/home</i> te gebruiken als uw home directories voor deze gebruikers,
gebruik veeleer iets gelijkaardig aan <i>/var/www/home</i>.

<li><b>Log Rotatie:</b> Normaal worden logs geroteerd door de oudere bestanden
te hernoemen, vervolgens httpd(8) een SIGUSR1 signaal te sturen om Apache
zijn oude logbestanden te laten sluiten en er nieuwe te openen. Dit is niet
langer mogelijk, aangezien httpd(8) geen mogelijkheid heeft om logbestanden
te openen en om hier naar te schrijven zodra hij privileges heeft laten vallen.
httpd(8) moet gestopt en herstart worden:

<blockquote><pre>
# <b>apachectl stop && apachectl start</b>
</pre></blockquote>

Er zijn ook andere strategieën beschikbaar, waaronder het loggen naar een
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pipe&amp;sektion=2">pipe(2)</a>,
en het gebruik van een externe logroteerder aan het andere uiteinde van de
pipe(2).

<li><b>Bestaande Apache modules:</b> Bijna allemaal zullen ze laden, sommige
kunnen echter niet goed werken in chroot(2) en kunnen problemen hebben bij
"<tt><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=apachectl&amp;sektion=8">apachectl</a>
restart</tt>", waarbij een fout gegenereerd wordt, wat ervoor zorgt dat
httpd(8) afsluit.

<li><b>Bestaande CGI's:</b> De meeste zullen NIET werken zoals ze zijn. Ze
kunnen programma's of libraries nodig hebben buiten <i>/var/www</i>. Sommige
kunnen gecorrigeerd worden door ze te compileren zodat ze statisch gelinkt
zijn (en geen libraries in andere directories nodig hebben), de meeste kunnen
gecorrigeeerd worden door de <i>/var/www</i> directory op te vullen met de
bestanden vereist door de toepassing, hoewel dit niet-triviaal is en
aanzienlijke programmeringskennis vereist -- de meeste gebruikers zullen het
gemakkelijker vinden om gewoon de chroot(2) functionaliteit uit te schakelen
totdat ze geüpdatet zijn.

</ul>

In sommige gevallen kan de toepassing of configuratie aangepast worden om
binnen de chroot te draaien. In andere gevallen zal u deze functionaliteit
gewoon moeten uitschakelen met de <tt>-u</tt> optie voor httpd(8) in
<i><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf&amp;sektion=8">/etc/rc.conf</a></i>.

<h3>Voorbeeld van een toepassing chroot(2)en: wwwcount</h3>
Als voorbeeld van een proces dat kan gebruikt worden om een toepassing te
chroot'en, zullen we kijken naar wwwcount, een eenvoudige webpagina teller
beschikbaar via
<a href="faq15.html#PkgMgmt">packages</a>.
Hoewel dit een heel effectief programma is, weet het niets over chroot(2)ed
Apache, en zal niet chroot(2)ed werken in zijn standaardconfiguratie.

<p>
Eerst installeren we de
<a href="http://www.muquit.com/muquit/software/Count/Count.html">wwwcount</a>
package.
We configureren en testen het, en we stellen vast dat het niet lijkt te
werken, we krijgen een Apache boodschap die "Internal Server Error" zegt.

De eerste stap is om Apache te stoppen en te herstarten met de <tt>-u</tt>
vlag om te verifiëren dat het probleem in het chroot(2)en ligt, en niet
in de systeemconfiguratie.

<blockquote><pre>
# <b>apachectl stop</b>
/usr/sbin/apachectl stop: httpd stopped
# <b>httpd -u</b>
</pre></blockquote>

Hierna zien we dat de teller juist werkt, ten minste nadat we de eigenaar
van een directory veranderen zodat Apache (en de CGI's die het draait) kan
schrijven naar de bestanden die het bijhoudt.
We hebben dus zeker een chroot probleem, dus we stoppen en herstarten Apache
opnieuw, met de standaard chrooting:

<blockquote><pre>
# <b>apachectl stop</b>
/usr/sbin/apachectl stop: httpd stopped
# <b>httpd</b>
</pre></blockquote>

<p>
Een goed vertrekpunt zou zijn om te veronderstellen dat wwwcount enkele
libraries en andere bestanden gebruikt die het niet kan vinden vanuit de
chroot. We kunnen het
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ldd&amp;sektion=1">ldd(1)</a>
commando gebruiken om dynamische object dependencies te weten te komen die de CGI nodig heeft:

<blockquote><pre>
# <b>cd /var/www/cgi-bin/</b>
# <b>ldd Count.cgi</b>
Count.cgi:
        Start    End      Type Ref Name
        00000000 00000000 exe   1  Count.cgi
        03791000 237ca000 rlib  1  /usr/lib/libc.so.30.3
        03db4000 03db4000 rtld  1  /usr/libexec/ld.so
</pre></blockquote>

Ok, hier is een probleem, twee bestanden die niet beschikbaar zijn in de
chroot(2) omgeving.
We kopiëren ze dus:

<blockquote><pre>
# <b>mkdir -p /var/www/usr/lib /var/www/usr/libexec</b>
# <b>cp /usr/lib/libc.so.30.3 /var/www/usr/lib</b>
# <b>cp /usr/libexec/ld.so /var/www/usr/libexec</b>
</pre></blockquote>

en proberen de teller opnieuw.

<p>
Wel, nu draait het programma ten minste, en het geeft ons rechtstreeks
foutboodschappen: "Unable to open config file for reading".
Vooruitgang geboekt, maar nog niet klaar.
Het configuratiebestand staat normaal in <tt>/var/www/wwwcount/conf</tt>,
maar binnen de chroot omgeving, lijkt dat <tt>/wwwcount/conf</tt> te zijn.
Onze mogelijkheden zijn ofwel het programma te hercompileren om het
te laten werken waar de bestanden nu staan, of de gegevensbestanden te
verplaatsen.
Aangezien we van een package installeerden, zullen we gewoon het
gegevensbestand verplaatsen.
Om dezelfde configuratie ofwel chroot(2)ed of niet te gebruiken, zullen we
een symbolische link gebruiken:

<blockquote><pre>
# <b>mkdir -p /var/www/var/www</b>
# <b>cd /var/www/var/www</b>
# <b>ln -s ../../wwwcount wwwcount</b>
</pre></blockquote>

Merk op dat de symbolische link gemaakt is om binnen de chroot te werken.
Opnieuw testen we... en we stellen vast dat we nog een ander probleem hebben.
Nu klaagt wwwcount dat het de "strip image" bestanden niet kan vinden die
het gebruikt om boodschappen weer te geven.
Na een beetje zoekwerk vinden we dat deze bewaard worden in
<tt>/usr/local/lib/wwwcount</tt>, dus we moeten die ook nog in de chroot
kopiëren.

<blockquote><pre>
# <b>tar cf - /usr/local/lib/wwwcount | (cd /var/www; tar xpf - )</b>
</pre></blockquote>

we testen opnieuw... en het werkt!

<p>
In dit voorbeeld is het programma vrij eenvoudig, en toch hebben we
verschillende soorten problemen gezien.
Sommige toepassingen zijn vrij eenvoudig, en ze chroot(2)en houdt steek.
Andere zijn heel complex, en ofwel zijn ze niet de moeite om ze in een
chroot(2) te dwingen, ofwel hebt u, tegen de tijd dat u voldoende van het
systeem in de chroot kopieert, alle voordelen van de chroot(2) omgeving
verloren.
Zelfs met een toepassing zo eenvoudig als deze, ze moet naar de schijf
schrijven (om haar tellers bij te houden), dus een beetje voordeel van
de chroot(2) gaat verloren.
In het algemeen moeten de minimale bestanden nodig om een toepassing te
draaien, in de chroot gekopieerd worden.
<i>Niet elke toepassing kan of moet gechroot(2)ed worden.</i>


<a name="rootshell"></a>
<h2>10.17 - Kan ik de root shell wijzigen?</h2>
Er wordt soms gezegd dat men de root shell best nooit verandert, hoewel
daarvoor geen reden is in OpenBSD.

<p>
De standaard shell voor <i>root</i> op OpenBSD is 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1">ksh</a>.

<p>
Een traditionele Unix richtlijn is om alleen statisch gecompileerde shells
te gebruiken voor root, omdat wanneer uw systeem in single user modus start,
niet-root partities niet gemount zullen worden en dynamisch gelinkte shells
geen toegang zullen hebben tot libraries in de <tt>/usr</tt> partitie. Dit is
eigenlijk geen aanzienlijk probleem voor OpenBSD, aangezien het systeem u zal
vragen om een shell wanneer het in single user modus start, en de standaard is
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sh&amp;sektion=1">sh</a>.

De drie standaard shells in OpenBSD
(<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=csh&amp;sektion=1">csh</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sh&amp;sektion=1">sh</a>
en
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1">ksh</a>)
zijn allemaal statisch gelinkt, en dus bruikbaar in single user modus.


<a name="ksh"></a>
<h2>10.18 - Wat kan ik nog doen met <i>ksh</i>?</h2>
In OpenBSD is 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1">ksh</a>
eigenlijk <a href="http://web.cs.mun.ca/~michael/pdksh/">pdksh</a>, de Public
Domain Korn Shell, en is dezelfde binary als
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sh&amp;sektion=1">sh</a>.

<p>
Gebruikers die vertrouwd zijn met <i>bash</i>, vaak gebruikt op Linux systemen,
zullen
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1">ksh</a>
waarschijnlijk heel vertrouwd vinden. Ksh(1) biedt de meeste van de veel
gebruikte functionaliteiten in
<i>bash</i>, inclusief tabvervollediging, commandoregelbewerking en
geschiedenis via de pijltjestoetsen, en CTRL-A/CTRL-E om naar begin/einde van
de commandoregel te springen. Als andere functionaliteiten van <i>bash</i>
gewenst zijn, kan <i>bash</i> zelf geladen worden via ofwel
<a href="faq15.html#PkgMgmt">packages</a> of
<a href="faq15.html#Ports">ports</a>.

<p>
De commandoprompt van <i>ksh</i> kan makkelijk veranderd worden naar iets dat
meer informatie biedt dan de standaard "$ " door de <tt>PS1</tt>
omgevingsvariable in te stellen. Bijvoorbeeld, het invoegen van de volgende
lijn:

<blockquote><pre>
export PS1='$PWD $ '
</pre></blockquote>

in uw <tt>/etc/profile</tt> geeft de volgende commandoprompt:

<blockquote><pre>
/home/nick $
</pre></blockquote>

Zie het bestand
<a href="http://www.openbsd.org/cgi-bin/cvsweb/~checkout~/src/etc/ksh.kshrc?content-type=text/plain"><tt>/etc/ksh.kshrc</tt></a>,
dat veel nuttige functionaliteiten en voorbeelden bevat, en aangeroepen kan
worden in de <tt>.profile</tt> van uw gebruiker.

<p>
Vanaf OpenBSD 3.7 werd ksh(1) verbeterd met een aantal "speciale tekens"
voor de primaire prompt string, PS1, gelijkaardig aan die die gebruikt
worden in bash.
Bijvoorbeeld:
<blockquote>
<tt>\e - </tt>Voeg een ASCII escape karakter in.<br>
<tt>\h - </tt>De hostname, min domeinnaam.<br>
<tt>\H - </tt>De volledige hostname, inclusief domeinnaam.<br>
<tt>\n - </tt>Voeg een newline karakter in.<br>
<tt>\t - </tt>De huidige tijd, in 24-uur HH:MM:SS formaat.<br>
<tt>\u - </tt>De gebruikersnaam van de huidige gebruiker.<br>
<tt>\w - </tt>De huidige werkdirectory.  $HOME wordt afgekort als `~'.<br>
<tt>\W - </tt>De basisnaam van de huidige werkdirectory.<br>
</blockquote>

(zie de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1">ksh(1)</a>
man pagina voor meer details!)

<p>
Men zou het volgende commando kunnen gebruiken:
<blockquote><pre>
export PS1="\n\u@\H\n\w $ "
</pre></blockquote>
om een heel uitgebreide maar ietwat nuttige prompt te geven.


<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
<a href= "faq9.html">[Naar Sectie 9 - Migreren naar OpenBSD]</a>
<!-- a href= "faq11.html">[Naar Sectie 11 - Prestatie Tuning]</a -->
<a href="faq12.html">[Naar Sectie 12 - Platform-specifieke Vragen]</a>
</font>

<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../../images/back.gif" border= "0" alt="[terug]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: faq10.html,v 1.129 ]<br>
$Translation: faq10.html,v 1.26 2006/10/27 12:05:29 smestdag Exp $<br>
-->
$OpenBSD: faq10.html,v 1.23 2006/10/27 13:32:07 jufi Exp $
</small>
</body>
</html>

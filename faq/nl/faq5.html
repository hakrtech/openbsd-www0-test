<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>5 - Het Systeem vanaf Broncode Bouwen</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 1998-2004 by OpenBSD.">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
</head>

<body bgcolor= "#ffffff" text= "#000000">
<!-- Passes validator.w3.org.  Please keep it this way -->

<a href="../../nl/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif" border="0">    
</a>
<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
<a href= "faq4.html">[Naar Sectie 4 - Installatiegids]</a>
<a href= "faq6.html">[Naar Sectie 6 - Netwerken]</a>
</font>

<h1><font color="#e00000">5 - Het Systeem vanaf Broncode Bouwen</font></h1>
<hr>

<p>
<h3>Inhoudstafel</h3>
<ul>
<li><a href= "#Flavors">5.1 - OpenBSD's Flavors</a>
<li><a href= "#Why">5.2 - Waarom heb ik een aangepaste kernel nodigl?</a>
<li><a href= "#Options">5.3 - Kernel configuratiebestanden</a>
<li><a href= "#Building">5.4 - Uw eigen kernel bouwen</a>
<li><a href= "#BootConfig">5.5 - Boot-time configuratie</a>
<li><a href= "#VerboseBoot">5.6 - Meer uitgebreide uitvoer bekomen tijdens het
  opstarten</a>
<li><a href= "#config">5.7 - Uw kernel aanpassen met config(8)</a>
<li><a href="#buildprobs">5.8 - Vaak voorkomende Problemen bij het
  Compileren en Bouwen</a>
   <ul>
   <li><a href="#sig11">5.8.1 - De build stopte met een "Signal 11" fout</a>
   <li><a href="#snake">5.8.2 - "make build" mislukt met "cannot open output
      file snake: is a directory"</a>
   </ul>
<li><a href="#BldRelease">5.9 - Hoe bouw ik een OpenBSD release?</a>
</ul>
<hr>
<br>


<a name="Flavors"></a>
<h2>5.1 - OpenBSD's Flavors</h2>
<!-- XXXversion - revise doodle -->
Er zijn drie "flavors" van OpenBSD:
<ul>
<li><b>-release:</b> De versie van OpenBSD die elke zes maanden op CD
    verdeeld wordt.
<li><b>-stable:</b>  Release, plus patches die kritiek beschouwd worden voor
    beveiliging en betrouwbaarheid.
<li><b>-current:</b> De tot-op-het-moment versie van OpenBSD, die de volgende
    release zal worden.
</ul>

Grafisch ziet de ontwikkeling van deze flavors er ongeveer zo uit:

<blockquote>
<pre>
       ,------o-----------o----X                    3.3 Stable
       |      .           .
       |      .    ,------o---------o----X          3.4 Stable
       |      .    |      .         .
       |      .    |      .    ,----o----------o--&gt; 3.5 Stable
       |      .    |      .    |    .          .
       |      .    |      .    |    .    ,-----o--&gt; 3.6 Stable
       |      .    |      .    |    .    |     .
       |      .    |      .    |    .    |     .
 --&gt;3.3Rel-----&gt;3.4Rel-----&gt;3.5Rel-----&gt;3.6Rel----&gt; Current 

          Time ---&gt;
</pre>
</blockquote>

<p>
De code tree wordt elke zes maanden vertakt ("branched") tussen <i>-current</i>,
<i>-release</i> en <i>-stable</i> -- <i>-release</i> wordt een bevroren punt
(een &quot;Tag&quot;) in de historiek van de source tree - het wordt nooit
meer aangepast, en is wat op de <a href="../../nl/orders.html">CDs</a> en
<a href="../../nl/ftp.html">FTP
servers</a> staat.  <i>-Current</i> is waar actief werk gebeurt, en wordt de
volgende <i>-release</i> van OpenBSD.

<p>
De <i>-stable</i> (ook bekend als de "Patch branch") is gebaseerd op
<i>-release</i>, en zoals men kan zien, is het een vertakking ("branch") van
het ontwikkelingspad van OpenBSD. Naarmate er belangrijke correcties
aangebracht worden aan <i>-current</i>, worden ze ge-"back-ported" in de
<i>-stable</i> branches.  In de bovenstaande illustratie zijn de verticale
stippellijnen bugcorrecties die in de <i>-stable</i> branches opgenomen worden.
U zal ook merken dat in het bovenstaande voorbeeld, de <i>3.3-stable</i>
branch aan zijn einde kwam bij <i>3.5-release</i>, en de <i>3.4-stable</i>
aan zijn einde kwam bij <i>3.6-release</i> -- oude releases worden typisch
tot twee releases terug ondersteund. Het vergt middelen en tijd om oudere
versies te ondersteunen, en hoewel we voortdurende ondersteuning voor oude
releases graag zouden aanbieden, zouden we ons liever toespitsen op nieuwe
functionaliteiten. De <i>-stable</i> branch is, door ontwerp, heel
gemakkelijk om te bouwen vanaf <i>-release</i> van dezelfde versie
(dus gaande van <i>3.6-release</i> naar <i>3.6-stable</i>).

<p>
De <i>-stable</i> branch is <i>-release</i> plus patches die terug te vinden
zijn op de
<a href="../../errata.html">errata pagina</a>, en enkele eenvoudige verbeteringen
die geen errata-aantekening verdienen. Gewoonlijk is de werking van
<i>-stable</i> dezelfde als de <i>-release</i> waarop het gebaseerd is. Als de
<a href="http://www.openbsd.org/cgi-bin/man.cgi">man pagina's</a> moeten
veranderen, zal het waarschijnlijk niet in <i>-stable</i> gaan. Met andere
woorden, nieuwe device ondersteuning zal NIET toegevoegd worden aan
<i>-stable</i>, en ondersteuning voor nieuwe functionaliteit zal zelden
toegevoegd worden tenzij het heel belangrijk geacht wordt.

<p>
Waarschuwing: <i>-current</i> is een doel in beweging. Het verandert met
de minuut, en kan gerust enkele keren veranderen in de tijd die het vergt om
de broncode op te vragen. Zoals eerder aangegeven, is er geen belofte dat het
systeem compileert of dat het werkt (natuurlijk is er de hoop dat het dat
doet). Het is perfect mogelijk en niet ongewoon om de <i>-current</i> broncode
af te halen en vast te stellen dat deze niet wil compileren, terwijl het vijf
minuten later wel prima werkt. <b>Indien u niet bereid bent om hiermee om te
gaan, blijf dan weg van <i>-current</i>.</b>

<p>
De meeste gebruikers draaien best ofwel <i>-stable</i> of <i>-release</i>.
Dat gezegd zijnde, draaien veel mensen <i>-current</i> op productiesystemen,
en het is belangrijk dat enkele mensen dat doen om bugs op te sporen en
nieuwe functionaliteiten te testen. Als u echter niet weet hoe een probleem
behoorlijk te beschrijven, te diagnosticeren en ermee om te gaan, zeg dan
niet tegen uzelf (of iemand anders) dat u "het project helpt" door
<i>-current</i> te draaien.  "Het werkte niet!" is geen
<a href="../../nl/report.html#bugtypes">nuttige bug melding</a>.  "De recente
wijzigingen aan de pciide driver hebben de compatibiliteit met mijn
Slugchip-gebaseerde IDE interface gebroken, dmesg van werkende en gebroken
systemen volgen..." zou een nuttige melding kunnen zijn.

<p>
Er zijn momenten wanneer "gewone" gebruikers misschien op het scherp van de
snee willen leven en <i>-current</i> draaien. De meest voorkomende reden is
dat de gebruiker een device heeft dat niet
ondersteund wordt door <i>-release</i> (en dus ook niet door <i>-stable</i>),
of verkiest om een nieuwe functionaliteit van <i>-current</i> te gebruiken.
In dit geval kan de keuze zijn om ofwel
<i>-current</i> te gebruiken ofwel het device niet te gebruiken, en
<i>-current</i> kan het kleinste kwaad zijn.  Men moet echter geen
"handjes vasthouden" van de ontwikkelaars verwachten.

<h3>Snapshots</h3>
Tussen formele releases van OpenBSD worden er <i>snapshots</i> beschikbaar
gemaakt via de <a href="../../nl/ftp.html">FTP sites</a>. Zoals de naam impliceert,
zijn dit builds van welke code er ook in de tree zit op het ogenblik dat de
builder een kopie nam van de code voor dat bepaald platform.
Onthou dat, op sommige platformen, het DAGEN kan duren voor de snapshot
build voltooid is en voor verspreiding vrijgegeven wordt. Er is geen belofte
dat de snapshots volledig functioneel zijn, of zelfs goed installeren. Vaak
kan een verandering die getest moet worden, het aanmaken van snapshots
teweegbrengen.

Voor sommige platformen worden bijna dagelijks snapshots gebouwd, voor andere
zal dit veel minder frequent gebeuren. Als u <i>-current</i> wenst te draaien,
is een recent snapshot vaak al wat u nodig hebt, en naar een snapshot upgraden
is een goed vertrekpunt alvorens <i>-current</i> proberen te bouwen.

<p>
Soms wordt gevraagd of er een manier is om precies de broncode te verkrijgen
die gebruikt werd om een snapshot te bouwen. Het antwoord is neen. Ten eerste
biedt dit geen aanzienlijk voordeel. Ten tweede worden snapshots gebouwd zoals
gewenst, naarmate de tijd het toelaat, en naarmate middelen beschikbaar worden.
Op snelle platformen is het mogelijk dat er meerdere snapshots ge-released
worden op één dag. Op tragere platformen kan het een week of
langer duren om een snapshot te bouwen. Etiketten ("tags") of kentekens
voorzien in de source tree voor elk snapshot zou erg onpraktisch zijn.

<h3>De Dingen in Sync houden</h3>
Het is belangrijk om te begrijpen dat OpenBSD een Besturingssysteem is,
bedoeld om als een geheel genomen te worden, niet als een kernel met een
hoop utilities er op gekleefd. U moet ervoor zorgen dat uw kernel, "userland"
(de ondersteunende utilities en bestanden) en
<a href="../../nl/ports.html"><tt>ports</tt></a> tree allemaal in sync zijn, of
er zullen onaangename dingen gebeuren. Anders gezegd (omdat de mensen de fout
gewoon blijven maken), u kan geen splinternieuwe <tt>ports</tt> draaien op
een systeem van een maand oud, of een kernel van <i>-current</i> broncode
herbouwen en verwachten dat deze werkt met een <i>-release</i> userland. Ja,
dit betekent dat u uw systeem moet updaten als u een nieuw programma wil
draaien dat vandaag aan de ports tree werd toegevoegd. Sorry, maar opnieuw,
OpenBSD heeft beperkte middelen ter beschikking.

<p>
Men zou ook moeten begrijpen dat bij
<a href="../upgrade-minifaq.html">upgraden vanaf broncode</a>, het update
proces in <b>slechts één richting: van ouder naar nieuwer</b>
ondersteund wordt, en van <i>-stable</i> naar <i>-current</i>. U kan niet
<i>3.6-current</i> (of een snapshot) draaien, vervolgens beslissen dat u te
gevaarlijk aan het leven bent, en een stap terugzetten naar <i>3.6-stable</i>.
U staat er alleen voor als u een ander pad verkiest dan de ondersteunde optie
om uw systeem vanaf nul te herladen, verwacht geen assistentie van het
OpenBSD ontwikkelingsteam.

<p>
Ja, dit betekent dat u lang en hard moet nadenken alvorens u zichzelf aan
het gebruik van <i>-current</i> waagt.


<p>
<a name="Why"></a>
<h2>5.2 - Waarom heb ik een aangepaste kernel nodig?</h2>

<p>
Eigenlijk hebt u dat waarschijnlijk niet nodig.

<p>
Een aangepaste kernel is een kernel gebouwd met een configuratiebestand
verschillende van het meegeleverde <tt>GENERIC</tt> configuratiebestand.
Een aangepaste kernel kan gebaseerd zijn op <a href="#Flavors"><i>-release,
-stable</i> of <i>-current</i></a> code, net zoals een <tt>GENERIC</tt>
kernel dat kan zijn.
Terwijl het compileren van uw eigen <tt>GENERIC</tt> kernel ondersteund is
door het OpenBSD team, is dit <i>niet</i> zo voor het compileren van uw eigen
aangepaste kernel.

<p>
De standaard OpenBSD kernelconfigurate (<tt>GENERIC</tt>) is ontworpen om
geschikt te zijn voor de meeste mensen.
Door het proberen tweaken van hun kernel hebben er meer mensen hun systeem
gebroken dan er de werking van het systeem verbeterd hebben.
Er zijn mensen die geloven dat u uw kernel en systeem moet aanpassen voor
optimale performantie, maar dit is niet waar voor OpenBSD.
Alleen de meest geavanceerde en best geïnformeerde gebruikers met de
meest veeleisende toepassingen hoeven zich zorgen te maken over een
aangepaste kernel of systeem.

<p>
Enkele redenen waarom u misschien een aangepaste kernel zou willen of
moeten bouwen:
<ul>
  <li>U weet echt wat u doet, en wil OpenBSD persen op een computer met een
      kleine hoeveelheid RAM door device drivers die u niet nodig hebt, te
      verwijderen.
  <li>U weet echt wat u doet, en wenst de standaardopties te verwijderen of
      opties toe te voegen die misschien standaard niet ingeschakeld zijn
      (en u hebt een goede reden om dat te doen).
  <li>U weet echt wat u doet, en wenst experimentele opties in te schakelen.
  <li>U weet echt wat u doet, en hebt een speciale behoefte waaraan niet
      voldaan wordt door <tt>GENERIC</tt>, en
      u gaat niet vragen waarom het niet werkt indien er iets verkeerd gaat.
</ul>

<p>
Enkele redenen waarom u beter niet een aangepaste kernel bouwt:
<ul>
  <li>Normaal gezien hoeft u dit niet te doen.
  <li>U zal geen sneller systeem verkrijgen.
  <li>U zal waarschijnlijk een minder betrouwbare machine maken.
  <li>U zal geen ondersteuning krijgen van ontwikkelaars.
  <li>Er zal van u verwacht worden dat u gelijk welk probleem reproduceert
      met een <tt>GENERIC</tt> kernel alvorens ontwikkelaars een
      probleemmelding ernstig nemen.
  <li>Gebruikers en ontwikkelaars zullen u uitlachen wanneer u uw systeem
      breekt.
  <li>Aangepaste compileropties leggen gewoonlijk beter compilerproblemen
      bloot dan dat ze de prestatie van het systeem verbeteren.

</ul>

<p>
Het verwijderen van device drivers kan het bootproces op uw systeem
versnellen, maar kan het herstel bemoeilijken als u een hardware probleem
hebt, en het wordt heel vaak verkeerd gedaan.
Het verwijderen van device drivers zal uw systeem <i>NIET</i> met een merkbare
hoeveelheid sneller laten draaien, maar kan wel een kleinere kernel produceren.
Het verwijderen van debugging en errorcontrole kan tot een meetbare
prestatiewinst leiden, maar zal het onmogelijk maken om een systeem
te onderzoeken als er iets verkeerd gaat.


<p>
Opnieuw, ontwikkelaars zullen gewoonlijk bugmeldingen negeren die te maken
hebben met aangepaste kernels, tenzij het probleem ook in een <tt>GENERIC</tt>
kernel kan gereproduceerd worden.
U bent gewaarschuwd.

<p>
<a name="Options"></a>
<h2>5.3 - Kernel configuratiebestanden</h2>
OpenBSD kernel generatie wordt gestuurd door configuratiebestanden,
die standaard in de <tt>/usr/src/sys/arch/<i>&lt;arch&gt;</i>/conf/</tt>
directory staan. Alle architecturen hebben een bestand, <tt>GENERIC</tt>,
dat gebruikt wordt om de standaard OpenBSD kernel voor dat platform te
genereren.
Het kan dat er ook andere configuratiebestanden zijn die gebruikt worden
om kernels met verschillende doelen aan te maken, bijvoorbeeld, voor
minimale RAM, schijfloze werkstations, etc.

<p>
Het configuratiebestand wordt verwerkt door
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>,
dat een compilatiedirectory aanmaakt en opvult in <tt>../compile</tt>,
op een typische installatie zou dat in
<tt>/usr/src/sys/arch/<i>&lt;arch&gt;</i>/compile/</tt> zijn. config(8) maakt
ook een <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=make&amp;sektion=1">Makefile</a> aan,
en andere bestanden die vereist zijn om met succes de kernel te bouwen.

<p>
Kernel Configuratie Opties zijn opties die u aan uw kernelconfiguratie
toevoegt en die bepaalde functionaliteiten in uw kernel plaatsen. Dit laat u
toe om precies de ondersteuning te hebben die u wenst, zonder ondersteuning te
hebben voor onnodige devices. Er zijn een veelheid aan opties die u toelaten
om uw kernel aan te passen. Hier zullen we er slechts enkele overlopen,
degene die het vaakst gebruikt worden. Bekijk de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=options&amp;sektion=4">options(4)</a>
man pagina voor een volledige lijst van opties, en aangezien deze van tijd tot
tijd veranderen, moet u ervoor zorgen dat u een man pagina gebruikt voor
dezelfde versie van OpenBSD die u aan het bouwen bent. U kan ook de
voorbeeldconfiguratiebestanden nakijken die beschikbaar zijn voor uw
architectuur.

<p>
<b>Gelieve geen opties toe te voegen, te verwijderen of te veranderen in uw
kernel tenzij u werkelijk een reden hebt om dat te doen!</b>  De enige kernel
configuratie die ondersteund wordt door het OpenBSD team is de GENERIC kernel,
de combinatie van de opties in
<tt>/usr/src/sys/arch/&lt;<i>arch</i>&gt;/conf/GENERIC</tt>
en <tt>/usr/src/sys/conf/GENERIC</tt> <i>zoals verdeeld door het OpenBSD
team</i> (dus NIET bewerkt). Een probleem melden over een aangepaste kernel zal
er bijna altijd toe leiden dat u gezegd wordt om het probleem trachten te
reproduceren met een GENERIC kernel. Niet alle opties zijn compatibel met
elkaar, en vele opties zijn vereist opdat het systeem zou werken. Er is geen
garantie dat, louter omdat u er in slaagt om een aangepaste kernel te
compileren, deze ook werkelijk zal draaien.

<p>
U kan hier de platform-specifieke configuratiebestanden zien:
<ul>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/alpha/conf/">alpha Kernel Configuratiebestanden</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/i386/conf/">i386 Kernel Configuratiebestanden</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/macppc/conf/">macppc Kernel Configuratiebestanden</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/sparc/conf/">sparc Kernel Configuratiebestanden</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/sparc64/conf/">sparc64 Kernel Configuratiebestanden</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/vax/conf/">vax Kernel Configuratiebestanden</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/hppa/conf/">hppa Kernel Configuratiebestanden</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/">Andere Architecturen</a>
</ul>

<p>
Bekijk deze bestanden van nabij en u zal bovenaan een lijn opmerken
gelijkaardig aan:
<pre>
     include "../../../conf/GENERIC"
</pre>
Dit betekent dat het naar een ander configuratiebestand verwijst,
één dat de platform-onafhankelijke opties bewaart. Wanneer u
uw Kernel Config aanmaakt, kijk overloop dan zeker
<a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/conf/GENERIC">sys/conf/GENERIC</a>. 
<p>
Kernel configuratie-opties moeten in uw kernelconfiguratiebestand geplaatst
worden in het volgende formaat:
<blockquote>
<tt>option&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt><i>name</i>
</blockquote>
Bijvoorbeeld, om de optie "DEBUG" in de kernel te plaatsen, voegt u een lijn
als deze toe:
<pre>
     option      DEBUG
</pre>
Opties in de OpenBSD kernel worden vertaald in compiler preprocessor opties,
daarom zou een optie als DEBUG ervoor zorgen dat de broncode gecompileerd
wordt met de optie -DDEBUG, wat equivalent is met een <tt>#define DEBUG</tt>
te doen doorheen de hele kernel.

<p>
Soms kan het dat u een optie wenst uit te schakelen die reeds gedefinieerd is,
typisch in het "<tt>src/sys/conf/GENERIC</tt>" bestand. Hoewel u een kopie
van dat bestand zou kunnen wijzigen, is het een betere keuze om de
<i>rmoption</i> opdracht te gebruiken. Als u bijvoorbeeld echt de in-kernel
debugger wil uitschakelen (<i>niet aanbevolen!</i>), zou u een lijn als deze
toevoegen:
<pre>
     rmoption DDB
</pre>
in uw kernelconfiguratiebestand. <tt>option DDB</tt> wordt gedefinieerd in
<tt>src/sys/conf/GENERIC</tt>, maar de bovenstaande <tt>rmoption</tt> lijn
deactiveert ze.

<p>
Nog eens, zie
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=options&amp;sektion=4">options(4)</a>
voor meer informatie over de bijzonderheden van deze opties. Merk ook op
dat veel van de opties ook hun eigen manual pagina's hebben -- lees steeds
alles wat over een optie beschikbaar is alvorens deze toe te voegen aan of te
verwijderen uit uw kernel.




<p> 
<a name="Building"></a>
<h2>5.4 - Uw eigen kernel bouwen</h2>

<p>
Volledige instructies voor het aanmaken van uw eigen kernel staan in de
<a href= "http://www.openbsd.org/cgi-bin/man.cgi?query=afterboot&amp;sektion=8">
afterboot(8)</a> man pagina.

<p>
Om uw kernel vanaf de CD-ROM te compileren moet u eerst de broncode ter
beschikking hebben. De broncode is beschikbaar zowel op de
<a href="../../nl/orders.html">officiële CD</a> (schijf 3) als op de
<a href="../../nl/ftp.html">FTP sites</a>.  Het volgende voorbeeld veronderstelt
dat CD3 gemount is op /mnt:

<blockquote>
<pre>
# <strong>cd /usr/src</strong>
# <strong>tar xvzf /mnt/src.tar.gz</strong>
</pre>
</blockquote>

<b>Opmerking:</b> Als u aan het downloaden bent van de FTP servers, zal u
TWEE bestanden vinden, <i>src.tar.gz</i> and <i>sys.tar.gz</i>. Het eerste is
het "userland" -- alles behalve de kernel, het tweede is de kernel broncode.
Download deze allebei en pak ze uit aangezien u ze, voor de meeste gebruiken,
allebei zal willen. Op de CD-ROM zijn ze gecombineerd in één
bestand.

<p>
Om nu uw aangepaste kernel aan te maken, is het het gemakkelijkst om te
beginnen met de GENERIC kernel. Deze staat in
<tt>/usr/src/sys/arch/$ARCH/conf/GENERIC</tt>, waarin $ARCH uw architectuur is.
Er zijn in die directory ook nog andere voorbeeldconfiguraties beschikbaar.
Hier zijn twee voorbeelden om uw kernel te compileren. Het eerste voorbeeld
compileert uw kernel op een read-only source tree. Het tweede op een
schrijfbare source tree.

<blockquote> 
<pre>
# <strong>cd /somewhere</strong>
# <strong>cp /usr/src/sys/arch/$ARCH/conf/SOMEFILE .</strong>
# <strong>vi SOMEFILE</strong>   <i>(om de wijzigingen te doen die u wenst)</i>
# <strong>config -s /usr/src/sys -b . SOMEFILE</strong>
</pre>
gevolgd door ofwel:

<pre>
    # <strong>make depend</strong>
         <b><i>- OF -</i></b>
    # <strong>make clean && make depend</strong>
# <strong>make</strong>
</pre>
</blockquote>

U voert best '<tt>make depend</tt>' uit wanneer u veranderingen (updates en
patches inbegrepen) hebt aangebracht aan uw source tree (met andere woorden,
bijna altijd).
Als config u zegt om ook '<tt>make clean</tt>' uit te voeren, doet u dat dan
vóórdat u '<tt>make depend</tt>' uitvoert.


<p>
Als u veranderingen hebt gedaan aan uw kernelconfiguratie-opties, en/of
grote veranderingen aan uw source tree, moet u '<tt>make clean</tt>' gebruiken
in plaats van het bovenstaande '<tt>made depend</tt>'.  Merk op dat het altijd
veilig is om een 'make clean' te doen, hoewel het kan leiden tot langere
compileertijden, aangezien er meer opnieuw gebouwd zal worden.

<p>
Om een kernel binnen een schrijfbare source tree te bouwen, doet u het
volgende:

<blockquote>
<tt>
# <strong>cd sys/arch/$ARCH/conf</strong><br>
# <strong>vi SOMEFILE</strong><i> (to make any changes you want)</i><br>
# <strong>config SOMEFILE</strong><i> (read more about it here: 
<a href= "http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>)</i><br>
# <strong>cd ../compile/SOMEFILE</strong><br>
# <strong>make</strong> <br>
</tt>
</blockquote>

<p>
Waarin $ARCH de architectuur is die u gebruikt (bv. i386). U kan ook een
<strong>make depend</strong> doen om de dependencies te maken voor de volgende
keer dat u uw kernel compileert.

<p>
Om uw kernel op zijn plaats te zetten:

<blockquote>
<pre>
# <strong>cp /bsd /bsd.old</strong>
# <strong>cp /sys/arch/$ARCH/compile/SOMEFILE/bsd /bsd</strong>
</pre>
</blockquote>

Om bij het booten terug te vallen op uw oudere kernel, moet u gewoon dit doen:

<blockquote>
<pre>
boot&gt; <strong>bsd.old</strong>
</pre>
</blockquote>

en uw oude kernel zal geladen worden in plaats van /bsd.

<p>
Soms zal het, wanneer u een nieuwe kernel bouwt, vereist zijn om nieuwe
bootblocks te installeren. Om dat te doen, leest u
<a href="faq14.html#InstBoot">FAQ 14, Bootblocks Installeren</a>, wat u een
overzicht geeft van het gebruik van OpenBSD's Bootloader.

<p>
<a name="BootConfig"></a>
<h2>5.5 - Boot-Time Configuratie</h2>

<p>
Soms wanneer u uw systeem boot, zou het kunnen dat u opmerkt dat de kernel
uw device vindt maar misschien op de verkeerde IRQ. En misschien moet u dit
device meteen gebruiken. Wel, zonder de kernel opnieuw te bouwen, kan u
OpenBSD's boot time kernelconfiguratie gebruiken. Dit zal uw probleem slechts
voor één keer corrigeren. Als u herstart, zal u deze procedure
moeten herhalen. Dus, dit is slechts als tijdelijke oplossing bedoeld, en u
corrigeert het probleem best door uw kernel te corrigeren en te hercompileren.
Uw kernel heeft echter <strong>option BOOT_CONFIG</strong> nodig, wat het
geval is bij GENERIC.

<p>
Het grootste deel van dit document kan u vinden in de man pagina
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot_config&amp;sektion=8">boot_config(8)</a>.

<p>
Om in de User Kernel Config, of UKC, te booten, gebruikt u de -c optie bij
het booten.

<blockquote><pre>
boot&gt; <strong>boot hd0a:/bsd -c</strong>
</pre></blockquote>

Of welke kernel u ook wil booten. Dit zal een UKC prompt tevoorschijn brengen.
Van daar kan u rechtstreeks aan de kernel commando's opgeven die devices
specificeren die u wil veranderen of uitschakelen of zelfs inschakelen.

<p>
Hier is een lijst van vaak voorkomende commando's in de UKC.

<ul>
<li><tt>add <strong>device</strong></tt> - Voeg een device toe door een ander te kopiëren
<li><tt>change <strong>devno | device </strong></tt> - Wijzig één of meer devices
<li><tt>disable <strong>devno | device </strong></tt> - Schakel één of meer devices uit
<li><tt>enable <strong>devno | device </strong></tt> - Schakel één of meer devices in
<li><tt>find <strong>devno | device </strong></tt> - Vind één of meer devices
<li><tt>help</tt> - Korte samenvatting van deze commando's
<li><tt>list</tt> - Toon ALLE gekende devices
<li><tt>exit/quit</tt> - Ga verder met Booten
<li><tt>show <strong>[attr [val]]</strong></tt> - Toon devices met een attribuut en optioneel met een gespecificeerde waarde
</ul>

<p>
Zodra u uw kernel geconfigureerd hebt, gebruikt u <tt>quit</tt> of
<tt>exit</tt> en gaat u verder met booten.
Daarna zou u de verandering blijvend moeten maken in uw kernel image,
zoals beschreven in <a href="faq5.html#config">Uw kernel aanpassen met
config(8)</a>.

<p>
<a name="VerboseBoot"></a>
<h2>5.6 - Meer uitgebreide uitvoer bekomen tijdens het opstarten</h2>

Meer uitgebreide uitvoer bekomen kan heel nuttig zijn bij het proberen
debuggen van problemen bij het booten. Als u een probleem hebt waarbij uw
bootdiskette niet wil booten en u meer informatie moet verkrijgen, herstart
dan gewoon. Wanneer u aan de &quot;boot&gt;&quot; prompt bent gekomen, boot
dan met boot -c. Dit brengt u naar de UKC&gt;, doe vervolgens:

<blockquote><pre>
UKC&gt; <strong>verbose</strong>
autoconf verbose enabled
UKC&gt; <strong>quit</strong>
</pre></blockquote>

<p>
Nu zal u extreem uitvoerige uitvoer gegeven worden bij het booten.

<p>
<a name="config"></a>
<h2>5.7 - Uw kernel aanpassen met config(8)</h2>
<p>
De <b>-e</b> en <b>-u</b> opties van
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>
kunnen erg behulpzaam zijn en tijdsverspilling vermijden bij het compileren
van uw kernel. De <b>-e</b> vlag laat u toe om de UKC of User Kernel Config
binnen te gaan op een draaiend systeem. Deze veranderingen zullen dan
plaatsvinden bij de volgende reboot.
De <b>-u</b> vlag test om te zien of er tijdens het booten veranderingen
gedaan werden aan de draaiende kernel, wat betekent dat u <b>boot -c</b>
gebruikte om de UKC binnen te gaan tijdens het booten van uw systeem.

<p>
Het volgende voorbeeld toont het uitschakelen van de ep* devices in de
kernel. Voor de veiligheid moet u de <b>-o</b> optie gebruiken die de
veranderingen wegschrijft naar het aangegeven bestand. Bijvoorbeeld:
<strong>config -e -o bsd.new /bsd</strong> zal de veranderingen schrijven naar
bsd.new. Het voorbeeld gebruikt de <b>-o</b> optie niet, daarom worden
veranderingen gewoon genegeeerd, en niet teruggeschreven naar de kernel binary.
Voor meer informatie relevant voor fout- en waarschuwingsboodschappen, leest u
de 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>
man pagina.

<blockquote><pre>
$ <strong>sudo config -e /bsd</strong>
OpenBSD 3.6 (GENERIC) #59: Fri Sep 17 12:32:57 MDT 2004
    deraadt@i386.openbsd.org:/usr/src/sys/arch/i386/compile/GENERIC
warning: no output file specified
Enter 'help' for information
ukc&gt; ?
        help                            Command help list
        add         dev                 Add a device
        base        8|10|16             Base on large numbers
        change      devno|dev           Change device
        disable     attr val|devno|dev  Disable device
        enable      attr val|devno|dev  Enable device
        find        devno|dev           Find device
        list                            List configuration
        lines       count               # of lines per page
        show        [attr [val]]        Show attribute
        exit                            Exit, without saving changes
        quit                            Quit, saving current changes
        timezone    [mins [dst]]        Show/change timezone
        nmbclust    [number]            Show/change NMBCLUSTERS
        cachepct    [number]            Show/change BUFCACHEPERCENT
        nkmempg     [number]            Show/change NKMEMPAGES
        shmseg      [number]            Show/change SHMSEG
        shmmaxpgs   [number]            Show/change SHMMAXPGS
ukc&gt; <strong>list</strong>
  0 audio* at sb0|sb*|gus0|pas0|sp0|ess*|wss0|wss*|ym*|eap*|eso*|sv*|neo*|cmpci*
|clcs*|clct*|auich*|autri*|auvia*|fms*|uaudio*|maestro*|esa*|yds*|emu* flags 0x0
  1 midi* at sb0|sb*|opl*|opl*|opl*|opl*|ym*|mpu*|autri* flags 0x0
  2 nsphy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*
|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|e
p*|ep* phy -1 flags 0x0
  3 nsphyter* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|
vr*|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep
*|ep*|ep* phy -1 flags 0x0
  4 qsphy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*
|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|e
p*|ep* phy -1 flags 0x0
  5 inphy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*
|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|e
p*|ep* phy -1 flags 0x0
  6 iophy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*
|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|e
p*|ep* phy -1 flags 0x0
  7 eephy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*
|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|e
p*|ep* phy -1 flags 0x0
  8 exphy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*
|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|e
p*|ep* phy -1 flags 0x0
[...snip...]
ukc&gt; <strong>disable ep</strong>
 67 ep0 disabled
 68 ep* disabled
 69 ep* disabled
155 ep0 disabled
156 ep0 disabled
157 ep* disabled
158 ep* disabled
210 ep* disabled
ukc&gt; <strong>quit</strong>
not forced
</pre></blockquote>

<p>
In het bovenstaande voorbeeld worden alle ep* devices uitgeschakeld in de
kernel en ze zullen niet gezocht worden. In sommige situaties waarbij u
tijdens het booten de UKC gebruikt hebt, via <b>boot -c</b>, zal u deze
veranderingen permanent moeten wegschrijven. Om dit te doen moet u de
<b>-u</b> optie gebruiken.
In het volgende voorbeeld werd de computer geboot naar de UKC en werd het
wi(4) device uitgeschakeld. Aangezien veranderingen gemaakt met boot -c
NIET blijvend zijn, moeten deze veranderingen weggeschreven worden.
Dit voorbeeld schrijft de veranderingen gemaakt met boot -c naar een
nieuwe kernel binary bsd.new.

<blockquote><pre>
$ <strong>sudo config -e -u -o bsd.new /bsd</strong>
OpenBSD 3.6 (GENERIC) #59: Fri Sep 17 12:32:57 MDT 2004
    deraadt@i386.openbsd.org:/usr/src/sys/arch/i386/compile/GENERIC
Processing history...
105 wi* disabled
106 wi* disabled
Enter 'help' for information
ukc&gt; <strong>quit</strong>
</pre></blockquote>

<p>
<a name="buildprobs"></a>
<h2>5.8 - Vaak voorkomende Problemen bij het Compileren en Bouwen</h2>

<a name="sig11"></a>
<h3>5.8.1 - De build stopte met een "Signal 11" fout</h3>

<p>
OpenBSD en andere programma's vanaf broncode bouwen, is een taak die meer
van hardware vergt dan de meeste andere, het gebruikt intensief de CPU, de
schijf en het geheugen. Dit heeft als gevolg dat, indien u hardware hebt die
een probleem heeft, het meest waarschijnlijke moment waarop dit probleem zich
zal voordoen, gedurende een build is. Signal 11 fouten worden <i>typisch</i>
veroorzaakt door hardwareproblemen, heel vaak geheugenproblemen, maar het
kunnen ook problemen met CPU, moederbord of warmte zijn. Uw systeem kan
verder eigenlijk heel stabiel zijn, maar het kan geen programma's compileren.

<p>
U zal het waarschijnlijk het best vinden om de componenten die problemen
veroorzaken, te vervangen, aangezien de problemen zich in de toekomst op andere
manieren kunnen manifesteren. Als u hardware hebt die u echt wenst te
gebruiken en die u geen andere problemen geeft, installeer dan gewoon een
snapshot of een release.

<p>
Voor veel meer informatie, zie de
<a href="http://www.bitwizard.nl/sig11/">Sig11 FAQ</a>.

<a name="snake"></a>
<h3>5.8.2 - "make build" mislukt met "cannot open output file snake: is
a directory"</h3>

Dit is het resultaat van twee afzonderlijke fouten:
<ul>
<li><b>Het niet juist afhalen of updaten van uw CVS tree.</b>  Wanneer u
een CVS checkout handeling doet, moet u de "<tt>-P</tt>" optie gebruiken,
bij een update van uw source tree met CVS moet u de "<tt>-Pd</tt>"
opties van
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1"
>cvs(1)</a> gebruiken,
zoals gedocumenteerd in de <a href="../../nl/anoncvs.html">anoncvs gids</a>, de
<a href="../upgrade-minifaq.html">upgrade-minifaq</a> en de
<a href="faq8.html#CVS">FAQ</a>.  Deze opties zorgen ervoor dat nieuwe
directories worden toegevoegd aan en verwijderd uit de tree naarmate
OpenBSD evolueert.

<li><b>U hebt de <tt>obj</tt> directory niet juist aangemaakt
vóór uw build.</b>  De tree bouwen zonder een <tt>/usr/obj</tt>
directory wordt niet ondersteund.

</ul>
Het is belangrijk om nauwkeurig de instructies te volgen bij het
<a href="../../nl/anoncvs.html">afhalen en updaten</a> van uw broncode en het
<a href="../upgrade-minifaq.html">bouwen</a> van uw tree.

<a name="BldRelease"></a>
<h2>5.9 - Hoe bouw ik een OpenBSD release?</h2>
Na het ter plaatse bouwen van uw systeem, kan u de OpenBSD
<a href="faq4.html#FilesNeeded">bestandensets</a> aanmaken die gebruikt
kunnen worden om uw systeem op een andere computer te installeren.

<p>
Dit wordt nauwkeurig uitgelegd in
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=release&amp;sektion=8">release(8)</a>


<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
<a href= "faq4.html">[Naar Sectie 4 - Installatiegids]</a>
<a href= "faq6.html">[Naar Sectie 6 - Netwerken]</a>
</font>

<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../../images/back.gif" border= "0" alt= "[terug]"></a>
<a href= "mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
Originally [OpenBSD: faq5.html,v 1.99 ]<br>
$Translation: faq5.html,v 1.2 2005/01/21 19:54:59 smestdag Exp $<br>
$OpenBSD: faq5.html,v 1.2 2005/01/22 12:13:43 jufi Exp $
</small>
</body>
</html>

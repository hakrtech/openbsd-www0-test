<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>OpenBSD -current changes</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta name="resource-type" content="document">
<meta name="description" content="OpenBSD -current changes">
<meta name="keywords" content="openbsd,changes">
<meta name="distribution" content="global">
<meta name="copyright" content="This document copyright 1996-2012 by OpenBSD.">
</head>

<body bgcolor="#ffffff" text="#000000" link="#23238e">

<a href="index.html"><img alt="[OpenBSD]" height="30" width="141" src="images/smalltitle.gif" border="0"></a>
<p>
<h2><font color="#e00000">OpenBSD -current changelog</font></h2>
<hr>

<p>
This is a partial list of the major machine-independent changes
(i.e., these are the changes people ask about most often).  Machine
specific changes have also been made, and are sometimes mentioned
in the pages for the specific <a href="plat.html">platforms</a>.

<p>
Note: <font color="#e00000">Problems for which patches exist are marked in red</font>.

<p>
<h3>
For changes in other releases, click below:<br>
<a href="plus20.html">2.0</a>,
<a href="plus21.html">2.1</a>,
<a href="plus22.html">2.2</a>,
<a href="plus23.html">2.3</a>,
<a href="plus24.html">2.4</a>,
<a href="plus25.html">2.5</a>,
<a href="plus26.html">2.6</a>,
<a href="plus27.html">2.7</a>,
<a href="plus28.html">2.8</a>,
<a href="plus29.html">2.9</a>,
<a href="plus30.html">3.0</a>,
<a href="plus31.html">3.1</a>,
<a href="plus32.html">3.2</a>,
<a href="plus33.html">3.3</a>,
<a href="plus34.html">3.4</a>,
<a href="plus35.html">3.5</a>,
<a href="plus36.html">3.6</a>,
<br>
<a href="plus37.html">3.7</a>,
<a href="plus38.html">3.8</a>,
<a href="plus39.html">3.9</a>,
<a href="plus40.html">4.0</a>,
<a href="plus41.html">4.1</a>,
<a href="plus42.html">4.2</a>,
<a href="plus43.html">4.3</a>,
<a href="plus44.html">4.4</a>,
<a href="plus45.html">4.5</a>,
<a href="plus46.html">4.6</a>,
<a href="plus47.html">4.7</a>,
<a href="plus48.html">4.8</a>,
<a href="plus49.html">4.9</a>,
<a href="plus50.html">5.0</a>,
<a href="plus51.html">5.1</a>.
<br>
</h3>

<p>
<h3><font color="#0000e0">Changes made between OpenBSD 5.1 and -current</font></h3><p>
<p>

<ul>
<!-- 2012/02/26 -->
<li>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mandoc&manpath=OpenBSD%20Current&sektion=1&format=html">mandoc(1)</a> program now replaces bogus characters with <code>?</code> instead of just dropping them.
<li>In <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=man&manpath=OpenBSD%20Current&sektion=7&format=html">man(7)</a>, support the <code>.OP</code> macro (for compatibility only).
<li>On the mips64 and sh platforms the per-thread errno should be fixed.
<li>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ix&manpath=OpenBSD%20Current&sektion=4&format=html">ix(4)</a> interrupt routine uses a shorter path to reenable interrupts and gains other tweaks which result in a doubled performance on 82599.
<!-- 2012/02/25 -->
<li>In the <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gus&manpath=OpenBSD%20Current&sektion=4&arch=i386&format=html">gus(4/i386)</a> driver MIDI registers will only be used if they are actually available. This fixes an issue which caused the driver to be disabled on 1999-08-22, but the happy-end can finally be seen in i386 GENERIC.
<li>For the <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=elroy&manpath=OpenBSD%20Current&sektion=4&arch=hppa&format=html">elroy(4/hppa)</a> driver an integer truncation error is fixed which caused systems to freeze hard.
<li>The process tracing facilities will work again on processors without floating-point registers/state. (Had been broken by the large extension of the 20th.)
<li>In <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tmux&manpath=OpenBSD%20Current&sektion=1&format=html">tmux(1)</a> the <code>show-options</code> and <code>window-show-options</code> commands can now be used to show just a single specified option.
<li>Minor tweaks and cleanups in the amd64 code of the kernel have been observed.
<!-- 2012/02/24 -->
<!-- 2012/02/23 -->
<li>pthread_yield(3) is renamed to sched_yield(3).
<li>Manual pages are created for the <code>pthread_condattr_t</code> type.
<li>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tmux&manpath=OpenBSD%20Current&sektion=1&format=html">tmux(1)</a> <code>display-message</code> command is extended by a <b>-F</b> option which can be used to specify a format string to control output formatting.
<li>New functions are added to the thread library: pthread_mutex_timedlock(3), pthread_condattr_getclock(3) and pthread_condattr_setclock(3); also, <code>PTHREAD_MUTEX_NORMAL</code> mutexes learn about self-deadlocks.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=snmpd&manpath=OpenBSD%20Current&sektion=8&format=html">snmpd(8)</a> gains the MIB module for gathering information from OpenBSD's packet filter.
<!-- 2012/02/22 -->
<li>In <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chroot&manpath=OpenBSD%20Current&sektion=2&format=html">chroot(2)</a> mode nginx(8) first <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chdir&manpath=OpenBSD%20Current&sektion=2&format=html">chdir(2)</a>s to the <code>PREFIX</code> directory before it starts to create it's temporary directories.
<!-- 2012/02/21 -->
<li>The pthread_suspend_np(3) and pthread_resume_np(3) function are no longer functional and become <code>ENOTSUP</code> stubs.
<!-- 2012/02/20 -->
<li>A lot of work is being done for making process tracing work with rthreads.
<li>In Xenocara, update xf86-video-geode 2.11.13 and xf86-video-dummy to 0.3.5.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=kdump&manpath=OpenBSD%20Current&sektion=1&format=html">kdump(1)</a> fixes an integer flip which could have happened for a kernel trace record with <code>ktr_len</code> of <code>SIZE_MAX</code> and would have caused a zero byte data allocation. It also learns more system calls and refactors output routines as well as the output produced by the latter.
<li>A lot of work is being done on regression tests for threads.
<!-- 2012/02/19 -->
<li>Bugfix in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tcpdump&manpath=OpenBSD%20Current&sektion=8&format=html">tcpdump(8)</a> to correctly check BGP prefix lengths in withdrawn routes.
<li>Fix return value documentation errors in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=usbhid&manpath=OpenBSD%20Current&sektion=3&format=html">usbhid(3)</a>.
<li>Allow for more vars in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&manpath=OpenBSD%20Current&sektion=1&format=html">ksh(1)</a> hash table, improve hash function, increase hash table size sooner.
<!-- 2012/02/18 -->
<li>Initialize the scope, policy, and inherit members in pthread_attr_init() so that their pthread_attr_get* don't return bogus values.
<li>Update nginx in base to 1.0.12 and sync its <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pcre&manpath=OpenBSD%20Current&sektion=3&format=html">pcre(3)</a> with the version in ports.
<li>Update to <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mkfontdir&manpath=OpenBSD%20Current&sektion=1&format=html">mkfontdir(1)</a> 1.0.7, <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mkfontscale&manpath=OpenBSD%20Current&sektion=1&format=html">mkfontscale(1)</a> 1.1.0, <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=oclock&manpath=OpenBSD%20Current&sektion=1&format=html">oclock(1)</a> 1.0.3, <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xclipboard&manpath=OpenBSD%20Current&sektion=1&format=html">xclipboard(1)</a> 1.1.2, <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xclock&manpath=OpenBSD%20Current&sektion=1&format=html">xclock(1)</a> 1.0.6, <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xcmsdb&manpath=OpenBSD%20Current&sektion=1&format=html">xcmsdb(1)</a> 1.0.4, <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xcompmgr&manpath=OpenBSD%20Current&sektion=1&format=html">xcompmgr(1)</a> 1.1.6, <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xfd&manpath=OpenBSD%20Current&sektion=1&format=html">xfd(1)</a> to 1.1.1 and util-macros to 1.16.1.
<!-- 2012/02/17 -->
<li>Add DIAGNOSTICS to <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bsd.port.mk&manpath=OpenBSD%20Current&sektion=5&format=html">bsd.port.mk(5)</a>, for easy grepping through logs, and no longer label "warning messages" as "errors".
<!-- 2012/02/16 -->
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkill&manpath=OpenBSD%20Current&sektion=1&format=html">pkill(1)</a> will now exit usage() with STATUS_BADUSAGE rather than STATUS_ERROR, in agreement with the man page.
<li>Set __isthreaded in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pthread_create&manpath=OpenBSD%20Current&sektion=3&format=html">pthread_create(3)</a>, i.e. even if a forked child creates a new thread. Fixes an rthread bug to properly represents whether a process is multi-threaded or not.
<li>Do an explicit "sync" instruction before returning from cache routines on mips64 (nop on R5k/RM52xx, but required on RM7k).
<li>Add <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=kevent&manpath=OpenBSD%20Current&sektion=2&format=html">kevent(2)</a> support for msdosfs to make applications monitoring fs mounts happy.
<!-- 2012/02/15 -->
<li>Enable rthreads by default (threads now in kernel not userspace), and add additional pthreads regression tests.
<li>Hold struct filedesc's fd_lock in more places. Fixes hangs in rthreaded processes calling <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fork&manpath=OpenBSD%20Current&sektion=2&format=html">fork(2)</a>.
<li>No longer attempt to enable MSI on 82571/82572 <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=em&manpath=OpenBSD%20Current&sektion=4&format=html">em(4)</a> Gigabit ethernet controllers (to workaround "Byte Enables 2 and 3 Are Not Set" hardware bug).
<!-- 2012/02/13 -->
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_create&manpath=OpenBSD%20Current&sektion=1&format=html">pkg_create(1)</a> now warns when <code>@option no-default-conflict</code> has been set without explicit <code>@conflict</code>.
</ul>
<p>

This list mentions mostly platform-independent changes.  For a list of changes
made in a particular platform, please check the page for that platform.  If you
find them not listed there, the changes are either (1) not being documented or
(2) are documented here.<br><br>

<hr>
<p>
<h3>
For changes in other releases, click below:<br>
<a href="plus20.html">2.0</a>,
<a href="plus21.html">2.1</a>,
<a href="plus22.html">2.2</a>,
<a href="plus23.html">2.3</a>,
<a href="plus24.html">2.4</a>,
<a href="plus25.html">2.5</a>,
<a href="plus26.html">2.6</a>,
<a href="plus27.html">2.7</a>,
<a href="plus28.html">2.8</a>,
<a href="plus29.html">2.9</a>,
<a href="plus30.html">3.0</a>,
<a href="plus31.html">3.1</a>,
<a href="plus32.html">3.2</a>,
<a href="plus33.html">3.3</a>,
<a href="plus34.html">3.4</a>,
<a href="plus35.html">3.5</a>,
<a href="plus36.html">3.6</a>,
<br>
<a href="plus37.html">3.7</a>,
<a href="plus38.html">3.8</a>,
<a href="plus39.html">3.9</a>,
<a href="plus40.html">4.0</a>,
<a href="plus41.html">4.1</a>,
<a href="plus42.html">4.2</a>,
<a href="plus43.html">4.3</a>,
<a href="plus44.html">4.4</a>,
<a href="plus45.html">4.5</a>,
<a href="plus46.html">4.6</a>,
<a href="plus47.html">4.7</a>,
<a href="plus48.html">4.8</a>,
<a href="plus49.html">4.9</a>,
<a href="plus50.html">5.0</a>,
<a href="plus51.html">5.1</a>.
<br>
</h3>

<hr>
<a href="index.html"><img height=24 width=24 src="back.gif" border=0 alt="OpenBSD"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br><small>$OpenBSD: plus.html,v 1.1214 2012/02/27 23:01:53 schwarze Exp $</small>

</body>
</html>

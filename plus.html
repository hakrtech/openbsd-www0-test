<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>OpenBSD-current changes</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta name="resource-type" content="document">
<meta name="description" content="OpenBSD-current changes">
<meta name="keywords" content="openbsd,current,changes">
<meta name="distribution" content="global">
<meta name="copyright" content="This document copyright 1996-2006 by OpenBSD.">
</head>

<body bgcolor="#ffffff" text="#000000" link="#23238e">

<a href="index.html"><img alt="[OpenBSD]" height="30" width="141" src="images/smalltitle.gif" border="0"></a>
<p>
<h2><font color="#e00000">Changes made between OpenBSD 4.0 and OpenBSD-current</font></h2>
<hr>

<p>
This is a partial list of the major machine-independent changes
(i.e., these are the changes people ask about most often).  Port
specific changes have also been made, and are sometimes mentioned
in the pages for the specific <a href="plat.html">platforms</a>.

<p>
There is a separate <a href="portsplus/index.html">list of Changes to the ports collection</a>.

<p>
Note: <font color="#e00000">Problems for which patches exist are marked in red</font>.

<p>
<h3>
For changes in other releases, click below:<br>
<a href="plus20.html">2.0</a>,
<a href="plus21.html">2.1</a>,
<a href="plus22.html">2.2</a>,
<a href="plus23.html">2.3</a>,
<a href="plus24.html">2.4</a>,
<a href="plus25.html">2.5</a>,
<a href="plus26.html">2.6</a>,
<a href="plus27.html">2.7</a>,
<a href="plus28.html">2.8</a>,
<a href="plus29.html">2.9</a>,
<a href="plus30.html">3.0</a>,
<a href="plus31.html">3.1</a>,
<a href="plus32.html">3.2</a>,
<a href="plus33.html">3.3</a>,
<a href="plus34.html">3.4</a>,
<a href="plus35.html">3.5</a>,
<a href="plus36.html">3.6</a>,
<a href="plus37.html">3.7</a>,
<a href="plus38.html">3.8</a>,
<a href="plus39.html">3.9</a>,
<a href="plus40.html">4.0</a>.
<br>
</h3>

<p>
<h3><font color="#0000e0">We are working on OpenBSD-current.</font></h3><p>
<p>

<ul>
<!-- 2006/11/07 -->
<li>Make <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sk&sektion=4&format=html">sk(4)</a> XMAC work on big-endian systems too.
<li>Add support for Decision Computer multiport serial cards in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=puc&sektion=4&format=html">puc(4)</a>.
<li>Fix sigmask handling bug for landisk platform that caused SIGCHLD to be almost always masked.
<li>Various fixes for <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=em&sektion=4&format=html">em(4)</a>.
<li>Add <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xmphy&sektion=4&format=html">xmphy(4)</a> to macppc GENERIC and RAMDISK kernels.
<li>Fix <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&sektion=1&format=html">dd(1)</a> so checks for seekability is done using isatty() instead.
<li>Various fixes for the landisk platform.
<li>Fixes for softdep mkdir syncing during pagedep flush.
<li>Correctly check for bad signature in the <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&sektion=1&format=html">ssh(1)</a> monitor, otherwise the monitor and unprivieged process can get out of sync.
<li>Add timecounters to the adm64 platform.
<!-- 2006/11/06 -->
<li>In <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&sektion=1&format=html">dd(1)</a>, fix skipping then reading from a tty.
<li>Add support in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ne&sektion=4&format=html">ne(4)</a> for AX88790 chipsets, and fix AX88796 waiting after sending a packet, since it seems to lack "remote DMA complete" bit in ISR.
<li>Fix in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&sektion=8&format=html">pfctl(8)</a> to unbreak <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&sektion=8&format=html">authpf(8)</a> by handling non-inline anchors separately.
<li>When stopping <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=malo&sektion=4&format=html">malo(4)</a> devices, also reset the TX ring.
<li>Correction in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=trek&sektion=6&format=html">trek(6)</a> where signed char fixes prevents infinite loops.
<li>For vax, do not let memset() behave as bzero() for lengths over 64KB.
<li>In <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&sektion=1&format=html">ssh(1)</a>, add missing checks for OpenSSL return codes.
<li>Fixes for HPPA savecore.
<li>Initial import of MFM controller code for Vax VS2000 and some VS3100, enabled in GENERIC and RAMDISK kernels.
<li>For <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tip&sektion=1&format=html">tip(1)</a>, replace -### with -s### for the speed string.
<li>Enable <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=malo&sektion=4&format=html">malo(4)</a> to transmit management frames. Fix/add firmware commands.
<li>Landisk/SuperH platform switched back to softfloat code generation for now.
<li>bgpd(8) would announce restart capabilities when announcing refresh capabilities. Fixed.
<li>Force a new sensor task to be run as soon as possible in order to collect early values instead of waiting for the first timeout.
<li>Make USB <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=wi&sektion=4&format=html">wi(4)</a> adapters not advertise themselves as supported hostap devices.
<li>In <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vic&sektion=4&format=html">vic(4)</a>, set the RX filters after setting the shared data address. Fixes a crash of the VMWare host when running an OpenBSD guest.
<!-- 2006/11/05 -->
<li>Add MCP67 SMBus controller to list of supported nviic(4Ö) devices.
<li>Sync <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=em&sektion=4&format=html">em(4)</a> to Intels 6.2.9 version. Adds support for a few newer Intel PCIe boards and a few bug fixes.
<li>Add <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gem&sektion=4&format=html">gem(4)</a> and <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gentbi&sektion=4&format=html">gentbi(4)</a> to amd64 and i386 GENERIC kernels.
<li>Endian fix in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&sektion=8&format=html">httpd(8)</a> for mod_proxy code.
<li>Add MCP67 PATA and SATA to the list of supported <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pciide&sektion=4&format=html">pciide(4)</a> devices.
<li>Add NVidia MCP67 LAN to the list of supported <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=nfe&sektion=4&format=html">nfe(4)</a> devices.
<li>Add power state table for 1GHz VIA Eden 90nm 'Esther' CPUs.
<li>Do not enable hardware cursor on vax in the Brooktree DAC on the 8 bpp model.
<li>Wait two seconds after reset before probing for devices on vax, lets RX23 devices get detected again.
<li>Handle <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hil&sektion=4&format=html">hil(4)</a> loop reconfiguration in a kernel thread instead of doing it from interrupt context.
<!-- 2006/11/04 -->
<li>Do not let <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&sektion=8&format=html">pfctl(8)</a> open a transaction for a ruleset unless it is a brace expansion that contain rules.
<li>Fix a potential memory leak in libevent.
<li>Make <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=arc&sektion=4&format=html">arc(4)</a> query the firmware for the number of devices, and then iterate through them to get the right names for sensor creation.
<li>Fix a bug in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=awk&sektion=1&format=html">awk(1)</a> when converting a variable from numeric type to string.
<li>Fix in X11 for video playback in the Radeon driver for Mobility M6 based machines.
<!-- 2006/11/03 -->
<li>Add AL7230B to list of supported <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=zyd&sektion=4&format=html">zyd(4)</a> devices. Untested for now.
<li>In <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ripd&sektion=8&format=html">ripd(8)</a>, if the nexthop is not reachable through outgoing interface, set it to INADDR_ANY.
<!-- 2006/11/02 -->
<li>If the hardware does not say it can do scatter gather lists for tx on <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vic&sektion=4&format=html">vic(4)</a> devices, limit it to only one dma segment.
<li>Enable <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vic&sektion=4&format=html">vic(4)</a> on i386 GENERIC and RAMDISK kernels.
<li>Make <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=raidctl&sektion=8&format=html">raidctl(8)</a> error out when passed an empty string as device name.
<!-- 2006/11/01 -->
<li>Make the <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vic&sektion=4&format=html">vic(4)</a> driver set a tick up to check the link state every second.
<li>Add active cooling support to acpi.
<li>Fix <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vic&sektion=4&format=html">vic(4)</a> initialization so ifconfig up and down now work.
<li>Add German LK-[24]01 keyboard layout for vax platform.
<li>Have <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=zyd&sektion=4&format=html">zyd(4)</a> abort bulk-in and bulk-out pipes before freeing the RX/TX transfer lists.
<li>Fix firmware fatal errors on re-associations in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=wpi&sektion=4&format=html">wpi(4)</a>.
<li>In <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vic&sektion=4&format=html">vic(4)</a>, fix the TX path so it can use more than one scatter gather entry when sending the packet.
<!-- 2006/10/31 -->
<li>Fix range checking in the argument parser for <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&sektion=1&format=html">dd(1)</a>.
<li>Make <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vic&sektion=4&format=html">vic(4)</a> handle slightly short frames, such as those coming from VMWare.
<li>Add support in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsecctl&sektion=8&format=html">ipsecctl(8)</a> for aggressive mode.
<li>Make <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&sektion=8&format=html">pfctl(8)</a> allow a user to recursively print anchors, including those without reserved names if a trailing * is specified in the anchor name.
<li>Make <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&sektion=1&format=html">ssh(1)</a> check DH_compute_key() for -1 even though it should be valid due to earlier checks.
<li>In the TCP code, do not regenerate the timestamp modulation offset for SYN-ACK retransmits.
<li>Initial code for adding sensors to <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=arc&sektion=4&format=html">arc(4)</a> devices.
<li>Make pfsync devices to be cloned, but prevent more than one instance for now.
<li>In <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&sektion=5&format=html">pf.conf(5)</a> allow <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&sektion=8&format=html">pfctl(8)</a> ruleset optimizer to be controlled from within the ruleset, or optionally on the command-line.
<li>Fix infinite loop in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gcc&sektion=1&format=html">gcc(1)</a> for i386 code when passing objects with 3+ base classes by value.
<!-- 2006/10/30 -->
<li>Major work on the <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vic&sektion=4&format=html">vic(4)</a> driver. Closer to working now, but the TX code path still needs work.
<li>Added a timecounter based implementation of <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adjfreq&sektion=2&format=html">adjfreq(2)</a>.
<li>Fix dynamic tuning of the radio sensitivity on rt2661 based devices.
<li>On luna88k, have the primary CPU start the CMMU for secondary CPUs because secondary CPUs will run endless loops without cache otherwise.
<li>Change CMMU probing method on luna88k machines.
<!-- 2006/10/29 -->
<li>Fix in output of "show vnode" in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ddb&sektion=4&format=html">ddb(4)</a>.
<li>Plug a memory leak in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=talk&sektion=1&format=html">talk(1)</a>.
<li>Let <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ospfd&sektion=8&format=html">ospfd(8)</a> allow braces to fit on a single line if only one or no argument is used.
<li>In libc, make __dtoa() and strtod() thread safe.
<li>Fix in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=isakmpd&sektion=8&format=html">isakmpd(8)</a> TAILQ usage, preventing crashes.
<li>On amd64 and i386 platforms, make sure swap defaults to partition "b" on the same disk as root, not partition "b" on unit 0.
<li>Make landisk booting more reliable by disabling cache before jumping into the kernel.
<!-- 2006/10/28 -->
<li>In the NFS socket code, make sure nm_srtt and nm_sdrtt arrays are not initialized out of bounds.
<li>In <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ld.so&sektion=1&format=html">ld.so(1)</a>, only <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mprotect&sektion=2&format=html">mprotect(2)</a> pages during relocation if the library is marked TEXTREL.
<li>In <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&sektion=5&format=html">pf.conf(5)</a>, add support for anchors loaded inline., enclosed in a brace-delimited block.
<!-- 2006/10/27 -->
<li>On macppc, have <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gcc&sektion=1&format=html">gcc(1)</a> make stack executable when doing trampoline code.
<li>On vax, hide hardware cursor on 4 bpp gpx displays.
<li>For sparc machines, blank then screen immediately if the lid is closed during boot.
<li>In <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ntpd&sektion=8&format=html">ntpd(8)</a>, use clock_gettime(CLOCK_MONOTONIC,..) to get a monotonically increasing time, and make <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ntpd&sektion=8&format=html">ntpd(8)</a> use that to send the next query to an ntp peer.
<li>Make <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=udcf&sektion=4&format=html">udcf(4)</a> degrade the sensor status to WARNING on first error condition and to CRITICAL if valid time information comes within 15 minutes.
<li>Partially revert some of the macppc PCI range calculations, since it broke some newer machines.
<!-- 2006/10/26 -->
<li>Fix <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fxp&sektion=4&format=html">fxp(4)</a> so it will reset the link when you change speed.
<li>Have <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bgpd&sektion=8&format=html">bgpd(8)</a> store copies of everything needed to remove SAs and flows later. Allows for migration from tcp md5sig to ipsec esp ike with just bgpctl reload on both sides and bgpctl neighbor $foo clear on one side.
<li>Make sure <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bgpd&sektion=8&format=html">bgpd(8)</a> store SPIs for tcpmd5 outside the conf struct so it can clear old SAs when the session is restarted after a config reload.
<!-- 2006/10/25 -->
<li>Add support for AMD Geode LX security block. Currently only RNG, AES to be added later.
<li>Initial driver for MosChip MCS7703 based USB serial devices. No hardware flow control yet.
<li>Allow pflogd to listen on alternate pflog interfaces.
<li>On sparc64 USIII-based machines, make sure we flush the I-TLB from the primary context and not the secondary.
<li>Allow spamlogd to use an alternate pflog interface.
<!-- 2006/10/24 -->
<li>Fix localhost DoS when using oversized values with crypto devices.
<li>Fix for segfaults in pthreads code in _thread_kern_poll when descriptor is in closing state.
<li>Add code to allow up to 16 pflog interfaces, and add support in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&sektion=5&format=html">pf.conf(5)</a> to specify which interface to log certain lines to.
<li>Make a RAMDISK kernel image for the landisk platform.
<li>Fix RX DMA handling in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=malo&sektion=4&format=html">malo(4)</a> and make sure we reset the RX descriptor ring on ifconfig down/up.
<li>Add new trace function to <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ddb&sektion=4&format=html">ddb(4)</a>, "machine acpi trace" so users can send useful traces without enabling acpi debug.
<li>Improvements in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ntpd&sektion=8&format=html">ntpd(8)</a> when updating from timedelta sensors.
<!-- 2006/10/23 -->
<li>Fix a crash in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=as&sektion=1&format=html">as(1)</a> when using --statistics.
<li>Build rthreads by default for easy testing.
<li>Reworked <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=malloc&sektion=3&format=html">malloc(3)</a> to keep pginfo and pgfree structs away from application memory by using special allocators for those instead of imalloc. For chunks, return randomly from a short list of recently freed chunk.
<li>Make the pflog interface cloneable.
<!-- 2006/10/22 -->
<li>Add Sundance TC9021 to list of supported <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=stge&sektion=4&format=html">stge(4)</a> devices.
<li>Fixes for PCI configuration on old-world macppc machines with non-contiguous PCI memory spaces.
<li>Make <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bge&sektion=4&format=html">bge(4)</a> recognize BCM5715 A3-based devices.
<li>Fix colormap in 4bpp mode on vax gpx displays.
<li>Make <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=zyd&sektion=4&format=html">zyd(4)</a> devices blink the LED on transmit.
<li>"Bogus xmit rate" panic fixed for <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rum&sektion=4&format=html">rum(4)</a> too.
<li>Replace rate control code in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ral&sektion=4&format=html">ral(4)</a>, should also fix "bogus xmit rate" panics in HostAP mode.
<li>Make <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=zyd&sektion=4&format=html">zyd(4)</a> handle per-node rate control
<li>Add Edimax EW-7318USG to the list of supported <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rum&sektion=4&format=html">rum(4)</a> devices.
<li>Fixes for rate handling in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=iwi&sektion=4&format=html">iwi(4)</a>.
<!-- 2006/10/21 -->
<li>Fix RX handling in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=malo&sektion=4&format=html">malo(4)</a> devices, now can receive management frames.
<li>Make sure <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bnx&sektion=4&format=html">bnx(4)</a> keeps at least 16 TX descriptors unused, and handle TX loads problems better.
<li>Enable <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=zyd&sektion=4&format=html">zyd(4)</a> on i386 and amd64 GENERIC kernels.
<li>Major rework on <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=zyd&sektion=4&format=html">zyd(4)</a> to bring it into a working state. Should work with ZD1211 chipsets, though IBSS and HostAP modes does not work yet.
<li>Fixes for the client part of OpenNTPD.
<!-- 2006/10/20 -->
<li>Add ASIX 88190 to the list of supported <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ne&sektion=4&format=html">ne(4)</a> devices.
<li>More fixes for VFS softdep code.
<!-- 2006/10/19 -->
<li>Boot fixes for the landisk platform, now supports "boot -c".
<li>Reworked the TX path of <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bnx&sektion=4&format=html">bnx(4)</a> devices.
<li>Another fix for the wscons jump scrolling code which can occur if autowrapping is on and certain control characters are encountered.
<li>In the VFS layer, promote certain bdwrite calls to bawrite for some cases so they wont get deferred due to pending softdeps.
<li>Make <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pciide&sektion=4&format=html">pciide(4)</a> match the CS5536 IDE controller in AMD Geode LX-800-based system.
<li>Replace ACPI ioctls with APM ioctls, now <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=apmd&sektion=8&format=html">apmd(8)</a> can be forced to use /dev/acpi.
<!-- 2006/10/18 -->
<li>Various acpi fixes.
<li>In <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sort&sektion=1&format=html">sort(1)</a>, remove code that could cause a SEGV if a buffer is realloc()ed, instead allocate two buffers early.
<li>FPU detection fixes for AMD Geode LX-800-based machines.
<li>For the SGI platform, enable ipv6 on the RAMDISK image.
<li>Do not enable Geode watchdog if building small kernels.
<li>On <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gcc&sektion=1&format=html">gcc(1)</a> for alpha, do not force -msmall-data for -fpic and -mlarge-data for -fPIC. Makes -fpic and -fPIC equivalent, as wsa the case with gcc 2.x.
<li>Initial import of <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ripd&sektion=8&format=html">ripd(8)</a>, a routing daemon for the RIP protocol.
<li>Return ECONNABORTED when a non-blocking socket has been shutdown() for receives instead of returning EWOULDBLOCK, since that misleads applications to think accept() may eventually succeed. Corrects a pthreads deadlock.
<!-- 2006/10/17 -->
<li>Change the way <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=wd&sektion=4&format=html">wd(4)</a> calculates the number of cylinders on non-CPU_BIOS architectures.
<li>Disable firmware fastboot feature in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bge&sektion=4&format=html">bge(4)</a> for 5752/5755 and 5787 ASICS, eliminates firmware timeouts.
<li>Reset fixes for non-SC100 Geode cpus.
<li>Deadlock fixes in libpthread regarding _FD_LOCK.
<li>Make sure i386 and amd64 uses partition 'b' for swap, not just the first partition after root.
<li>Increase max <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&sektion=4&format=html">pf(4)</a> tag name size from 16 to 64 characters.
<!-- 2006/10/16 -->
<li>Make sure <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&sektion=4&format=html">pf(4)</a> doesn't set 'flags S/SA' on stateless rules.
<li>In <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=re&sektion=4&format=html">re(4)</a>, fix for watchdog timeouts experienced with some RealTek adapters.
<li>In <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ps&sektion=1&format=html">ps(1)</a>, make the session field 8 chars for 32-bit cpus and 16 chars for 64-bit cpus since it is a pointer. Also, left-justify the state field name to match the state data.
<li>Use 64 bit daddr_t for logical blocks in the file system layer too.
<!-- 2006/10/15 -->
<li>Initial import of <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=malo&sektion=4&format=html">malo(4)</a> code, a new driver for the Marvell Libertas chips.
<li>Remove a potential race in ftp-proxy(8) by closing file descriptors before cleaning up events.
<li>For <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gem&sektion=4&format=html">gem(4)</a>, get MAC address from VPD, like we do for <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hme&sektion=4&format=html">hme(4)</a>.
<li>Add BCM5787 A2 to the list of supported <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bge&sektion=4&format=html">bge(4)</a> devices.
<!-- 2006/10/14 -->
<li>Enable <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bce&sektion=4&format=html">bce(4)</a> on amd64 GENERIC and RAMDISK kernels.
<li>Also add cross-compiling hints to crunchgen to allow for a different obj/ directory.
<li>Fixes to allow cross-compiling of <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=less&sektion=1&format=html">less(1)</a>.
<!-- 2006/10/13 -->
<li>New checks in ACPI code for Embedded Controllers, should be detected correctly now.
<li>Fix for <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ath&sektion=4&format=html">ath(4)</a> reset procedure of single-chip variants. Should make AR5424 PCIe chipsets work.
<li>Fix kernel page fault in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pgt&sektion=4&format=html">pgt(4)</a> when the device gets detached after the firmware failed to load.
<li>In <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=lynx&sektion=1&format=html">lynx(1)</a>, add checks for mkdtemp() failure, prevents segfaults when TMP or TMPDIR environment variables are set to non-existent directories.
<!-- 2006/10/12 -->
<li>Massive ACPI changes.
<!-- 2006/10/11 -->
<li>Make <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=file&sektion=1&format=html">file(1)</a> recognize OpenBSD/sh binaries too.
<li>Fix a potential null dereference, and a memory leak in the <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pgt&sektion=4&format=html">pgt(4)</a> error path.
<li>Make sure <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&sektion=1&format=html">ssh(1)</a> exits instead of doing a blocking tcp send if we detect a client/server timeout, since the tcp sendqueue might be full of alive requests.
<li>Fixes for SIGCONT, may be sent to any process with the same session ID as the caller, not to any process that is a descendant of the current process.
<li>Add <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=udcf&sektion=4&format=html">udcf(4)</a> to amd64 GENERIC.
<li>Implemented the IP_MINTTL tcp socket option.
<li>Implemented the IP_RECVTTL socket option for raw or udp sockets.
<!-- 2006/10/10 -->
<li>In <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&sektion=5&format=html">pf.conf(5)</a>, allow the 'quick' keyword on an anchor.
<li>Various fixes for <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xge&sektion=4&format=html">xge(4)</a>.
<li>Revert firmware synchronization change in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bge&sektion=4&format=html">bge(4)</a>, since breaks dual-port cards.
<li>Make <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&sektion=1&format=html">ssh(1)</a> sleep before retrying, not after, since sleeping affects errno.
<!-- 2006/10/09 -->
<li>Stop spoofing NetBSD/FreeBSD MBR partitions as the 'a' partition in a disklabel when no OpenBSD partition is found.
<li>Fixes in the delay routines for dp8390-based devices on fast machines.
<li>Add powerhooks to the <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pgt&sektion=4&format=html">pgt(4)</a> driver.
<!-- 2006/10/08 -->
<li>Fix glitch in jump scroll code for wscons vt100 emulation.
<li>SuperH additions to <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ld&sektion=1&format=html">ld(1)</a> and <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=as&sektion=1&format=html">as(1)</a> in binutils.
<li>Fixes for linux emulation regarding linux_sys_waitpid() calls.
<!-- 2006/10/07 -->
<li>Add PCI Express Fibre Channel FC949E to the list of supported <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mpi&sektion=4&format=html">mpi(4)</a> devices.
<li>Fix for macppc <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mc&sektion=4&arch=macppc&format=html">mc(4)</a> by using the "Enforce in-order Execution" to stop it from crashing under heavy load.
<li>Make cd-roms retry forever while the device indicates that it is becoming ready, in the same way it was done for tapes in st.c.
<!-- 2006/10/06 -->
<li>Enable <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pgt&sektion=4&format=html">pgt(4)</a> on cardbus for the i386 and amd64 GENERIC kernels.
<li>Fix cardbus support for <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pgt&sektion=4&format=html">pgt(4)</a>.
<li>Initial import of the SuperH-based landisk platform.
<li>Various binutils and <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gcc&sektion=1&format=html">gcc(1)</a> additions to handle 32-bit SuperH cpus.
<li>In <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&sektion=5&format=html">pf.conf(5)</a>, make 'flags S/SA keep state' the implicit default for filter rules.
<!-- 2006/10/05 -->
<li><font color="#e00000"><strong>SECURITY FIX: Integer overflow in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=systrace&amp;sektion=4">systrace(4)</a>'s STRIOCREPLACE support. This could be exploited for DoS, limited kmem reads or local privilege escalation.</strong></font><br><a href="errata.html#systrace">A source code patch is available</a>.<br><a href="stable.html"><font color="#00b000">[Applied to stable]</font></a>
<li>Update OpenSSH to 4.4.
<li>Always allow read-only opens on (s)vnd devices, despite the type of the first open (svnd vs vnd).
<!-- 2006/10/04 -->
<li>Add <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mc&sektion=4&arch=macppc&format=html">mc(4)</a> driver for AMD AM79C940 (MACE) ethernet chip to macppc.
<li>Make sure bufcache calculation on i386 does not take memory above 4g into account since it wont be used anyhow.
<li>Fix for <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=write&sektion=1&format=html">write(1)</a> to handle cases where the utmp file is missing.
<li>Fixes for <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pci&sektion=4&format=html">pci(4)</a> where unit numbers do not match PCI Bus number.
<li><font color="#e00000"><strong>SECURITY FIX: Several problems have been found in OpenSSL. While parsing certain invalid ASN.1 structures an error condition is mishandled, possibly resulting in an infinite loop. A buffer overflow exists in the SSL_get_shared_ciphers function. A NULL pointer may be dereferenced in the SSL version 2 client code. In addition, many applications using OpenSSL do not perform any validation of the lengths of public keys being used.</strong></font><br>
<a href="errata.html#openssl2">A source code patch is available</a>.<br>
<a href="stable.html"><font color="#00b000">[Applied to stable]</font></a>
<!-- 2006/10/03 -->
<li>Use 64 bit daddr type for physical block numbers in the filesystem code.
<li>Enable altq on <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=acx&sektion=4&format=html">acx(4)</a> devices.
<li>Altq fixes for <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pgt&sektion=4&format=html">pgt(4)</a>, <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vge&sektion=4&format=html">vge(4)</a> and <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=axe&sektion=4&format=html">axe(4)</a> based devices.
<!-- 2006/10/02 -->
<li>Fixes for libpthread regarding dup2() and _thread_fd_table_init() return values.
<li>Add ServerWorks PCIe bridge ids to pcidevs.
<!-- 2006/10/01 -->
<li>OpenBSD/cats platform now discontinued.
<li>Switch i386 fpu control too, i386 also has proper "long double" support now.
<li>Initial code for 88E3082 Fast Ethernet PHY. Untested at the moment.
<li>Switch amd64 fpu control word to hardware default, makes us use 64-bit precision instead of 53-bit, giving us proper support for "long double".
<li>Make sure SAF/TE and SES free their sensors on detach.
<!-- 2006/09/30 -->
<li>Small fixes for running <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=nm&sektion=1&format=html">nm(1)</a> on ELF binaries.
<!-- 2006/09/29 -->
<li>Improved CPU signature detection in the powernow K7 code.
<li>Various small fixes in the <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=re&sektion=4&format=html">re(4)</a>.
<li>Make sure rtl81x9 code discards packets in the receive handler if they are too short or too large.
<li>Small fix for powerpc pthread stack allocation code.
<li>Add support for HenTong WK-668 to list of supported <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=udav&sektion=4&format=html">udav(4)</a> devices.
<!-- 2006/09/28 -->
<li>Make sure rtl81x9 code free the mbuf chain on certain failures.
<li>Tree search speedup in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostapd&sektion=8&format=html">hostapd(8)</a> via inlined compare function.
<li>Fix <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostapd&sektion=8&format=html">hostapd(8)</a> parser for event rules and handling of multiple matches of the "not" grammar rule.
<!-- 2006/09/27 -->
<li>Add cardbus support for <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pgt&sektion=4&format=html">pgt(4)</a>.
<li>Add <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=uath&sektion=4&format=html">uath(4)</a> to sparc64 GENERIC. Almost works.
<li>Add <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=an&sektion=4&format=html">an(4)</a>, <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=atw&sektion=4&format=html">atw(4)</a>, <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=auth&sektion=4&format=html">auth(4)</a> and <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=wi&sektion=4&format=html">wi(4)</a> to alpha GENERIC.
<li>Add <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifstated&sektion=8&format=html">ifstated(8)</a> to rc startup bits.
<li>Enable <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=uath&sektion=4&format=html">uath(4)</a> on amd64.
<li>Fix in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ospfd&sektion=8&format=html">ospfd(8)</a> to better detect on which interface incoming OSPF packets arrived.
<!-- 2006/09/26 -->
<li>Add <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=uow&sektion=4&format=html">uow(4)</a> 1-Wire support to all USB-capable arches.
<li>Add <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pgt&sektion=4&format=html">pgt(4)</a> and <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=acx&sektion=4&format=html">acx(4)</a> to sparc64 GENERIC too.
<li>Plug memory leak in OpenRCS diff code.
<li>Add <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=acx&sektion=4&format=html">acx(4)</a> to alpha GENERIC kernels.
<li>Switch alpha to gcc3.
<li>Initial support for HostAP mode on <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pgt&sektion=4&format=html">pgt(4)</a>.
<li>Make sure port number 664 isn't used since packets might get stolen by IPMI/asf.
<li>Reduce number of unsafe signal operations in the X server logging functions.
<li>In <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=grep&sektion=1&format=html">grep(1)</a>, allow zero-length patterns with -x.
<li>Make pthreads allocate stack using mmap instead of malloc.
<li>More of the fd race and deadlock corrections in pthread code.
<li>Make sure <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bge&sektion=4&format=html">bge(4)</a> does not allocate jumbo buffers and also does not allow reception of large frames until mtu is set to higher value. 
<li>On <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=acx&sektion=4&format=html">acx(4)</a>, make HostAP mode work, and fix IBSS tweaks.
<li>Add ELECOM LD-USB20 to list of supported <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=aue&sektion=4&format=html">aue(4)</a> devices.
<li>Endian fix for ISO chksum in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dvmrpd&sektion=8&format=html">dvmrpd(8)</a>.
<li>Fix races in FFS code which may violate softdep processing and create inconsistant on-disk ffs state and absuse kmem aswell.
<!-- 2006/09/25 -->
<li>Fix in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&sektion=8&format=html">httpd(8)</a> for error response to unsupported Expect: header.
<li>Fix for the shutdown hooks on <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=arc&sektion=4&format=html">arc(4)</a> so it syncs correctly.
<!-- 2006/09/24 -->
<li>Make <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=nc&sektion=1&format=html">nc(1)</a> also accept "HTTP/1.1 200" as a success response.
<li>In ld.so, fill in the list of loaded segments for the main executable so we can unprotect them if needed for binaries that have TEXTREL set.
<li>Add <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pgt&sektion=4&format=html">pgt(4)</a> to alpha GENERIC kernels.
<!-- 2006/09/23 -->
<li>Add TRENDnet TEW-429UB A to list of supported <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=zyd&sektion=4&format=html">zyd(4)</a> devices.
<!-- 2006/09/22 -->
<li>Make sure sparc64 can dump memory above 4GB.
<li>Fixes for file descriptor races and deadlocks in the pthread code.
<li>Add support for Marvell Yukon 88E8056 to <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=msk&sektion=4&format=html">msk(4)</a>.
<!-- 2006/09/21 -->
<li>Add support for hot plugging <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mpi&sektion=4&format=html">mpi(4)</a> SAS devices, but disabled for now.
<li>In OpenRCS, add support for all other diff flags that are pertinent to files, and do not conflict with rcsdiff-specific flags.
<li>Make libXpm more robust when parsing XPM files with unterminated comments in them.
<li>Make the wsfb driver inform the X server that is does not require direct access to the hardware.
<li>Make sure the SCSI midlayer frees the scsi_link struct on detach now that hotplugging of controllers is possible.
<!-- 2006/09/20 -->
<li>Fix the way delays between retransmissions are calculated in NFS when receiving NFSERR_TRYLATER from the server.
<li>Fix memory leak in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=top&sektion=1&format=html">top(1)</a>.
<li>Implement zero-copy RX data path for <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=uath&sektion=4&format=html">uath(4)</a> devices.
<li>Corrected SpeedStep table for Pentium M 770.
<li>Make <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vnd&sektion=4&format=html">vnd(4)</a> work on read-only file systems.
<!-- 2006/09/19 -->
<li>Enable <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pgt&sektion=4&format=html">pgt(4)</a> on amd64 GENERIC kernels.
<li>Enable AR2413, 5413 and 5424 based devices.
<li>In <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tcpdump&sektion=8&format=html">tcpdump(8)</a>, enable ESP and AH dissectors over IPv6.
<li>Disable 802.11g mode on AR5211 and 5212 based devices for now.
<!-- 2006/09/18 -->
<li>Fixes for <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=re&sektion=4&format=html">re(4)</a> on cardbus, for kernel faults on halt/reboot.
<li>The macppc platform extended .text and .data segments to 64MB, allowing programs with large .text segments to run.
<!-- 2006/09/17 -->
<li>Re-add Dell PHY LED setup workaround and Jumbo capability flag on <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bge&sektion=4&format=html">bge(4)</a>.
<li>Various fixes in the RX path for <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=em&sektion=4&format=html">em(4)</a> devices regarding mbuf cluster allocations, updating status bits in RX descriptors and DMA map unloading on errors.
<li>Re-add <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=re&sektion=4&format=html">re(4)</a> link state check, as a workaround for a link state issue found on 8139C+ chips.
<li>Alignment fixes for <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=em&sektion=4&format=html">em(4)</a> when doing VLAN and jumbo frames together.
<li>Fixes for bge_reset() in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bge&sektion=4&format=html">bge(4)</a>, eliminates firmware timeouts for the BCM5752.
<li>Make <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rdate&sektion=8&format=html">rdate(8)</a> ignore ntp responses with ALARM status.
<li>Defer the establishment of interrupts on <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bge&sektion=4&format=html">bge(4)</a> until later during attach. Fixes panic on some systems running non-MP kernels.
</ul>
<p>

This list mentions mostly platform-independent changes.  For a list of changes
made in a particular platform, please check the page for that platform.  If you
find them not listed there, the changes are either (1) not being documented or
(2) are documented here.<br><br>

<hr>
<p>
<h3>
For changes in other releases, click below:<br>
<a href="plus20.html">2.0</a>,
<a href="plus21.html">2.1</a>,
<a href="plus22.html">2.2</a>,
<a href="plus23.html">2.3</a>,
<a href="plus24.html">2.4</a>,
<a href="plus25.html">2.5</a>,
<a href="plus26.html">2.6</a>,
<a href="plus27.html">2.7</a>,
<a href="plus28.html">2.8</a>,
<a href="plus29.html">2.9</a>,
<a href="plus30.html">3.0</a>,
<a href="plus31.html">3.1</a>,
<a href="plus32.html">3.2</a>,
<a href="plus33.html">3.3</a>,
<a href="plus34.html">3.4</a>,
<a href="plus35.html">3.5</a>,
<a href="plus36.html">3.6</a>,
<a href="plus37.html">3.7</a>.
<a href="plus38.html">3.8</a>,
<a href="plus39.html">3.9</a>,
<a href="plus40.html">4.0</a>.
<br>
</h3>

<hr>
<a href="index.html"><img height=24 width=24 src="back.gif" border=0 alt="OpenBSD"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br><small>$OpenBSD: plus.html,v 1.1031 2006/12/14 16:59:45 pvalchev Exp $</small>

</body>
</html>

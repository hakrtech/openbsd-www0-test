<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>OpenBSD 4.0 发行版本</title>
  <link rev="made" href="mailto:www@openbsd.org">
  <meta name="resource-type" content="document">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="description" content="OpenBSD 4.0">
  <meta name="keywords" content="openbsd,main">
  <meta name="distribution" content="global">
  <meta name="copyright" content="This document copyright 2006 by OpenBSD.">
</head>

<body bgcolor="#ffffff" text="#000000" link="#24248E">
  <a href="index.html"><img alt="[OpenBSD]" height="30" width="141" hspace="24" src="../images/smalltitle.gif" border="0"></a>
  <hr>

  <p><a href="../images/Pufferix.jpg"><img align="left" width="227" height="343" hspace="24" vspace="30" src="../images/Pufferix.jpg" alt="OpenBSD 4.0 logo"></a>

  <h2><font color="#0000e0">OpenBSD 4.0 版本:</font></h2>

  <p>发布于2006年11月1日<br>
  Copyright 1997-2006, Theo de Raadt.<br>
  <font color="#e00000">ISBN 0-9731791-8-X</font><br>
  <a href="../lyrics.html#40">4.0 歌曲: "Humppa Negala"</a>
  <p>

  <a href="#new">新特性</a><br>
  <a href="#install">如何安装</a><br>
  <a href="#upgrade">如何升级</a><br>
  <a href="#ports">使用 ports 的方法</a><br>
  <a href="orders.html">购买 CD</a><br>

<p>
<h3><font color="#0000e0">如何得到此版本的文件:
<ul>
    <li>从我们的<a href="orders.html">订购系统</a>中订购。
    <li>从镜像站点的 <a href="ftp.html">FTP 页面</a> 中选择合适的镜像。
    <li>从镜像站点的 <font color="#e00000">pub/OpenBSD/4.0/</font> 目录中找寻相关的版本。
    <li>大致阅览本文件的接下来的部分。
    <li>阅读 <a href="errata40.html">4.0 勘误表</a>获得问题列表和背景。
    <li>阅读 3.9 与 4.0 之间的<a href="../plus40.html">详细修改记录</a>。
</ul>
</font></h3>
<br clear=all>

<strong>说明:</strong> 所有相关的版权和荣誉声明在 src.tar.gz，sys.tar.gz 和
XF4.tar.gz 文件中，或在通过 ports.tar.gz 下载的文件中。由于空间不足，用于构建
ports.tar.gz 文件中的程序包的发行文件并未包括在 CDROM 中。
<p>

<a name="new"></a>
<hr>
<p>
  <h3><font color="#0000e0">新特性</font></h3>

  <p>以下是仅 OpenBSD 4.0 中新特性和新系统功能的部分列表。更详细的，请参阅有关
4.0 版本的<a href="../plus40.html">修改记录</a>。
<p>

<ul>

<li>新增/扩展的构架平台:

      <ul>
        <li><a href="../armish.html">OpenBSD/armish</a>.<br>
        用 Redboot 引导的各种基于 ARM 的变体，目前只支持 Thecus N2100 和 IOData HDL-G。

        <li><a href="../sparc64.html">OpenBSD/sparc64</a>.<br>
        现在支持基于 UltraSPARC III 的机器!

        <li><a href="../zaurus.html">OpenBSD/zaurus</a>.<br>
        支持 Zaurus SL-C3200平台。
</ul>
<p>
    <li>更新了硬件支持, 包括:
<ul>
<li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=msk&amp;sektion=4">msk(4)</a> driver for Marvell/SysKonnect Yukon-2 Gigabit Ethernet.
<li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bnx&amp;sektion=4">bnx(4)</a> driver for Broadcom NetXtreme II Gigabit Ethernet.
<li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xge&amp;sektion=4">xge(4)</a> driver for Neterion Xframe/Xframe II 10Gb Ethernet.
<li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rum&amp;sektion=4">rum(4)</a> driver for Ralink Technology 2nd gen USB IEEE 802.11a/b/g wireless.
<li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=acx&amp;sektion=4">acx(4)</a> driver for Texas Instruments ACX100/ACX111 IEEE 802.11a/b/g wireless.
<li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pgt&amp;sektion=4">pgt(4)</a> driver for Connexant/Intersil Prism GT Full-MAC IEEE 802.11a/b/g wireless.
<li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=uath&amp;sektion=4">uath(4)</a> driver for Atheros USB IEEE 802.11a/b/g wireless.
<li>New binary blob free <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=wpi&amp;sektion=4">wpi(4)</a> driver for Intel PRO/Wireless 3945ABG IEEE 802.11a/b/g wireless.
<li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=arc&amp;sektion=4">arc(4)</a> driver for Areca Technology Corporation SATA RAID; including RAID management via <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bio&amp;sektion=4">bio(4)</a>.
<li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mfi&amp;sektion=4">mfi(4)</a> driver for LSI Logic &amp; Dell MegaRAID SAS RAID; including RAID management via <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bio&amp;sektion=4">bio(4)</a>.
<li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=azalia&amp;sektion=4">azalia(4)</a> driver for generic High Definition Audio.
<li>New SD/MMC/SDIO drivers (<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sdhc&amp;sektion=4">sdhc(4)</a>, <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sdmmc&amp;sektion=4">sdmmc(4)</a>), currently supporting SD memory cards as fake SCSI <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sd&amp;sektion=4">sd(4)</a> drives.
<li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=udcf&amp;sektion=4">udcf(4)</a> driver for Gude ADS Expert mouseCLOCK DCF77/HBG time signal station receivers.
<li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=uslcom&amp;sektion=4">uslcom(4)</a> driver for Silicon Laboratories CP2101/CP2102 based USB serial adapters.
<li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ucycom&amp;sektion=4">ucycom(4)</a> driver for Cypress microcontroller based USB serial adapters.
<li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=uark&amp;sektion=4">uark(4)</a> driver for Arkmicro Technologies ARK3116 based USB serial adapters.
<li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=umsm&amp;sektion=4">umsm(4)</a> driver for Qualcomm MSM EVDO based modems.
<li>New Dallas/Maxim 1-Wire bus support, including:
<ul>
<li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gpioow&amp;sektion=4">gpioow(4)</a> driver for 1-Wire bus bit-banging through GPIO pin
<li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=onewire&amp;sektion=4">onewire(4)</a> 1-Wire bus driver
<li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=owid&amp;sektion=4">owid(4)</a> 1-Wire ID family driver
<li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=owtemp&amp;sektion=4">owtemp(4)</a> 1-Wire temperature family driver
</ul>
<li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=isagpio&amp;sektion=4">isagpio(4)</a> driver for ISA I/O mapped as GPIO.
<li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=nmea&amp;sektion=4">nmea(4)</a>
line discipline for NMEA 0183 (GPS) devices. The new
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=nmeaattach&amp;sektion=8">nmeaattach(8)</a>
utility can be used to receive NMEA 0183 data and provide the time
received as a timedelta sensor to be used by, for example,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ntpd&amp;sektion=8">ntpd(8)</a>.
<li>New VAX framebuffer drivers:
<ul>
<li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=lcg&amp;sektion=4&amp;arch=vax">lcg(4)</a> driver for VAXstation 4000/60 and VLC color frame buffers
<li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=lcspx&amp;sektion=4&amp;arch=vax">lcspx(4)</a> driver for Low-Cost SPX color frame buffers
<li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gpx&amp;sektion=4&amp;arch=vax">gpx(4)</a> driver for GPX color frame buffers
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=smg&amp;sektion=4&amp;arch=vax">smg(4)</a> driver for Small Monochrome Graphics frame buffers heavily updated to be a modern <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=wscons&amp;sektion=4">wscons(4)</a> driver
</ul>
<li>Support for VAX-based Digital VXT2000 and VXT2000+ terminals.
<li>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bge&amp;sektion=4">bge(4)</a> driver supporting newer chipsets, such as the Broadcom BCM5754, BCM5755, BCM5786, and BCM5787.
<li>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=em&amp;sektion=4">em(4)</a> driver supporting newer chipsets, such as the Intel ESB2 and ICH8.
<li>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=nfe&amp;sektion=4">nfe(4)</a> driver supporting newer chipsets, such as the NVIDIA MCP61 and MCP65.
<li>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=re&amp;sektion=4">re(4)</a> driver supporting newer chipsets, such as the Realtek RT8101E, RT8168, and RT8169SC.
<li>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dc&amp;sektion=4">dc(4)</a> driver supporting newer chipsets, such as the ADMtek ADM9511 and ADM9513.
<li>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pciide&amp;sektion=4">pciide(4)</a> driver supporting newer chipsets, such as:
<ul>
<li>ATI IXP300 SATA, IXP600 IDE
<li>Intel 6321ESB IDE/SATA, 82801G SATA, and 82801H SATA
<li>IT Express IT8211F IDE
<li>NVIDIA MCP61 SATA, MCP65 SATA
<li>Promise PDC205xx SATA
<li>ServerWorks SATA
<li>VIA VT8237A SATA
</ul>
<li>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mpt&amp;sektion=4">mpt(4)</a> driver has been replaced with <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mpi&amp;sektion=4">mpi(4)</a>, a more stable driver that supports more hardware.
<li>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=com&amp;sektion=4">com(4)</a> driver now supports pcmcia and cardbus cards on macppc.
<li>Working interrupt routing on Sun Netra t1 105, Ultra 60 and possibly other <a href="../sparc64.html">sparc64</a> systems.
<li>Work around broken VIA and NVIDIA MPBIOSes, fixes interrupt routing with GENERIC.MP on several systems.
<li>Initial <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bio&amp;sektion=4">bio(4)</a> support for Compaq/HP <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ciss&amp;sektion=4">ciss(4)</a> Smart ARRAY 5/6 SAS/SCSI RAID controllers.
<li>Improved speed control on some systems:
<ul>
<li>New SpeedStep detection code, also adds support for VIA C7-M, and several newer Pentium M's.
<li>Support SpeedStep in rudimentary fashion on most unknown CPU's that advertise the feature.
<li>Zaurus can be moved into slower speeds now too.
<li>The Pentium 4 Thermal Clock Control driver now supports more CPU's including the Intel Pentium M and Xeon, and provides an estimated performance impact.
<li>Numerous improvements to PowerNow K7 and K8 support on i386, and support for K8 was added to amd64.
</ul>
<li>Support for Intel 945G/GM video chipsets (on i386).</li>
<li>Support for additional I2C sensors:
<ul>
<li>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adt&amp;sektion=4">adt(4)</a> driver now supports the National Semiconductor LM9600, SMSC EMC6D10x and SMSC SCH5017 chips.
<li>The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=admtemp&amp;sektion=4">admtemp(4)</a> driver now supports the Analog Devices ADM1023, Genesys Logic GL523SM and Global Mixed-mode Technology G781 chips.
</ul>
</ul>
<p>

    <li>新工具:
<ul>
<li>GNU RCS has been replaced with <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rcs&amp;sektion=1">OpenRCS</a>.
</ul>
<p>

    <li>新功能:
<ul>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsec&amp;sektion=4">IPsec</a>
 has been greatly improved:
<ul>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsecctl&amp;sektion=8">ipsecctl(8)</a>
 has been greatly extended and completely supersedes ipsecadm(8):
<ul>
<li>Lots of documentation improvements (man
 <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsec.conf&amp;sektion=5">ipsec.conf</a>)
<li>IPv6 support
<li>AH support
<li>Transport mode support
<li>Dynamic IKE support for roaming users
<li>USER_FQDN id support
</ul>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sasyncd&amp;sektion=8">sasyncd(8)</a>
 works much better:
<ul>
<li>communicates with
 <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=isakmpd&amp;sektion=8">isakmpd(8)</a>,
 telling it to run active or passive depending on the master/slave state of the
 <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4">carp(4)</a>
 interfaces.  This makes
 <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsec&amp;sektion=4">IPsec</a>
 failover setups much more robust.
<li>looks at the
 <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4">carp(4)</a>
 interface group by default to suppress preemption of
 <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsec&amp;sektion=4">IPsec</a>
 traffic during system boot.
</ul>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=isakmpd&amp;sektion=8">isakmpd(8)</a>
 can now be safely configured by
 <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsecctl&amp;sektion=8">ipsecctl(8)</a>
 on startup.
</ul>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp&amp;sektion=1">ftp(1)</a> now supports HTTPS.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cdio&amp;sektion=1">cdio(1)</a> can now perform track-at-once burning and rewritable blanking.
<li>spppcontrol(8) and wicontrol(8) functionality has been merged into
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8">ifconfig(8)</a>.
<li>gcc(1) provides a new warning, -Wstack-larger-than-N, to report functions
which are too greedy in stack variables, see
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gcc-local&amp;sektion=1">gcc-local(1)</a> for details.
<li>An in-kernel <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=getcwd&amp;sektion=3">getcwd(3)</a> implementation.
<li>A new system call <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adjfreq&amp;sektion=2">adjfreq(2)</a>
to allow <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ntpd&amp;sektion=8">ntpd(8)</a>
to adjust the tick rate of the system clock automatically.
<li>Support for X11 on VAX has been added
<li>Virtual Allocation Table (VAT) support for <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mount_udf&amp;sektion=8">UDF</a>.
<li>C99 functions
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=round&amp;sektion=3">round(3)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=roundf&amp;sektion=3">roundf(3)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=trunc&amp;sektion=3">trunc(3)</a>, and
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=truncf&amp;sektion=3">truncf(3)</a>
have been added to libm, the math library.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4">pf(4)</a>
 now supports Unicast Reverse Path Forwarding (uRPF) checks for simplified
 ingress filtering.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bpf&amp;sektion=4">bpf(4)</a>
 can now ignore packets based on their direction (inbound/outbound) using the
 BIOCSDIRFILT ioctl.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pdisk&amp;sektion=8&amp;arch=mac68k">pdisk(8)</a>
 can now set up slices on HFS(DPME) partitioned disks on mac68k.
<li>New dissectors have been added to
 <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tcpdump&amp;sektion=8">tcpdump(8)</a>:
<ul>
<li>Cisco's VQP (VLAN Query Protocol)
<li>IEEE 802.1AB LLDP (Link Layer Discovery Protocol)
</ul>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=trunk&amp;sektion=4">trunk(4)</a> now
 supports the new loadbalance mode to balance outgoing traffic based on hashed protocol header
 information.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bioctl&amp;sektion=8">bioctl(8)</a> has been extended to provide runtime information on rebuilds, scrubs and initialization.
<li>New sysctls to check the system vendor, product, version, serial number, and UUID.
<li>Equal cost multipath routing support. Needs to be enabled by a sysctl.
<li>Prebind, a secure implementation of prelinking, has been added to
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ldconfig&amp;sektion=8" >ldconfig(8)</a>,
it speeds up launching of shared binaries. Prebind is compatible with
address space randomization, unlike prelink.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vnconfig&amp;sektion=8">vnconfig(8)</a> can now use PKCS #5 PBKDF2 to create a more secure key when using encryption.
</ul>
<p>


<li>各种改进和代码清理:
<ul>
<li>Much better time keeping for multiprocessor <a href="../i386.html">OpenBSD/i386</a>
systems.
<li>Much improved implementation of <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=telldir&amp;sektion=3">telldir(3)</a>
and friends.
<li>Replacement of many
 <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=malloc&amp;sektion=3">malloc(3)</a>
 calls that follow a pattern prone to integer overflow with safer constructs.
<li>Improved failover handling in
 <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4">carp(4)</a>:
 <ul>
 <li>Extend the carp protocol with the demotion counter to act smarter on multiple failures.
 <li>Group failovers now work without carp running preempt mode.
 <li>Demotion can now be controlled via interface groups.
 </ul>
<li>
 <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chio&amp;sektion=1">chio(1)</a>
is now a useful tool for controlling tape changers.
<li>Much improved
 <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=st&amp;sektion=4">st(4)</a>
device setup, tape handling and error processing.
<li>Many
 <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dhclient&amp;sektion=8">dhclient(8)</a>
fixes, including 'alias' handling and improved interface initialization.
<li>
 <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=scsi&amp;sektion=4">scsi(4)</a>
devices detect the correct SCSI version.
<li>More
 <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=umass&amp;sektion=4">umass(4)</a>
devices properly detected.
<li>Improved detection of fibre channel devices and devices in SCSI enclosures.
<li>The new RSSI header has been added to the <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ieee80211_radiotap&amp;sektion=9">ieee80211_radiotap(9)</a>
  framework as a replacement for ANTSIGNAL headers.
<li>Many integer type safety cleanups with
 <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=lint&amp;sektion=1">lint(1)</a>.
</ul>
<p>

    <li>对安装/升级过程的修改
<ul>
<li>Host specific site files add easy customization for individual hosts
<li>X Window aperture support, where available, now defaults to off
</ul>
<p>

<li>New functionality for
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hostapd&amp;sektion=8">hostapd(8)</a>,
    the Host Access Point Daemon:
<ul>
<li>IP based roaming to build wireless networks without the requirement
    of a single broadcast domain.
<li>New event rules to match optional elements of radiotap headers:
    signal percentage, transmit rate and channel frequency.
<li>Various bug fixes and improvements.
</ul>
<p>

<li>OpenSSH 4.4:
<ul>
<li>Conditional configuration in <a href=
   "http://www.openbsd.org/cgi-bin/man.cgi?query=sshd_config&amp;sektion=5"
   >sshd_config(5)</a> using the <b>Match</b> directive.  This allows some
   configuration options to be selectively overridden if specific criteria
   (based on user, group, hostname and/or address) are met.
<li>Add support for Diffie-Hellman group exchange key agreement with a
   final hash of SHA256.
<li>Added a <b>ForceCommand</b> directive to <a href=
   "http://www.openbsd.org/cgi-bin/man.cgi?query=sshd_config&amp;sektion=5"
   >sshd_config(5)</a>, similar to the command="..." option in
   ~/.ssh/authorized_keys.
<li>Added a <b>PermitOpen</b> directive to <a href=
   "http://www.openbsd.org/cgi-bin/man.cgi?query=sshd_config&amp;sektion=5"
   >sshd_config(5)</a>, similar to the permitopen="..." option in
   authorized_keys, to allow control over the port-forwardings that a
   user is allowed to establish.
<li>Added an <b>ExitOnForwardFailure</b> option to cause ssh(1) to exit (with
   a non-zero exit code) when requested port forwardings could not be
   established.
<li>Added optional logging of transactions to <a href=
   "http://www.openbsd.org/cgi-bin/man.cgi?query=sftp-server&amp;sektion=8"
   >sftp-server(8)</a>.
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&amp;sektion=1"
   >ssh(1)</a> will now record port numbers for hosts stored in
   ~/.ssh/authorized_keys when a non-standard port has been requested.
<li>Extended the <a href=
   "http://www.openbsd.org/cgi-bin/man.cgi?query=sshd_config&amp;sektion=5"
   >sshd_config(5)</a> "SubSystem" directive to allow the
   specification of commandline arguments.
<li>Many manpage fixes and improvements
</ul>
<p>

<li>OpenBGPD 4.0:
<ul>
<li>new nexthop selection logic ignoring bgpd routes, helps in complex setups
    with ospfd
<li>add a &quot;detailed&quot; show rib view to bgpctl, including communities
<li>allow requesting a route refresh from a peer that supports it
<li>have bgpd always report back the result of an operation to bgpctl, so
    the operator can spot errors quicker
<li>allow bgpd to manipulate carp demotion counters based on session states,
    gives even greater failover support
<li>support restarting sessions that reached max-prefix after a given time
<li>bgpctl can now show all routes received from a neighbor before filters
    were applied, and routes sent to neighbors
<li>assorted fixes and improvements, as usual
</ul>
<p>

<li>OpenOSPFD 4.0:
<ul>
<li>Track uptime of the daemon itself.
<li>Track uptime of all ospf enabled interfaces.
<li>Adjust logging behaviour to prevent unwanted logging.
<li>Delay LSA updates when removing and adding - prevent flapping.
<li>Fix plaintext authentication.
<li>Improve the output of 'ospfctl show interfaces'.
<li>Support rtlabels when redistributing routes.
</ul>
<p>

<li>OpenNTPD 4.0:
<ul>
<li>support timedelta sensors, such as DCF77 receivers supported by
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=udcf&amp;sektion=4">udcf(4)</a>
    and GPS receivers supported by
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=nmea&amp;sektion=4">nmea(4)</a>.
<li>Adjust the kernel tick frequency, using
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adjfreq&amp;sektion=2">adjfreq(2)</a>,
    improving accuracy on many machines.
<li>allow for weight to be added to sensors or servers, so that one can
    weight timedelta sensors higher than ntp peers
</ul>
<p>

    <li>超过 3700 个 ports，3400 个预编译的包，更好的 package 工具。

    <li>完全支持通过一个 ssh(1) 连接使用 pkg_add(1)。
    <p>

    <li>按照惯例，手册或其它文档也有相应补充和修改。
    <p>

    <li>以下是系统内置的外部提供的重要程序:
<ul>
<li>X.Org 6.9.0 (+ patches, and i386 contains XFree86 3.3.6 servers
(+ patches) for legacy chipsets not supported by X.Org)
<li>Gcc 2.95.3
(+ <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gcc-local&amp;sektion=1">patches</a>)
and 3.3.5
(+ <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gcc-local&amp;sektion=1">patches</a>)
<li>Perl 5.8.8 (+ patches)
<li>Apache 1.3.29, mod_ssl 2.8.16, DSO support (+ patches)
<li>OpenSSL 0.9.7j (+ patches)
<li>Groff 1.15
<li>Sendmail 8.13.8, with libmilter
<li>Bind 9.3.2-P1 (+ patches)
<li>Lynx 2.8.5rel.4 with HTTPS and IPv6 support (+ patches)
<li>Sudo 1.6.8p9
<li>Ncurses 5.2
<li>Latest KAME IPv6
<li>Heimdal 0.7.2 (+ patches)
<li>Arla 0.35.7
<li>Binutils 2.15 (+ patches)
<li>Gdb 6.3 (+ patches)
</ul>
<p>
</ul>

<a name="install"></a>
<hr>
<p>
  <h3><font color="#0000e0">如何安装</font></h3>

  <p>如果通过购买的 CD 安装，请按照下述指令操作。使用
FTP(或其它安装方式)安装与之类似；CDROM 中的安装说明，
会让你知道如果使用购买的 CD 安装是多么方便。
  <p>
  <hr>
  有关安装 OpenBSD 4.0 更详细的信息，请参阅在三张 CD 或相关 FTP
镜像站点中的以下文件:
<p>
<ul>
<li>CD1:4.0/i386/INSTALL.i386
<p>
<li>CD2:4.0/amd64/INSTALL.amd64
<li>CD2:4.0/macppc/INSTALL.macppc
<p>
<li>CD3:4.0/sparc/INSTALL.sparc
<li>CD3:4.0/sparc64/INSTALL.sparc64
<p>
<li>FTP:.../OpenBSD/4.0/alpha/INSTALL.alpha
<li>FTP:.../OpenBSD/4.0/armish/INSTALL.armish
<li>FTP:.../OpenBSD/4.0/cats/INSTALL.cats
<li>FTP:.../OpenBSD/4.0/hp300/INSTALL.hp300
<li>FTP:.../OpenBSD/4.0/hppa/INSTALL.hppa
<li>FTP:.../OpenBSD/4.0/luna88k/INSTALL.luna88k
<li>FTP:.../OpenBSD/4.0/mac68k/INSTALL.mac68k
<li>FTP:.../OpenBSD/4.0/mvme68k/INSTALL.mvme68k
<li>FTP:.../OpenBSD/4.0/mvme88k/INSTALL.mvme88k
<li>FTP:.../OpenBSD/4.0/sgi/INSTALL.sgi
<li>FTP:.../OpenBSD/4.0/vax/INSTALL.vax
<li>FTP:.../OpenBSD/4.0/zaurus/INSTALL.zaurus
</ul>
<hr>

<p>
快速安装仅适合熟悉 OpenBSD 和"isklabel -E"命令用法的人。如果你根本不懂安装
OpenBSD，请参阅上面罗列的相应 INSTALL.* 文件!
<p>

<h3><font color="#e00000">OpenBSD/i386:</font></h3>
<ul>
    设置 BIOS 可以从 CD 启动。OpenBSD/i386 发行版本在 CD1 中。如果你的 BIOS
不支持从 CD 启动，就可能需要制作启动软盘。用 <i>CD1:4.0/i386/floppy40.fs</i>
来制作启动软盘，通过软盘驱动器启动。

    <p>使用 <i>CD1:4.0/i386/floppyB40.fs</i> 来制作启动软盘，可以获得更好的 SCSI
支持，或者使用 <i>CD1:4.0/i386/floppyC40.fs</i> 来制作启动软盘，
获得更好的笔记本电脑支持。

    <p>如果你不能从 CD 和软盘启动的话，还可以用 PXE 通过网络安装，请参阅
INSTALL.i386 文件。

    <p>如果计划让 OpenBSD 与另一操作系统共存，双重启动，请参阅 INSTALL.i386
文件。

    <p>在 MS-DOS 环境制作启动软盘，请使用位于 <i>CD1:4.0/tools/rawrite.exe</i>
的“rawrite”工具。在 Unix OS 环境制作启动软盘，请使用 <a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&amp;sektion=1">dd(1)</a>
工具。下面是使用 <a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&amp;sektion=1">dd(1)</a>
的例子，"device"可以是"floppy"，"rfd0c"，或"rfd0a"。

<ul><pre>
# <strong>dd if=&lt;file&gt; of=/dev/&lt;device&gt; bs=32k</strong>
</pre></ul>

<p>请确保你的软盘无坏道，已经正确格式化。否则很可能会安装失败。
有关制作启动软盘和安装 OpenBSD/i386 的信息请参阅 <a
href="../faq/zh/faq4.html#MkFlop">FAQ 4.3.1</a>。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/amd64:</font></h3>
<ul>OpenBSD/amd64 的 4.0 版本在 CD2 中。设置 BIOS 可以从 CD 启动，然后用 CD
启动，开始安装。如果不能从 CD 启动，可以通过制作启动软盘来安装。用
<i>CD2:4.0/amd64/floppy40.fs</i> 来制作启动软盘，然后用软驱来启动。

    <p>如果不能从 CD 或软盘启动，可以用 PXE 通过网络来安装，有关信息请参阅
INSTALL.amd64 文件。

    <p>如果计划让 OpenBSD 与另一个操作系统共存，双重启动，请参阅
INSTALL.amd64。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/macppc:</font></h3>
<ul>将 CD2 放入 CDROM，开机后一直按着 <i>C</i> 键，直到显示器显示
<i>OpenBSD/macppc boot</i> 。

    <p>或者在出现 Open Firmware 提示时，输入
<i>boot cd:,ofwboot /4.0/macppc/bsd.rd</i> 。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/sparc:</font></h3>
<ul>
    OpenBSD/sparc的4.0版本在 CD2 中，启动该 CD 时，根据你所用的 ROM 版本，
需用到下面两个命令中的一个：

<ul><pre>
ok <strong>boot cdrom 4.0/sparc/bsd.rd</strong>
或
&gt; <strong>b sd(0,6,0)4.0/sparc/bsd.rd</strong>
</pre></ul>

<p>如果你的 SPARC 系统没有 CD 驱动器，可以选择通过软盘来启动引导。将
<i>CD3:4.0/sparc/floppy40.fs</i> 写入软盘来制作引导盘。更多的信息请参阅
<a href="../faq/zh/faq4.html#MkFlop">FAQ 4.3.1</a>。根据 ROM
版本的不同，从软盘启动需要下面两个命令中的一个。

<ul><pre>
ok <strong>boot floppy</strong>
或
&gt; <strong>b fd()</strong>
</pre></ul>

<p>请确保你的软盘无坏道，已经正确格式化，否则很可能安装失败。

    <p>如果你的 SPARC 系统既没有软驱也没有光驱，
你可以通过可引导的磁带或者网络来安装，相关信息请参阅 INSTALL.sparc 文件 。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/sparc64:</font></h3>
<ul>将 CD3 放入 CDROM，输入 <i>boot cdrom</i> 。

    <p>如果这个没用，或没有光驱，你可以把 <i>CD3:4.0/sparc64/floppy40.fs</i> 或
<i>CD3:4.0/sparc64/floppyB40.fs</i> 写入软盘，用它作为启动盘，输入
<i>boot floppy</i> 来启动。详细内容参阅 INSTALL.sparc64。

    <p>请确保你的软盘无坏道，已经正确格式化。否则很可能会安装失败。

    <p>你也可以将 <i>CD3:4.0/sparc64/miniroot40.fs</i> 写入磁盘中的 swap 分区，
然后在启动时输入 <i>boot disk:b</i> 。

    <p>如果以上都不行，你可以通过网络来启动安装。相关内容在
INSTALL.sparc64 中。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/alpha:</font></h3>
<ul>
<p>根据你的机器类型，将 <i>FTP:4.0/alpha/floppy40.fs</i> 或
<i>FTP:4.0/alpha/floppyB40.fs</i> 写入软盘，然后在启动时输入 <i>boot dva0</i> 。
详细内容参阅 INSTALL.alpha。

    <p>请确保你的软盘无坏道，已经正确格式化。否则很可能会安装失败。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/armish:</font></h3>
<ul>
<p>连接串口之后，Thecus 能直接通过网络用 tftp 或 http 启动。使用 fconfig
配置网络，重置之后，加载 bsd.rd。详细信息 请参阅 INSTALL.armish 。IOData HDL-G
只能在 EXT2 格式的分区上启动。进入 linux，复制"boot"和"bsd.rd"到 wd0(hda1)，
然后加载和运行 bsd.rd，保留 wd0i(hda1) 上的 EXT2 分区。请参阅 INSTALL.armish
以获得更多信息。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/cats:</font></h3>
<ul>
<p>有必要的话，将固件驱动升级到最新的 ABLE 1.95，通过 ABLE
支持的设备（例如光驱或已有的 FFS 或 EXT2 分区）来引导
<i>FTP:4.0/cats/bsd.rd</i>安装。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/hp300:</font></h3>
<ul>
<p>按照 INSTALL.hp300 的相关说明通过网络来启动安装。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/hppa:</font></h3>
<ul>
<p>按照 INSTALL.hppa 或 <a href="../hppa.html#install">hppa</a>
平台的相关说明通过网络来启动安装。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/luna88k:</font></h3>
<ul>
<p>将 bsd.rd 复制到 Mach 或 UniOS 分区，通过 PROM 启动安装。
你也可以制作可启动磁带来安装。更多信息请参阅 INSTALL.luna88k。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/mac68k:</font></h3>
<ul>
<p>正常启动 MacOS，将 <i>FTP:4.0/mac68k/utils</i> 下的程序
“BSD/Mac68k Booter” 解压到硬盘。用 bsd.rd 内核文件的位置配置
“BSD/Mac68k Booter”，启动后进入安装程序。更多相关信息请参阅
INSTALL.mac68k。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/mvme68k:</font></h3>
<ul>
<p>可以制作启动磁带或通过网络来安装。<br>
    网络启动需要支持 <i>NIOT</i> 和 <i>NBO</i> 调试命令的 MVME68K BUG 版本。
更多相关信息请参阅 INSTALL.mvme68k。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/mvme88k:</font></h3>
<ul>
<p>可以制作启动磁带或通过网络来安装。<br>
    网络启动需要支持 <i>NIOT</i> 和 <i>NBO</i> 调试命令的 MVME88K BUG 版本。
更多相关信息请参阅 INSTALL.mvme88k。
</ul>

<p>
  <h3><font color="#e00000">OpenBSD/sgi:</font></h3>
<ul>
    <p>刻录一张 cd40.iso 的光盘，将其放入光驱中，从系统维护菜单中选择
<i>Install System Software</i> 进行安装。

    <p>如果没有光驱，可以通过 DHCP 或 tftp 连接到网络服务器的话，用
bootp()/bsd.rd 来引导启动安装。更多相关信息请参阅 INSTALL.sgi。
</ul>

<p>
  <h3><font color="#e00000">OpenBSD/vax:</font></h3>
<ul>用 mopbooting 通过网络启动来安装，相关信息请参阅 INSTALL.vax。
</ul>

<p>
  <h3><font color="#e00000">OpenBSD/zaurus:</font></h3>
<ul>
<p>用 Linux 内置的图形化安装程序 ipkg 来安装 openbsd40_arm.ipk 包。
重启之后，即可运行。更多信息请参阅INSTALL.zaurus。
</ul>

<p>
  <h3><font color="#e00000">关于源代码的说明:</font></h3>
<ul>
    src.tar.gz 包含的源代码文件开始路径是 /usr/src。
该文件包括除了内核代码之外的所有源代码，内核代码位于单独的档案文件中。
 解压方法:

<p>
<ul><pre>
# <strong>mkdir -p /usr/src</strong>
# <strong>cd /usr/src</strong>
# <strong>tar xvfz /tmp/src.tar.gz</strong>
</pre></ul>
<p>sys.tar.gz 包含的源代码文件路径开始是 /usr/src/sys。
该文件包括了重建内核需要的所有源代码。解压方法:

<p>
<ul><pre>
# <strong>mkdir -p /usr/src/sys</strong>
# <strong>cd /usr/src</strong>
# <strong>tar xvfz /tmp/sys.tar.gz</strong>
</pre></ul>
<p>这些文件是 CVS 检出格式。可以使用<a href="anoncvs.html">匿名 CVS
服务器</a>基于它们获得最新的版本。基于这些文件更新，比完全重新从 CVS
检出的速度要快得多。
<p>
</ul>

<a name="upgrade"></a>
<hr>
<p>
  <h3><font color="#0000e0">How to upgrade</font></h3>

  <p>如果你已经安装了OpenBSD 3.9，不想重新安装，可以在
<a href="../faq/upgrade40.html">升级指南</a>中找到升级方法和忠告。

<a name="ports"></a>
<hr>
<p>
  <h3><font color="#0000e0">使用 ports 的方法</font></h3>

  <p>也提供了 ports 的档案文件。解压方法:

<p>
<ul><pre>
# <strong>cd /usr</strong>
# <strong>tar xvfz /tmp/ports.tar.gz</strong>
# <strong>cd ports</strong>
</pre></ul>
<p><i>ports/</i> 子目录是 OpenBSD ports 树的检出副本。假如你不了解 ports，
请浏览 <a href="../ports.html">ports</a> 页面。该文件并非是如何使用 ports 的手册，
它只是 OpenBSD ports 系统用户的初级读本。

  <p><i>ports/</i> 目录是我们从 CVS(如果你不熟悉 CVS，请参阅手册 <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;apropos=0&amp;sektion=1&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html">
cvs(1)</a>) 检出的 ports 副本。与我们的代码一样，ports 也可以通过匿名 CVS
服务器更新。因此，为了确保版本是最新的，必须使 <i>ports/</i> 在可读写的介质中，
更新的命令是:

<p>
<ul><pre>
# <strong>cd [portsdir]/; cvs -d anoncvs@server.openbsd.org:/cvs update -Pd -rOPENBSD_4_0</strong>
</pre></ul>

<p>[当然，在实际操作时需要将本地目录和服务器名称替换成你的 ports
所在位置和较近的匿名 CVS 服务器。]

  <p>注意大部分的 ports 可以通过 FTP 获得预先编译的二进制包。如果发现问题，会为
4.0 版本发布升级包。

  <p>如果你有兴趣观察 ports 的变动信息，或者帮助我们，或者只想获得更多的信息，
请加入邮件列表 ports@openbsd.org 。
  <p>
  <hr>
  <a href="index.html"><img height="24" width="24" src="../back.gif" border="0" alt="OpenBSD"></a>
  <a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br><small>
$OpenBSD: 40.html,v 1.6 2008/05/27 10:00:24 tobias Exp $
</small>

</body>
</html>
<!--
Originally [OpenBSD: 40.html,v 1.89 ]<br>
$Translation: 40.html,v 1.15 2008/05/12 08:22:11 dongsheng Exp $<br>
-->

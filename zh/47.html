<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>OpenBSD 4.7 发行版本</title>
<link rev=made href="mailto:www@openbsd.org">
<meta name="resource-type" content="document">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="OpenBSD 4.7">
<meta name="keywords" content="openbsd,main">
<meta name="distribution" content="global">
<meta name="copyright" content="This document copyright 2010 by OpenBSD.">
</head>

<body bgcolor="#ffffff" text="#000000" link="#24248E">

<a href="index.html">
<img alt="[OpenBSD]" height="30" width="141" hspace="24" src="../images/smalltitle.gif" border="0"></a>
<hr>

<p>
<a href="../images/Superfish.jpg">
<img align="left" width="227" height="343" hspace="24" vspace="30"
src="../images/Superfish.jpg" alt="OpenBSD 4.7 logo"></a>
<h2><font color="#0000e0">The OpenBSD 4.7 发行版本:</font></h2>
<p>
发布于2010年5月19日<br>
版权 1997-2010, Theo de Raadt。<br>
<font color="#e00000">ISBN 978-0-9784475-5-7</font>
<br>
<a href="../lyrics.html#47">4.7 主题歌: "I'm still here"</a>
<p>

<a href="#new">新特性</a><br>
<a href="#install">如何安装</a><br>
<a href="#upgrade">如何升级</a><br>
<a href="#ports">使用 ports 的方法</a><br>
<a href="orders.html">购买 CD</a><br>

<p>
<h3><font color="#0000e0">
获得此版本的文件:
<ul>
<li>从我们的<a href="orders.html">订购系统</a>购买 CDROM。
<li>从镜像站点的 <a href="ftp.html">FTP 页面</a>中选择合适的镜像。
<li>进入镜像站点的 <font color="#e00000">pub/OpenBSD/4.7/</font> 目录。
<li>简要阅读本文档的剩余部分。
<li>阅读 <a href="errata47.html">4.7 勘误表</a>获得问题列表和解决方案。
<li>阅读 4.6 与 4.7 之间的<a href="../plus45.html">详细修改记录</a>。
</ul>
</font></h3>
<br clear=all>

<strong>说明:</strong> 所有相关的版权和荣誉声明在 src.tar.gz，sys.tar.gz 和
xenocara.tar.gz 文件中，或在通过 ports.tar.gz 下载的文件中。由于空间不足，
用于构建 ports.tar.gz 文件中的程序包的发行文件并未包括在 CDROM 中。
<p>

<a name="new"></a>
<hr>
<p>
<h3><font color="#0000e0">新特性</font></h3>
<p>以下是 OpenBSD 4.7 中新特性和新系统功能的部分列表。 完整的列表位于 4.7
的<a href="../plus47.html">修改记录</a>中。
<p>

<ul>

<li>新增/扩展的构架平台:
    <ul>
    <li><a href="alpha.html">OpenBSD/alpha</a>
	<ul>
	<li>增加对 DS15/DS25/ES45 的支持。
	</ul>
    <li><a href="loongson.html">OpenBSD/loongson</a><br>
    基于 MIPS 兼容的 Loongson 2E 和 2F 处理器的新平台。支持以下机型：
	<ul>
	<li>Lemote Fuloong 2F mini-PC
	<li>Lemote Lynloong all-in-one-PC
	<li>Lemote Yeeloong netbook (8.9" and 10.1" models)
	<li>EMTEC Gdium Liberty 1000 netbook
	</ul>
    <li><a href="sgi.html">OpenBSD/sgi</a>
    	<ul>
	<li>增加对多节点 SGI Origin 系统 M 模式的支持。
	<li>增加对 SGI Origin 350, Onyx 350, Onyx 4 和 Tezro 系统的支持。
	<li>增加对 SGI Octane 的 SMP 支持。
	<li>增加对 Octane 和 Origin 系统更多内置设备的支持 (见下)。
	</ul>
    <li><a href="socppc.html">OpenBSD/socppc</a>
	<ul>
	<li>增加对 RouterBOARD RB600A 的支持。
	</ul>
    <li><a href="sparc64.html">OpenBSD/sparc64</a>
	<ul>
	<li>在 sun4v 机型的 OpenBSD 控制域中，增加在客户域中运行 OpenBSD 的初步支持。
	</ul>
    </ul>
<p>

<li>更新了硬件支持, 包括:
    <ul>
    <li>Revamped SCSI midlayer and improved driver support.
    <li>UDF 2.5 and 2.6 (HDDVD and Blu-ray) disks support.
    <li>Added <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mpath&sektion=4&format=html">mpath(4)</a>,
      a driver that steals paths to scsi devices if they could be
      available via multiple paths and then made available
    via <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mpath&sektion=4&format=html">mpath(4)</a>.
    <li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=aibs&sektion=4&format=html">aibs(4)</a>
      driver for ASUSTeK AI Booster hardware monitoring.
    <li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=uthum&amp;sektion=4">uthum(4)</a>
      driver for the TEMPerHUM USB temperature and humidity sensors.
    <li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=utrh&amp;sektion=4">utrh(4)</a>
      driver for USBRH temperature and humidity sensors.
    <li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=uyurex&amp;sektion=4">uyurex(4)</a>
      driver for the Maywa-denki & KAYAC YUREX twitch/jiggle of knee sensor.
    <li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=urndis&amp;sektion=4">urndis(4)</a>
      driver for remote NDIS Ethernet over USB devices (phones).
    <li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=wsudl&amp;sektion=4">xf86-video-wsudl(4)</a>
       Xorg driver for USB DisplayLink devices supported by
        <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=udl&amp;sektion=4">udl(4)</a>.
    <li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mpii&amp;sektion=4">mpii(4)</a>
      driver for LSI Logic Fusion MPT Message Passing Interface II based SAS 2 controllers.
    <li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=athn&amp;sektion=4">athn(4)</a>
      driver for Atheros IEEE 802.11a/g/n wireless network devices.
    <li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=alc&amp;sektion=4">alc(4)</a>
      driver for Atheros AR8131/AR8132 10/100/Gigabit Ethernet devices.
    <li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=lisa&amp;sektion=4">lisa(4)</a>
      driver for STMicroelectronics LIS331DL MEMS motion sensors.
    <li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gcu&amp;sektion=4">gcu(4)</a>
      driver for Intel EP80579 Global Configuration Unit.
    <li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=lom&amp;sektion=4&amp;arch=sparc64">lom(4)</a>
      driver for LOMLite and LOMLite2 as found on many of Sun's UltraSPARC-IIi
      servers.
    <li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vsw&amp;sektion=4&amp;arch=sparc64">vsw(4)</a>
      driver for virtual switches on sun4v machines.
    <li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vds&amp;sektion=4&amp;arch=sparc64">vds(4)</a>
      driver for virtual disk servers on sun4v machines.
    <li>Support for EP80579 integrated Ethernet and ICH9 M V has been added to
        <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=em&amp;sektion=4">em(4)</a>.
    <li>Support for 82599 and SFP+ 82598 devices has been added to
        <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ix&amp;sektion=4">ix(4)</a>.
    <li>Support for the Sun GigabitEthernet SBus Adapter 1.0/1.1 has been added
        to <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ti&amp;sektion=4">ti(4)</a>.
    <li>Support for SBus variants of the QLogic Fibre Channel host adapters has
        been added to <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=isp&amp;sektion=4">isp(4)</a>.
    <li>Support for SBus variants of the Sun Gigabit Ethernet has
        been added to <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gem&amp;sektion=4">gem(4)</a>.
    <li>Support for Intel WiFi Link 1000 and Intel Centrino Advanced-N 6200/Ultimate-N 6300
        has been added to <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=iwn&amp;sektion=4">iwn(4)</a>.
    <li>Support for Ralink RT3572 based 802.11n devices
        has been added to <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=run&amp;sektion=4">run(4)</a>.
    <li>VIA Tremor 5.1, M-Audio Revolution 5.1 cards
        has been added to <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=envy&amp;sektion=4">envy(4)</a>.
    <li>New <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=uhts&amp;sektion=4">uhts(4)</a>
	driver for USB HID touchscreens.
    <li>Improved touchscreen support in
        the <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ws&amp;sektion=4">xf86-input-ws(4)</a>
        Xorg driver and improved calibration using the new device
        properties from Xinput.
    <li>Support for ON CAT6095 and ON CAT34TS02 temperature sensors added to
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sdtemp&amp;sektion=4">sdtemp(4)</a>.
    <li>Several improvements and bug fixes to existing Ethernet
      drivers, including
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=em&amp;sektion=4">em(4)</a>,
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=re&amp;sektion=4">re(4)</a>,
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ti&amp;sektion=4">ti(4)</a>
      and <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vge&amp;sektion=4">vge(4)</a>.
    <li>Support for the <i>PIC</i> PCI-X controller added to the SGI
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xbridge&amp;sektion=4&amp;arch=sgi">xbridge(4)</a> driver.
    <li>Support for the onboard Fast Ethernet interface found on SGI Octane and
	many SGI Origin family systems,
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=iec&amp;sektion=4&amp;arch=sgi">iec(4)</a>.
    <li>Support for more SGI input and video devices on Octane and Origin systems, with
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=iockbc&amp;sektion=4&amp;arch=sgi">iockbc(4)</a>,
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=impact&amp;sektion=4&amp;arch=sgi">impact(4)</a>,
      and <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=odyssey&amp;sektion=4&amp;arch=sgi">odyssey(4)</a>.
    <li>Improved PCI resource allocation; more hardware left unconfigured by
      the machine's firmware (including hotplugged hardware) should work now.
    <li>Support for recording/full-duplex added to
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mavb&amp;sektion=4&amp;arch=sgi">mavb(4)</a>.
    <li>Improved support for USB audio devices in
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=uaudio&amp;sektion=4">uaudio(4)</a>.
    <li>Improved support for
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bwi&amp;sektion=4">bwi(4)</a> devices on strict-alignment architectures like armish.
      <li>Eliminate usage of SCSI tagged queueing mechanisms other than simple queuing, thus avoiding incorrect implementations on various disk devices.
      <li>Eliminate spurious <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dhclient&amp;sektion=">dhclient(8)</a> error messages when the specified interface does not exist.
      <li>Eliminate spurious <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=softraid&amp;sektion=">softraid(4)</a> error messages for removable devices without media.
    </ul>
<p>

<li>新工具:
    <ul>
    <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=newfs_ext2fs&amp;sektion=8">newfs_ext2fs(8)</a> for creating ext2 filesystems.
    <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mkuboot&amp;sektion=8">mkuboot(8)</a> for creating U-Boot boot loader images.
    <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=midicat&amp;sektion=1">midicat(1)</a> MIDI server allowing MIDI programs to communicate
    <li>POSIX-compliant <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fuser&amp;sektion=1">fuser(1)</a> to identify process IDs holding a file open
    </ul>
<p>

<li>文件系统中间层的改进:
    <ul>
    <li> Dynamic Buffer Cache now supported to a max size set with sysctl <tt>kern.bufcachepercent</tt>
    <li> Dynamic VFS name cache rewrite, now uses Red/Black trees instead of linked lists.
    <li> Numerous NFS client stability fixes.
    <li> Fix FAT32 mounting.
    <li> Fix cd9660 directory handling to eliminate looping and random
	 truncation of directory entries.
    <li> Fix various internal locking problems with cd9660, udf, msdosfs and ffs file systems.
    </ul>
<p>

<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4">pf(4)</a> 改进:
    <ul>
    <li>nat-to, rdr-to, binat-to options replace the nat, rdr and binat
    translation rules. See
    <a href="http://www.openbsd.org/faq/current.html#20090901">
    2009/09/01 - pf(4) address translation changes</a> for more info.
    <li>The route-to, reply-to, dup-to and fastroute options in pf.conf move to
    filteropts. See <a href="http://www.openbsd.org/faq/current.html#20090902">
    2009/09/02 - pf(4) route-to/reply-to syntax change</a> for more info.
    <li>pf(4) can now <i>translate</i> packets between different routing
    domains.
    <li>Added -S and -L options to <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&sektion=8&format=html">pfctl(8)</a> to store and load pf state table from a file.
    <li>Added support for IPV4 and IPv6 divert sockets.
    </ul>
<p>

<li>OpenBGPD, OpenOSPFD 以及其它后台路由程序的改进:
    <ul>
    <li>Update capability code in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bgpd&sektion=8&format=html">bgpd(8)</a> to follow RFC 5492.
    <li>BGP MPLS VPN (RFC 4364) support added to the bgpd RIB.
    <li>In <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bgpd&sektion=8&format=html">bgpd(8)</a>, implement the RFC4486 BGP Cease Notification Message subcodes.
    <li>It is now possible to enable/disable specific BGP capabilities.
    <li>Update <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bgpctl&sektion=8&format=html">bgpctl(8)</a> irrfilter to support IPv6 and 4-byte AS numbers.
    <li>Minimal router-dead-time of 1 second and sub-second hello intervals
    added to <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ospfd&amp;sektion=8">ospfd(8)</a>.
    Additionally it is now possible to specify sub-second SPF timers for faster
    route fail-over.
    <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ospf6d&amp;sektion=8">ospf6d(8)</a> is now installed by default. 
    The RIB can be synced with the kernel routing table now. 
    Support for AS-ext LSA has been added.
    This is still work-in-progress but testing is highly appreciated.
    <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ldpd&amp;sektion=8">ldpd</a> -- the MPLS label distribution protocol daemon -- is now installed by default. A custom kernel with option MPLS is needed to use it.
    </ul>
<p>

<li>通用网络堆栈的改进:
    <ul>
    <li>brconfig is now integrated into
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8">ifconfig(8)</a>
    <li>Added <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vether&sektion=4&format=html">vether(4)</a>, a virtual Ethernet device.
    <li>Two bugs in IPsec/HMAC-SHA2 were fixed, resulting in an incompatibility
    with the HMAC-SHA-256/384/512 hash algorithms with previous versions of
    OpenBSD and other IPsec implementations sharing the bugs.
    <li>In <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dhcpd&sektion=8&format=html">dhcpd(8)</a>, echo back the Relay Agent Information option if present, and add support for the ipsec-tunnel hardware type.
    <li>Make <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dhcrelay&sektion=8&format=html">dhcrelay(8)</a> pick up the routing domain from the specified interface and use that rdomain for relaying the packets to the server.
    <li>Added support in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dhcrelay&sektion=8&format=html">dhcrelay(8)</a> for RFC3046 "DHCP-over-ipsec".
    <li>Make the <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tcpdump&sektion=8&format=html">tcpdump(8)</a> BGP OPEN capability parser RFC 5492 compliant.
    <li>Added an exec command to <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=route&sektion=8&format=html">route(8)</a> to run a process and its children in a specified routing domain.
    <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8">ifconfig(8)</a> now deals with more than 64 alias addresses.
    <li>Various fixes to mbuf defragmenting and mbuf chain copying improve reliability.
    </ul>
<p>

<li>杂项改进:
    <ul>
    <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=malloc&amp;sektion=3">malloc(3)</a>
     now has an <tt>S</tt> flag to turn on the options that help debugging
     and improve security.
    <li>Updated <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=terminfo&amp;sektion=3">terminfo(3)</a>
     database and <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ncurses&amp;sektion=3">ncurses(3)</a>
     library.
    <li>Added support for lazy binding in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ld.so&amp;sektion=1">ld.so(1)</a>
      on hppa.
    <li>Added POSIX silent check option (<tt>-C</tt>) to
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sort&amp;sektion=1">sort(1)</a>.
    <li>Added POSIX extended regular expression support to
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sed&amp;sektion=1">sed(1)</a> (<tt>-E</tt> option).
    <li>Added GNU-compatible macro prefix option (<tt>-P</tt>) to
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=m4&amp;sektion=1">m4(1)</a>.
    <li>Make it possible to specify a port in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=resolv.conf&sektion=5&format=html">resolv.conf(5)</a>.
    <li>Improved FILE locking support in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=stdio&amp;sektion=3">stdio(3)</a>.
    <li>Added SO_SNDTIMEO and SO_RCVTIMEO support in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pthreads&amp;sektion=3">pthreads(3)</a>.
    <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cdio&amp;sektion=1">cdio(1)</a> no longer prints bogus information if no TOC is found on the disk.
    <li>New -v flag causes <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cdio&amp;sektion=1">cdio(1)</a> to print profile and feature information.
    <li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=whois&amp;sektion=1">whois(1)</a> no longer attempts to keep the memory of 6Bone alive.
    <li>Added per-application MIDI-controlled volume knob to <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=aucat&amp;sektion=1">aucat(1)</a>
    <li>Added MMC and MTC support to <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=aucat&amp;sektion=1">aucat(1)</a> making possible MIDI-to-audio synchronization
    <li>Added <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mio_open&amp;sektion=3">mio_open(3)</a> interface to access hardware and software MIDI ports
    <li>发现并修正了许多内存泄露。
    <li>通过正确的初始化开始 label，使处理软盘的 disklabel 更可靠。
    </ul>
<p>

<li>对安装/升级过程的修改:
    <ul>
    <li>Take more care to ensure all filesystems are umount'ed when
	restarting an install or upgrade.
    <li>If no possible root disk is found, keep checking until one
	appears.
    <li>The default ftp directory for -stable is now the release directory
	instead of the snapshot directory.
    <li>Selection of TZ during installs is no longer confused by
	trailing slashes.
    <li>If /etc/X11 is found during upgrades, add the X sets to the
	list of default sets to install.
    </ul>
<p>

<li>OpenSSH 5.5:
    <ul>
    <li>新特性:
        <ul>
        <li>SSH protocol 1 is disabled by default.
        <li>Remove the libsectok/OpenSC-based smartcard code and add support
            for PKCS#11 tokens.
        <li>Add support for certificate authentication of users and hosts using
            a new, minimal OpenSSH certificate format (not X.509).
        <li>Added a 'netcat mode' to
            <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&sektion=1">ssh(1)</a>.
        <li>Add the ability to revoke keys in
            <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&sektion=8">sshd(8)</a>
            and
            <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&sektion=1">ssh(1)</a>.
        <li>Rewrite the
            <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&sektion=1">ssh(1)</a>
            multiplexing support to support non-blocking operation of the mux
            master.
        <li>Add a 'read-only' mode to
            <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sftp-server&sektion=8">sftp-server(8)</a>
            that disables open in write mode and all other fs-modifying
            protocol methods. (bz#430)
        <li>Allow setting an explicit umask on the
            <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sftp-server&sektion=8">sftp-server(8)</a>
            commandline to override whatever default the user has. (bz#1229)
        <li>Many improvements to the
            <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sftp&sektion=1">sftp(1)</a>
            client.
        <li>New RSA keys will be generated with a public exponent of 65537
            instead of the previous value 35.
        <li>Passphrase-protected SSH protocol 2 private keys are now protected
            with AES-128 instead of 3DES.
        </ul>
    <li>修正了以下重要问题:
        <ul>
        <li>Fixed a minor information leak of environment variables specified
            in authorized_keys if an attacker happens to know the public key
            in use.
        <li>When using <em>ChrootDirectory</em>, make sure we test for the
            existence of the user's shell inside the chroot and not outside.
            (bz#1679)
        <li>Cache user and group name lookups in sftp-server using
            <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pwcache&sektion=3">user_from_[ug]id(3)</a>
            to improve performance on hosts where these operations are slow.
            (bz#1495)
        <li>Fix problem that prevented passphrase reading from being
            interrupted in some circumstances. (bz#1590)
        <li>Ignore and log any Protocol 1 keys where the claimed size is not
            equal to the actual size.
        <li>Make <em>HostBased</em> authentication work with a
            <em>ProxyCommand</em>. (bz#1569)
        <li>Avoid run-time failures when specifying hostkeys via a relative
            path by prepending the current working directory in these cases.
            (bz#1290)
        <li>Do not prompt for a passphrase if we fail to open a keyfile, and
            log the reason why the open failed to debug. (bz#1693)
        <li>Document that the <em>PubkeyAuthentication</em> directive is
            allowed in a
            <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd_config&sektion=5">sshd_config(5)</a>
            <em>Match</em> block. (bz#1577)
        <li>When converting keys, truncate key comments at 72 chars as per
            RFC4716. (bz#1630)
        <li>Do not allow logins if <em>/etc/nologin</em> exists but is not
            readable by the user logging in.
        <li>Output a debug log if
            <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&sektion=8">sshd(8)</a>
            can't open an existing <em>authorized_keys</em>. (bz#1694)
        <li>Quell
            <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tcsetattr&sektion=3">tc[gs]etattr(3)</a>
            warnings when forcing a tty (ssh -tt), since we usually don't
            actually have a tty to read/set. (bz#1686)
        <li>Prevent
            <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sftp&sektion=1">sftp(1)</a>
            from crashing when given a "-" without a command; also, allow
            whitespace to follow a "-". (bz#1691)
        <li>After
            <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&sektion=8">sshd(8)</a>
            receives a SIGHUP, ignore subsequent HUPs while
            <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&sektion=8">sshd(8)</a>
            re-execs itself; prevents two HUPs in quick succession from
            resulting in
            <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&sektion=8">sshd(8)</a>
            dying. (bz#1692)
        <li>Clarify in
            <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd_config&sektion=5">sshd_config(5)</a>
            that <em>StrictModes</em> does not apply to
            <em>ChrootDirectory</em>; permissions and ownership are always
            checked when chrooting. (bz#1532)
        <li>Set close-on-exec on various descriptors so they don't get leaked
            to child processes. (bz#1643)
        <li>Fix very rare race condition in x11/agent channel allocation
        <li>Fix incorrect exit status when multiplexing and channel ID 0 is
            recycled. (bz#1570)
        <li>Fail with an error when an attempt is made to connect to a server
            with <em>ForceCommand=internal-sftp</em> with a shell session.
            (bz#1606)
        <li>Warn but do not fail if
            <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=stat&sektion=2">stat(2)</a>ing
            the subsystem binary fails. (bz#1599)
        <li>Change "Connecting to host..." message to "Connected to host."
            and delay it until after the sftp protocol connection has been
            established. (bz#1588)
        <li>Use the <em>HostKeyAlias</em> rather than the hostname specified
            on the commandline when prompting for passwords. (bz#1039)
        <li>Correct off-by-one in percent_expand(). (bz#1607)
        <li>Fix passing of empty options from
            <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=scp&sektion=1">scp(1)</a>
            and
            <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sftp&sektion=1">sftp(1)</a>
            to the underlying
            <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh&sektion=1">ssh(1)</a>;
            also add support for the stop option "--".
        <li>Fix an incorrect magic number and typo in PROTOCOL. (bz#1688)
        <li>Don't escape backslashes when displaying the SSH2 banner. (bz#1533)
        <li>Don't unnecessarily dup() the in and out fds for
            <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sftp-server&sektion=8">sftp-server(8)</a>.
            (bz#1566)
        <li>Force use of the correct hash function for random-art signature
            display. (bz#1611)
        <li>Do not fall back to adding keys without constraints when the agent
            refuses the constrained add request. (bz#1612)
        <li>Fix a race condition in
            <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-agent&sektion=1">ssh-agent(1)</a>
            that could result in a wedged or spinning agent. (bz#1633)
        <li>Flush stdio before exec() to ensure that everything has made it out
            before the streams go away. (bz#1596)
        <li>Set <em>FD_CLOEXEC</em> on in/out sockets in
            <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&sektion=8">sshd(8)</a>.
            (bz#1706)
        </ul>
    </ul>
<p>

<li>超过 5800 个 ports，package 工具的健壮性和速度有所改进。
<li>每种架构都有许多预先构建的包:
    <table border=0 cellspacing=0 cellpadding=2 width="95%">
    <tr>
    <td valign="top" width="25%">
    <ul>
    <li>i386:       5951
    <li>sparc64:    5745
    <li>alpha:      5641
</ul></td><td valign=top width="25%"><ul>
    <li>sh:          768
    <li>amd64:      5879
    <li>powerpc:    5785
</ul></td><td valign=top width="25%"><ul>
    <li>sparc:      4053
    <li>arm:        3711
    <li>hppa:       5500
</ul></td><td valign=top width="25%"><ul>
    <li>vax:        1785
    <li>mips64:     3690
    <li>mips64el:   4316
</ul></td></tr></table>
部分关键程序:
    <ul>
    <li>Gnome 2.28.2.
    <li>KDE 3.5.10.
    <li>Xfce 4.6.1.
    <li>MySQL 5.1.42.
    <li>PostgreSQL 8.4.2.
    <li>Postfix 2.6.5.
    <li>OpenLDAP 2.3.43.
    <li>Mozilla Firefox 3.0.18 and 3.5.8.
    <li>Mozilla Thunderbird 2.0.0.23.
    <li>OpenOffice.org 3.1.1.
    <li>Emacs 21.4 and 22.3
    <li>Vim 7.2.267.
    <li>PHP 5.2.12.
    <li>Python 2.4.6, 2.5.4 and 2.6.3.
    <li>Ruby 1.8.6.369.
    </ul>
<p>

<li>按照惯例，手册或其它文档也有相应补充和修改。
<p>

<li>以下是系统包含的外部提供的重要程序:
    <ul>
    <li>Xenocara (based on X.Org 7.4 with xserver 1.6.5 + patches,
	freetype 2.3.9,
        fontconfig 2.6.0, Mesa 7.4.2, xterm 250 and more)
    <li>Gcc 2.95.3 (+ patches) and 3.3.5 (+ patches)
    <li>Perl 5.10.1 (+ patches)
    <li>Our improved and secured version of Apache 1.3, with SSL/TLS
        and DSO support
    <li>OpenSSL 0.9.8k (+ patches)
    <li>Groff 1.15
    <li>Sendmail 8.14.3, with libmilter
    <li>Bind 9.4.2-P2 (+ patches)
    <li>Lynx 2.8.6rel.5 with HTTPS and IPv6 support (+ patches)
    <li>Sudo 1.7.2
    <li>Ncurses 5.7
    <li>Latest KAME IPv6
    <li>Heimdal 0.7.2 (+ patches)
    <li>Arla 0.35.7
    <li>Binutils 2.15 (+ patches)
    <li>Gdb 6.3 (+ patches)
    </ul>
<p>

</ul>

<a name="install"></a>
<hr>
<p>
<h3><font color="#0000e0">如何安装</font></h3>
<p>
如果通过购买的 CD 安装，请按照下述指令操作。使用
FTP(或其它安装方式)安装与之类似；CDROM 中的安装是自治的，
它会让你知道如果使用购买的 CD 安装是多么方便。
<p>

<hr>
有关安装 OpenBSD 4.7 更详细的信息，请参阅在三张 CD 或相关 FTP
镜像站点中的以下文件:
<p>
<ul>
<li>CD1:4.7/i386/INSTALL.i386
<p>
<li>CD2:4.7/amd64/INSTALL.amd64
<li>CD2:4.7/macppc/INSTALL.macppc
<p>
<li>CD3:4.7/sparc64/INSTALL.sparc64
<p>
<li>FTP:.../OpenBSD/4.7/alpha/INSTALL.alpha
<li>FTP:.../OpenBSD/4.7/armish/INSTALL.armish
<li>FTP:.../OpenBSD/4.7/hp300/INSTALL.hp300
<li>FTP:.../OpenBSD/4.7/hppa/INSTALL.hppa
<li>FTP:.../OpenBSD/4.7/landisk/INSTALL.landisk
<li>FTP:.../OpenBSD/4.7/loongson/INSTALL.loongson
<li>FTP:.../OpenBSD/4.7/mvme68k/INSTALL.mvme68k
<li>FTP:.../OpenBSD/4.7/mvme88k/INSTALL.mvme88k
<li>FTP:.../OpenBSD/4.7/sgi/INSTALL.sgi
<li>FTP:.../OpenBSD/4.7/socppc/INSTALL.socppc
<li>FTP:.../OpenBSD/4.7/sparc/INSTALL.sparc
<li>FTP:.../OpenBSD/4.7/vax/INSTALL.vax
<li>FTP:.../OpenBSD/4.7/zaurus/INSTALL.zaurus
</ul>
<hr>

<p>
快速安装仅适合熟悉 OpenBSD 和“disklabel -E”命令用法的人。如果你根本不懂安装
OpenBSD，请参阅上面罗列的相应 INSTALL.* 文件!
<p>

<h3><font color="#e00000">OpenBSD/i386:</font></h3>
<ul>
设置 BIOS 可以从 CD 启动。OpenBSD/i386 发行版本在 CD1 中。如果你的 BIOS
不支持从 CD 启动，就可能需要制作启动软盘。将 <i>CD1:4.7/i386/floppy47.fs</i>
写入软盘来制作启动软盘，通过软盘驱动器启动。

<p>
使用 <i>CD1:4.7/i386/floppyB47.fs</i> 来制作引导软盘，可以获得更好的 SCSI
支持，或者使用 <i>CD1:4.7/i386/floppyC47.fs</i> 获得更好的笔记本电脑支持。

<p>
如果你不能从 CD 或软盘启动的话，还可以用 PXE 通过网络安装，请参阅
INSTALL.i386 文件。

<p>
如果计划让 OpenBSD 与另一操作系统共存，双重启动，请参阅 INSTALL.i386
文件。

<p>
在 MS-DOS 环境制作启动软盘，请使用位于 <i>CD1:4.7/tools/rawrite.exe</i>
的"rawrite"工具。在 Unix OS 环境制作启动软盘，请使用
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&amp;sektion=1">dd(1)</a>
工具。下面是使用
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&amp;sektion=1">dd(1)</a>
的例子，"device"可以是"floppy"，"rfd0c"，或"rfd0a"。

<ul><pre>
# <strong>dd if=&lt;file&gt; of=/dev/&lt;device&gt; bs=32k</strong>
</pre></ul>

<p>
请确认你的软盘无坏道，已经正确格式化。否则很可能会安装失败。
有关制作启动软盘和安装 OpenBSD/i386 的信息请参阅
<a href="faq/faq4.html#MkFlop">FAQ 4.3.1</a>。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/amd64:</font></h3>
<ul>
OpenBSD/amd64 的 4.7 版本在 CD2 中。设置 BIOS 可以从 CD 启动，然后用 CD
启动，开始安装 - 你可能需要先修改 BIOS 选项。
如果不能从 CD 启动，可以通过制作启动软盘来安装。用 <i>CD2:4.7/amd64/floppy47.fs</i>  
来制作启动软盘，然后用软驱来启动。

<p>
如果不能从 CD 或软盘启动，可以用 PXE 通过网络来安装，有关信息请参阅
INSTALL.amd64 文件。

<p>
如果计划让 OpenBSD 与另一个操作系统共存，双重启动，请参阅
INSTALL.amd64。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/macppc:</font></h3>
<ul>
将 CD2 放入 CDROM，开机后一直按着
<i>C</i> 键，直到显示器显示 <i>OpenBSD/macppc boot</i>。

<p>
或者在出现 Open Firmware提示时，输入 <i>boot cd:,ofwboot
/4.7/macppc/bsd.rd</i>
</ul>

<p>
<h3><font color="#e00000">OpenBSD/sparc64:</font></h3>
<ul>
将 CD3 放入 CDROM，输入 <i>boot cdrom</i>。

<p>
如果这个没用，或没有光驱，你可以把
<i>CD3:4.7/sparc64/floppy47.fs</i> 或 <i>CD3:4.7/sparc64/floppyB47.fs</i>
(依赖于你的机器)写入软盘，用它作为启动盘，输入 <i>boot
floppy</i> 来启动。详细内容参阅 INSTALL.sparc64。

<p>
请确认你的软盘无坏道，已经正确格式化。否则很可能会安装失败。

<p>
你也可以将 <i>CD3:4.7/sparc64/miniroot47.fs</i> 写入磁盘中的 swap 分区，
然后在启动时输入 <i>boot disk:b</i>。

<p>
如果以上都不行，你可以按照 INSTALL.sparc64 中的描述通过网络来启动安装。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/alpha:</font></h3>
<ul>
<p>将 <i>FTP:4.7/alpha/floppy47.fs</i> 或
<i>FTP:4.7/alpha/floppyB47.fs</i> (依赖于你的机器)写入软盘，用它作为启动盘，输入 
<i>boot dva0</i> 来启动。详细内容参阅 INSTALL.alpha。

<p>
请确认你的软盘无坏道，已经正确格式化。否则很可能会安装失败。

</ul>

<p>
<h3><font color="#e00000">OpenBSD/armish:</font></h3>
<ul>
<p>
连接串口之后，Thecus 能直接通过网络用 tftp 或 http 启动。使用 fconfig
配置网络，重置之后，加载 bsd.rd，详细信息请参阅 INSTALL.armish 。
IOData HDL-G 只能从 EXT2 格式分区启动。进入
linux，复制 'boot' 和 'bsd.rd' 到第一个分区 wd0(hda1)，
然后加载和运行 'bsd.rd'，保留 wd0i(hda1) 上的 EXT2 分区。请参阅 INSTALL.armish
以获得更多信息。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/hp300:</font></h3>
<ul>
<p>
按照 INSTALL.hp300 的相关说明通过网络来启动安装。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/hppa:</font></h3>
<ul>
<p>
按照 INSTALL.hppa 或
<a href="hppa.html#install">hppa 平台页面</a>的相关说明通过网络来启动安装。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/landisk:</font></h3>
<ul>
<p>
将 <i>miniroot47.fs</i> 写入 CF 卡或磁盘的开始，正常启动后安装。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/loongson:</font></h3>
<ul>
<p>
将 <i>miniroot47.fs</i> 写入 USB 盘，然后引导 bsd.rd；或者通过 tftp 引导 bsd.rd 。
详细信息请参阅 INSTALL.loongson 中的安装说明。
</ul>
<p>

<p>
<h3><font color="#e00000">OpenBSD/mvme68k:</font></h3>
<ul>
<p>
可以制作启动磁带或通过网络来安装。<br>
网络启动需要支持 <i>NIOT</i> 和 <i>NBO</i> 调试命令的 MVME68K BUG 版本。
更多相关信息请参阅 INSTALL.mvme68k 中的安装说明。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/mvme88k:</font></h3>
<ul>
<p>
网络启动需要支持 <i>NIOT</i> 和 <i>NBO</i> 调试命令的 MVME88K BUG 版本。
更多相关信息请参阅 INSTALL.mvme88k。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/sgi:</font></h3>
<ul>
<p>
在 O2 中安装时，将 cd47.iso 刻录到光盘，将其放入光驱中，从系统维护菜单中选择
<i>Install System Software</i> 进行安装。

<p>
对于其它系统，或者没有光驱，你可以配置 DHCP/tftp 网络服务器，使用匹配你的系统类型的内核，用
"bootp()/bsd.rd.IP##" 引导。更多相关信息请参阅 INSTALL.sgi。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/socppc:</font></h3>
<ul>
<p>
连接串口，通过 DHCP/tftp 引导安装。更多相关信息请参阅 INSTALL.socppc。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/sparc:</font></h3>
<ul>
从提供的 ISO 安装文件引导，根据你所用的 ROM 版本，
需用到下面两个命令中的一个。

<ul><pre>
ok <strong>boot cdrom 4.7/sparc/bsd.rd</strong>
或
&gt; <strong>b sd(0,6,0)4.7/sparc/bsd.rd</strong>
</pre></ul>

<p>
如果你的 SPARC 系统没有 CD 驱动器，你可以将
<i>floppy47.fs</i> 写入启动软盘。
更多相关信息请参阅 <a href="faq/faq4.html#MkFlop">FAQ 4.3.1</a>。
根据你所用的 ROM 版本，需用到下面两个命令中的一个来从软盘引导。

<ul><pre>
ok <strong>boot floppy</strong>
或
&gt; <strong>b fd()</strong>
</pre></ul>

<p>
请确认你的软盘无坏道，已经正确格式化。否则很可能会安装失败。

<p>
如果你的 SPARC 系统没有软驱和 CD 驱动器，你可以制作可启动磁带，
或者通过网络来安装。相关内容在 INSTALL.sparc 中。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/vax:</font></h3>
<ul>
用 mopbooting 通过网络启动来安装，相关信息请参阅 INSTALL.vax。
</ul>

<p>
<h3><font color="#e00000">OpenBSD/zaurus:</font></h3>
<ul>
<p>
用 Linux 内置的图形化安装程序 ipkg 来安装 openbsd47_arm.ipk 包。
重启之后，即可运行。更多信息请参阅 INSTALL.zaurus 。
</ul>

<p>
<h3><font color="#e00000">关于源代码的说明:</font></h3>
<ul>
src.tar.gz 包含的源代码文件开始路径是 /usr/src。
该文件包括除了内核代码之外的所有源代码，内核代码位于单独的档案文件中。
解压方法:
<p>
<ul><pre>
# <strong>mkdir -p /usr/src</strong>
# <strong>cd /usr/src</strong>
# <strong>tar xvfz /tmp/src.tar.gz</strong>
</pre></ul>
<p>
sys.tar.gz 包含的源代码文件路径开始是 /usr/src/sys。
该文件包括了重建内核需要的所有源代码。解压方法:
<p>
<ul><pre>
# <strong>mkdir -p /usr/src/sys</strong>
# <strong>cd /usr/src</strong>
# <strong>tar xvfz /tmp/sys.tar.gz</strong>
</pre></ul>
<p>
这些文件是 CVS 检出格式。可以使用<a href="anoncvs.html">匿名 CVS
服务器</a>基于它们获得最新的版本。基于这些文件更新，比从 CVS
完全检出的速度要快得多。
<p>
</ul>

<a name="upgrade"></a>
<hr>
<p>
<h3><font color="#0000e0">如何升级</font></h3>
<p>
如果你已经安装了OpenBSD 4.6，不想重新安装，可以在<a
href="../faq/upgrade47.html">升级指南</a>中找到升级方法和忠告。

<a name="ports"></a>
<hr>
<p>
<h3><font color="#0000e0">使用 ports 的方法</font></h3>
<p>
也提供了 ports 的档案文件。解压方法:
<p>
<ul><pre>
# <strong>cd /usr</strong>
# <strong>tar xvfz /tmp/ports.tar.gz</strong>
# <strong>cd ports</strong>
</pre></ul>
<p>
<i>ports/</i> 子目录是 OpenBSD ports 版本库的检出副本。假如你不了解 ports，
请浏览 <a href="../ports.html">ports</a> 页面。该文件并非是如何使用 ports 的手册，
它只是 OpenBSD ports 系统用户的初级读本。
<p>
The <i>ports/</i> 目录是我们从 CVS(如果你不熟悉 CVS，请参阅手册 <a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;apropos=0&amp;sektion=1&amp;manpath=OpenBSD+Current&amp;arch=i386">
cvs(1)</a>) 检出的 ports 副本。与我们的代码一样，ports 也可以通过匿名 CVS
服务器更新。因此，为了确保版本是最新的，必须使 <i>ports/</i> 在可读写的介质中，
更新的命令是:
<p>
<ul><pre>
# <strong>cd [portsdir]/; cvs -d anoncvs@server.openbsd.org:/cvs update -Pd -rOPENBSD_4_7</strong>
</pre></ul>
<p>
[当然，在实际操作时需要将本地目录和服务器名称替换成你的 ports
所在位置和较近的匿名 CVS 服务器。]
<p>
注意大部分的 ports 可以通过 FTP 获得预先编译的二进制包。如果发现问题，会为
4.7 版本发布升级包。
<p>
如果你有兴趣观察 ports 的变动信息，或者帮助我们，或者只是想获得更多的信息，
请加入邮件列表 ports@openbsd.org 。
<p>

<hr>
<a href="index.html"><img height="24" width="24" src="../back.gif" border="0"
alt="OpenBSD"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br><small>
$OpenBSD: 47.html,v 1.3 2010/10/19 14:31:15 ajacoutot Exp $
</small>

</body>
</html>

<!--
Originally [OpenBSD: 47.html,v 1.62]<br>
$Translation: 47.html,v 1.4 2010/10/19 14:17:34 dongsheng Exp $<br>
-->

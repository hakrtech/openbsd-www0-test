<!DOCTYPE HTML PUBLIC  "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>OpenBSD/mvme88k</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="resource-type" content="document">
<meta name="description" content="the OpenBSD/mvme88k page">
<meta name="keywords" content="openbsd,mvme88k">
<meta name="distribution" content="global">
<meta name="copyright" content="This document copyright 1996-2003 by OpenBSD.">
</head>

<body bgcolor="#ffffff" text="#000000" link="#23238e">
<a href="index.html"><img alt="[OpenBSD]" height="30" width="141" src="images/smalltitle.gif" border="0"></a>
<p>
<h2><font color="#e00000">OpenBSD/mvme88k</font></h2>

<hr>

<p>
OpenBSD/mvme88k is an effort to port OpenBSD to the Motorola's 881x0-based
VME motherboard family.
</p>

<p>
There is currently no maintainer for the mvme88k port, as it is not
officially supported.
The people working on it are
<a href="mailto:smurph@openbsd.org">Steve Murphree</a> and
<a href="mailto:miod@openbsd.org">Miodrag Vallat</a>.
</p>

<a href="#toc"></a>
<h3><font color="#0000e0"><i>Table of contents</i></font></h3>
<p>
<ul>
  <li><a href="#history">History of the port</a>
  <li><a href="#status">Current status</a>
  <li><a href="#projects">Project list</a>
  <li><a href="#hardware">Supported hardware list</a>
  <li><a href="#install">Getting and installing OpenBSD/mvme88k</a>
  <li><a href="#details">Hardware details</a>
</ul>
</p>

<hr>
<a name="history"></a>
<h3><font color="#0000e0"><strong>History:</strong></font></h3>

<p>
The Motorola 88k processor is said to be the best RISC processor ever 
devised.  Its simplicity and elegance combine to make the mvme88k a 
hearty, robust platform. 
</p>

<p>
Nivas Madhur started the initial mvme88k port for the MVME187 card, but
has since moved on to another employer.  
The port was brought in the OpenBSD tree by Dale Rahn, but he did not
have enough time to work on it.
Steve Murphree, Jr. eventually completed the port to the MVME187 in
November 1998.
</p>

<p>
Unfortunately, at the same time, a compiler upgrade from gcc 2.8.1 to
egcs revealed a lot of problems in the mvme88k support in gcc, which
could not be fixed in time for mvme88k to be a supported OpenBSD 2.5
release.
</p>

<p>
The lack of an in-tree toolchain did not prevent further work on the port,
and a lot of changes were made to the codebase, such as revamped autoconf
and on-board SCSI driver, greatly expanded VME bus support, working install
process that correctly creates a Motorola VID block on the disks,
and support for MVME188 as well as improving support for MVME197.
</p>

<hr>
<a name="status"></a>
<h3><font color="#0000e0"><strong>Current status:</strong></font></h3>

<p>
Recent work on the toolchain eventually produced a working compiler, although
optimization is not yet totally reliable. Unfortunately, a few kernel bugs
prevent the system from being very stable at the moment.
</p>

<hr>
<a name="projects"></a>
<h3><font color="#0000e0"><strong>Projects (in no particular order):
</strong></font></h3>

<p>
<ul>
  <li>Fix remaining gcc mvme88k code generation bugs when optimization is used.
  <li>Improve the kernels overall stability by debugging and fixing issues.
  <li>Repair MVME188 and MVME197 support.
  <li>Work on unsupported cards (MVME327, MVME374...).
  <li>Write code for new binutils (and gdb!!), switch to ELF and, later,
      shared libraries.
</ul>
</p>

<hr>
<a name="hardware"></a>
<h3><font color="#0000e0"><strong>Supported hardware:</strong></font></h3>

<p>
<h4>Supported processor boards</h4>
</p>

<p>
<ul>
<li><strong>MVME187</strong> (single processor 88100)<br>
All the on-board devices are supported, except for the parallel port.
<li><strong>Motorola 8120</strong>
This system is based on an MVME187 with no VMEBus, and is supported as well
as the regular MVME187.
</ul>
</p>

<p>
<h4>Supported on-board devices</h4>
</p>

<p>
<ul>
<li><strong>Serial ports</strong>
  <ul>
  <li>MVME187 on-board Cirrus Logic CL2400 serial ports (tty00-tty03)
<!--  <li>MVME188 SYSCON DUART serial ports (ttya, ttyb) -->
  </ul>
<li><strong>Ethernet adapters</strong>
  <ul>
  <li>MVME187 <!-- and MVME197 -->on-board Intel i82586 interface
  </ul>
<li><strong>SCSI controllers</strong>
  <ul>
  <li>MVME187 <!-- and MVME197 -->on-board NCR 53c7xx controller
  </ul>
</ul>
</p>

<p>
<h4>Supported extension boards</h4>
</p>

<p>
<ul>
  <li><strong>MVME328</strong>: SCSI controller
  <li><strong>MVME332</strong>: 8 port serial board
  <li><strong>MVME376</strong>: VME Lance ethernet
</ul>
</p>

<p>
<h4>Unsupported processor boards</h4>
<p>

<p>
Although these boards have been more or less supported in the past, their
support is currently non-functional in the latest snapshot.
<ul>
<li><strong>MVME188</strong> (one to four 88100 processors)<br>
Contrary to the other MVME processor boards, this board has no on-board
devices; it just acts as a container for an <i>HyperModule</i> which provides
1, 2 or 4 processors, and associated Cache/Memory Management Units
(<i>CMMU</i>).
All existing HyperModule models should be supported, but this has only been
tested so far on 1P64 (1 cpu, 4 cmmu) and 2P256 (2 cpu, 4 cmmu) modules.
External cards specific to the MVME188 family provide memory and serial ports.
<li><strong>MVME197</strong> (single or dual processor 88110)<br>
The MVME197 boards come in different flavours, differing by the number of
processors (1 or 2) and the optional presence of an external cache controller.
All existing configurations should be supported, but this has only been tested
on a MVME197LE (no external cache controller) board.
Support for this board is still very experimental and has issues.
</ul>
</p>

<hr>
<a name="install"></a>
<h3><font color="#0000e0">
<strong>Getting and installing OpenBSD/mvme88k:</strong>
</font></h3>

<p>
Snapshots are made available from time to time, in
<a href="ftp://ftp.openbsd.org/pub/OpenBSD/snapshots/mvme88k">this location</a>
as well as in a few
<a href="ftp.html">mirrors</a>.
Here are the
<a href="ftp://ftp.openbsd.org/pub/OpenBSD/snapshots/mvme88k/INSTALL.mvme88k">
OpenBSD/mvme88k snapshot installation instructions
</a> as well.
</p>

<hr>
<a name="details"></a>
<h3><font color="#0000e0"><strong>Hardware details:</strong></font></h3>

<p>
As VME hardware is quite uncommon in the average retail place, and Motorola
881x0-based hardware is even more rare, this section is here to satisfy the
well-founded curiosity about the mvme88k hardware.
</p>

<a name="pics">
<p>
Pictures of a Motorola 900 modular chassis, with a 33MHz MVME187 CPU board,
32MB RAM, 4 MVME332XT serial boards, and an Archive 250MB QIC tape drive.
<ul>
 <li><a href="images/mvme187-1.jpg">MVME187 Series 900 (front view)</a>
 <li><a href="images/mvme187-2.jpg">MVME187 Series 900 (rear view)</a>
 <li><a href="images/mvme187-3.jpg">MVME187 Series 900 (rear view w/terminal)</a>
 <li><a href="images/mvme187-4.jpg">MVME187 Series 900 (rear view close up)</a>
 <li><a href="images/mvme188-2.jpg">MVME188 Dual proc board</a>
</ul>
</p>

<p>
This is a boot log of an MVME187 system.
<pre>
MVME187 board configuration #A: 1 CPUs 2 CMMUs
CPU0 is attached with 2 MC88200 CMMUs
CPU0 is master CPU
[ using 163088 bytes of bsd a.out symbol table ]
Copyright (c) 1982, 1986, 1989, 1991, 1993
        The Regents of the University of California.  All rights reserved.
Copyright (c) 1995-2003 OpenBSD. All rights reserved.  http://www.OpenBSD.org

OpenBSD 3.3-current (GENERIC) #86: Sun Aug 10 03:49:48 GMT 2003
    miod@arzon:/usr/src/sys/arch/mvme88k/compile/GENERIC
Model: Motorola MVME187, 33MHz
real mem  = 67108864
avail mem = 59138048 (14438 pages)
using 844 buffers containing 3457024 bytes of memory
mainbus0 (root) machine type MVME187
bugtty0 at mainbus0 addr 0xfff45000: bugtty
pcctwo0 at mainbus0 addr 0xfff00000: rev 0
clock0 at pcctwo0 ipl 5: VME1x7
sclock0 at pcctwo0 ipl 5: VME1x7
memc0 at pcctwo0 offset 0x43000: MEMC040 rev 1
memc1 at pcctwo0 offset 0x43100: MCECC rev 0
nvram0 at pcctwo0 offset 0xc0000: MK48T08 len 8192
cl0 at pcctwo0 offset 0x45000 ipl 3 console
vme0 at pcctwo0 offset 0x40000: vector base 0x80, system controller
vme0: using BUG parameters
vme0: 1phys 0x04000000-0xefff0000 to VME 0x04000000-0xefff0000
vme0: 2phys 0xff000000-0xff7f0000 to VME 0xff000000-0xff7f0000
vme0: 3phys 0x00000000-0x00000000 to VME 0x00000000-0x00000000
vme0: 4phys 0x00000000-0x00000000 to VME 0x00000000-0x00000000
vme0: vme to cpu irq level 1:1
vmes0 at vme0
vs0 at vmes0 addr 0xffff9000 vaddr 0x551b000 vec 0x80 ipl 2: target 7
scsibus0 at vs0: 8 targets
sd0 at scsibus0 targ 0 lun 0: &lt;COMPAQPC, DCAS-32160, S6CA&gt; SCSI2 0/direct fixed
sd0: 2006MB, 8188 cyl, 3 head, 167 sec, 512 bytes/sec, 4110000 sec total
vmel0 at vme0
ie0 at pcctwo0 offset 0x46000 ipl 1: address 08:00:3e:21:7c:74
boot device: sd0
root on sd0a
rootdev=0x400 rrootdev=0x800 rawdev=0x802
Automatic boot in progress: starting file system checks.
/dev/rsd0a: file system is clean; not checking
/dev/rsd0d: file system is clean; not checking
/dev/rsd0e: file system is clean; not checking
/dev/rsd0f: file system is clean; not checking
/dev/rsd0g: file system is clean; not checking
/dev/rsd0h: file system is clean; not checking
/dev/rsd0i: file system is clean; not checking
setting tty flags
ddb.console: 0 -&gt; 1
kern.splassert: 0 -&gt; 2
starting network
add net default: gateway odyssee
starting system logger
starting rpc daemons: portmap ypbind rdate timed.
savecore: no core dump
checking quotas: done.
building ps databases: kvm dev.
clearing /tmp
starting pre-securelevel daemons:.
setting kernel security level: kern.securelevel: 0 -&gt; 1
creating runtime link editor directory cache.
starting network daemons: inetd sshd.
starting local daemons:.
standard daemons: cron.
Sun Aug 10 20:22:04 GMT 2003

OpenBSD/mvme88k (arzon) (console)

login:  
</pre>

<hr>
<a href="plat.html">
<img height="24" width="24" src="back.gif" border="0" alt="Supported platforms">
</a> 
<br>
<small><a href="mailto:www@openbsd.org">www@openbsd.org</a></small>
<br>
<small>$OpenBSD: mvme88k.html,v 1.33 2003/08/10 21:20:15 miod Exp $</small>

</body>
</html>

<!DOCTYPE HTML PUBLIC  "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>OpenBSD/mvme88k</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="resource-type" content="document">
<meta name="description" content="the OpenBSD/mvme88k page">
<meta name="keywords" content="openbsd,mvme88k">
<meta name="distribution" content="global">
<meta name="copyright" content="This document copyright 1996-2003 by OpenBSD.">
</head>

<body bgcolor="#ffffff" text="#000000" link="#23238e">
<a href="index.html"><img alt="[OpenBSD]" height="30" width="141" src="images/smalltitle.gif" border="0"></a>
<p>
<h2><font color="#e00000">OpenBSD/mvme88k</font></h2>

<hr>

<p>
OpenBSD/mvme88k is an effort to port OpenBSD to the Motorola's 881x0-based
VME motherboard family.
</p>

<p>
There is currently no maintainer for the mvme88k port, as it is not
officially supported.
The people working on it are
<a href="mailto:smurph@openbsd.org">Steve Murphree</a> and
<a href="mailto:miod@openbsd.org">Miodrag Vallat</a>.
</p>

<a href="#toc"></a>
<h3><font color="#0000e0"><i>Table of contents</i></font></h3>
<p>
<ul>
  <li><a href="#history">History of the port</a>
  <li><a href="#status">Current status</a>
  <li><a href="#projects">Project list</a>
  <li><a href="#hardware">Supported hardware list</a>
  <li><a href="#install">Getting and installing OpenBSD/mvme88k</a>
  <li><a href="#details">Hardware details</a>
</ul>
</p>

<hr>
<a name="history"></a>
<h3><font color="#0000e0"><strong>History:</strong></font></h3>

<p>
The Motorola 88k processor is said to be the best RISC processor ever 
devised.  Its simplicity and elegance combine to make the mvme88k a 
hearty, robust platform. 
</p>

<p>
Nivas Madhur started the initial mvme88k port for the MVME187 card, but
has since moved on to another employer.  
The port was brought in the OpenBSD tree by Dale Rahn, but he did not
have enough time to work on it.
Steve Murphree, Jr. eventually completed the port to the MVME187 in
November 1998.
</p>

<p>
Unfortunately, at the same time, a compiler upgrade from gcc 2.8.1 to
egcs revealed a lot of problems in the mvme88k support in gcc, which
could not be fixed in time for mvme88k to be a supported OpenBSD 2.5
release.
As of today, these problems are still not entirely fixed.
</p>

<p>
The lack of an in-tree toolchain did not prevent further work on the port,
and a lot of changes were made to the codebase, such as revamped autoconf
and on-board SCSI driver, greatly expanded VME bus support, working install
process that correctly creates a Motorola VID block on the disks,
and support for MVME188 as well as improving support for MVME197.
</p>

<hr>
<a name="status"></a>
<h3><font color="#0000e0"><strong>Current status:</strong></font></h3>

<p>
Recent work on the toolchain eventually produced a working compiler, as long
as optimization is not enabled; work is in progress towards getting reliable
optimization as well. Unfortunately, numerous kernel stability problems make
this effort progress very slowly at the moment.
</p>

<hr>
<a name="projects"></a>
<h3><font color="#0000e0"><strong>Projects (in no particular order):
</strong></font></h3>

<p>
<ul>
  <li>Fix remaining gcc mvme88k code generation bugs and get optimization
      working.
  <li>Improve the kernels overall stability by debugging and fixing issues.
  <li>Improve MVME197 support reliability.
  <li>Work on unsupported cards (MVME327, MVME374...).
  <li>Write code for new binutils (and gdb!!), switch to ELF and, later,
      shared libraries.
</ul>
</p>

<hr>
<a name="hardware"></a>
<h3><font color="#0000e0"><strong>Supported hardware:</strong></font></h3>

<p>
<h4>Supported processor boards</h4>
</p>

<p>
<ul>
<li><strong>MVME187</strong> (single processor 88100)<br>
All the on-board devices are supported, except for the parallel port.
<li><strong>MVME188</strong> (one to four 88100 processors)<br>
Contrary to the other MVME processor boards, this board has no on-board
devices; it just acts as a container for an <i>HyperModule</i> which provides
1, 2 or 4 processors, and associated Cache/Memory Management Units
(<i>CMMU</i>).
All existing HyperModule models should be supported, but this has only been
tested so far on 1P64 (1 cpu, 4 cmmu) and 2P256 (2 cpu, 4 cmmu) modules.
External cards specific to the MVME188 family provide memory and serial ports.
<li><strong>MVME197</strong> (single or dual processor 88110)<br>
The MVME197 boards come in different flavours, differing by the number of
processors (1 or 2) and the optional presence of an external cache controller.
All existing configurations should be supported, but this has only been tested
on a MVME197LE (no external cache controller) board.
Support for this board is still very experimental and has issues.
</ul>
</p>

<p>
<h4>Supported on-board devices</h4>
</p>

<p>
<ul>
<li><strong>Serial ports</strong>
  <ul>
  <li>MVME187 on-board Cirrus Logic CL2400 serial ports (tty00-tty03)
  <li>MVME188 SYSCON DUART serial ports (ttya, ttyb)
  </ul>
<li><strong>Ethernet adapters</strong>
  <ul>
  <li>MVME187 and MVME197 on-board Intel i82586 interface
  </ul>
<li><strong>SCSI controllers</strong>
  <ul>
  <li>MVME187 and MVME197 on-board NCR 53c7xx controller
  </ul>
</ul>
</p>

<p>
<h4>Supported extension boards</h4>
</p>

<p>
<ul>
  <li><strong>MVME328</strong>: SCSI controller
  <li><strong>MVME332</strong>: 8 port serial board
  <li><strong>MVME376</strong>: VME Lance ethernet
</ul>
</p>

<hr>
<a name="install"></a>
<h3><font color="#0000e0">
<strong>Getting and installing OpenBSD/mvme88k:</strong>
</font></h3>

<p>
Due to the compiler problems, no snapshots have been generated since a long
time. There was a 2.4-current snapshot on the ftp mirrors for some time, which
supports only MVME187 cards and can be used as a very crude basis to rebuild
a complete system, for the adventurous hacker. If you want to get it, ask
<a href="mailto:miod@openbsd.org">miod</a>. Access to an
<a href="mvme68k.html">OpenBSD/mvme68k</a> system greatly helps, as both
systems are very similar.
</p>


<p>
Due to the recent toolchain improvements, a new snapshot is expected soon.
Stay tuned!
</p>

<hr>
<a name="details"></a>
<h3><font color="#0000e0"><strong>Hardware details:</strong></font></h3>

<p>
As VME hardware is quite uncommon in the average retail place, and Motorola
881x0-based hardware is even more rare, this section is here to satisfy the
well-founded curiosity about the mvme88k hardware.
</p>

<a name="pics">
<p>
Pictures of a Motorola 900 modular chassis, with a 33MHz MVME187 CPU board,
32MB RAM, 4 MVME332XT serial boards, and an Archive 250MB QIC tape drive.
<ul>
 <li><a href="images/mvme187-1.jpg">MVME187 Series 900 (front view)</a>
 <li><a href="images/mvme187-2.jpg">MVME187 Series 900 (rear view)</a>
 <li><a href="images/mvme187-3.jpg">MVME187 Series 900 (rear view w/terminal)</a>
 <li><a href="images/mvme187-4.jpg">MVME187 Series 900 (rear view close up)</a>
 <li><a href="images/mvme188-2.jpg">MVME188 Dual proc board</a>
</ul>
</p>

<p>
This is a dmesg of an MVME188 system.
<pre>
Model: Motorola MVME188 25Mhz
MVME188 board configuration #5: 2 CPUs 4 CMMUs
CPU0 is attached with 2 MC88204 CMMUs
CPU1 is attached with 2 MC88204 CMMUs
CPU0 is master CPU
[ using 146999 bytes of bsd a.out symbol table ]
ddb enabled
Copyright (c) 1982, 1986, 1989, 1991, 1993
	The Regents of the University of California.  All rights reserved.
Copyright (c) 1995-2001 OpenBSD. All rights reserved.  http://www.OpenBSD.org

OpenBSD 2.9-current (GENERIC) #59: Thu Jun 14 01:18:03 GMT 2001
    miod@arzon:/src/current/src/sys/arch/mvme88k/compile/GENERIC
real mem  = 33550336
avail mem = 28381184 (6929 pages)
using 435 buffers containing 1781760 bytes of memory
mainbus0 (root) machine type MVME188
bugtty0 at mainbus0 addr 0xfff45000: bugtty
syscon0 at mainbus0 addr 0xfff00000: rev 1
clock0 at syscon0 ipl 5: VME188
sclock0 at syscon0 ipl 5: VME188
nvram0 at syscon0 offset 0x80000: MK48T02 len 2048
dart0 at syscon0 offset 0x82000 ipl 3 console (ttya) 
vme0 at syscon0 offset 0x85000: system controller
vmes0 at vme0
vs0 at vmes0 addr 0xffff9000 vaddr 0x2e59000 vec 0x80 ipl 2: target 7
scsibus0 at vs0: 8 targets
sd0 at scsibus0 targ 1 lun 0: &lt;FUJITSU, M2624F-512, M405&gt; SCSI1 0/direct fixed
sd0: 496MB, 1429 cyl, 11 head, 64 sec, 512 bytes/sec, 1015812 sec total
vs1 at vmes0 addr 0xffff9800 vaddr 0x2e5a800 vec 0x82 ipl 2: target 7
scsibus1 at vs1: 8 targets
ve0 at vmes0 addr 0xffff1200 vaddr 0x2e5b200 vec 0x74 ipl 1
ve0: address 00:00:77:83:9f:cc
ve0: 128 receive buffers, 32 transmit buffers
vmel0 at vme0
boot device: sd0
root on sd0a
rootdev=0x400 rrootdev=0x800 rawdev=0x802
</pre>

<hr>
<a href="plat.html">
<img height="24" width="24" src="back.gif" border="0" alt="Supported platforms">
</a> 
<br>
<small><a href="mailto:www@openbsd.org">www@openbsd.org</a></small>
<br>
<small>$OpenBSD: mvme88k.html,v 1.32 2003/08/05 13:53:02 miod Exp $</small>

</body>
</html>
